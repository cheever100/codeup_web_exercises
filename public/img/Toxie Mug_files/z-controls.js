Uize.module({name:'Zazzle.Widgets.IAFooter',superclass:'Zazzle.Widget.V2',required:['Uize.Dom.Basics'],builder:function(f_$){'use strict';var f__=Uize,f_a=f__.Dom.Basics;return f_$.subclass({stateProperties:{
},omegastructor:function(){var m=this;m.wireNode('viewFullSite','click',function(){m.ajax({service:'mobilesetfullwidth',ax:'true'},{callbackSuccess:function(f_b){location.href=location.href;}});});m.wireNode('viewMobileSite','click',function(){
m.ajax({service:'mobilesetfullwidth',ax:'false'},{callbackSuccess:function(f_b){location.href=location.href;}});});},childBindings:{},cssBindings:{},htmlBindings:{},eventBindings:{'#i18nLink:click':function(){
var m=this;m.web('i18nLi').toggleClass(m.cssClass('i18nLiActive'));}},instanceMethods:{wireUi:function(){var m=this;if(!m.isWired){var f_c=m.children.i18nPalette;if(f_c){m.web('i18nLink').click(function(){
f_c.set('shown',!f_c.get('shown'));});}f_$.doMy(m,'wireUi');}}}});}});
Uize.module({name:'ZazzleWww.BasicPromotion.HeaderBar',required:['Uize.Node','Uize.Widget.FormElement.Text','Uize.Widget.mWeb'],builder:function(e_$){'use strict';var e__=true,e_a=false,e_b=null,e_c=Uize
;var e_d=e_$.subclass(),e_e=e_d.prototype;e_d.mixins(e_c.Widget.mWeb);e_e.e_f=function(e_g,e_h){this.web(e_h).setClassState('active',e_g);};e_e.e_i=function(){var m=this;m.web('expanded').display(m.e_j);
m.web('contracted').display(!m.e_j);};e_e.wireUi=function(){var m=this;if(!m.isWired){if(m.e_k){var e_l=document.documentElement,e_m=document.body;e_c.Node.wire(window,{'load':function(){m.e_n&&setTimeout(
function(){m.e_f(e__,m.e_o);setTimeout(function(){m.e_f(e_a,m.e_o);},m.e_p);},m.e_q);},'scroll':function(){var e_r=(e_l&&e_l.scrollTop||e_m&&e_m.scrollTop||window.pageYOffset&&window.pageYOffset||0);
m.e_s&&clearTimeout(m.e_s);m.e_s=setTimeout(function(){if(m.e_t){if(!m.e_j){setTimeout(function(){m.e_f(e_a,m.e_u);},500);}}m.e_f(e_r==0&& !m.e_j,m.e_o);},e_r==0?m.e_v:m.e_w);}});m.web('contracted').click(function(){
m.set('isExpanded',e__);});m.web('expandHitzone').click(function(){m.set('isExpanded',e_a);});if(!m.e_t){m.web('expanded').click(function(){m.set('isExpanded',e_a);});m.web().mouseout(function(){m.e_f(e_a,'');
m.set('isExpanded',e_a);});}var e_x=m.addChild('promoInput',Uize.Widget.FormElement.Text);e_x.wire('Changed.focused',function(){e_x.isWired&&e_x.get('focused')&&e_x.select();});}e_$.doMy(m,'wireUi');
}};e_d.stateProperties({e_o:{name:'activeClassNode',value:'title'},e_n:{name:'allowAnimationOnLoad',value:e_a},e_y:'cssClassPeekout',e_k:{name:'useAnimation',value:e__},e_q:{name:'afterLoadAnimationDelay',
value:1000},e_p:{name:'afterLoadAnimationDuration',value:1500},e_v:{name:'afterScrollAnimationDelay',value:10},e_w:{name:'afterScrollAnimationDuration',value:100},e_t:{name:'isHandheld',value:e_a},e_j:{
name:'isExpanded',value:e_a,onChange:function(){this.e_i();}},e_z:{name:'scrollThreshold',value:40}});return e_d;}});
Uize.module({name:'ZazzleWww.WebHook',superclass:'Zazzle.Widget.V2',required:['Uize.Url'],builder:function(f_$){'use strict';var f__=Uize,f_a=true,f_b=false;return f_$.subclass({alphastructor:function(){
var m=this,f_c=f_a;if(Uize.global().localStorage&&Uize.global().localStorage.getItem("webhookFirstTimeClosed")){var f_d=JSON.parse(Uize.global().localStorage.getItem("webhookFirstTimeClosed"));var f_e=new Date();
var f_f=new Date(f_d.timestamp);if(f_f<f_e){f__.global().localStorage.removeItem("webhookFirstTimeClosed");m.set({f_g:f_a});}}else m.set({f_g:f_a});},stateProperties:{f_h:{name:'isPhone'},f_i:{name:'isTopShown'
},f_j:{name:'sourceButton'},f_k:{name:'sourceTypePosition'},f_l:{name:'sourceTypeId'},f_m:{name:'pageType'},f_n:{name:'pageParam'},f_o:{name:'marketURL'},f_p:{name:'osVer'},f_q:{name:'osType'},f_r:{name:'isTablet'
},f_s:{name:'persistentTopBanner',value:f_a},f_g:{name:'firstTimeOpen',onChange:function(){var m=this;if(!this.f_g){if(Uize.global().localStorage&& !Uize.global().localStorage.getItem("webhookFirstTimeClosed")){
var f_t=new Date();f_t.setDate(f_t.getDate()+1);var webHookObject={value:"true",timestamp:f_t};try{Uize.global().localStorage.setItem("webhookFirstTimeClosed",JSON.stringify(webHookObject));}catch(error){
}}m.fire({name:'Track Event',bubble:true,extra:{ax:'webhookBottomClosed',sourceType:'web_banner',sourceTypeId:m.f_l,sourceTypePosition:m.f_k,sourcePage:m.f_m,sourceURL:document.URL,sourceOS:m.f_u(m),
sourceRouteDestination:m.f_v(m),isControl:m.f_i,isPhone:m.f_h,isTablet:m.f_r,isBlueClosed:m.f_g}});}}},f_w:{name:"isTabletSticky",derived:{properties:["windowScrollY","firstTimeOpen","topThreshold","isSupported"],
derivation:function(f_x,f_g,f_y,f_z){return f_x>=f_y&&f_g&&f_z;}}},f_A:{name:"isTopTabletSticky",derived:{properties:["isTopSticky","isTablet"],derivation:function(f_B,f_r){return f_B&&f_r;}}},f_C:{name:"isMobileSticky",
derived:{properties:["windowScrollY","firstTimeOpen","topThreshold","isSupported"],derivation:function(f_x,f_g,f_y,f_z){return f_x>=f_y&&f_g&&f_z;}}},f_x:{name:"windowScrollY",value: -401},f_y:{name:"topThreshold",
value: -400},f_B:{name:"isTopSticky",derived:{properties:["persistentTopBanner","firstTimeOpen"],derivation:function(f_s,f_g){return f_s&& !f_g;}}},f_z:{name:"isSupported",derived:{properties:["pageType"],
derivation:function(f_m){return f_m==='Default'||typeof f_m==='undefined'?f_b:f_a;}}}},cssBindings:{isTopTabletSticky:['','promoTablet'],isTopSticky:['','topSticky'],isTabletSticky:['','tabletSticky'],
isMobileSticky:['','mobileSticky']},eventBindings:{'#rmTopBanner:click':function(){this.set({f_s:f_b});},'#rmBanner:click':function(){this.set({f_g:f_b});},'#stickyBottomBanner:click':function(){var m=this;
m.f_k="bottom";m.f_l="sticky_v1";m.f_j="botton_slim_banner";m.f_D(m);},'#bottomBanner:click':function(){var m=this;m.f_k="bottom_pinned";m.f_l="pinned_blue_v1";m.f_j="pinned_bottom_banner";m.f_D(m);},
'#tabletBottomBanner:click':function(){var m=this;m.f_k="bottom";m.f_l="sticky_blue_v1";m.f_j="sticky_bottom_popover ";m.f_D(m);},'#topBanner:click':function(){var m=this;m.f_k="top";m.f_l="slim_dismissible_v1";
m.f_j="top_slim_banner";m.f_D(m);}},instanceMethods:{f_D:function(m){if(m.f_q===0){m.f_E(m);}else if(m.f_q===1){m.f_F(m);}},f_G:function(m){var f_H="";if(m.f_j==="bottom_sticky_banner")f_H+="&source_type=web_popover";
else f_H+="&source_type=web_banner";f_H+="&source_type_id="+m.f_l;f_H+="&source_type_position="+m.f_k;f_H+="&source_page="+m.f_m;f_H+="&source_url="+document.URL;if(m.f_q===1){f_H+="&utm_source=zazzle_site";
f_H+="&utm_content="+m.f_j;f_H+="&utm_term="+m.f_m;}return f_H;},f_v:function(m){var f_I="";switch(m.f_m){case"Cart":f_I="cart?stub=0";break;case"Product":f_I="product?product_id="+m.f_n;break;case"Collections":
f_I="collection?collection_id="+m.f_n;break;case"Department":f_I="department?department="+m.f_n;break;case"Order":if(m.f_n===null)f_I="order?";else f_I="order?order_id="+m.f_n;break;case"Search":f_I="search?query="+m.f_n;
break;case"Home":f_I="page?stub=0";case"Default":f_I="page?stub=0";break;default:f_I="page?stub=0";}return f_I+m.f_G(m);},f_u:function(m){if(m.f_q===0){return"iOS";}else if(m.f_q===1){return"Android";
}},f_E:function(m){var timer;var heartbeat;var lastInterval;function clearTimers(){clearTimeout(timer);clearTimeout(heartbeat);}window.addEventListener("pageshow",function(e){clearTimers();},false);window.addEventListener("pagehide",function(e){
clearTimers();},false);function getTime(){return(new Date()).getTime();}function intervalHeartbeat(){var now=getTime();var diff=now-lastInterval-200;lastInterval=now;if(diff>1000){clearTimers();}}function launchAppOrAltUrl(m){
var timeToOpen;lastInterval=getTime();heartbeat=setInterval(intervalHeartbeat,200);m.fire({name:'Track Event',bubble:true,extra:{ax:'webhookInstalled',sourceType:'web_banner',sourceTypeId:m.f_l,sourceTypePosition:m.f_k,
sourcePage:m.f_m,sourceURL:document.URL,sourceOS:m.f_u(m),sourceRouteDestination:m.f_v(m),isControl:m.f_i,isPhone:m.f_h,isTablet:m.f_r,isBlueClosed:m.f_g}});document.location="zazzle://"+m.f_v(m);if(parseInt(m.f_p)>=8){
timeToOpen=800;}else{timeToOpen=30;}timer=setTimeout(function(){m.fire({name:'Track Event',bubble:true,extra:{ax:'webhookNotInstalled',sourceType:'web_banner',sourceTypeId:m.f_l,sourceTypePosition:m.f_k,
sourcePage:m.f_m,sourceURL:document.URL,sourceOS:m.f_u(m),sourceRouteDestination:m.f_v(m),isControl:m.f_i,isPhone:m.f_h,isTablet:m.f_r,isBlueClosed:m.f_g}});document.location=m.f_o;},timeToOpen);}launchAppOrAltUrl(m);
event.preventDefault();},f_F:function(m){var custom="zazzle://"+m.f_v(m)+"#Intent;scheme=zazzle;package=com.zazzle;end";var alt=m.f_o;var gIntent="intent://"+m.f_v(m)+"#Intent;scheme=zazzle;package=com.zazzle;end";
var timer;var heartbeat;var iframeTimer;function clearTimers(){clearTimeout(timer);clearTimeout(heartbeat);clearTimeout(iframeTimer);}function intervalHeartbeat(){if(document.webkitHidden||document.hidden){
clearTimers();}}function track(){m.fire({name:'Track Event',bubble:true,extra:{ax:'webhookAndroid',sourceType:'web_banner',sourceTypeId:m.f_l,sourceTypePosition:m.f_k,sourcePage:m.f_m,sourceURL:document.URL,
sourceOS:m.f_u(m),sourceRouteDestination:m.f_v(m),isControl:m.f_i,isPhone:m.f_h,isTablet:m.f_r,isBlueClosed:m.f_g}});}function tryIframeApproach(){var iframe=document.createElement("iframe");iframe.style.border="none";
iframe.style.width="1px";iframe.style.height="1px";iframe.onload=function(){track();document.location=alt;};iframe.src=custom;document.body.appendChild(iframe);}function tryWebkitApproach(){document.location=custom;
timer=setTimeout(function(){track();document.location=alt;},2500);}function useIntent(){track();document.location=gIntent;}function launchAppOrAltUrl(el){heartbeat=setInterval(intervalHeartbeat,200);
if(navigator.userAgent.match(/Chrome/)){useIntent();}else if(navigator.userAgent.match(/Firefox/)){tryWebkitApproach();iframeTimer=setTimeout(function(){tryIframeApproach();},1500);}else{tryIframeApproach();
}}launchAppOrAltUrl(m);event.preventDefault();},wireUi:function(){var m=this;if(!m.isWired){var f_J=m.web(window);f_J.scroll(function(f_K){m.set("windowScrollY",f_J.scrollTop());});f_$.doMy(m,'wireUi');
}}}});}});
Uize.module({name:'ZazzleWww.ZazzleFooter2',superclass:'Zazzle.Widget',required:['Uize.Dom.Basics','ZazzleWww.EmailSignupForm','Zazzle.Widgets.IAFooter'],builder:function(e_$){'use strict';var e__=true,
e_a=false,e_b=null,e_c=Uize.Dom.Basics;var e_d=e_$.subclass(e_b,function(){var m=this;m.addChild('iaFooter',Zazzle.Widgets.IAFooter);m.addChild('emailSignup',ZazzleWww.EmailSignupForm);m.addChild('emailSignup2',ZazzleWww.EmailSignupForm);
}),e_e=e_d.prototype;e_e.wireUi=function(){var m=this;if(!m.isWired){e_$.doMy(m,'wireUi');}};e_d.stateProperties({});return e_d;}});
Uize.module({name:'Zazzle.SelectorValueDisplayBase',superclass:'Uize.Widget.Button.ValueDisplay.Selector',required:'Uize.Url',builder:function(g_$){'use strict';var g__=false,g_a=null,g_b=Uize.Url,g_c='Alternate',
g_d='None',g_e=function(){this.set({g_f:true});return this.canWire;},g_g=function(){this.set({canWire:this.g_f&& !this.isWired&&this.g_h!==g__});},g_i=function(){this.set({canUpdate:this.isWired&&this.g_h!==g__});
},g_j=function(){var m=this,g_k=m.get('valueDetails'),g_l=m.g_l;if(m.isWired&&g_k&&g_l){var g_m=function(g_n){return!!g_n},g_o=function(g_p,g_n,g_q){var g_r=m.web(g_p);g_r.display(g_q);g_q&&g_r.html(g_n);
},g_s=g_l.showDisplayName==g_c?g_k.displayNameAlt||g_k.displayName:g_k.displayName,g_t=g_k.importantInfo,g_u=g_l.showDescription==g_c?g_k.descriptionAlt||g_k.description:g_k.description,g_v=g_l.showThumbnail==g_c
?g_k.thumbnailUrlAlt||g_k.thumbnailUrl:g_k.thumbnailUrl,g_w=m.showDisplayName=g_l.showDisplayName!=g_d&&g_m(g_s),g_x=m.showImportantInfo=g_l.showImportantInfo&&g_m(g_t),g_y=m.showDescription=g_l.showDescription!=g_d
&&g_m(g_u),g_z=m.showThumbnail=m.g_A!=g__&&g_l.showThumbnail!=g_d&&g_m(g_v),g_B=m.showInput=g_l.showInput!=g_d,g_C=m.showData=g_w||g_x||g_y,g_D=m.web('thumbnail'),g_E=m.getInherited('env').assets;m.web('input').display(g_B);
if(g_C){g_o('displayName',g_s,g_w);g_o('importantInfo',g_t,g_x);g_o('description',g_u,g_y);}g_D.display(g_z&& !m.g_F);if(g_z&& !m.g_F){var g_G=g_v.charAt(0)=='#',g_H=g_G?g_a:g_b.resolve(g_v,(g_v.indexOf(g_E)<0
||g_b.from(g_v).query)?{max_dim:m.g_I,bg:g_l.thumbnailBgColor}:{});g_D.css({backgroundColor:g_G?g_v:'transparent',backgroundImage:g_H?'url("'+g_H+'")':'none'});}}},g_J=function(){this.set({g_h:this.g_A!==g__||this.g_K!==g__});
};return g_$.subclass({stateProperties:{g_L:{name:'layout',derived:'valueDisplayInfo:valueDisplayInfo && valueDisplayInfo.layout'},g_F:{name:'thumbnailIsZazzicon',derived:'zazzicon:zazzicon && zazzicon.indexOf("zazzicon-") === 0'
},g_I:{name:'thumbnailSize',onChange:g_j},g_l:{name:'valueDisplayInfo',onChange:g_j},g_M:{name:'zazzicon',derived:'valueDetails:valueDetails && valueDetails.attributes && valueDetails.attributes.zazzicon'
},canUpdate:{onChange:function(){this.canUpdate&&this.updateUi()}},canWire:{onChange:function(){if(this.canWire)this.get('built')?this.wireUi():this.insertUi()}},g_f:{name:'desiredWired',onChange:g_g
},g_A:{name:'seen',onChange:g_J},g_h:{name:'usable',onChange:[g_g,g_i]},g_K:{name:'usableWhenNotSeen',onChange:g_J,value:g__}},set:{mode:null},omegastructor:function(){var m=this;m.wire({'Changed.valueDetails':function(){m.g_j()},
'Changed.wired':function(){g_g.call(m);g_i.call(m);}});},instanceMethods:{g_j:g_j,insertOrWireUi:g_e,prepareToWire:g_e,unwireUi:function(){this.set({g_f:false});g_$.doMy(this,'unwireUi');},updateUi:function(){
var m=this;if(m.isWired&&m.canUpdate){g_$.doMy(m,'updateUi');m.g_j();}},wireUi:function(){var m=this;!m.isWired&&m.prepareToWire()&&g_$.doMy(m,'wireUi');}}});}});
Uize.module({name:'Zazzle.SelectorValueDisplay',superclass:'Zazzle.SelectorValueDisplayBase',required:'Zazzle.Widget.mV2',builder:function(h_$){var h__=function(){var m=this;m.web('label').value(m.h_a);
},h_b=function(){var m=this,h_c=m.get('valueDetails'),h_d=m.get('valueDisplayInfo');if(m.isWired&&m.canUpdate&&h_c&&h_d){var h_e=m.get('thumbnailIsZazzicon'),h_f= !!(m.showThumbnail||h_e),h_g=m.showData=m.showData
|| !!m.getNode('label')||m.h_h,h_i=m.getNode('inputImage');m.web(['inputCell','inputCellExtra']).display(h_d.showInput);m.web('input').display(!h_i);m.web(h_i).display();m.web('displayData').display(h_g);
m.web('thumbnailCell').display(h_f);if(h_f){!(m.h_j&&h_c.name!=null)&&m.web('thumbnail').property({alt:h_c.displayName,title:h_c.displayName});}m.web('thumbnailZazzicon').display(h_e);h_e&&m.web('thumbnailZazzicon').addClass(m.get('zazzicon'));
m.web('thumbDataExtra').display(h_g&&h_f);}};return h_$.subclass({mixins:[Zazzle.Widget.mV2],stateProperties:{h_a:{name:'label',onChange:h__},h_h:{name:'showAfterDisplayNameContent',onChange:h_b}},cssBindings:{
layout:'value',selected:['','selected'],thumbnailIsZazzicon:['','zazziconForThumbnail']},omegastructor:function(){var m=this;m.wire('Changed.valueDetails',function(){m.h_b()});},instanceMethods:{h_b:h_b,
h__:h__,updateUi:function(){var m=this;if(m.isWired&&m.canUpdate){h_$.doMy(m,'updateUi');m.h_b();m.h__();}}}});}});
Uize.module({name:'Uize.Util.PropertyAdapter',superclass:'Uize.Class',builder:function(c_$){'use strict';function c__(c_a){if(c_a){var c_b=Uize.isArray(c_a);if(c_b||Uize.isInstance(c_a))c_a=c_b?{instance:c_a[0],property:c_a[1]}:{instance:c_a}
;c_a.property||(c_a.property='value');}return c_a;}function c_c(){var m=this,c_d=m.c_d;function c_e(c_f){for(var c_g= -1,c_h=c_d.length,c_i;++c_g<c_h;)(c_i=c_d[c_g]).c_j[c_f](c_i.c_k,c_i.c_l);}if(c_d)
c_d=m.c_d=c_e('unwire');if(m.c_m){var c_n=m.c_n,c_o=m.c_o,c_p=m.c_p,c_q,c_r=function(c_s){var c_t=c_s?c_n:c_o,c_u=c_s?c_o:c_n;if(c_q!=c_u){var c_v=c_t.instance.get(c_t.property);c_q=c_t;c_u.instance.set(
c_u.property,c_p?c_p[c_s?'aToB':'bToA'](c_v):c_v);c_q=null;}};if(c_n&&c_o){c_r(true);c_d=m.c_d=[{c_j:c_n.instance,c_k:'Changed.'+c_n.property,c_l:function(){c_r(true)}},{c_j:c_o.instance,c_k:'Changed.'+c_o.property,
c_l:function(){c_r()}}];c_e('wire');}}}return c_$.subclass({stateProperties:{c_m:{name:'connected',onChange:c_c,value:true},c_n:{name:'propertyA',conformer:c__,onChange:c_c},c_o:{name:'propertyB',conformer:c__,
onChange:c_c},c_p:{name:'valueAdapter',onChange:c_c}}});}});
Uize.module({name:'Zazzle.Checkbox',superclass:'Uize.Widget.FormElement',required:['Zazzle.SelectorValueDisplay','Uize.Util.PropertyAdapter'],builder:function(e_$){var e__=e_$.subclass(null,function(){
var m=this,e_a=Uize.Util.PropertyAdapter,e_b=m.addChild('valueDisplay',m.e_c||Zazzle.SelectorValueDisplay,m.e_d);new e_a({propertyA:{instance:m,property:'value'},propertyB:{instance:e_b,property:'selected'
},valueAdapter:{aToB:function(e_e){return m.valueAtoB(e_e)},bToA:function(e_e){return m.valueBtoA(e_e)}}});new e_a({propertyA:{instance:e_b,property:'valueDetails'},propertyB:{instance:m,property:'label'
},valueAdapter:{aToB:function(e_e){return e_e?e_e.displayName:'';},bToA:function(e_e){return Uize.copyInto({},e_b.get('valueDetails'),{displayName:e_e});}}});e_b.wire({Over:function(){m.set({tentativeValue:true})},
Out:function(){m.set({tentativeValue:m.valueOf()})}});m.wire('Changed.value',function(){m.validate()});}),e_f=e__.prototype;e_f.valueAtoB=function(e_e){return e_e===true||e_e=='true'};e_f.valueBtoA=function(e_e){return e_e};
e_f.updateUi=function(){var m=this;if(m.isWired){m.children.valueDisplay.updateUi();e_$.doMy(m,'updateUi');}};e__.stateProperties({e_g:'label',e_c:'valueDisplayWidgetClass',e_d:{name:'valueDisplayWidgetProperties',
onChange:function(){var e_b=this.children.valueDisplay;e_b&&e_b.set(this.e_d);}}});return e__;}});
Uize.module({name:'Zazzle.CheckboxList',superclass:'Uize.Widget.FormElement',required:['Zazzle.Checkbox','Uize.Data'],builder:function(e_$){'use strict';var e__='false',e_a=false,e_b=true,e_c=Uize,e_d=e_c.Data
;var e_e=e_$.subclass(null,function(){var m=this,e_f=(m.e_g&&m.e_g.length)||0,e_h=Zazzle.Checkbox;m.e_i=[];for(var e_j= -1;++e_j<e_f;){var e_k=m.addChild('option'+e_j,e_h);m.e_l(e_k);}m.e_m();m.wire(
'Changed.value',function(){m.e_n();});}),e_o=e_e.prototype;e_o.e_n=function(){var m=this,e_p=e_c.lookup(m.valueOf(),e_b),e_g=m.e_g;m.e_q=e_b;for(var e_j= -1;++e_j<m.e_i.length;)m.e_i[e_j].set({value:e_p[e_g[e_j].name]||e_a
});m.e_q=e_a;},e_o.e_l=function(e_k){var m=this;if(e_k){e_k.wire({'Changed.value':function(){!m.e_q&&m.e_r();},'Changed.tentativeValue':function(){m.e_s()}});m.e_i.push(e_k);}};e_o.e_t=function(){var m=this;
for(var e_u=0;e_u<m.e_i.length;e_u++){var e_v=m.e_i[e_u].children.valueDisplay.get('value');m.e_i[e_u].set({enabled:!e_c.isIn(m.e_w,e_v)});}};e_o.e_m=function(){var m=this;if(m.e_x<0)m.e_x=0;else if(m.e_x>m.e_g)
m.e_x=m.e_g.length;if(m.e_y<m.e_x)m.e_y=m.e_x;m.e_z=[function(e_v){var e_A=(e_v&&e_v.length)||0;return e_v&&e_A>=m.e_x&&e_A<=m.e_y}];};e_o.e_B=function(e_C){var m=this,e_g=m.e_g,e_D=[];for(var e_j= -1;++e_j<m.e_i.length;){
var e_k=m.e_i[e_j],e_E=e_k.get(e_C);e_E&&e_E!=e__&&e_D.push(e_g[e_j].name);}m.set(e_C,e_D);};e_o.e_s=function(){this.e_B('tentativeValue')};e_o.e_r=function(){this.e_B('value')};e_o.e_F=function(){var m=this;
if(m.isWired){var e_G=0,e_H=m.e_g.length;for(var e_u=0;e_u<m.e_i.length;e_u++){var e_I=m.e_i[e_u].get('name');m.e_i[e_u].removeUi();m.removeChild(e_I);}m.set({updatingValues:e_b});Uize.require('Uize.Json',function(e_J){
function e_K(e_L,e_M){var e_N='option'+e_M;m.callInherited('loadHtmlIntoNode')({node:m.getNode('list'),injectMode:'inner bottom'},{cp:'Zazzle.Checkbox',idPrefix:m.get('idPrefix')+'_'+e_N,valueDetails:e_J.to(e_L.valueDetails),
valueDisplayInfo:m.get('valueDisplayInfo')?e_J.to(m.get('valueDisplayInfo')):null},{cache:'memory',callback:function(){m.e_l(m.children[e_N]);if(++e_G==e_H||(!e_H&& !(e_G-1))){var e_v=m.get('value'),
e_O=[];for(var e_P= -1;++e_P<e_v.length;){!e_c.isEmpty(e_d.findRecords(m.e_g,{name:e_v[e_P]}))&&e_O.push(e_v[e_P]);}m.set({value:e_O});m.e_n();m.e_t();m.set({updatingValues:e_a});}}});}e_c.emptyOut(m.e_i);
e_c.forEach(m.e_g,e_K);});}};e_o.getMoreValidators=function(){return this.e_z};e_e.stateProperties({e_i:{value:[]},e_w:{name:'disabledList',onChange:e_o.e_t},e_y:{name:'maxSelected',onChange:e_o.e_m,
value:Infinity},e_x:{name:'minSelected',onChange:e_o.e_m,value:0},e_q:{value:e_a},e_Q:{name:'updatingValues',value:e_a},e_g:{name:'values',onChange:e_o.e_F}});e_e.set({e_R:function(e_v){var m=this,e_O=[],
e_g=m.e_g;if(e_d.identical(e_v,m.get('value')))return m.get('value');for(var e_P= -1;++e_P<e_v.length;){!e_c.isEmpty(e_d.findRecords(e_g,{name:e_v[e_P]}))&&e_O.push(e_v[e_P]);}return e_O;}});return e_e;
}});
Uize.module({name:'Uize.Class.mModels',required:['Uize.Class.mChildObjectBindings','Uize.Class.mDeclarativeChildObjects','Uize.Class.mChildObjectEventBindings'],builder:function(){'use strict';var c_$=null,
c__=Uize,c_a=c__.Class,c_b='models',c_c='models',c_d='addedModels',c_e='addModel';return function(c_f){c_f.declare({mixins:[c_a.mChildObjectBindings,c_a.mDeclarativeChildObjects,c_a.mChildObjectEventBindings
],stateProperties:c__.pairUp(c_c,{name:c_c,conformer:function(c_g){var m=this,c_h=m[c_b];if(c_g){var c_i=this.mModels_unappliedModelsProperties;for(var c_j in c_g){var c_k=c_g[c_j],c_l=c_h[c_j];if(c__.isInstance(c_k)){
m.addModel(c_j,c_k);}else c_l?c_l.set(c_k):c_i[c_j]=c_k;}}return c_h;}}),alphastructor:function(){var m=this;m.mModels_unappliedModelsProperties={};m[c_b]={};m[c_d]=new c__.Class;},instanceMethods:c__.copyInto(
c__.pairUp(c_e,function(c_j,c_m,c_n){c_n||(c_n={});c_j||(c_j=c_n.name);var m=this,c_h=m[c_b],c_l=c_h[c_j];if(c_l&&c_l!=c_m){m.removeModel(c_l);c_l=c_$;}if(!c_l){var c_i=m.mModels_unappliedModelsProperties,
c_o=c_i[c_j];if(c_o){c_n=c__.copy(c_n,c_o);delete c_i[c_j];}c_l=c__.isInstance(c_m)?c_m:c_$;c_l&&c_l.set(c_n);c_l=c_h[c_j]=c_l||new c_m(c_n);m[c_d].met(c_j);}return c_l;}),{removeModel:function(c_p){
var m=this,c_h=m[c_b],c_q=c_p,c_r;if(c__.isInstance(c_q)){for(var c_j in c_h){var c_l=c_h[c_j];if(c_l==c_p){c_r=c_l;c_q=c_j;}}}else c_r=c_h[c_q];if(c_r){delete c_h[c_q];m[c_d].unmet(c_q);}}}),childObjectBindings:{
declaration:'modelBindings',instanceProperty:c_b,addedInstanceProperty:c_d,stateProperty:c_c},declarativeChildObjects:{declaration:'models',addMethod:'addModel',childObjectClassKey:'modelClass'},childObjectEventBindings:{
declaration:'modelEventBindings',instanceProperty:c_b,addedInstanceProperty:c_d}});};}});
Uize.module({name:'Uize.Widget.mModels',required:'Uize.Class.mModels',builder:function(){'use strict';return function(d_$){d_$.declare({mixins:Uize.Class.mModels,alphastructor:function(){var m=this,d__=m.children,
d_a=m.models,d_b=function(){for(var d_c in d__){var d_d=d__[d_c];Uize.isFunction(d_d.addModel)&&d__[d_c].set({models:d_a});}};m.addedModels.wire('Changed.*',d_b);m.addedChildren.wire('Changed.*',d_b);
}});};}});
Uize.module({name:'Uize.Array.Sort',builder:function(){'use strict';var c_$=Function,c__=[],c_a=c_$('a,b','return a.v<b.v?-1:a.v>b.v?1:0'),c_b=c_$('a,b','return a.v<b.v?1:a.v>b.v?-1:0'),c_c=c_$('a,b','return a<b?-1:a>b?1:0'),
c_d=c_$('a,b','return a<b?1:a>b?-1:0');return Uize.package({sortBy:function(c_e,c_f,c_g){var c_h=c_e.length;if(c_h>1){if(c_f!=null){var c_i;if(!Uize.isFunction(c_f)){if(typeof c_f=='number')c_f='value ['+c_f+']'
;c_f=Uize.resolveTransformer(c_f);};for(var c_j=c__.length=c_h;--c_j>=0;){(c_i=c__[c_j]||(c__[c_j]={})).v=c_f(c_i.c_k=c_e[c_i.c_j=c_j],c_j);}c__.sort(c_g== -1?c_b:c_a);for(var c_j=c_h;--c_j>=0;){if(c_j!=(c_i=c__[c_j]).c_j)
c_e[c_j]=c_i.c_k;c_i.c_k=c_i.v=null;}}else{c_e.sort(c_g== -1?c_d:c_c);}}return c_e;}});}});
Uize.module({name:'Zazzle.Model',superclass:'Uize.Class',required:['Uize.Class.mModels','Uize.Comm.Ajax'],builder:function(c_$){'use strict';var c__=false,c_a=Uize,c_b=function(c_c,c_d){c_c&&c_c.apply(this,c_a.isArray(c_d)?c_d:[c_d]);
};return c_$.subclass({mixins:c_a.Class.mModels,stateProperties:{c_e:'busy',c_f:'csrfToken',c_g:'serviceUrlBase'},alphastructor:function(){this.c_h=new c_a.Comm.Ajax},instanceMethods:{ajax:function(c_i,c_j,c_k,c_l){
var m=this,c_m=c_a.isFunction(c_k)?{callback:c_k}:(c_k||{}),c_n=c_a.isNumber(c_m.delay)?c_m.delay:1;if(m.c_g){var c_o=function(){m.met('busy');m.c_h.request(c_a.copyInto({url:[m.c_g+c_i,{csrf:m.c_f},
c_j],returnType:'json',requestMethod:'POST',cache:'never',callback:m.c_p(c_i,c_j,c_m,c_l),errorCallback:function(c_q){m.unmet('busy');console.error(c_a.substituteInto('Model ERROR for "[#module]" calling "[#service]" service with params:',
{module:m.Class.moduleName,service:m.c_g+c_i}),c_j,c_q);}},c_m.requestOverrides));};clearTimeout(m.c_r);if(c_n>0)m.c_r=setTimeout(c_o,c_n);else c_o();}},c_p:function(c_i,c_j,c_m,c_l){var m=this,c_s=c_m.callback,
c_t=c_m.callbackSuccess||c_s,c_u=c_m.callbackFail||c_s;return function(c_v){var c_w=c_v.error&&c_v.error.csrf;if(!c_l&&c_w){m.set('csrfToken',c_w);m.ajax(c_i,c_a.copyInto(c_j,{csrf_resubmit:true}),c_m,
true);}else{c_b(c_v.success?c_t:c_u,c_v);m.unmet('busy');}}}}});}});
Uize.module('ZazzleWww.Models');
Uize.module({name:'ZazzleWww.Models.IdeaBoards',superclass:'Zazzle.Model',required:['Uize.Array.Sort','Uize.Data.Compare'],builder:function(d_$){'use strict';var d__=Uize,d_a=null,d_b=d__.Data.Compare.identical,
d_c=function(d_d,d_e){return d_b(d_d,d_e)?d_e:d_d;};return d_$.subclass({stateProperties:{d_f:{name:'userId',value:0},d_g:{name:'ideaBoards',conformer:d_c,derived:{properties:'regularBoards',derivation:function(d_h){
var d_i=[],d_j;if(!d__.isEmpty(d_h)&& !d__.isNully(d_h)){d__.Array.Sort.sortBy(d_h,'value.title.toLowerCase()');for(var d_k=0;d_k<d_h.length;d_k++){d_j=(d_h[d_k].numItems>=d_h[d_k].maxItems?'<i class="zazzicon zazzicon-warningStamp"></i>':'')+
(!d_h[d_k].isPublic?'<i class="zazzicon zazzicon-lock"></i>':'');d_i.push({name:d_h[d_k].id,valueDetails:{displayName:d_h[d_k].title,name:d_h[d_k].id,importantInfo:d_j}});}}return d_i;}}},d_l:{name:'likesBoard',
conformer:d_c},d_m:{name:'maxRegularBoards',value:1000},d_n:'productLookup',d_h:{name:'regularBoards',conformer:d_c},d_o:{name:'regularBoardsDisabledList',conformer:d_c,derived:{properties:'regularBoards',
derivation:function(d_h){var d_p=[];if(!d__.isEmpty(d_h)){for(var d_k=0;d_k<d_h.length;d_k++){if(d_h[d_k].numItems>=d_h[d_k].maxItems){d_p.push(d_h[d_k].id);}}}return d_p;}}}},staticMethods:{},instanceMethods:{
d_q:function(d_r,d_s){var m=this,d_t=(!d__.isEmpty(m.d_l)&&d_s==m.d_l.id),d_h= !d_t?d__.clone(m.d_h):d_a,d_u=d_t?d__.clone(m.d_l):d__.findRecord(d_h,{id:d_s});if(!d__.isArray(m.d_n[d_r]))m.d_n[d_r]=[d_s];
else m.d_n[d_r].push(d_s);if(!d__.isEmpty(d_u)){d_u.numItems=d_u.numItems+1;m.set(d_t?'likesBoard':'regularBoards',d_t?d_u:d_h);}},d_v:function(d_r,d_s){var m=this,d_t=(!d__.isEmpty(m.d_l)&&d_s==m.d_l.id),
d_h= !d_t?d__.clone(m.d_h):d_a,d_u=d_t?m.d_l:d__.findRecord(d_h,{id:d_s});if(d__.isArray(m.d_n[d_r])){var d_w=d__.findRecordNo(m.d_n[d_r],d_s);if(d_w> -1)m.d_n[d_r].splice(d_w,1);}if(!d__.isEmpty(d_u)){
d_u.numItems=d_u.numItems-1;m.set(d_t?'likesBoard':'regularBoards',d_t?d_u:d_h);}},addProductToIdeaboard:function(d_s,d_r,d_x,d_y){var m=this;m.ajax('ideaboarditem/add',{boardId:d_s,productId:d_r,attributes:d_x
},{callback:function(d_z){if(d_z.success){m.d_q(d_r,d_s);m.fire({name:'Added Product to Ideaboard',data:{boardId:d_s,productId:d_r,boardItemId:d_z.data.boardItemId}});}d_y&&d_y(d_z);}});},addProductToLikes:function(d_r,d_x,d_y){
var m=this;m.ajax('ideaboarditem/addlike',{productId:d_r,attributes:d_x},{callback:function(d_z){if(d_z.success){m.d_q(d_r,m.d_l.id);m.fire({name:'Added Product to Ideaboard',data:{boardId:m.d_l.id,productId:d_r}});
}d_y&&d_y(d_z);}});},createIdeaboard:function(d_A,d_y){var m=this;m.ajax('ideaboard/add',d_A,{callback:function(d_z){if(d_z.success){var d_B=[{id:d_z.data.boardId,title:d_z.data.title,isPublic:d_z.data.isPublic,numItems:0}],
d_C=m.get('regularBoards')||[];m.set({regularBoards:d_B.concat(d_C)});}d_y&&d_y(d_z);}});},validateTitle:function(d_D,d_E,d_y){var m=this;m.ajax('ideaboard/validatetitle',{title:d_D,ideaBoardId:d_E},
{callback:function(d_z){d_y&&d_y(d_z);}});},updateIdeaBoard:function(d_A,d_y){var m=this;m.ajax('ideaboard/update',d_A,{callback:function(d_z){if(!d__.isNully(d_z.data)){m.fire({name:'Metadata updated',data:{
title:d_z.data.title,description:d_z.data.description,lastUpdated:d_z.data.lastUpdated,isPublic:d_z.data.isPublic}});}d_y&&d_y(d_z);}});},updateBanner:function(d_s,d_F,d_x,d_y){var m=this;m.ajax('ideaboard/updatebanner',
{boardId:d_s,imageId:d_F,attributes:d_x},{callback:function(d_z){d_y&&d_y(d_z);}});},updateCoverImage:function(d_s,d_G,d_H,d_y){this.ajax('ideaboard/update',{boardId:d_s,coverImageId:d_G,coverAttributes:d_H
},{callback:function(d_z){d_y&&d_y(d_z);}});},deleteCoverImage:function(d_s,d_y){this.ajax('ideaboard/deleteCoverImage',{boardId:d_s},{callback:function(d_z){d_y&&d_y(d_z);}});},deleteIdeaBoard:function(d_s,d_y){
var m=this;m.ajax('ideaboard/delete',{boardId:d_s},{callback:function(d_z){d_y&&d_y(d_z);}});},lookupIdeaboardsforProduct:function(d_r,d_y){var m=this,d_I=(!d__.isEmpty(m.d_n)?m.d_n:{})[d_r];if(!d__.isArray(d_I)&&d__.isEmpty(d_I)&& !Uize.isEmpty(d_r)){
m.lookupIdeaboardsforProducts([d_r],function(){d_y&&d_y(m.d_n[d_r]);});}else{d_y&&d_y(d_I);}},lookupIdeaboardsforProducts:function(d_J,d_y,d_K){var m=this,d_n=m.d_n,d_L=(d_K||d__.isEmpty(m.d_n))?d_J:[]
;if(!d_K&& !d__.isEmpty(d_J)&& !d__.isEmpty(m.d_n)){for(var d_k=0;d_k<d_J.length;d_k++){if(!d__.isArray(d_n[d_J[d_k]]))d_L.push(d_J[d_k]);}}if(m.d_f>0&& !d__.isEmpty(d_L)){m.ajax('ideaboard/lookupproductids',
{productIds:d_L},{requestOverrides:{cache:'memory'},callback:function(d_z){if(d_z.success){var d_M=d_z.data.productLookup;m.set({productLookup:d__.copyInto({},m.get('productLookup'),d_M),likesBoard:d_z.data.likesBoard,
regularBoards:d_z.data.regularBoards});if(d_J.length>1){m.fire('Bulk Updated Lookup');}}d_y&&d_y();}});}else{d_y&&d_y();}},getIdeaBoard:function(d_s,d_y){var m=this;m.ajax('ideaboard/get',{boardId:d_s
},{callback:function(d_z){console.log(d_z);d_y&&d_y(d_z.data);}});},getIdeaBoardSocialMediaInfo:function(d_s,d_y){var m=this;m.ajax('ideaboard/getsocialmediainfo',{boardId:d_s},{callback:function(d_z){
d_y&&d_y(d_z.data);}});},moveItemInIdeaboard:function(d_s,d_N,d_O,d_y){var m=this;m.ajax('ideaboarditem/moveitem',{boardId:d_s,boardItemId:d_N,prevBoardItemId:d_O},{callback:function(d_z){d_y&&d_y(d_z);
}});},moveIdeaBoard:function(d_P,d_Q,d_R,d_S,d_y){var m=this;m.ajax('ideaboard/moveboard',{boardToMove:d_P,boardNewPreviousId:d_Q,contextId:d_R||0,nextBoardId:d_S},{callback:function(d_z){d_y&&d_y(d_z);
}});},moveToLast:function(d_s,d_R,d_y){this.ajax('ideaboard/movetolast',{boardId:d_s,storeId:d_R||0},{callback:function(d_z){d_y&&d_y(d_z);}});},removeProductFromIdeaboard:function(d_s,d_r,d_y){var m=this;
m.ajax('ideaboarditem/removeproduct',{productId:d_r,boardId:d_s},{callbackSuccess:function(d_z){if(d_z.success){m.d_v(d_r,d_s);m.fire({name:'Removed Product from Ideaboard',data:{boardId:d_s,productId:d_r}});
}d_y&&d_y(d_z);}});},removeProductFromLikes:function(d_r,d_y){var m=this;m.removeProductFromIdeaboard(m.d_l.id,d_r,d_y);},updateUser:function(d_f,d_J,d_y){var m=this;if(d_f!=0){m.set({userId:d_f});m.lookupIdeaboardsforProducts(d_J,function(d_T){
m.set({userId:d_f});d_y&&d_y(d_T);});}else{d_y&&d_y();}}}});}});
Uize.module({name:'ZazzleWww.AddToIdeaboard',superclass:'Zazzle.Widget.V2',required:['Uize.Web','Uize.Web.xDom','Uize.Data.Compare','Uize.Node.Event','Uize.Widget.Button','Uize.Widget.mModels','Uize.Widget.FormElement.Text',
'Zazzle.Palette','Zazzle.CheckboxList','ZazzleWww.Models.IdeaBoards'],builder:function(f_$){'use strict';var f__=null,f_a=true,f_b=false,f_c=Uize,f_d=f_b,f_e=f_b,f_f=f_c.Node.Event;return f_$.subclass({
mixins:[Uize.Widget.mModels],stateProperties:{f_g:'disabledList',f_h:{name:'fleetingMessage',derived:{properties:'productTitle,newCollectionTitle,newCollectionLink',derivation:function(f_i,f_j,f_k){return this.localize('fleetingNewMessage',{
productTitle: !f_c.isEmpty(f_i)?f_i:'',collectionTitle:'<a href="'+(!f_c.isEmpty(f_k)?f_k:'javascript://')+'" >'+(!f_c.isEmpty(f_j)?f_j:'')+'</a>'});}}},f_l:'hasIdeaBoards',f_m:{name:'hidePaletteOnMouseout',
value:f_b},f_n:{name:'hovered',value:f_b,onChange:function(){var m=this;if(m.f_n){m.f_o&&m.set({shown:f_a});}else{m.f_o&&m.set({shown:f_b});!m.f_o&&m.set({showPalette:f_b});}}},f_p:'ideaboardMembership',
f_q:'includeFleeting',f_r:'isLiked',f_s:'isCollectioned',f_t:{name:'newCollection',derived:{properties:'newCollectionId',derivation:function(f_u){return f_c.findRecord(this.models.ideaboardsModel.get('regularBoards'),{id:f_u});
}}},f_u:'newCollectionId',f_j:{name:'newCollectionTitle',derived:{properties:'newCollection',derivation:function(f_t){return!f_c.isEmpty(f_t)?f_t.title:'';}}},f_k:{name:'newCollectionLink',derived:{properties:'newCollection',
derivation:function(f_t){return!f_c.isEmpty(f_t)?(this.get('urls').ideaboardPage+f_t.id):'javascript://';}}},f_v:'productAttributes',f_w:{name:'productAttributesWithoutView',derived:{properties:'productAttributes',
derivation:function(f_v){var f_x=f_c.clone(f_v);delete f_x.view;return f_x;}}},f_y:'productId',f_i:'productTitle',f_o:{name:'showActionsOnHover',value:f_b},f_z:'showCollectionCreateButton',f_A:{name:'shown',
value:f_b,onChange:function(){var m=this;if(m.f_A){m.f_B();}else if(!m.f_A){m.set({showPalette:f_b});}}},f_C:{name:'showPalette',onChange:function(){var m=this;!m.f_C&&m.f_D();}}},children:{ideaboards:Zazzle.CheckboxList,
ideaboardTitle:Uize.Widget.FormElement.Text,createIdeaboard:Uize.Widget.Button},cssBindings:{showPalette:['','showPalette'],showCollectionCreateButton:['','showCollectionCreateButton'],isLiked:['','liked'],
isCollectioned:['','collectioned'],hasIdeaBoards:['noIdeaBoards','']},htmlBindings:{shown:'contentWrapper:?'},eventBindings:{'#addToLike:click':function(){var m=this,f_E=m.getInherited('user').isLoggedIn
;m.callInherited('ensureLoggedIn')({callback:function(){var f_F=m.models.ideaboardsModel,f_G=function(){f_F.addProductToLikes(m.get('productId'),!f_c.isEmpty(m.f_v)?f_c.Url.toParams(m.f_v):f__,function(f_H){
if(f_H.success)m.set({isLiked:f_a});});};if(!f_E){setTimeout(function(){f_F.set({userId:m.getInherited('user').id});m.f_B(f_G);},10);}else if(f_E&&m.f_r){f_F.removeProductFromLikes(m.get('productId'),function(f_H){
if(f_H.success)m.set({isLiked:f_b});});}else{var f_I=f_F.get('likesBoard');if((!f_c.isEmpty(f_I)?f_I.numItems:0)>=f_I.maxItems){m.inform({title:m.localize('ideaboardItemLikesLimitTitle'),message:m.localize('ideaboardItemLikesLimitMessage'),
state:'error',callback:function(){}});}else{f_G();}}}});},'#openPalette:click':function(){var m=this,f_E=m.getInherited('user').isLoggedIn;if(m.f_C){m.set({showPalette:f_b});return;}f_d=f_b;m.callInherited('ensureLoggedIn')({
callback:function(){var f_J=m.children.ideaboards,f_p=m.get('ideaboardMembership'),f_K=function(){f_d=f_c.Data.Compare.identical(f_J.get('values'),m.models.ideaboardsModel.get('ideaBoards'));f_J.set({
values:m.models.ideaboardsModel.get('ideaBoards'),value: !f_c.isEmpty(f_p)?f_p:[]});f_d&&m.set({showPalette:f_a});};if(!f_E){setTimeout(function(){m.models.ideaboardsModel.set({userId:m.getInherited('user').id});
m.f_B(f_K);},10);}else{f_K();}}});},'ideaboards:Changed.updatingValues':function(){var m=this;if(!m.children.ideaboards.get('updatingValues')){m.set({showPalette:f_a});f_d=f_a;}},'ideaboardTitle:Changed.focused':function(){
var m=this,f_L=m.children.ideaboardTitle;if(f_L.get('focused')){f_L.set({placeholder:''});m.set({showCollectionCreateButton:f_a});}},'ideaboards:Changed.value':function(){var m=this,f_F=m.models.ideaboardsModel,
f_M=f_F.get('likesBoard').id,f_N=f_c.clone(m.children.ideaboards.get('value')),f_O=f_c.clone(m.f_p),f_P= -1,f_Q,f_R=function(f_S,f_T){for(var f_U=0;f_U<f_S.length;f_U++){if(!f_c.isIn(f_T,f_S[f_U]))return f_S[f_U];
}},f_V=function(f_W){f_W&&m.f_q&&m.callInherited('displayFleetingToast')({message:m.f_X(f_Q),clickToDismiss:f_a,lifeSpan:5000});m.set({isCollectioned: !f_c.isEmpty(f_N),showPalette:f_b});};if(f_d&& !f_e){
f_P=f_c.findRecordNo(f_N,f_M);f_P> -1&&f_N.splice(f_P,1);f_P=f_c.findRecordNo(f_O,f_M);f_P> -1&&f_O.splice(f_P,1);if((!f_c.isEmpty(f_O)?f_O.length:0)>(!f_c.isEmpty(f_N)?f_N.length:0)){f_Q=f_R(f_O,f_N);
!f_c.isEmpty(f_Q)&&f_F.removeProductFromIdeaboard(f_Q,m.get('productId'),function(){f_V(f_b)});}else if((!f_c.isEmpty(f_O)?f_O.length:0)<(!f_c.isEmpty(f_N)?f_N.length:0)){f_Q=f_R(f_N,f_O);if(!f_c.isEmpty(f_Q)&&f_c.findRecordNo(m.get('disabledList'),f_Q)> -1){
f_e=f_a;m.inform({title:m.localize('ideaboardItemLimitTitle'),message:m.localize('ideaboardItemLimitMessage'),state:'error',callback:function(){m.children.ideaboards.set({value:m.f_p});f_e=f_b;}});}else{
!f_c.isEmpty(f_Q)&&f_F.addProductToIdeaboard(f_Q,m.get('productId'),!f_c.isEmpty(m.f_v)?f_c.Url.toParams(m.f_v):f__,function(){f_V(f_a)});}}}},'createIdeaboard:Click':function(){this.f_Y();},'#:mouseover':function(){
var m=this;if(m.f_m&&m.f_C&&m.f_Z){clearTimeout(m.f_Z);}},'#:mouseout':function(){var m=this;if(m.f_m){m.f_Z=setTimeout(function(){m.set({showPalette:f_b});},500);}},'#dismiss:click':function(){this.set({showPalette:f_b});
},'#scrollable:DOMMouseScroll':function(f_0){var m=this;m.f_1(f_0,m.getNode('scrollable'));},'#scrollable:mousewheel':function(f_0){var m=this;m.f_1(f_0,m.getNode('scrollable'));},'ideaboardTitle:Key Up':function(f_0){
var f_2=f_0.domEvent;if(f_f.isKeyEnter(f_2)){f_f.abort(f_2);this.f_Y();}},'#info:click':function(){var m=this;m.callInherited('useDialog')({component:{name:'ZazzleWww.Dialog.IdeaBoardsOnboarding'},widgetProperties:{
name:'ideaBoardsOnboarding'}});}},instanceMethods:{f_D:function(){var m=this,f_L=m.children.ideaboardTitle;if(m.isWired){f_L&&f_L.set({focused:f_b,value:'',placeholder:m.localize('createCollectionPlaceholder')
});m.set({showCollectionCreateButton:f_b});}},f_B:function(f_3){var m=this,f_F=m.models.ideaboardsModel;if(f_F&&m.getInherited('user').isLoggedIn){f_F.lookupIdeaboardsforProduct(m.get('productId'),function(f_4){
var f_r= !f_c.isEmpty(f_F.get('likesBoard'))&&f_c.findRecordNo(f_4,f_F.get('likesBoard').id)> -1,f_s= !f_c.isEmpty(f_4)&&(f_r?f_4.length>1:f_4.length>0),f_g=f_c.clone(f_F.get('regularBoardsDisabledList'))
;for(var f_U=0;f_U<f_4.length;f_U++){var f_P=f_c.findRecordNo(f_g,f_4[f_U]);f_P> -1&&f_g.splice(f_P,1);}m.set({isLiked:f_r,isCollectioned:f_s,hasIdeaBoards: !f_c.isEmpty(f_F.get('ideaBoards')),ideaboardMembership:f_4,
disabledList:f_g});f_3&&f_3();});}else{f_3&&f_3();}},f_Y:function(){var m=this,f_F=m.models.ideaboardsModel,f_5=m.children.ideaboardTitle.get('value'),f_6=function(f_Q){f_F.addProductToIdeaboard(f_Q,
m.get('productId'),!f_c.isEmpty(m.f_v)?f_c.Url.toParams(m.f_v):f__,function(){m.set({isCollectioned:f_a,showPalette:f_b});m.f_q&&m.callInherited('displayFleetingToast')({message:m.f_h,clickToDismiss:f_a})
;});},f_7=function(){f_F.createIdeaboard({title:f_5},function(f_4){if(f_4.success){m.set({newCollectionId:f_4.data.boardId,hasIdeaBoards:f_a});f_6(f_4.data.boardId);}});};if(f_F.get('regularBoards')&&f_F.get('regularBoards').length>=f_F.get('maxRegularBoards')){
m.inform({message:m.localize('ideaboardBoardLimitMessage'),state:'error'});}else{f_F.validateTitle(f_5,f__,function(f_4){var f_8=f_4.error&&f_4.error.boardIds;if(f_4.success&&f_4.data.valid){f_7();}else if(f_c.isArray(f_8)&& !f_c.isEmpty(f_8)){
m.confirm({message:m.localize('duplicateTitleErrorMessage',{title:f_5}),okText:m.localize('duplicateTitleErrorOk'),cancelText:m.localize('duplicateTitleErrorCancel'),yesHandler:function(){f_6(f_8[0]);
},noHandler:function(){m.set({showPalette:f_b});}});}else if(f_4.error.errorMessage){m.inform({message:f_4.error.errorMessage,callback:function(){m.set({showPalette:f_b});}});}});}},f_1:function(f_0,f_9){
var f_$_=f_0.wheelDelta|| -f_0.detail;f_9.scrollTop+=(f_$_<0?1: -1)*30;f_0.preventDefault&&f_0.preventDefault();},f_X:function(f___){var m=this,f_F=m.models.ideaboardsModel,f_a_=f_c.findRecord(f_F.get('regularBoards'),{id:f___}),
f_i=m.get('productTitle'),f_b_= !f_c.isEmpty(f_a_)?(m.get('urls').ideaboardPage+f_a_.id):'javascript://',f_c_= !f_c.isEmpty(f_a_)?f_a_.title:'';return m.localize('fleetingAddedMessage',{productTitle: !f_c.isEmpty(f_i)?f_i:'',
collectionTitle:'<a href="'+(!f_c.isEmpty(f_b_)?f_b_:'javascript://')+'" >'+(!f_c.isEmpty(f_c_)?f_c_:'')+'</a>'});},wireUi:function(){var m=this;if(!m.isWired){!m.f_o&&m.set({shown:f_a});m.models.ideaboardsModel.wire('Bulk Updated Lookup',function(){
!m.f_o&&m.f_B();});f_$.doMy(m,'wireUi');}}}});}});
Uize.module({name:'ZazzleWww.ProfileLogo',superclass:'Zazzle.Widget.V2',builder:function(f_$){'use strict';var f__=Uize,f_a=false,f_b=true,f_c="00000000-0000-0000-0000-000000000000";return f_$.subclass({
alphastructor:function(){var m=this;m.whenever('wired',function(){m.web(zPage).wire('click',function(e){m.set('optionsShown',f_a);});});},stateProperties:{f_d:'profileOwnerId',f_e:{name:'editMode',value:f_a
},f_f:{name:'minUploadDim',value:512},f_g:{name:'maxDim',value:150},f_h:{name:'hasImage',value:f_a,derived:{properties:'logoImageId',derivation:function(f_i){return!f__.isNully(f_i);}}},f_i:{name:'logoImageId',
value:null,conformer:function(f_j){return f_j!=f_c?f_j:null;}},f_k:'cropRect',f_l:'cropRectEncoded',f_m:{name:'logoImageUrl',derived:{properties:'logoImageId, cropRectEncoded',derivation:function(f_i,f_k){
var m=this,f_n={id:f_i,max_dim:m.f_g,view_crop:f_k};if(f__.isEmpty(f_k)){f_n['square_it']='fill';}return Uize.Url.resolve([m.getInherited('env').rlvNetService+"getimage",f_n]);}}},f_o:{name:'allowCrop',
value:f_a,derived:{properties:'logoImageId',derivation:function(f_i){return(!f__.isNully(f_i)&&f_i.indexOf('-')!= -1);}}},f_p:{name:'optionsShown',value:f_a}},cssBindings:{editMode:['showIconOnHover','']
},htmlBindings:{logoImageUrl:'logoImage:value',hasImage:['monogram:hide','logoImage:show'],optionsShown:'options:show',allowCrop:'cropImage:show'},instanceMethods:{f_q:function(f_r,f_k,f_s){var m=this;
m.ajax({service:'profile/updatelogo',profileOwnerId:m.f_d,imageId:f_r,attributes:f__.Url.toParams({"view_crop":f_k})},{callback:function(f_t){if(f_t.success){m.set({'logoImageId':f_r,'cropRect':f_k,'cropRectEncoded':f__.Url.toPiece(f_k)});
}else{m.inform({state:'error',message:m.localize("updateError")});}f_s&&f_s(f_t);}});},f_u:function(f_s){var m=this;m.callInherited('useMediaBrowser')({title:m.localize('uploadNew'),sources:['MyComputer','MyImages'],
selectionMode:'single'},function(f_v){if(f_v&&f_v.length){var f_w=f_v[0].attributes.id;if(!f__.isNully(f_w)){m.f_x(f_w,f_a,f_s);}}});},f_x:function(f_w,f_y,f_s){var m=this,f_k=null,f_g=m.get('maxDim'),
f_z=m.get('minUploadDim');if(m.get('logoImageId')==f_w){f_k=m.get('cropRect');}m.callInherited('useDialog')({component:{name:'Zazzle.Dialog.ImageResolutionFail',params:{cropTitle:m.localize('cropTitle'),
Images:Uize.Json.to([{wwwData:{Id:f_w,CropRect:f_k}}]),minResolutionWidth:f_z,minResolutionHeight:f_z,aspectRatio:1,showCropAreaLabel:f_a,alwaysCrop:f_y}},widgetProperties:{name:'imageResolutionFail',
anticache:Math.random()},submitHandler:function(f_A){var f_k=f_A.croppedImages[0].cropRect;m.f_q(f_w,f_k,f_s);}});},uploadImage:function(f_s){this.f_u(f_s);}},eventBindings:{'#uploadImage:click':function(f_A){
var m=this;if(!f__.isNully(m.f_i)){if(m.get('optionsShown')==false){m.fire({name:'Hide Palettes',bubble:f_b});f_A.cancelBubble=f_b;}m.toggle('optionsShown');}else{m.f_u();}},"#change:click":function(){
this.f_u();},"#position:click":function(){var m=this,f_i=m.get('logoImageId');if(!f__.isNully(f_i))m.f_x(f_i,f_b);},"#remove:click":function(){var m=this;m.confirm({message:m.localize("areYouSure"),yesHandler:function(){
m.f_q(f_c,"",function(f_t){if(!f_t.success){m.inform({state:'error',message:m.localize("deleteError")});}});}});}}});}});
Uize.module({name:'ZazzleWww.MakerLocation',superclass:'Zazzle.Widget.V2',builder:function(f_$){'use strict';var f__=Uize;return f_$.subclass({stateProperties:{},children:{},childBindings:{},cssBindings:{
},htmlBindings:{},eventBindings:{}});}});
Uize.module({name:'Zazzle.RatingContinuous',superclass:'Uize.Widget',builder:function(d_$){'use strict';var d__=d_$.subclass(),d_a=d__.prototype;d_a.updateUi=function(){var m=this;if(m.isWired){var d_b= +m.d_c,
d_d=Math.floor(d_b),d_e=d_b-d_d;for(var d_f=0;d_f<m.d_g;d_f++){m.setNodeStyle('star'+d_f,{width:(d_f<d_d?100:(d_f==d_d?Math.round(d_e*100):0))+'%'});m.setNodeProperties('shell'+d_f,{title:m.d_h});}d_$.doMy(m,'updateUi');
}};d__.stateProperties({d_c:{name:'value',onChange:d_a.updateUi},d_g:'outOf',d_h:'tooltip'});return d__;}});
Uize.module({name:'ZazzleWww.MakerRating',superclass:'Uize.Widget',required:['Zazzle.RatingContinuous'],builder:function(d_$){'use strict';var d__=Uize;return d_$.subclass({stateProperties:{d_a:{name:'scrollToNode',
value:false}},omegastructor:function(){var m=this;if(m.get('scrollToNode')){m.wireNode('reviewsLink','click',function(){d__.require('Uize.Fx.Scroll',function(d_b){d_b.scrollToNode("reviewsSection");}
);});}}});}});
Uize.module({name:'ZazzleWww.MakerBanner',superclass:'Zazzle.Widget.V2',builder:function(f_$){'use strict';var f__=Uize,f_a=null;return f_$.subclass({stateProperties:{f_b:'groupId',f_c:'makespace',f_d:{
name:'productId',value:f_a}},children:{},childBindings:{},cssBindings:{},htmlBindings:{},eventBindings:{}});}});
Uize.module({name:'ZazzleWww.MakerBanner.ProfileCard',builder:function(g_$){'use strict';var g__=Uize,g_a=null;return g_$.subclass({stateProperties:{g_b:'productId',g_c:'contextHint'},eventBindings:{'#question:click':function(){
var m=this;m.callInherited('ensureLoggedIn')({callback:function(){m.callInherited('useDialog')({component:{name:'ZazzleWww.Dialog.Form.Messaging',params:{tl:m.localize('messagingTitle'),categoryId:'product',
topicId:g_a,product:m.g_b,order:g_a,displayCategoryUi:false,recipientProfile:m.get('groupId'),contextHint:m.get('contextHint'),anticache:Math.random()}},widgetProperties:{name:'messagingDialog'}});m.fire({
name:'Track Event',bubble:true,extra:{ax:'messagingdialogattempt',location:'profilecard',categoryId:'product',product:m.g_b,toTypeOverride:'maker_group_id',toIdOverride:m.get('groupId')}});}});}}});}
});
Uize.module({name:'ZazzleWww.ProductStylesAndGroup',superclass:'Uize.Widget',required:'Uize.Url',builder:function(d_$){var d__=Uize.Url,d_a=Uize;var d_b=d_$.subclass(),d_c=d_b.prototype;d_c.wireUi=function(){
var m=this;if(!m.isWired){var d_d=m.getInherited('env'),d_e=d_d.params;function d_f(){var d_g=(m.getInherited('storeContext'))?m.getInherited('storeContext')+'/products/styles/pd-'+m.d_h:'pd/styles/pd-'+m.d_h;
location.href=d__.resolve(d_d.www+d_g,{dp:d_e.gp?null:d_e.dp||'',qs:d_e.qs||'',tl:m.getInherited('searchTitle')||''});}m.wireNode('moreStylesLink','click',function(){d_i("style");d_f();});function d_j(){
var d_k=d_d.www+(m.getInherited('storeContext')?m.getInherited('storeContext')+'/':'')+'gifts';location.href=d__.resolve(d_k,{gp:m.d_h});}m.wireNode('moreProductsLink','click',function(){d_i("product");
d_j();});function d_i(e){m.fire({name:'Track Event',bubble:true,extra:d_a.copyInto({ax:'moreLink',service:e})});}d_$.doMy(m,'wireUi');}};d_b.stateProperties({d_h:'productId',d_l:'hideMoreStylesLink',
d_m:'hideMoreProductsLink'});return d_b;}});
Uize.module({name:'Zazzle.SeeMoreUi',superclass:'Zazzle.Widget.V2',builder:function(f_$){'use strict';var f__=function(){var m=this;m.f_a?location.href=m.f_a:m.toggle('collapsed');};return f_$.subclass({
stateProperties:{f_b:{name:'collapsed',value:true},f_c:{name:'containerMaxHeight',derived:{properties:'collapsed,shortHeight',derivation:function(f_b,f_d){return f_b?f_d:'none';}}},f_e:'contentsFit',
f_f:{name:'displayMoreLinkInfo',derived:{properties:'collapsed,containerMaxHeight,updateIncrement',derivation:function(f_b,f_c,f_g){return{f_b:f_b,f_c:f_c,f_g:f_g};}}},f_a:'seeMoreLink',f_h:'seeLessLabel',
f_i:'seeMoreLabel',f_d:'shortHeight',f_g:{name:'updateIncrement',value:0}},cssBindings:{collapsed:['','collapsed'],contentsFit:['','contentsFit']},htmlBindings:{displayMoreLinkInfo:function(f_f){var m=this,
f_j=parseInt(m.web('containerShell').css('maxHeight'));m.set({f_e:f_f.f_b&&(!Uize.isNumber(f_j)||m.web('container').height()<=f_j)});},containerMaxHeight:'containerShell:style.maxHeight',seeLessLabel:'seeLess:html',
seeMoreLabel:'seeMore:html'},eventBindings:{'#seeMore:click':f__,'#seeLess:click':f__}});}});
Uize.module({name:'ZazzleWww.StoreInfo',superclass:'Zazzle.Widget.V2',builder:function(f_$){'use strict';var f__=Uize,f_a=null;return f_$.subclass({stateProperties:{f_b:{name:'profileId',value:f_a},f_c:{
name:'productId',value:f_a},f_d:'messagingContextHint'},eventBindings:{'#contactButton:click':function(){var m=this;m.callInherited('ensureLoggedIn')({callback:function(){m.callInherited('useDialog')({
component:{name:'ZazzleWww.Dialog.Form.Messaging',params:{tl:m.localize('messagingTitle'),categoryId:m.get('messagingCategoryId'),recipientProfile:m.f_b,product:m.f_c,order:f_a,displayCategoryUi:false,
contextHint:m.f_d,anticache:Math.random()}},widgetProperties:{name:'messagingDialog'}});}});}}});}});
Uize.module({name:'Uize.Widget.Fleeting',required:'Uize.Fade',builder:function(d_$){'use strict';var d__;function d_a(m){m.d_b!=d__&&m.isWired&&m.setNodeInnerHtml('text',m.d_b);}return d_$.subclass({alphastructor:function(){
var m=this;m.d_c=null;m.d_d=Uize.Fade({curve:Uize.Fade.celeration(0,1),duration:750});m.d_d.wire({Start:function(){m.d_e&&m.displayNode('',m.d_e)},'Changed.value':function(){m.setNodeOpacity('',m.d_d)
},Done:function(){!m.d_e&&m.displayNode('',m.d_e)}});},instanceMethods:{show:function(){var m=this;if(m.d_c!=null){clearTimeout(m.d_c);m.d_c=null;}m.set({d_e:true});},updateUi:function(){var m=this;if(m.isWired){
d_a(m);d_$.doMy(m,'updateUi');}},wireUi:function(){var m=this;if(!m.isWired){var d_f=m.d_f=m.getNode();if(d_f){m.d_b==d__&&m.set({d_b:m.getNodeValue('text')});m.wireNode('','click',function(){if(m.d_g)
m.set({d_e:false});});d_$.doMy(m,'wireUi');}}}},stateProperties:{d_g:{name:'clickToDismiss',value:false},d_h:{name:'maxOpacity',value:1},d_i:{name:'lifeSpan',value:5000},d_c:{name:'lifeTimeout',value:null
},d_e:{name:'shown',onChange:function(){var m=this;if(m.isWired){m.d_e&&m.fire('Before Show');m.d_d.start({startValue:m.d_e?0:m.d_h,endValue:m.d_e?m.d_h:0});if(m.d_e)m.d_c=setTimeout(function(){m.set({d_e:false})},
m.d_i);!m.d_e&&m.fire('After Hide');}},value:false},d_b:{name:'text',onChange:function(){d_a(this)}}}});}});
Uize.module({name:'ZazzleWww.AccessoryUi',superclass:'Uize.Widget.Button',required:['Uize.Url','Zazzle.SeeMoreUi','Uize.Widget.mWeb'],builder:function(e_$){'use strict';var e__=false,e_a=null;var e_b=e_$.subclass(
e_a,function(){var m=this;m.addChild('seeMore',Zazzle.SeeMoreUi,{extraClasses:m.e_c});m.addChild('add',Uize.Widget.Button).wire('Click',function(){m.e_d()});}),e_e=e_b.prototype;e_b.mixins(Uize.Widget.mWeb);
e_e.e_d=function(){var m=this,e_f=m.e_f,e_g=e_f.isDependent,e_h=function(e_i){m.callInherited('useProductUiDialog')({action:e_g?'bundle':'addtocartservice',productId:e_f.productId,productAttributes:Uize.copy(
e_f.attributes,{context:null,view:null}),title:e_f.title,okText:m.children.add.get('text'),isEditable:e__,allowOos:e__,singleProductContext:true,accessoryId:e_f.accessoryId,parentProductOption:m.e_j,
parentProductId:e_i,parentProductType:m.e_k,productTitle:e_f.title,showQuantitySelector:e_g?e_a:true,submitHandler:function(e_l){m.fire({name:'Accessory Added',widget:m,parentProductId:e_i,attributes:e_l.attributeValues,
isDependent:e_g});},dismissHandler:function(){m.fire({name:'Cancel Add',widget:m,parentProductId:e_i});}})};!m.fire({name:'Before Add',handler:e_h}).handled&&e_h(m.e_i);};e_e.e_m=function(e_n){var m=this;
if(m.isWired){}};e_e.e_o=function(){var m=this,e_f=m.e_f;if(m.isWired){m.web('title').html(e_f.title).property('title',e_f.title);m.web('description').html(e_f.description);m.web('price').html(e_f.price);
m.children.add.set({text:e_f.addButtonTitle});m.web('thumbnail').value(Uize.Url.resolve(e_f.thumbnailUrl,{max_dim:m.e_p==='List'?m.e_q:m.e_r}));m.children.seeMore.updateUi();}};e_e.updateUi=function(){
var m=this;if(m.isWired){m.e_o();e_$.doMy(m,'updateUi');}};e_e.wireUi=function(){var m=this;if(!m.isWired){m.web('thumbnail').click(function(){m.e_d()});e_$.doMy(m,'wireUi');}};e_b.stateProperties({e_f:{
name:'info',onChange:e_e.e_o},e_j:'parentAttributes',e_i:'parentProductId',e_k:'parentProductType',e_c:'seeMoreCssClass',e_r:{name:'thumbnailSizeGrid',value:152},e_q:{name:'thumbnailSizeList',value:92
},e_p:{name:'view',value:'List'}});return e_b;}});
Uize.module({name:'ZazzleWww.AccessoriesUi',superclass:'Uize.Widget.Options',required:['ZazzleWww.AccessoryUi','Uize.Url','Uize.Data.Compare','Uize.Dom.Pos','Uize.Widget.Fleeting','Uize.Widget.mWeb'],builder:function(e_$){
'use strict';var e__=Uize,e_a=e__.Url.toParams,e_b=null,e_c;var e_d=e_$.subclass(e_b,function(){var m=this,e_e=m.addChild('added',e__.Widget.Fleeting);m.wire({'Option Event':function(e_f){var e_g=e_f.childEvent,
e_h=e_g.name;if(e_h=='Accessory Added'){var e_i=e_g.widget,e_j=e_g.widget.get('info'),e_k=e_e.getNodeStyle('',{paddingLeft:1,paddingRight:1});e_e.setNodeStyle('',{width:e__.Dom.Pos.getDimensions(e_i.getNode('title')).width
-parseInt(e_k.paddingLeft||0)-parseInt(e_k.paddingRight||0),top:e__.Dom.Pos.getCoords(e_i.getNode()).top-e__.Dom.Pos.getCoords(m.getNode()).top});e_e.set({text:m.localize('accessoryAdded',{accessoryName:e_j.productTypeDisplayName}
),shown:true});e_j.isDependent?m.ajax({service:'product/bundle',ax:'createoradd',pd:e_j.productId,ea:e_a(e_g.attributes),qty:e_j.quantity,did:e_j.dependencyId,ppd:m.e_l,patt:e_a(m.e_m),pqty:m.e_n},function(e_o){
if(e_o.success)m.fire({name:'Accessory Added',bundleId:e_o.bundleId});else m.inform({message:m.localize('accessoryAddFailed')});}):m.fire({name:'Accessory Added',isDependent:false,parentProductId:e_g.parentProductId
});}else if(e_h=='Before Add'||e_h=='Cancel Add')m.fire(e_g);},'Changed.values':function(){m.e_p()}});}),e_q=e_d.prototype;e_d.mixins(e__.Widget.mWeb);e_q.e_r=function(){var m=this;m.isWired&&m.getNode()
&&(m.e_l||m.e_s)&&m.ajax({service:'product/accessories/get',pt:m.e_s,pd:m.e_l,ea:e_a(m.e_m),bg:m.e_t,ta:e_a(m.e_u)},{cache:'memory',callbackSuccess:function(e_o){if(e_o.success){var e_v=m.e_v,e_w=m.e_w,
e_x=e_o.data,e_y=m.get('values');if(e_v==e_c)e_v=0;if(e_w==e_c)e_w=Infinity;if(e_v>0||e_w<Infinity){e_w=Math.min(e_x.length-1,e_w);var e_z=[];for(var e_A=e_v;e_A<=e_w;e_A++)e_z.push(e_x[e_A]);e_x=e_z;
}if(!e__.Data.Compare.identical(e_x,e_y)){if(!e__.isEmpty(e_y)&&e_x.length==e_y.length){m.forAll(function(e_B,e_C){e_B.set(m.getOptionProperties(e_C,e_x[e_C]));});}else m.set({values:e_x});}}}});};e_q.e_p=function(){
var m=this;if(m.isWired){m.web().display(!e__.isEmpty(m.get('values')));m.forAll(function(e_B){e_B.updateUi()});}};e_q.getOptionProperties=function(e_D,e_E){var m=this;return e__.copyInto(e_$.doMy(m,'getOptionProperties',[e_D,e_E])||{},
{backgroundColor:m.e_t,info:e_E.info,parentAttributes:m.e_m,parentProductId:m.e_l,parentProductType:m.e_s,thumbnailSizeGrid:m.e_F,thumbnailSizeList:m.e_G,view:m.e_H});};e_q.updateUi=function(){var m=this;
if(m.isWired){m.e_p();e_$.doMy(m,'updateUi');}};e_q.wireUi=function(){var m=this;if(!m.isWired){e_$.doMy(m,'wireUi');!m.e_I&&m.e_J&&m.e_r();m.e_I=true;}};e_d.stateProperties({e_m:{name:'attributes',conformer:function(e_K){
return Uize.Data.Compare.identical(e_K,this.e_m)?this.e_m:e_K;},onChange:e_q.e_r},e_t:{name:'backgroundColor',onChange:e_q.e_r},e_J:'clientSideLoaded',e_w:'endIndex',e_l:{name:'productId',onChange:e_q.e_r
},e_s:{name:'productType',onChange:e_q.e_r},e_n:{name:'quantity',value:1},e_v:'startIndex',e_u:{name:'templateParams',onChange:e_q.e_r},e_F:{name:'thumbnailSizeGrid',value:152},e_G:{name:'thumbnailSizeList',
value:92},e_H:{name:'view',value:'List'},e_L:{name:'sectionTitle'}});e_d.set({optionWidgetClass:ZazzleWww.AccessoryUi,html:true});return e_d;}});
Uize.module({name:'ZazzleWww.BasicBoxPromotion',superclass:'Uize.Widget',required:'Uize.Node',builder:function(d_$){'use strict';var d__=true,d_a=false,d_b=null,d_c=Uize;var d_d=d_$.subclass(),d_e=d_d.prototype
;d_e.launchDetailsDialog=function(){var m=this;m.callInherited('useDialog')({component:{name:'ZazzleWww.Dialog.PromotionDetails',params:{promotion:m.d_f}},widgetClassName:'Uize.Widget.Dialog',widgetProperties:{
name:'promotionDetailsDialog'}});};d_e.wireUi=function(){var m=this;if(!m.isWired){m.wireNode('boxDetails','click',function(){m.launchDetailsDialog()});d_$.doMy(m,'wireUi');}};d_d.stateProperties({d_f:'promotionId',
d_g:'promoCode'});return d_d;}});
Uize.module({name:'ZazzleWww.ProductPagePromotions',superclass:'Zazzle.Widget',builder:function(e_$){'use strict';var e__=true,e_a=false;var e_b=e_$.subclass(),e_c=e_b.prototype;e_c.wireUi=function(){var m=this;
if(!m.isWired){m.wireNode('seeBelow','click',function(){m.e_d&&Uize.require('Uize.Fx.Scroll',function(e_e){e_e.scrollToNode(m.e_d);});});if(m.e_f){m.web('close').click(function(){m.web().setClassState(m.e_g,e__);
m.web('closeTab').hide();m.web('offerTab').show();m.fire({name:'Changed.height',bubble:e__});});m.web('offerTab').click(function(){m.web().setClassState(m.e_g,e_a);m.web('closeTab').show();m.web('offerTab').hide();
m.fire({name:'Changed.height',bubble:e__});});m.web().setClassState(m.e_h,e_a);m.web('closeTab').contentHeight(m.web('content').dimensions().height);m.web().setClassState(m.e_h,e__);}if(m.e_i){m.web('content').click(function(e_j){
if(e_j.target.tagName.toLowerCase()!=='a')m.web().toggleClassState(m.e_k);});}e_$.doMy(m,'wireUi');}};e_b.stateProperties({e_d:'scrollToNodeId',e_h:'cssClassOpen',e_g:'cssClassCollapsed',e_k:'cssClassToggled',
e_f:{name:'allowTab',value:e_a},e_i:'toggleOnClick'});return e_b;}});
Uize.module({name:'Zazzle.Hammer',builder:function(b_$){if(typeof window!='undefined'){(function(window,document,exportName,undefined){'use strict';var VENDOR_PREFIXES=['','webkit','moz','MS','ms','o'];
var TEST_ELEMENT=document.createElement('div');var TYPE_FUNCTION='function';var round=Math.round;var abs=Math.abs;var now=Date.now;function setTimeoutContext(fn,timeout,context){return setTimeout(bindFn(fn,context),timeout);
}function invokeArrayArg(arg,fn,context){if(Array.isArray(arg)){each(arg,context[fn],context);return true;}return false;}function each(obj,iterator,context){var i;if(!obj){return;}if(obj.forEach){obj.forEach(iterator,context);
}else if(obj.length!==undefined){i=0;while(i<obj.length){iterator.call(context,obj[i],i,obj);i++;}}else{for(i in obj){obj.hasOwnProperty(i)&&iterator.call(context,obj[i],i,obj);}}}function extend(dest,src,merge){
var keys=Object.keys(src);var i=0;while(i<keys.length){if(!merge||(merge&&dest[keys[i]]===undefined)){dest[keys[i]]=src[keys[i]];}i++;}return dest;}function merge(dest,src){return extend(dest,src,true);
}function inherit(child,base,properties){var baseP=base.prototype,childP;childP=child.prototype=Object.create(baseP);childP.constructor=child;childP.b__=baseP;if(properties){extend(childP,properties);
}}function bindFn(fn,context){return function boundFn(){return fn.apply(context,arguments);};}function boolOrFn(val,args){if(typeof val==TYPE_FUNCTION){return val.apply(args?args[0]||undefined:undefined,args);
}return val;}function ifUndefined(val1,val2){return(val1===undefined)?val2:val1;}function addEventListeners(target,types,handler){each(splitStr(types),function(type){target.addEventListener(type,handler,false);
});}function removeEventListeners(target,types,handler){each(splitStr(types),function(type){target.removeEventListener(type,handler,false);});}function hasParent(node,parent){while(node){if(node==parent){
return true;}node=node.parentNode;}return false;}function inStr(str,find){return str.indexOf(find)> -1;}function splitStr(str){return str.trim().split(/\s+/g);}function inArray(src,find,findByKey){if(src.indexOf&& !findByKey){
return src.indexOf(find);}else{var i=0;while(i<src.length){if((findByKey&&src[i][findByKey]==find)||(!findByKey&&src[i]===find)){return i;}i++;}return-1;}}function toArray(obj){return Array.prototype.slice.call(obj,0);
}function uniqueArray(src,key,sort){var results=[];var values=[];var i=0;while(i<src.length){var val=key?src[i][key]:src[i];if(inArray(values,val)<0){results.push(src[i]);}values[i]=val;i++;}if(sort){
if(!key){results=results.sort();}else{results=results.sort(function sortUniqueArray(a,b){return a[key]>b[key];});}}return results;}function prefixed(obj,property){var prefix,prop;var camelProp=property[0].toUpperCase()+property.slice(1);
var i=0;while(i<VENDOR_PREFIXES.length){prefix=VENDOR_PREFIXES[i];prop=(prefix)?prefix+camelProp:property;if(prop in obj){return prop;}i++;}return undefined;}var b_a=1;function uniqueId(){return b_a++;
}function getWindowForElement(element){var doc=element.ownerDocument;return(doc.defaultView||doc.parentWindow);}var MOBILE_REGEX=/mobile|tablet|ip(ad|hone|od)|android/i;var SUPPORT_TOUCH=('ontouchstart'in window);
var SUPPORT_POINTER_EVENTS=prefixed(window,'PointerEvent')!==undefined;var SUPPORT_ONLY_TOUCH=SUPPORT_TOUCH&&MOBILE_REGEX.test(navigator.userAgent);var INPUT_TYPE_TOUCH='touch';var INPUT_TYPE_PEN='pen';
var INPUT_TYPE_MOUSE='mouse';var INPUT_TYPE_KINECT='kinect';var COMPUTE_INTERVAL=25;var INPUT_START=1;var INPUT_MOVE=2;var INPUT_END=4;var INPUT_CANCEL=8;var DIRECTION_NONE=1;var DIRECTION_LEFT=2;var DIRECTION_RIGHT=4;
var DIRECTION_UP=8;var DIRECTION_DOWN=16;var DIRECTION_HORIZONTAL=DIRECTION_LEFT|DIRECTION_RIGHT;var DIRECTION_VERTICAL=DIRECTION_UP|DIRECTION_DOWN;var DIRECTION_ALL=DIRECTION_HORIZONTAL|DIRECTION_VERTICAL;
var PROPS_XY=['x','y'];var PROPS_CLIENT_XY=['clientX','clientY'];function Input(manager,callback){var self=this;this.manager=manager;this.callback=callback;this.element=manager.element;this.target=manager.options.inputTarget;
this.domHandler=function(ev){if(boolOrFn(manager.options.enable,[manager])){self.handler(ev);}};this.init();}Input.prototype={handler:function(){},init:function(){this.evEl&&addEventListeners(this.element,this.evEl,this.domHandler);
this.evTarget&&addEventListeners(this.target,this.evTarget,this.domHandler);this.evWin&&addEventListeners(getWindowForElement(this.element),this.evWin,this.domHandler);},destroy:function(){this.evEl&&removeEventListeners(this.element,this.evEl,this.domHandler);
this.evTarget&&removeEventListeners(this.target,this.evTarget,this.domHandler);this.evWin&&removeEventListeners(getWindowForElement(this.element),this.evWin,this.domHandler);}};function createInputInstance(manager){
var Type;var inputClass=manager.options.inputClass;if(inputClass){Type=inputClass;}else if(SUPPORT_POINTER_EVENTS){Type=PointerEventInput;}else if(SUPPORT_ONLY_TOUCH){Type=TouchInput;}else if(!SUPPORT_TOUCH){
Type=MouseInput;}else{Type=TouchMouseInput;}return new(Type)(manager,inputHandler);}function inputHandler(manager,eventType,input){var pointersLen=input.pointers.length;var changedPointersLen=input.changedPointers.length;
var isFirst=(eventType&INPUT_START&&(pointersLen-changedPointersLen===0));var isFinal=(eventType&(INPUT_END|INPUT_CANCEL)&&(pointersLen-changedPointersLen===0));input.isFirst= !!isFirst;input.isFinal= !!isFinal;
if(isFirst){manager.session={};}input.eventType=eventType;computeInputData(manager,input);manager.emit('hammer.input',input);manager.recognize(input);manager.session.prevInput=input;}function computeInputData(manager,input){
var session=manager.session;var pointers=input.pointers;var pointersLength=pointers.length;if(!session.firstInput){session.firstInput=simpleCloneInputData(input);}if(pointersLength>1&& !session.firstMultiple){
session.firstMultiple=simpleCloneInputData(input);}else if(pointersLength===1){session.firstMultiple=false;}var firstInput=session.firstInput;var firstMultiple=session.firstMultiple;var offsetCenter=firstMultiple?firstMultiple.center:firstInput.center;
var center=input.center=getCenter(pointers);input.timeStamp=now();input.deltaTime=input.timeStamp-firstInput.timeStamp;input.angle=getAngle(offsetCenter,center);input.distance=getDistance(offsetCenter,center);
computeDeltaXY(session,input);input.offsetDirection=getDirection(input.deltaX,input.deltaY);input.scale=firstMultiple?getScale(firstMultiple.pointers,pointers):1;input.rotation=firstMultiple?getRotation(firstMultiple.pointers,pointers):0;
computeIntervalInputData(session,input);var target=manager.element;if(hasParent(input.srcEvent.target,target)){target=input.srcEvent.target;}input.target=target;}function computeDeltaXY(session,input){
var center=input.center;var offset=session.offsetDelta||{};var prevDelta=session.prevDelta||{};var prevInput=session.prevInput||{};if(input.eventType===INPUT_START||prevInput.eventType===INPUT_END){prevDelta=session.prevDelta={
x:prevInput.deltaX||0,y:prevInput.deltaY||0};offset=session.offsetDelta={x:center.x,y:center.y};}input.deltaX=prevDelta.x+(center.x-offset.x);input.deltaY=prevDelta.y+(center.y-offset.y);}function computeIntervalInputData(session,input){
var last=session.lastInterval||input,deltaTime=input.timeStamp-last.timeStamp,velocity,velocityX,velocityY,direction;if(input.eventType!=INPUT_CANCEL&&(deltaTime>COMPUTE_INTERVAL||last.velocity===undefined)){
var deltaX=last.deltaX-input.deltaX;var deltaY=last.deltaY-input.deltaY;var v=getVelocity(deltaTime,deltaX,deltaY);velocityX=v.x;velocityY=v.y;velocity=(abs(v.x)>abs(v.y))?v.x:v.y;direction=getDirection(deltaX,deltaY);
session.lastInterval=input;}else{velocity=last.velocity;velocityX=last.velocityX;velocityY=last.velocityY;direction=last.direction;}input.velocity=velocity;input.velocityX=velocityX;input.velocityY=velocityY;
input.direction=direction;}function simpleCloneInputData(input){var pointers=[];var i=0;while(i<input.pointers.length){pointers[i]={clientX:round(input.pointers[i].clientX),clientY:round(input.pointers[i].clientY)
};i++;}return{timeStamp:now(),pointers:pointers,center:getCenter(pointers),deltaX:input.deltaX,deltaY:input.deltaY};}function getCenter(pointers){var pointersLength=pointers.length;if(pointersLength===1){
return{x:round(pointers[0].clientX),y:round(pointers[0].clientY)};}var x=0,y=0,i=0;while(i<pointersLength){x+=pointers[i].clientX;y+=pointers[i].clientY;i++;}return{x:round(x/pointersLength),y:round(y/pointersLength)
};}function getVelocity(deltaTime,x,y){return{x:x/deltaTime||0,y:y/deltaTime||0};}function getDirection(x,y){if(x===y){return DIRECTION_NONE;}if(abs(x)>=abs(y)){return x>0?DIRECTION_LEFT:DIRECTION_RIGHT;
}return y>0?DIRECTION_UP:DIRECTION_DOWN;}function getDistance(p1,p2,props){if(!props){props=PROPS_XY;}var x=p2[props[0]]-p1[props[0]],y=p2[props[1]]-p1[props[1]];return Math.sqrt((x*x)+(y*y));}function getAngle(p1,p2,props){
if(!props){props=PROPS_XY;}var x=p2[props[0]]-p1[props[0]],y=p2[props[1]]-p1[props[1]];return Math.atan2(y,x)*180/Math.PI;}function getRotation(start,end){return getAngle(end[1],end[0],PROPS_CLIENT_XY)-getAngle(start[1],start[0],PROPS_CLIENT_XY);
}function getScale(start,end){return getDistance(end[0],end[1],PROPS_CLIENT_XY)/getDistance(start[0],start[1],PROPS_CLIENT_XY);}var MOUSE_INPUT_MAP={mousedown:INPUT_START,mousemove:INPUT_MOVE,mouseup:INPUT_END
};var MOUSE_ELEMENT_EVENTS='mousedown';var MOUSE_WINDOW_EVENTS='mousemove mouseup';function MouseInput(){this.evEl=MOUSE_ELEMENT_EVENTS;this.evWin=MOUSE_WINDOW_EVENTS;this.allow=true;this.pressed=false;
Input.apply(this,arguments);}inherit(MouseInput,Input,{handler:function MEhandler(ev){var eventType=MOUSE_INPUT_MAP[ev.type];if(eventType&INPUT_START&&ev.button===0){this.pressed=true;}if(eventType&INPUT_MOVE&&ev.which!==1){
eventType=INPUT_END;}if(!this.pressed|| !this.allow){return;}if(eventType&INPUT_END){this.pressed=false;}this.callback(this.manager,eventType,{pointers:[ev],changedPointers:[ev],pointerType:INPUT_TYPE_MOUSE,
srcEvent:ev});}});var POINTER_INPUT_MAP={pointerdown:INPUT_START,pointermove:INPUT_MOVE,pointerup:INPUT_END,pointercancel:INPUT_CANCEL,pointerout:INPUT_CANCEL};var IE10_POINTER_TYPE_ENUM={2:INPUT_TYPE_TOUCH,
3:INPUT_TYPE_PEN,4:INPUT_TYPE_MOUSE,5:INPUT_TYPE_KINECT};var POINTER_ELEMENT_EVENTS='pointerdown';var POINTER_WINDOW_EVENTS='pointermove pointerup pointercancel';if(window.MSPointerEvent){POINTER_ELEMENT_EVENTS='MSPointerDown';
POINTER_WINDOW_EVENTS='MSPointerMove MSPointerUp MSPointerCancel';}function PointerEventInput(){this.evEl=POINTER_ELEMENT_EVENTS;this.evWin=POINTER_WINDOW_EVENTS;Input.apply(this,arguments);this.store=(this.manager.session.pointerEvents=[]);
}inherit(PointerEventInput,Input,{handler:function PEhandler(ev){var store=this.store;var removePointer=false;var eventTypeNormalized=ev.type.toLowerCase().replace('ms','');var eventType=POINTER_INPUT_MAP[eventTypeNormalized];
var pointerType=IE10_POINTER_TYPE_ENUM[ev.pointerType]||ev.pointerType;var isTouch=(pointerType==INPUT_TYPE_TOUCH);var storeIndex=inArray(store,ev.pointerId,'pointerId');if(eventType&INPUT_START&&(ev.button===0||isTouch)){
if(storeIndex<0){store.push(ev);storeIndex=store.length-1;}}else if(eventType&(INPUT_END|INPUT_CANCEL)){removePointer=true;}if(storeIndex<0){return;}store[storeIndex]=ev;this.callback(this.manager,eventType,{
pointers:store,changedPointers:[ev],pointerType:pointerType,srcEvent:ev});if(removePointer){store.splice(storeIndex,1);}}});var SINGLE_TOUCH_INPUT_MAP={touchstart:INPUT_START,touchmove:INPUT_MOVE,touchend:INPUT_END,
touchcancel:INPUT_CANCEL};var SINGLE_TOUCH_TARGET_EVENTS='touchstart';var SINGLE_TOUCH_WINDOW_EVENTS='touchstart touchmove touchend touchcancel';function SingleTouchInput(){this.evTarget=SINGLE_TOUCH_TARGET_EVENTS;
this.evWin=SINGLE_TOUCH_WINDOW_EVENTS;this.started=false;Input.apply(this,arguments);}inherit(SingleTouchInput,Input,{handler:function TEhandler(ev){var type=SINGLE_TOUCH_INPUT_MAP[ev.type];if(type===INPUT_START){
this.started=true;}if(!this.started){return;}var touches=normalizeSingleTouches.call(this,ev,type);if(type&(INPUT_END|INPUT_CANCEL)&&touches[0].length-touches[1].length===0){this.started=false;}this.callback(this.manager,type,{
pointers:touches[0],changedPointers:touches[1],pointerType:INPUT_TYPE_TOUCH,srcEvent:ev});}});function normalizeSingleTouches(ev,type){var all=toArray(ev.touches);var changed=toArray(ev.changedTouches);
if(type&(INPUT_END|INPUT_CANCEL)){all=uniqueArray(all.concat(changed),'identifier',true);}return[all,changed];}var TOUCH_INPUT_MAP={touchstart:INPUT_START,touchmove:INPUT_MOVE,touchend:INPUT_END,touchcancel:INPUT_CANCEL
};var TOUCH_TARGET_EVENTS='touchstart touchmove touchend touchcancel';function TouchInput(){this.evTarget=TOUCH_TARGET_EVENTS;this.targetIds={};Input.apply(this,arguments);}inherit(TouchInput,Input,{
handler:function MTEhandler(ev){var type=TOUCH_INPUT_MAP[ev.type];var touches=getTouches.call(this,ev,type);if(!touches){return;}this.callback(this.manager,type,{pointers:touches[0],changedPointers:touches[1],
pointerType:INPUT_TYPE_TOUCH,srcEvent:ev});}});function getTouches(ev,type){var allTouches=toArray(ev.touches);var targetIds=this.targetIds;if(type&(INPUT_START|INPUT_MOVE)&&allTouches.length===1){targetIds[allTouches[0].identifier]=true;
return[allTouches,allTouches];}var i,targetTouches,changedTouches=toArray(ev.changedTouches),changedTargetTouches=[],target=this.target;targetTouches=allTouches.filter(function(touch){return hasParent(touch.target,target);
});if(type===INPUT_START){i=0;while(i<targetTouches.length){targetIds[targetTouches[i].identifier]=true;i++;}}i=0;while(i<changedTouches.length){if(targetIds[changedTouches[i].identifier]){changedTargetTouches.push(changedTouches[i]);
}if(type&(INPUT_END|INPUT_CANCEL)){delete targetIds[changedTouches[i].identifier];}i++;}if(!changedTargetTouches.length){return;}return[uniqueArray(targetTouches.concat(changedTargetTouches),'identifier',true),
changedTargetTouches];}function TouchMouseInput(){Input.apply(this,arguments);var handler=bindFn(this.handler,this);this.touch=new TouchInput(this.manager,handler);this.mouse=new MouseInput(this.manager,handler);
}inherit(TouchMouseInput,Input,{handler:function TMEhandler(manager,inputEvent,inputData){var isTouch=(inputData.pointerType==INPUT_TYPE_TOUCH),isMouse=(inputData.pointerType==INPUT_TYPE_MOUSE);if(isTouch){
this.mouse.allow=false;}else if(isMouse&& !this.mouse.allow){return;}if(inputEvent&(INPUT_END|INPUT_CANCEL)){this.mouse.allow=true;}this.callback(manager,inputEvent,inputData);},destroy:function destroy(){
this.touch.destroy();this.mouse.destroy();}});var PREFIXED_TOUCH_ACTION=prefixed(TEST_ELEMENT.style,'touchAction');var NATIVE_TOUCH_ACTION=PREFIXED_TOUCH_ACTION!==undefined;var TOUCH_ACTION_COMPUTE='compute';
var TOUCH_ACTION_AUTO='auto';var TOUCH_ACTION_MANIPULATION='manipulation';var TOUCH_ACTION_NONE='none';var TOUCH_ACTION_PAN_X='pan-x';var TOUCH_ACTION_PAN_Y='pan-y';function TouchAction(manager,value){
this.manager=manager;this.set(value);}TouchAction.prototype={set:function(value){if(value==TOUCH_ACTION_COMPUTE){value=this.compute();}if(NATIVE_TOUCH_ACTION){this.manager.element.style[PREFIXED_TOUCH_ACTION]=value;
}this.actions=value.toLowerCase().trim();},update:function(){this.set(this.manager.options.touchAction);},compute:function(){var actions=[];each(this.manager.recognizers,function(recognizer){if(boolOrFn(recognizer.options.enable,[recognizer])){
actions=actions.concat(recognizer.getTouchAction());}});return cleanTouchActions(actions.join(' '));},preventDefaults:function(input){if(NATIVE_TOUCH_ACTION){return;}var srcEvent=input.srcEvent;var direction=input.offsetDirection;
if(this.manager.session.prevented){srcEvent.preventDefault();return;}var actions=this.actions;var hasNone=inStr(actions,TOUCH_ACTION_NONE);var hasPanY=inStr(actions,TOUCH_ACTION_PAN_Y);var hasPanX=inStr(actions,TOUCH_ACTION_PAN_X);
if(hasNone||(hasPanY&&direction&DIRECTION_HORIZONTAL)||(hasPanX&&direction&DIRECTION_VERTICAL)){return this.preventSrc(srcEvent);}},preventSrc:function(srcEvent){this.manager.session.prevented=true;srcEvent.preventDefault();
}};function cleanTouchActions(actions){if(inStr(actions,TOUCH_ACTION_NONE)){return TOUCH_ACTION_NONE;}var hasPanX=inStr(actions,TOUCH_ACTION_PAN_X);var hasPanY=inStr(actions,TOUCH_ACTION_PAN_Y);if(hasPanX&&hasPanY){
return TOUCH_ACTION_PAN_X+' '+TOUCH_ACTION_PAN_Y;}if(hasPanX||hasPanY){return hasPanX?TOUCH_ACTION_PAN_X:TOUCH_ACTION_PAN_Y;}if(inStr(actions,TOUCH_ACTION_MANIPULATION)){return TOUCH_ACTION_MANIPULATION;
}return TOUCH_ACTION_AUTO;}var STATE_POSSIBLE=1;var STATE_BEGAN=2;var STATE_CHANGED=4;var STATE_ENDED=8;var STATE_RECOGNIZED=STATE_ENDED;var STATE_CANCELLED=16;var STATE_FAILED=32;function Recognizer(options){
this.id=uniqueId();this.manager=null;this.options=merge(options||{},this.defaults);this.options.enable=ifUndefined(this.options.enable,true);this.state=STATE_POSSIBLE;this.simultaneous={};this.requireFail=[];
}Recognizer.prototype={defaults:{},set:function(options){extend(this.options,options);this.manager&&this.manager.touchAction.update();return this;},recognizeWith:function(otherRecognizer){if(invokeArrayArg(otherRecognizer,'recognizeWith',this)){
return this;}var simultaneous=this.simultaneous;otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this);if(!simultaneous[otherRecognizer.id]){simultaneous[otherRecognizer.id]=otherRecognizer;
otherRecognizer.recognizeWith(this);}return this;},dropRecognizeWith:function(otherRecognizer){if(invokeArrayArg(otherRecognizer,'dropRecognizeWith',this)){return this;}otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this);
delete this.simultaneous[otherRecognizer.id];return this;},requireFailure:function(otherRecognizer){if(invokeArrayArg(otherRecognizer,'requireFailure',this)){return this;}var requireFail=this.requireFail;
otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this);if(inArray(requireFail,otherRecognizer)=== -1){requireFail.push(otherRecognizer);otherRecognizer.requireFailure(this);}return this;},
dropRequireFailure:function(otherRecognizer){if(invokeArrayArg(otherRecognizer,'dropRequireFailure',this)){return this;}otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this);var index=inArray(this.requireFail,otherRecognizer);
if(index> -1){this.requireFail.splice(index,1);}return this;},hasRequireFailures:function(){return this.requireFail.length>0;},canRecognizeWith:function(otherRecognizer){return!!this.simultaneous[otherRecognizer.id];
},emit:function(input){var self=this;var state=this.state;function emit(withState){self.manager.emit(self.options.event+(withState?stateStr(state):''),input);}if(state<STATE_ENDED){emit(true);}emit();
if(state>=STATE_ENDED){emit(true);}},tryEmit:function(input){if(this.canEmit()){return this.emit(input);}this.state=STATE_FAILED;},canEmit:function(){var i=0;while(i<this.requireFail.length){if(!(this.requireFail[i].state&(STATE_FAILED|STATE_POSSIBLE))){
return false;}i++;}return true;},recognize:function(inputData){var inputDataClone=extend({},inputData);if(!boolOrFn(this.options.enable,[this,inputDataClone])){this.reset();this.state=STATE_FAILED;return;
}if(this.state&(STATE_RECOGNIZED|STATE_CANCELLED|STATE_FAILED)){this.state=STATE_POSSIBLE;}this.state=this.process(inputDataClone);if(this.state&(STATE_BEGAN|STATE_CHANGED|STATE_ENDED|STATE_CANCELLED)){
this.tryEmit(inputDataClone);}},process:function(inputData){},getTouchAction:function(){},reset:function(){}};function stateStr(state){if(state&STATE_CANCELLED){return'cancel';}else if(state&STATE_ENDED){
return'end';}else if(state&STATE_CHANGED){return'move';}else if(state&STATE_BEGAN){return'start';}return'';}function directionStr(direction){if(direction==DIRECTION_DOWN){return'down';}else if(direction==DIRECTION_UP){
return'up';}else if(direction==DIRECTION_LEFT){return'left';}else if(direction==DIRECTION_RIGHT){return'right';}return'';}function getRecognizerByNameIfManager(otherRecognizer,recognizer){var manager=recognizer.manager;
if(manager){return manager.get(otherRecognizer);}return otherRecognizer;}function AttrRecognizer(){Recognizer.apply(this,arguments);}inherit(AttrRecognizer,Recognizer,{defaults:{pointers:1},attrTest:function(input){
var optionPointers=this.options.pointers;return optionPointers===0||input.pointers.length===optionPointers;},process:function(input){var state=this.state;var eventType=input.eventType;var isRecognized=state&(STATE_BEGAN|STATE_CHANGED);
var isValid=this.attrTest(input);if(isRecognized&&(eventType&INPUT_CANCEL|| !isValid)){return state|STATE_CANCELLED;}else if(isRecognized||isValid){if(eventType&INPUT_END){return state|STATE_ENDED;}else if(!(state&STATE_BEGAN)){
return STATE_BEGAN;}return state|STATE_CHANGED;}return STATE_FAILED;}});function PanRecognizer(){AttrRecognizer.apply(this,arguments);this.pX=null;this.pY=null;}inherit(PanRecognizer,AttrRecognizer,{
defaults:{event:'pan',threshold:10,pointers:1,direction:DIRECTION_ALL},getTouchAction:function(){var direction=this.options.direction;var actions=[];if(direction&DIRECTION_HORIZONTAL){actions.push(TOUCH_ACTION_PAN_Y);
}if(direction&DIRECTION_VERTICAL){actions.push(TOUCH_ACTION_PAN_X);}return actions;},directionTest:function(input){var options=this.options;var hasMoved=true;var distance=input.distance;var direction=input.direction;
var x=input.deltaX;var y=input.deltaY;if(!(direction&options.direction)){if(options.direction&DIRECTION_HORIZONTAL){direction=(x===0)?DIRECTION_NONE:(x<0)?DIRECTION_LEFT:DIRECTION_RIGHT;hasMoved=x!=this.pX;
distance=Math.abs(input.deltaX);}else{direction=(y===0)?DIRECTION_NONE:(y<0)?DIRECTION_UP:DIRECTION_DOWN;hasMoved=y!=this.pY;distance=Math.abs(input.deltaY);}}input.direction=direction;return hasMoved&&distance>options.threshold&&direction&options.direction;
},attrTest:function(input){return AttrRecognizer.prototype.attrTest.call(this,input)&&(this.state&STATE_BEGAN||(!(this.state&STATE_BEGAN)&&this.directionTest(input)));},emit:function(input){this.pX=input.deltaX;
this.pY=input.deltaY;var direction=directionStr(input.direction);if(direction){this.manager.emit(this.options.event+direction,input);}this.b__.emit.call(this,input);}});function PinchRecognizer(){AttrRecognizer.apply(this,arguments);
}inherit(PinchRecognizer,AttrRecognizer,{defaults:{event:'pinch',threshold:0,pointers:2},getTouchAction:function(){return[TOUCH_ACTION_NONE];},attrTest:function(input){return this.b__.attrTest.call(this,input)&&
(Math.abs(input.scale-1)>this.options.threshold||this.state&STATE_BEGAN);},emit:function(input){this.b__.emit.call(this,input);if(input.scale!==1){var inOut=input.scale<1?'in':'out';this.manager.emit(this.options.event+inOut,input);
}}});function PressRecognizer(){Recognizer.apply(this,arguments);this.b_b=null;this.b_c=null;}inherit(PressRecognizer,Recognizer,{defaults:{event:'press',pointers:1,time:500,threshold:5},getTouchAction:function(){
return[TOUCH_ACTION_AUTO];},process:function(input){var options=this.options;var validPointers=input.pointers.length===options.pointers;var validMovement=input.distance<options.threshold;var validTime=input.deltaTime>options.time;
this.b_c=input;if(!validMovement|| !validPointers||(input.eventType&(INPUT_END|INPUT_CANCEL)&& !validTime)){this.reset();}else if(input.eventType&INPUT_START){this.reset();this.b_b=setTimeoutContext(function(){
this.state=STATE_RECOGNIZED;this.tryEmit();},options.time,this);}else if(input.eventType&INPUT_END){return STATE_RECOGNIZED;}return STATE_FAILED;},reset:function(){clearTimeout(this.b_b);},emit:function(input){
if(this.state!==STATE_RECOGNIZED){return;}if(input&&(input.eventType&INPUT_END)){this.manager.emit(this.options.event+'up',input);}else{this.b_c.timeStamp=now();this.manager.emit(this.options.event,this.b_c);
}}});function RotateRecognizer(){AttrRecognizer.apply(this,arguments);}inherit(RotateRecognizer,AttrRecognizer,{defaults:{event:'rotate',threshold:0,pointers:2},getTouchAction:function(){return[TOUCH_ACTION_NONE];
},attrTest:function(input){return this.b__.attrTest.call(this,input)&&(Math.abs(input.rotation)>this.options.threshold||this.state&STATE_BEGAN);}});function SwipeRecognizer(){AttrRecognizer.apply(this,arguments);
}inherit(SwipeRecognizer,AttrRecognizer,{defaults:{event:'swipe',threshold:10,velocity:0.65,direction:DIRECTION_HORIZONTAL|DIRECTION_VERTICAL,pointers:1},getTouchAction:function(){return PanRecognizer.prototype.getTouchAction.call(this);
},attrTest:function(input){var direction=this.options.direction;var velocity;if(direction&(DIRECTION_HORIZONTAL|DIRECTION_VERTICAL)){velocity=input.velocity;}else if(direction&DIRECTION_HORIZONTAL){velocity=input.velocityX;
}else if(direction&DIRECTION_VERTICAL){velocity=input.velocityY;}return this.b__.attrTest.call(this,input)&&direction&input.direction&&input.distance>this.options.threshold&&abs(velocity)>this.options.velocity&&input.eventType&INPUT_END;
},emit:function(input){var direction=directionStr(input.direction);if(direction){this.manager.emit(this.options.event+direction,input);}this.manager.emit(this.options.event,input);}});function TapRecognizer(){
Recognizer.apply(this,arguments);this.pTime=false;this.pCenter=false;this.b_b=null;this.b_c=null;this.count=0;}inherit(TapRecognizer,Recognizer,{defaults:{event:'tap',pointers:1,taps:1,interval:300,time:250,
threshold:2,posThreshold:10},getTouchAction:function(){return[TOUCH_ACTION_MANIPULATION];},process:function(input){var options=this.options;var validPointers=input.pointers.length===options.pointers;
var validMovement=input.distance<options.threshold;var validTouchTime=input.deltaTime<options.time;this.reset();if((input.eventType&INPUT_START)&&(this.count===0)){return this.failTimeout();}if(validMovement&&validTouchTime&&validPointers){
if(input.eventType!=INPUT_END){return this.failTimeout();}var validInterval=this.pTime?(input.timeStamp-this.pTime<options.interval):true;var validMultiTap= !this.pCenter||getDistance(this.pCenter,input.center)<options.posThreshold;
this.pTime=input.timeStamp;this.pCenter=input.center;if(!validMultiTap|| !validInterval){this.count=1;}else{this.count+=1;}this.b_c=input;var tapCount=this.count%options.taps;if(tapCount===0){if(!this.hasRequireFailures()){
return STATE_RECOGNIZED;}else{this.b_b=setTimeoutContext(function(){this.state=STATE_RECOGNIZED;this.tryEmit();},options.interval,this);return STATE_BEGAN;}}}return STATE_FAILED;},failTimeout:function(){
this.b_b=setTimeoutContext(function(){this.state=STATE_FAILED;},this.options.interval,this);return STATE_FAILED;},reset:function(){clearTimeout(this.b_b);},emit:function(){if(this.state==STATE_RECOGNIZED){
this.b_c.tapCount=this.count;this.manager.emit(this.options.event,this.b_c);}}});function Hammer(element,options){options=options||{};options.recognizers=ifUndefined(options.recognizers,Hammer.defaults.preset);
return new Manager(element,options);}Hammer.VERSION='2.0.4';Hammer.defaults={domEvents:false,touchAction:TOUCH_ACTION_COMPUTE,enable:true,inputTarget:null,inputClass:null,preset:[[RotateRecognizer,{enable:false}],
[PinchRecognizer,{enable:false},['rotate']],[SwipeRecognizer,{direction:DIRECTION_HORIZONTAL}],[PanRecognizer,{direction:DIRECTION_HORIZONTAL},['swipe']],[TapRecognizer],[TapRecognizer,{event:'doubletap',taps:2},['tap']],
[PressRecognizer]],cssProps:{userSelect:'none',touchSelect:'none',touchCallout:'none',contentZooming:'none',userDrag:'none',tapHighlightColor:'rgba(0,0,0,0)'}};var STOP=1;var FORCED_STOP=2;function Manager(element,options){
options=options||{};this.options=merge(options,Hammer.defaults);this.options.inputTarget=this.options.inputTarget||element;this.handlers={};this.session={};this.recognizers=[];this.element=element;this.input=createInputInstance(this);
this.touchAction=new TouchAction(this,this.options.touchAction);toggleCssProps(this,true);each(options.recognizers,function(item){var recognizer=this.add(new(item[0])(item[1]));item[2]&&recognizer.recognizeWith(item[2]);
item[3]&&recognizer.requireFailure(item[3]);},this);}Manager.prototype={set:function(options){extend(this.options,options);if(options.touchAction){this.touchAction.update();}if(options.inputTarget){this.input.destroy();
this.input.target=options.inputTarget;this.input.init();}return this;},stop:function(force){this.session.stopped=force?FORCED_STOP:STOP;},recognize:function(inputData){var session=this.session;if(session.stopped){
return;}this.touchAction.preventDefaults(inputData);var recognizer;var recognizers=this.recognizers;var curRecognizer=session.curRecognizer;if(!curRecognizer||(curRecognizer&&curRecognizer.state&STATE_RECOGNIZED)){
curRecognizer=session.curRecognizer=null;}var i=0;while(i<recognizers.length){recognizer=recognizers[i];if(session.stopped!==FORCED_STOP&&(!curRecognizer||recognizer==curRecognizer||recognizer.canRecognizeWith(curRecognizer))){
recognizer.recognize(inputData);}else{recognizer.reset();}if(!curRecognizer&&recognizer.state&(STATE_BEGAN|STATE_CHANGED|STATE_ENDED)){curRecognizer=session.curRecognizer=recognizer;}i++;}},get:function(recognizer){
if(recognizer instanceof Recognizer){return recognizer;}var recognizers=this.recognizers;for(var i=0;i<recognizers.length;i++){if(recognizers[i].options.event==recognizer){return recognizers[i];}}return null;
},add:function(recognizer){if(invokeArrayArg(recognizer,'add',this)){return this;}var existing=this.get(recognizer.options.event);if(existing){this.remove(existing);}this.recognizers.push(recognizer);
recognizer.manager=this;this.touchAction.update();return recognizer;},remove:function(recognizer){if(invokeArrayArg(recognizer,'remove',this)){return this;}var recognizers=this.recognizers;recognizer=this.get(recognizer);
recognizers.splice(inArray(recognizers,recognizer),1);this.touchAction.update();return this;},on:function(events,handler){var handlers=this.handlers;each(splitStr(events),function(event){handlers[event]=handlers[event]||[];
handlers[event].push(handler);});return this;},off:function(events,handler){var handlers=this.handlers;each(splitStr(events),function(event){if(!handler){delete handlers[event];}else{handlers[event].splice(inArray(handlers[event],handler),1);
}});return this;},emit:function(event,data){if(this.options.domEvents){triggerDomEvent(event,data);}var handlers=this.handlers[event]&&this.handlers[event].slice();if(!handlers|| !handlers.length){return;
}data.type=event;data.preventDefault=function(){data.srcEvent.preventDefault();};var i=0;while(i<handlers.length){handlers[i](data);i++;}},destroy:function(){this.element&&toggleCssProps(this,false);
this.handlers={};this.session={};this.input.destroy();this.element=null;}};function toggleCssProps(manager,add){var element=manager.element;each(manager.options.cssProps,function(value,name){element.style[prefixed(element.style,name)]=add?value:'';
});}function triggerDomEvent(event,data){var gestureEvent=document.createEvent('Event');gestureEvent.initEvent(event,true,true);gestureEvent.gesture=data;data.target.dispatchEvent(gestureEvent);}extend(Hammer,{
INPUT_START:INPUT_START,INPUT_MOVE:INPUT_MOVE,INPUT_END:INPUT_END,INPUT_CANCEL:INPUT_CANCEL,STATE_POSSIBLE:STATE_POSSIBLE,STATE_BEGAN:STATE_BEGAN,STATE_CHANGED:STATE_CHANGED,STATE_ENDED:STATE_ENDED,STATE_RECOGNIZED:STATE_RECOGNIZED,
STATE_CANCELLED:STATE_CANCELLED,STATE_FAILED:STATE_FAILED,DIRECTION_NONE:DIRECTION_NONE,DIRECTION_LEFT:DIRECTION_LEFT,DIRECTION_RIGHT:DIRECTION_RIGHT,DIRECTION_UP:DIRECTION_UP,DIRECTION_DOWN:DIRECTION_DOWN,
DIRECTION_HORIZONTAL:DIRECTION_HORIZONTAL,DIRECTION_VERTICAL:DIRECTION_VERTICAL,DIRECTION_ALL:DIRECTION_ALL,Manager:Manager,Input:Input,TouchAction:TouchAction,TouchInput:TouchInput,MouseInput:MouseInput,
PointerEventInput:PointerEventInput,TouchMouseInput:TouchMouseInput,SingleTouchInput:SingleTouchInput,Recognizer:Recognizer,AttrRecognizer:AttrRecognizer,Tap:TapRecognizer,Pan:PanRecognizer,Swipe:SwipeRecognizer,
Pinch:PinchRecognizer,Rotate:RotateRecognizer,Press:PressRecognizer,on:addEventListeners,off:removeEventListeners,each:each,merge:merge,extend:extend,inherit:inherit,bindFn:bindFn,prefixed:prefixed});
if(typeof define==TYPE_FUNCTION&&define.amd){define(function(){return Hammer;});}else if(typeof module!='undefined'&&module.exports){module.exports=Hammer;}else{window[exportName]=Hammer;}})(window,document,'Hammer');
}}});
Uize.module({name:'Zazzle.Widgets.Hammer',superclass:'Zazzle.Widget.V2',required:['Zazzle.Hammer'],builder:function(f_$){'use strict';var f__=Uize,f_a={doubletap:'Double Tap',panend:'Pan End',panmove:'Pan Move',
panstart:'Pan Start',pinchend:'Pinch End',pinchmove:'Pinch Move',pinchstart:'Pinch Start',swipe:'Swipe',tap:'Tap'};return f_$.subclass({stateProperties:{f_b:'element',f_c:{name:'instance',derived:{properties:'element',
derivation:function(f_b){this.f_c&&this.f_c.destroy();return new Hammer(f_b);}},onChange:function(){if(this.f_c)this.f_d();}}},instanceMethods:{enableRecognizer:function(f_e,f_f){if(f_f===undefined)f_f=true;
this.setRecognizerOptions(f_e,{enable:f_f});},getRecogznier:function(f_e){if(this.f_c)return this.f_c.get(f_e);},setRecognizerOptions:function(f_e,f_g){var f_h=this.getRecogznier(f_e);if(f_h)f_h.set(f_g);
},f_d:function(){var m=this;if(m.f_c)f__.forEach(f_a,function(f_i,f_j){m.f_c.on(f_j,function(e){m.fire({name:f_i,hammerEvent:e});});});}}});}});
Uize.module({name:'Zazzle.Widgets.Scrolly',superclass:'Zazzle.Widget.V2',required:['Zazzle.Widgets.Hammer'],builder:function(f_$){'use strict';var f__=Uize;return f_$.subclass({stateProperties:{f_a:{name:'activeListItemIndex',
onChange:function(){var m=this,f_b=m.f_c?m.f_d:m.f_d-1,f_e= !m.f_f||m.f_g===0?m.f_g:m.f_g-1,f_h=m.f_a;if(f_h>f_b&&m.f_d){m.paginate(1);}else if(f_h<=f_e&&m.f_g){m.paginate(-1);}}},f_i:'centerContentWhenSinglePage',
f_d:'endListItemIndex',f_j:{name:'isCentered',value:false},f_c:'isEndVisible',f_k:'isPrevDisabled',f_l:'isNextDisabled',f_f:'isStartVisible',f_m:'isTransitioning',f_n:'isVertical',f_o:'itemsSelector',
f_p:'listItems',f_q:'nextButton',f_r:{name:'panOffset',value:0},f_s:'prevButton',f_t:'startingPan',f_g:{name:'startListItemIndex',value:0},f_u:{name:'transformString',derived:{properties:'isVertical, panOffset',
derivation:function(f_n,f_r){if(f_n)return'translate3d(0, '+f_r+'px,0)';else return'translate3d('+f_r+'px,0,0)';}}},f_v:'transitionDuration'},omegastructor:function(){var m=this;m.whenever('wired',function(){
var f_w=m.children.hammer;if(m.getNode()!==null)f_w.set('element',m.getNode());});},children:{hammer:Zazzle.Widgets.Hammer},cssBindings:{isTransitioning:['','isTransitioning'],isPrevDisabled:['','isPrevDisabled'],
isNextDisabled:['','isNextDisabled'],isVertical:['isHorizontal','isVertical'],isCentered:['','isCentered']},htmlBindings:{transformString:['contents:style.transform','contents:style.webkitTransform']
},eventBindings:{'#up:click':function(){this.paginate(-1);},'#left:click':function(){this.paginate(-1);},'#down:click':function(){this.paginate(1);},'#right:click':function(){this.paginate(1);},'hammer':{
'Pan Start':function(e){var m=this;if(!m.f_k&& !m.f_l)m.set({f_t:m.f_r});},'Pan Move':function(e){var m=this,f_x=m.f_n?e.hammerEvent.deltaY:e.hammerEvent.deltaX;if(!m.f_k&& !m.f_l)m.set({f_r:m.f_t+f_x});
},'Pan End':function(e){var m=this,f_x=m.f_n?e.hammerEvent.deltaY:e.hammerEvent.deltaX,f_y=m.f_p;if(m.f_r>0&& !m.f_k&& !m.f_l)m.set({f_g:0});else if(!m.f_k&& !m.f_l){m.set({f_g:m.findBorderItem(0,f_y.length,Math.abs(m.f_r))
});}m.updateEndIndex();m.snapToItem(f_x* -1);},'Swipe':function(e){this.paginate(e.hammerEvent.deltaX* -1);}}},instanceMethods:{updateUi:function(){var m=this;if(m.getNode()!==null){m.set({f_p:m.getNode().querySelectorAll(m.f_o)});
m.updateAfterContentLoaded();}f_$.doMy(m,'updateUi');},updateAfterContentLoaded:function(){var m=this,f_z=0,f_A=m.getNode().querySelectorAll("img");if(f_A.length===0)m.updateContentDependentValues();
for(var f_B=0;f_B<f_A.length;f_B++){var f_C=f_A[f_B];f_C.ondragstart=function(){return false;};if(f_C.complete){f_z++;if(f_z>=f_A.length)m.updateContentDependentValues();}else{f_C.onload=function(){f_z++;
if(f_z>=f_A.length)m.updateContentDependentValues();};}}},updateContentDependentValues:function(){var m=this,f_D=m.web('view'),f_e=m.f_g,f_E;m.checkOrientation();if(m.f_a===m.f_d)m.snapToItem(1);else
 m.snapToItem(-1);if(m.f_p.length===0)f_E=0;else f_E=m.f_n?f_D.height()+Math.abs(m.f_r):f_D.width()+Math.abs(m.f_r);m.set({f_d:m.findBorderItem(f_e,m.f_p.length,f_E)});m.updateVisibilityValues();m.updateButtons();
if(m.f_i&&m.f_f&&m.f_c){m.set({f_j:m.f_p.length===0||(m.f_g===0&&m.f_d===m.f_p.length-1)});}else{m.set({f_j:false});}},checkOrientation:function(){var m=this,f_y=m.f_p,f_F=f_y.length===0,f_D=m.web('view'),
f_G=f_F?0:f_y[0].offsetLeft,f_H=f_F?0:f_y[0].offsetTop,f_I=f_F?0:f_y[f_y.length-1].offsetLeft,f_J=f_F?0:f_y[f_y.length-1].offsetTop,f_K=Math.abs(parseFloat(f_I-f_G)),f_L=Math.abs(parseFloat(f_J-f_H))
;if(f_L>f_K||f_D.width()<=0){m.met('isVertical');}else if(f_L<f_K||f_D.height()<=0){m.unmet('isVertical');}else if(f_L===f_K){m.unmet('isVertical');}},paginate:function(f_M){var m=this,f_D=m.web('view'),
f_F=m.f_p.length===0,f_y=m.f_p,f_e=m.f_g,f_b=m.f_d,f_N;if(f_M<0&& !f_F&&m.f_g!==0){f_N=m.f_n?m.f_r+f_D.height():m.f_r+f_D.width();if(m.f_n&&f_N>0){m.set({f_g:0});m.updateEndIndex();}else{m.set({f_d:m.f_f?f_e-1:f_e
});m.updateStartIndex();}}else if(f_M>0&& !f_F&&m.f_d!==f_y.length-1){var f_O=f_y[f_y.length-1].offsetTop+f_y[f_y.length-1].offsetHeight,f_P=f_y[f_y.length-1].offsetLeft+f_y[f_y.length-1].offsetWidth,
f_Q=f_y[m.f_g].offsetTop,f_R=f_y[m.f_g].offsetLeft;f_N=m.f_n?m.f_r-f_D.height():m.f_r-f_D.width();if((m.f_n&&(f_O-f_Q)<f_D.height())||(!m.f_n&&(f_P-f_R)<f_D.width())){m.set({f_d:f_y.length-1});m.updateStartIndex();
}else{m.set({f_g:m.f_c?f_b+1:f_b});m.updateEndIndex();}}m.met('isTransitioning');m.set({f_r:f_N!==undefined?f_N:m.f_r});m.snapToItem(f_M);},snapToItem:function(f_M){var m=this,f_D=m.web('view'),f_S=m.web('contents'),
f_y=m.f_p,f_F=f_y.length===0,f_T=m.f_r,f_N;if(f_M>0&& !f_F){m.updateStartIndex();var f_U=f_y[m.f_d].offsetLeft+f_y[m.f_d].offsetWidth,f_V=f_y[m.f_d].offsetTop+f_y[m.f_d].offsetHeight,f_W=parseInt(f_S.css('padding-bottom')),
f_X=parseInt(f_S.css('padding-right'));if(m.f_n)f_N=f_D.height()<f_V?(f_V-f_D.height()+f_W)* -1:0;else f_N=f_D.width()<f_U?(f_U-f_D.width()+f_X)* -1:0;}else if(f_M<0&& !f_F){m.updateEndIndex();var f_Y=parseInt(f_S.css('padding-top')),
f_Z=parseInt(f_S.css('padding-left'));if(m.f_n)f_N=(f_y[m.f_g].offsetTop-f_Y)* -1;else if(f_y.length>1)f_N=(f_y[m.f_g].offsetLeft-f_Z)* -1;}m.met('isTransitioning');m.set({f_r:f_N!==undefined?f_N:m.f_r
});setTimeout(function(){if(f_M>0)m.updateVisibilityValues(undefined,true);else if(f_M<0)m.updateVisibilityValues(true);m.updateButtons();m.unmet('isTransitioning');},m.f_v);},findBorderItem:function(f_0,f_1,f_E){
var m=this,f_y=m.f_p,f_e=f_0,f_b=f_1,f_2,f_3,f_4,f_5;while(f_e<f_b&&(f_b-f_e>1)){f_2=Math.floor((f_e+f_b)/2);f_3=f_y[f_2].offsetTop;f_4=f_y[f_2].offsetLeft;f_5=m.f_n?f_3:f_4;if(f_5<f_E)f_e=f_2;else if(f_5>f_E)
f_b=f_2;else{return f_2-1;}}return f_e;},updateStartIndex:function(){var m=this,f_D=m.web('view'),f_y=m.f_p,f_V=f_y[m.f_d].offsetTop+f_y[m.f_d].offsetHeight,f_U=f_y[m.f_d].offsetLeft+f_y[m.f_d].offsetWidth,
f_E=m.f_n?f_V-f_D.height():f_U-f_D.width();m.set({f_g:m.findBorderItem(0,m.f_d,f_E)});},updateEndIndex:function(){var m=this,f_D=m.web('view'),f_y=m.f_p,f_e=m.f_g,f_E=m.f_n?f_D.height()+m.f_p[f_e].offsetTop:f_D.width()+m.f_p[f_e].offsetLeft;
;m.set({f_d:m.findBorderItem(f_e,f_y.length,f_E)});},updateVisibilityValues:function(f_6,f_7){var m=this,f_D=m.web('view'),f_y=m.f_p,f_e=m.f_g,f_b=m.f_d,f_F=f_y.length===0,f_T=m.f_r,f_V,f_U;if(f_6)m.set({f_f:f_6});
else if(!f_F){m.set({f_f:m.f_n?f_y[f_e].offsetTop+f_T>=0:f_y[f_e].offsetLeft+f_T>=0});}else m.unmet('isStartVisible');if(f_7)m.set({f_c:f_7});else if(!f_F){f_V=f_y[f_b].offsetTop+f_y[f_b].offsetHeight;
f_U=f_y[f_b].offsetLeft+f_y[f_b].offsetWidth;m.set({f_c:m.f_n?f_V+f_T<=f_D.height():f_U+f_T<=f_D.width()});}},updateButtons:function(){var m=this,f_F=m.f_p.length===0;if(m.f_n){m.set({f_s:m.web('up'),
f_q:m.web('down')});}else{m.set({f_s:m.web('left'),f_q:m.web('right')});}if(m.f_g===0&&m.f_f)m.met('isPrevDisabled');else m.unmet('isPrevDisabled');if(f_F||(m.f_d===m.f_p.length-1&&m.f_c))m.met('isNextDisabled');
else m.unmet('isNextDisabled');}}});}});
Uize.module({name:'Uize.Json',builder:function(){'use strict';var b_$,b__='string',b_a=[],b_b={},b_c='       ',b_d=b_c.replace(/ /g,b_c).replace(/ /g,b_c),b_e={RegExp:1,Date:1,String:1,Number:1,Boolean:1},
b_f=Uize.lookup(['break','boolean','case','catch','continue','const','debugger','default','delete','do','else','export','false','finally','for','function','if','import','in','instanceof','new','null','return','switch','this','throw','true','try','typeof','var','void','while','with','implements','interface','let','package','private','protected','public','static','yield'
],b_b),b_g={indentChars:'\t',keyAlign:'left',keyDelimiter:':',linebreakChars:'\n',padKeys:false,quoteChar:'\'',sortKeys:false,whenToQuoteKeys:'auto'},b_h={whenToQuoteKeys:'always',quoteChar:'"'},b_i={
indentChars:'',linebreakChars:''},b_j={mini:Uize.copy(b_g,b_i),miniStrict:Uize.copy(b_g,b_i,b_h),nice:b_g,strict:Uize.copy(b_g,b_h)};return Uize.package({encodingOptionsPresets:b_j,from:function(b_k){
return b_k?Uize.eval('0,('+b_k+')'):null;},to:function(b_l,b_m){b_m=(typeof b_m=='string'?b_j[b_m]:b_m)||b_j.nice;function b_n(b_o,b_p){var b_q=b_m[b_o];return typeof b_q==b__?b_q:b_p;}var b_r=[],b_s=b_n('indentChars','\t'),
b_t=b_n('linebreakChars','\n'),b_u=b_n('quoteChar','\''),b_v=new RegExp(b_u,'g'),b_w='\\'+b_u,b_x=b_m.sortKeys===true,b_y=b_m.padKeys===true,b_z=b_m.keyDelimiter||':',b_A={left:0,center:0.5,right:1}[b_m.keyAlign||'left'],
b_B=b_m.whenToQuoteKeys||'auto';function b_C(b_D){return b_d.substr(0,b_D)}function b_E(b__){return(b_u+b__.replace(/\\/g,'\\\\').replace(/\n/g,'\\n').replace(/\r/g,'\\r').replace(b_v,b_w)+b_u);}function b_F(b_G,b_H,b_I,b_J){
var b_K=0,b_L=typeof b_G;function b_M(b_N,b_J){b_r.push(b_I+(b_K++ ?'':b_H)+b_N+(b_J?',':''));}if(b_G==b_$||b_L=='number'||b_L=='boolean'||b_L=='function'){b_M(b_G,b_J);}else if(b_L==b__){b_M(b_E(b_G),b_J);
}else if(b_L=='object'){var b_O=b_G.constructor,b_P=b_O==Object||b_O==Array,b_Q;if(!b_P)b_Q=(((b_O+'').match(typeof b_O=='object'?/\[object\s+([^\]]+)\]/:/^\s*function\s+([^\(]+)\s*\(/)||b_a)[1])||''
;if(b_P||b_Q=='Object'||b_Q=='Array'){var b_R=b_I+b_s;if(b_G instanceof Array||(b_G&&Uize.isFunction(b_G.splice))){var b_S=b_G.length;if(b_S){var b_T=b_S-1;b_M('[');for(var b_U= -1;++b_U<b_S;)b_F(b_G[b_U],'',b_R,b_U<b_T
);b_M(']',b_J);}else{b_M('[]',b_J);}}else{var b_V=Uize.keys(b_G),b_W=b_V.length;if(b_W){b_x&&b_V.sort();var b_X=function(b_Y){return(isNaN(+b_Y)?(/[^\w\$]|^\d/.test(b_Y)||b_f[b_Y]==b_b):b_Y!= +b_Y+''||b_Y<0
);};var b_Z=b_B=='always';if(!b_Z&&b_B=='auto all'){for(var b_0= -1;++b_0<b_W&& !b_Z;)b_Z=b_Z||b_X(b_V[b_0]);}var b_1=[];for(var b_0= -1;++b_0<b_W;){var b_Y=b_V[b_0];b_1[b_0]=(b_Z||b_X(b_Y))?b_E(b_Y)
:b_Y;}var b_2=0;if(b_y){for(var b_0= -1;++b_0<b_W;)b_2=Math.max(b_2,b_1[b_0].length);}var b_3=b_W-1;b_M('{');for(var b_0= -1;++b_0<b_W;){var b_4='',b_5=b_1[b_0];if(b_y){var b_6=b_2-b_5.length,b_7=Math.round(b_A*b_6)
;b_4=b_C(b_7);b_5+=b_C(b_6-b_7);}b_F(b_G[b_V[b_0]],b_5+b_z,b_R+b_4,b_0<b_3);}b_M('}',b_J);}else{b_M('{}',b_J);}}}else{if(b_e[b_Q]){b_M('new '+b_Q+' ('+(b_Q=='String'?b_E(b_G):b_G.valueOf())+')',b_J);
}else{b_M('{}',b_J);}}}}b_F(b_l,'','');return b_r.join(b_t);}});}});
Uize.module({name:'Zazzle.MediaGallery',superclass:'Zazzle.Widget.V2',required:['Uize.Dom.Event','Uize.Json','Zazzle.Widgets.Scrolly'],builder:function(f_$){'use strict';var f__=true;return f_$.subclass({
instanceMethods:{clickHandler:function(f_a,i,f_b){var m=this,f_c=Uize.Dom.Event.target(f_b),f_d=f_c&&m.web(f_c).attribute('data-play-icon')!==null;m.fire({name:'Track Event',bubble:f__,extra:{ax:'Media Gallery Clicked',
productType:m.f_e}});if(m.f_f)m.f_f(f_a,i);else if(m.f_g)m.callInherited('useMediaGallery')({componentParams:{mediaItems:Uize.Json.to(m.f_h),productTypeName:m.f_e,productOptions:m.f_i},widgetProperties:{
activeCarouselItemIndex:i,playSelectedItemOnShowIfVideo:f_d,preventPageScrollWhenShown:false}});},wireUi:function(){var m=this;if(!m.isWired){if(m.f_h&&m.f_h.length){Uize.forEach(m.f_h,function(f_a,i){
m.web('item'+i).click(function(e){m.clickHandler(f_a,i,e);});});}m.web(window).load(function(){m.children.mediaItemsScrolly.updateUi();});m.web(window).resize(function(){m.children.mediaItemsScrolly.updateUi();
});f_$.doMy(m,'wireUi');}}},stateProperties:{f_f:'clickHandler',f_g:{name:'clickLaunchesDialog',value:true},f_h:{name:'mediaItems',value:[]},f_j:'numItemsToShow',f_e:'productTypeName',f_i:'productOptions'
},cssBindings:{clickHandler:['','hasClickHandler']},children:{mediaItemsScrolly:Zazzle.Widgets.Scrolly}});}});
Uize.module({name:'Zazzle.OverallReviewRating',superclass:'Uize.Widget',required:'Zazzle.RatingContinuous',builder:function(d_$){'use strict';var d__=true,d_a=false,d_b=null,d_c=Uize;var d_d=d_$.subclass(
d_b,function(){this.addChild('rating',Zazzle.RatingContinuous);}),d_e=d_d.prototype;d_e.wireUi=function(){var m=this;if(!m.isWired){m.wireNode('','click',function(){if(m.d_f=='MoreReviewsDialog'){var
 d_g='OnProductType',d_h=m.d_i,d_j=d_a,d_k;if(m.d_l=='OnProduct'&&m.d_m>0){d_g='OnProduct';d_h=m.localize('moreReviewsTitle',{product:m.d_n});}d_k=d_g=='OnProductType'?'Good':'Low';m.callInherited('useDialog')({
component:{name:'Zazzle.Dialog.MoreReviews',params:{reviewsSet:d_g,pd:m.d_o,qualifiedType:m.d_p,unqualifiedType:m.d_q,productAttributes:m.d_r,isPublic:m.d_s,privateView:m.d_t,reviewQuality:d_k}},widgetProperties:{
parent:m,name:'moreReviews',title:d_h}});}else if(m.d_f=='ReviewHash'){Uize.require('Uize.Fx.Scroll',function(d_u){d_u.scrollToNode(m.d_v);m.fire({name:'Track Event',bubble:d__,extra:{ax:'scrollreviews',
pd:m.d_o}});});}else if(m.d_f=='ReviewForm'){m.callInherited('ensureLoggedIn')({callback:function(d_w){m.ajax({serviceUrl:'/svc/product/productreviews/canreview',mbr:m.getInherited('user').id,pt:m.d_q,
atts:m.d_r},function(d_x){var d_y=d_x.data;m.d_z=d_y.hasOthers;m.d_A=d_y.goToForm;m.d_B=d_y.reviewUrl;if(m.d_A){location.href=m.d_B;}else{var d_C=m.localize('message')+'<br /><br />';m.d_z&&(d_C+='<a href="'+m.get('urls').productsToReviewUrl+'">'+m.localize('linkMessage')+'</a>');
m.inform({title:m.localize('title'),message:d_C,state:'info'});}});}});}});d_$.doMy(m,'wireUi');}};d_e.reset=function(){var m=this;if(m.isWired){m.d_k='Low';m.ajax({serviceUrl:'/svc/product/productreviews/readptpdreviews',
pg:1,ps:5,callerId:m.getInherited('user').id,pd:m.d_o,pt:m.d_p,atts:m.d_r,isPublic:m.d_s,privateView:m.d_t,minRating:0},{cache:'memory',callbackSuccess:function(d_y){if(d_y.success){var d_x=d_y.data,
d_D=d_x.pdResults,d_E=d_x.ptResults;m.d_m=d_D.numResults;m.d_F=d_E.numResults;m.d_G=d_D.avgRating;m.d_H=d_E.avgRating;m.d_I=d_D.avgRatingDisplay;m.d_J=d_E.avgRatingDisplay;m.d_i=d_E.similarReviewsTitle;
m.d_K();}}});}};d_e.d_K=function(){var m=this;if(m.isWired){m.d_L=0;if(m.d_l=='OnProduct'){m.d_L=m.d_m;}else if(m.d_l=='OnProductType'){m.d_L=m.d_F;}m.d_M=0;m.d_N='0';if(m.d_l=='OnProduct'){m.d_M=m.d_G;
m.d_N=m.d_I;if(!(m.d_m>0)&&m.d_O=='ShowFilledPtStars'){m.d_M=m.d_H;m.d_N=m.d_J;}}else if(m.d_l=='OnProductType'){m.d_M=m.d_H;m.d_N=m.d_J;}var d_P=m.d_M>0?m.localize('xStarsTooltip',{num:m.d_N}):m.localize('noReviewsTooltip')
;m.children.rating.set({tooltip:d_P,value:m.d_M});if(m.d_l=='OnProduct'){if(m.d_F==0&&m.d_m==0){m.d_f='ReviewForm';}else{m.d_f=m.d_Q=='MoreReviewsDialog'?'MoreReviewsDialog':'ReviewHash';}}else if(m.d_l=='OnProductType'){
if(m.d_F>0){m.d_f=m.d_Q=='MoreReviewsDialog'?'MoreReviewsDialog':'ReviewHash';}else{m.d_f='ReviewForm';}}var d_R='';d_R+=(m.d_S&&m.d_f!='ReviewForm'&&m.d_M>0)?m.d_N+'  ':'';d_R+='<a id="'+m.get('idPrefix')+'-reviewLabel" href="javascript://">';
if(m.d_f=='ReviewForm')d_R+=m.localize('writeAReview');else if((m.d_f=='ReviewHash'||m.d_f=='MoreReviewsDialog')&&m.d_m==0&&m.d_l=='OnProduct'&&m.d_O=='ShowFilledPtStars'){d_R+=m.localize(m.d_T?'xReviewsForStyle':'xReviews',{num:m.d_F});
m.d_k='Good';}else if((m.d_f=='ReviewHash'||m.d_f=='MoreReviewsDialog')&&m.d_l=='OnProductType'){d_R+=m.localize(m.d_T?'xReviewsForStyle':'xReviews',{num:m.d_F});m.d_k='Good';}else if((m.d_f=='ReviewHash'||m.d_f=='MoreReviewsDialog')&&m.d_m==0){
d_R+=m.localize(m.d_T?'xReviewsForStyle':'readOtherReviews',{num:m.d_F});m.d_k='Good';}else if((m.d_f=='ReviewHash'||m.d_f=='MoreReviewsDialog')&&m.d_l=='OnProduct')d_R+=m.localize('xReviews',{num:m.d_L});
else if((m.d_f=='ReviewHash'||m.d_f=='MoreReviewsDialog')&&m.d_l=='OnProductType')d_R+=m.localize(m.d_T?'xReviewsForStyle':'xReviews',{num:m.d_L});d_R+='</a>';m.setNodeInnerHtml('detailLabel',d_R);if(m.d_O=='DisplayNone'&&m.d_l=='OnProduct'&&m.d_m==0)
m.displayNode('',d_a);else if(m.d_O=='DisplayNone'&&m.d_l=='OnProduct'&&m.d_m>0)m.displayNode('',d__);if(m.d_U=='DisplayNone'&&m.d_l=='OnProductType'&&m.d_F==0)m.displayNode('',d_a);else if(m.d_U=='DisplayNone'&&m.d_l=='OnProductType'&&m.d_F>0)
m.displayNode('',d__);}};d_d.stateProperties({d_r:{name:'attributes',onChange:d_e.reset},d_z:'canReviewItems',d_A:'canReviewThis',d_f:'detailAction',d_V:'displayName',d_s:'isPublic',d_O:'noPdReviewsFallbackAction',
d_U:'noReviewsFallbackAction',d_Q:'hasReviewsDetailAction',d_F:'numPtReviews',d_m:'numPdReviews',d_L:'numReviews',d_W:'outOf',d_t:'privateView',d_X:{name:'productTypeDisplayName',value:''},d_B:'reviewFormUrl',
d_k:'reviewQuality',d_l:'reviewsSet',d_o:'rootId',d_p:'qualifiedType',d_v:'scrollToNodeId',d_S:'showValue',d_i:'similarReviewsTitle',d_n:'productTitle',d_q:'unqualifiedType',d_T:'useStyleText',d_G:'valuePdReviews',
d_H:'valuePtReviews',d_I:'valueDisplayPdReviews',d_J:'valueDisplayPtReviews',d_M:'value',d_N:'valueDisplay'});return d_d;}});
Uize.module({name:'Zazzle.DepartmentBreadcrumb',superclass:'Zazzle.Widget.V2',builder:function(f_$){'use strict';var f__=Uize;return f_$.subclass({stateProperties:{f_a:{name:'numLinks',value:0},f_b:{name:'trackClicks',
value:false}},omegastructor:function(){var m=this;if(m.get('trackClicks')){m.whenever('wired',function(){for(var i=0;i<m.get('numLinks');i++){m.wireNode("link"+i,"click",function(){m.fire({name:'Track Event',
bubble:true,extra:{ax:'departmentBreadcrumbClicked'}});});}});}}});}});
Uize.module({name:'ZazzleWww.Widgets.ShareButton',superclass:'Zazzle.Widget.V2',required:['Uize.Url','Uize.Widget.Button','Uize.Widget.mModels'],builder:function(f_$){'use strict';var f__=Uize;return f_$.subclass({
mixins:f__.Widget.mModels,stateProperties:{f_a:'description',f_b:'hasImageIcon',f_c:'includeSocialParam',f_d:'mediaUrl',f_e:{name:'popupIndex',value:0},f_f:'sendProfileCompletionEvent',f_g:'serviceName',
f_h:'sharedItemId',f_i:'sharedItemType',f_j:'url'},children:{link:f__.Widget.Button},cssBindings:{hasImageIcon:['','hasImageIcon']},eventBindings:{'link:Click':function(f_k){var m=this;m.trackClick();
m.share();m.f_l();f_k.domEvent.cancelBubble=false;}},instanceMethods:{getNewPopupName:function(){return this.f_g+this.f_e++;},getUrlToShare:function(){var m=this,f_m=m.getInherited('env').lang.substr(0,2),
f_n=m.getInherited('user');return f__.Url.resolve(m.f_j||m.callInherited('getUrl')(),[m.models.product&&m.models.product.getQueryParams(),{CMPN:'shareicon',lang:f_m,social:m.f_c?true:undefined},f_n.isAssociate
?{rf:f_n.id}:undefined]);},share:function(){},trackClick:function(){var m=this,f_o=m.getInherited('deviceType');m.fire({name:'Track Event',bubble:true,extra:f__.copyInto({ax:'shareButton',service:m.f_g
},f_o&&{device:f_o})});},f_l:function(){var m=this;if(m.f_f){m.ajax({service:'profile/profilecompletionitemshared',sharedItemId:m.f_h>0?m.f_h:m.models.product.get('productId'),sharedItemType:m.f_i});
}}}});}});
Uize.module({name:'ZazzleWww.Widgets.ShareButton.Email',superclass:'ZazzleWww.Widgets.ShareButton',required:['Uize.Url'],builder:function(g_$){'use strict';var g__=Uize;return g_$.subclass({instanceMethods:{
share:function(){var m=this,g_a=m.models.product,g_b=zPage.children.product.children.views,g_c=g_b.children.view?g_b.children.view:g_b.get('activeView'),g_d=g_c.children.mainView.get('value');m.callInherited('useDialog')({
component:{name:'ZazzleWww.Widgets.Dialog.EmailShare.Product',params:{imageId:g_a.get('preferredView').get('value'),imageUrl:g_d,product:g__.Url.toParams(g_a.serialize()),anticache:Math.random()}},widgetProperties:{
name:'emailShareDialog'}});}}});}});
Uize.module({name:'ZazzleWww.Widgets.ShareButton.Pinterest',superclass:'ZazzleWww.Widgets.ShareButton',required:['Uize.Url'],builder:function(g_$){'use strict';var g__=Uize;return g_$.subclass({instanceMethods:{
share:function(){var m=this,g_a=m.getNewPopupName(),g_b=m.get('sharedItemType'),g_c=function(g_d,g_e){var g_f=g__.Url.resolve('https://www.pinterest.com/pin/create/button',{url:m.getUrlToShare(),media:g_d,
description:g_e});m.callInherited('launchPopup')({name:g_a,url:g_f});};m.callInherited('launchPopup')({name:g_a});if(g_b==='Product'){var g_g=m.models.product,g_h= !g__.isNully(g_g)?g_g.getQueryParams():null,
g_e=m.get('description')||(!g__.isNully(g_g)?g_g.get('title'):'');if(!g__.isEmpty(g_h))g_g.getProductInfo(function(g_i){g_c(g_i.data.imageUrl,g_e);},{po:g__.Url.toParams(g_h),view:g_h.view});else g_c(m.get('mediaUrl')||(!g__.isNully(g_g)?g_g.get('imageUrl'):''),g_e);
}else if(g_b==='IdeaBoard'){m.models.ideaboardsModel.getIdeaBoardSocialMediaInfo(m.get('sharedItemId'),function(g_j){g_c(g_j.pinterestImageUrl,g_j.basicDescription);});}else if(g_b==='Profile'){m.ajax(
{service:'profile/getsocialmediainfo',profileOwnerId:m.get('sharedItemId')},{callback:function(g_i){if(g_i.success){g_c(g_i.data.pinterestImageUrl,g_i.data.basicDescription);}}});}}}});}});
Uize.module({name:'ZazzleWww.Widgets.ShareButton.Facebook',superclass:'ZazzleWww.Widgets.ShareButton',builder:function(g_$){'use strict';var g__=Uize;return g_$.subclass({stateProperties:{g_a:'canonicalUrl',
g_b:'forceScrape'},instanceMethods:{share:function(){var m=this,g_c=m.getUrlToShare(),g_d=m.getInherited('commObject'),g_e=m.getNewPopupName(),g_f=g__.Url.resolve('https://www.facebook.com/sharer/sharer.php',
{u:g_c}),g_g=function(){m.callInherited('launchPopup')({name:g_e,url:g_f});};if(m.g_b){m.callInherited('launchPopup')({name:g_e});if(g_d){g_d.request({url:Uize.Url.resolve("http://graph.facebook.com",
{id:m.g_a||g_c,scrape:true}),returnType:'json',requestMethod:'POST',callback:function(g_h){g_g();}});}}else{g_g();}}}});}});
Uize.module({name:'ZazzleWww.Widgets.ShareButton.Twitter',superclass:'ZazzleWww.Widgets.ShareButton',required:['Uize.Url'],builder:function(g_$){'use strict';var g__=Uize;return g_$.subclass({instanceMethods:{
share:function(){var m=this,g_a=m.getNewPopupName(),g_b=m.models.product,g_c=m.models.ideaboardsModel,g_d=m.get('sharedItemType'),g_e=function(g_f){var g_g=g__.Url.resolve('https://twitter.com/intent/tweet',
{text:g_f,url:m.getUrlToShare()});m.callInherited('launchPopup')({name:g_a,url:g_g});};m.callInherited('launchPopup')({name:g_a});if(g_d==='Product'&& !g__.isNully(g_b)){g_e(m.models.product.get('title'));
}else if(g_d=='IdeaBoard'&& !g__.isNully(g_c)){g_c.getIdeaBoardSocialMediaInfo(m.get('sharedItemId'),function(g_h){g_e(g_h.tweet);});}else if(g_d==='Profile'){m.ajax({service:'profile/getsocialmediainfo',
profileOwnerId:m.get('sharedItemId')},{callback:function(g_i){if(g_i.success){g_e(g_i.data.tweet);}}});}else{g_e(m.get('description'));}}}});}});
Uize.module({name:'ZazzleWww.Widgets.ShareButton.Link',superclass:'ZazzleWww.Widgets.ShareButton',builder:function(g_$){'use strict';var g__=Uize;return g_$.subclass({stateProperties:{g_a:'productId',g_b:'productAttributes'
},instanceMethods:{share:function(){var m=this,g_c=m.models.product,g_d={anticache:Math.random()};if(!g__.isNully(g_c)){g_d['product']=g__.Url.toParams(m.models.product.serialize());}else if(!g__.isNully(m.g_a)){
g_d['pd']=m.g_a;g_d['att']=m.g_b;}g_d['sharedItemId']=m.get('sharedItemId');g_d['sharedItemType']=m.get('sharedItemType');m.callInherited('useDialog')({component:{name:'ZazzleWww.Widgets.Dialog.LinkToThis',
params:g_d},widgetProperties:{name:'linkToThisDialog'}});m.trackClick();}}});}});
Uize.module({name:'ZazzleWww.Widgets.ShareButton.Wanelo',superclass:'ZazzleWww.Widgets.ShareButton',builder:function(g_$){'use strict';var g__=Uize;return g_$.subclass({instanceMethods:{share:function(){
var m=this,g_a=g__.Url.resolve('http://wanelo.com/p/save',{url:m.getUrlToShare(),title:m.get('description')||(m.models.product!=null?m.models.product.get('title'):'')});m.callInherited('launchPopup')({
name:m.getNewPopupName(),url:g_a});}}});}});
Uize.module({name:'ZazzleWww.Widgets.ShareButton.Tumblr',superclass:'ZazzleWww.Widgets.ShareButton',required:['Uize.Url'],builder:function(g_$){'use strict';var g__=Uize;return g_$.subclass({instanceMethods:{
share:function(){var m=this,g_a=m.models.product,g_b=m.models.ideaboardsModel,g_c=m.getNewPopupName(),g_d=m.get('sharedItemType'),g_e=function(g_f,g_g,g_h){m.callInherited('launchPopup')({name:g_c,url:g__.Url.resolve(
'https://www.tumblr.com/share/'+g_h,{source:g_f,caption:g_g})});};m.callInherited('launchPopup')({name:g_c});if(g_d==='Product'&& !g__.isNully(g_a)){var g_i=g_a.getQueryParams();g_a.getProductInfo(function(g_j){
var g_k=g_j.data,g_l=[g_a.get('title')+' - '+g_k.displayPrice,'Made by '+g_k.makerName,g_k.description,m.getUrlToShare()];if(!g_k.makerName)g_l.splice(1,1);g_e(g_k.imageUrl,g_l.join('\n'),'photo');},
{po:g__.Url.toParams(g_i),view:g_i.view});}else if(g_d==='IdeaBoard'&& !g__.isNully(g_b)){g_b.getIdeaBoardSocialMediaInfo(m.get('sharedItemId'),function(g_m){g_e(g_m.tumblrImageUrl,g_m.longerDescription,'photo');
});}else if(g_d==='Profile'){m.ajax({service:'profile/getsocialmediainfo',profileOwnerId:m.get('sharedItemId')},{callback:function(g_j){if(g_j.success){var g_l=[g_j.data.basicDescription,g_j.data.longerDescription,
m.getUrlToShare()];g_e(g_j.data.tumblrImageUrl,g_l.join("\n"),'link');}}});}else{g_e(m.get('mediaUrl'),m.get('description'),'photo');}}}});}});
Uize.module({name:'ZazzleWww.Widgets.ShareButton.GooglePlus',superclass:'ZazzleWww.Widgets.ShareButton',builder:function(g_$){'use strict';var g__=Uize;return g_$.subclass({instanceMethods:{share:function(){
var m=this,g_a=g__.Url.resolve('https://plus.google.com/share',{url:m.getUrlToShare()});m.callInherited('launchPopup')({name:m.getNewPopupName(),url:g_a});}}});}});
Uize.module({name:'ZazzleWww.Widgets.DesktopShareTray',superclass:'Zazzle.Widget.V2',requred:['Uize.Widget.mModels'],builder:function(f_$){'use strict';var f__=Uize;return f_$.subclass({mixins:Uize.Widget.mModels,
stateProperties:{f_a:{},f_b:{value:function(e){var m=this,f_c=m.getNode('secondaryButtons'),f_d=(e.target==f_c)||f_c.contains(e.target),f_e=m.getNode('seeMore'),f_f=(e.target==f_e)||f_e.contains(e.target)
;if(!f_d&& !f_f)m.unmet('toggledOpen');}},f_g:{name:'deviceType',value:'desktop'},f_h:{name:'expanded',derived:'hovered,toggledOpen: hovered || toggledOpen',onChange:function(){var m=this;if(m.f_h)setTimeout(function(){
document.body.addEventListener('click',m.f_a,true);},0);else setTimeout(function(){document.body.removeEventListener('click',m.f_a,true);},0)}},f_i:'hovered',f_j:'orientation',f_k:'toggledOpen'},omegastructor:function(){
var m=this;m.f_a=function(e){m.f_b.call(m,e);};},children:{},childBindings:{},cssBindings:{expanded:['','expanded'],orientation:'value',toggledOpen:['','toggledOpen']},htmlBindings:{},eventBindings:{
'#:mouseleave':function(){this.unmet('hovered');},'#seeMore':{click:function(){this.toggle('toggledOpen');},mouseenter:function(){this.met('hovered');}}}});}});
Uize.module('Zazzle.DebugHelpers');
Uize.module({name:'Zazzle.DebugHelpers.getCaller',builder:function(){return function getCaller(nth){nth=nth||0;nth+=2;var stack;try{var err=new Error();if(err.stack){stack=err.stack;}else{throw err;}}catch(err){
stack=err.stack;}var stackParts=stack.split(new RegExp("\n +at ")).splice(1);return stackParts[nth];};}});
Uize.module({name:'Zazzle.DebugHelpers.getCallerFiltered',required:['Zazzle.DebugHelpers.getCaller'],builder:function(){return function getCallerFiltered(){var getCaller=Zazzle.DebugHelpers.getCaller;var localStorage=Uize.global().localStorage;
if(!localStorage){return getCaller(1);}var ignoredFiles=[];try{if(localStorage.getCallerFiltered_text){ignoredFiles=JSON.parse(localStorage.getCallerFiltered_text);}}catch(err){console.error("Could not load ignored file list because",err);
}function shouldIgnore(callEntry){return ignoredFiles.some(function(file){return callEntry.indexOf(file)>=0});}var n=0;var caller;do{n++;caller=getCaller(n);}while(caller&&shouldIgnore(caller));if(!caller){
caller=getCaller();}return caller;};}});
Uize.module({name:'Zazzle.DesignModel',required:['Zazzle.DebugHelpers.getCallerFiltered'],builder:function(b_$){Uize.global().zazzle=(function(){var b__={rlv:{DesignState:{SYNCHRONIZED:1,DIRTY:2,NEEDSYNCH:3,
WAITINGFORSERVER:4,ERROR:5},DesignObjectSpace:{OBJECT:1,DESIGN:2,SCREEN:3},DesignTextAlign:{CENTER:1,LEADING:2,TRAILING:3},DesignTextParagraphAlign:{CENTER:1,NEAR:2,FAR:3},DesignTextScaleMode:{FIT:1,
NONE:2,USER:3},DesignTextPath:{HORZ:1,VERT:2,ARC:3,RARC:4},DesignImageType:{JPG:1,PNG:2,ZTR:3,OFM:4}},ajax:{},util:{}};return b__;}());(function(){var i;var xhr;var options=[function(){return new XMLHttpRequest();
},function(){return new ActiveXObject('Microsoft.XMLHTTP');}];for(i=0;i<options.length;i++){try{xhr=options[i]();zazzle.ajax.create=options[i];}catch(e){}}}());(function(){if(!zazzle.ajax.create){return;
}function isSuccess(transport){var status=transport.status;return(status>=200&&status<300)||status===304;}function getResponse(transport){var result;var index;var contentType=transport.getResponseHeader('Content-Type');
index=contentType.indexOf(';');if(index>0){contentType=contentType.substring(0,index);}switch(contentType){case'text/html':result=transport.responseXML;break;case'text/javascript':case'text/json':case'application/json':
result=(new Function('var a=['+transport.responseText+'];return a.pop()'))();break;default:result=transport.responseText;}return result;}function buildQueryString(data){var name;var value;var pair;var pairs=[];
for(name in data){if(data.hasOwnProperty(name)){value=data[name].toString();pair=encodeURIComponent(name)+'='+encodeURIComponent(value);pairs.push(pair);}}return pairs.join('&');}zazzle.ajax.buildQueryString=buildQueryString;
function encodeFormData(data){var name;var value;var pair;var regexp=/%20/g;var pairs=[];for(name in data){if(data.hasOwnProperty(name)){value=data[name].toString();pair=encodeURIComponent(name).replace(regexp,'+')+'='+encodeURIComponent(value).replace(regexp,'+');
pairs.push(pair);}}return pairs.join('&');}zazzle.ajax.encodeFormData=encodeFormData;function post(url,data,callback,errorHandler,token,additionalCallback){var contentType;var sendData=data;var transport=zazzle.ajax.create();
transport.onreadystatechange=function(){if(transport.readyState===4){if(isSuccess(transport)){callback(getResponse(transport),token,additionalCallback);}else{if(errorHandler){errorHandler(transport.status,transport.statusText,token,additionalCallback);
}else{callback(null,token,additionalCallback);}}}};transport.open('POST',url);if(typeof data==='string'){contentType='text/xml';sendData=data;}else{contentType='application/x-www-form-urlencoded';sendData=zazzle.ajax.encodeFormData(data);
}transport.setRequestHeader('Content-Type',contentType);transport.send(sendData);}zazzle.ajax.post=post;}());(function(){var nextSequenceId=1;var defeatStrCount=1;var entitiesToEncodeMap={'&':'&amp;',
'"':'&quot;','\'':'&apos;','<':'&lt;','>':'&gt;','\n':'&#10;','\r':'&#13;'};function getEncodedCharacter(val){return entitiesToEncodeMap[val];}function xmlSafe(str,inAttribute){var result=str;if(str&&typeof str==='string'){
if(inAttribute){result=str.replace(/[&\n\r"'<>]/g,getEncodedCharacter);}else{result=str.replace(/[&<>]/g,getEncodedCharacter);}}return result;}zazzle.util.xmlSafe=xmlSafe;function xmlStartElement(name,attribs,selfClose){
var aName;var aValue;var segment='<'+name;if(attribs&&(typeof attribs==='object')){for(aName in attribs){if(attribs.hasOwnProperty(aName)){aValue=attribs[aName];segment=segment+' '+aName+'="'+zazzle.util.xmlSafe(aValue,true)+'"';
}}}if(selfClose){segment=segment+'/>';}else{segment=segment+'>';}return segment;}zazzle.util.xmlStartElement=xmlStartElement;function xmlEndElement(name){var result='</'+name+'>';return result;}zazzle.util.xmlEndElement=xmlEndElement;
function getNextSequenceId(){var result=nextSequenceId;nextSequenceId=nextSequenceId+1;return result;}zazzle.util.getNextSequenceId=getNextSequenceId;function isArray(val){return val&&typeof val==='object'&&val.constructor===Array;
}zazzle.util.isArray=isArray;function defeatCacheStr(){var now=new Date();var result=String(now.valueOf())+String(Math.round(Math.random()*1000))+String(defeatStrCount++);return result;}zazzle.util.defeatCacheStr=defeatCacheStr;
function matrixDeterminant(matrixA){var det=0.0;if(isArray(matrixA)&&(matrixA.length===6)){det=matrixA[0]*matrixA[3];det-=matrixA[1]*matrixA[2];}return det;}zazzle.util.matrixDeterminant=matrixDeterminant;
function matrixInverse(matrixA){var resultMatrix=[1.0,0.0,0.0,1.0,0.0,0.0];var temp;var det;var a;var b;var c;var d;var e;var f;if(isArray(matrixA)&&(matrixA.length===6)){det=matrixDeterminant(matrixA);
temp=det;if(det<0.0){temp= -det;}if(temp>0.0001){a=matrixA[3];b= -matrixA[2];c=(matrixA[2]*matrixA[5])-(matrixA[3]*matrixA[4]);d= -matrixA[1];e=matrixA[0];f=(matrixA[4]*matrixA[1])-(matrixA[0]*matrixA[5]);
resultMatrix[0]=a/det;resultMatrix[1]=d/det;resultMatrix[2]=b/det;resultMatrix[3]=e/det;resultMatrix[4]=c/det;resultMatrix[5]=f/det;}}return resultMatrix;}zazzle.util.matrixInverse=matrixInverse;}());
zazzle.rlv.DesignOptions=function DesignOptions(opts){if(!(this instanceof zazzle.rlv.DesignOptions)){return new zazzle.rlv.DesignOptions(opts);}var aName;var aValue;if(opts&&typeof opts==='object'){
for(aName in opts){if(opts.hasOwnProperty(aName)){aValue=opts[aName];this[aName]=aValue;}}}};zazzle.rlv.DesignViewOptions=function DesignViewOptions(opts){if(!(this instanceof zazzle.rlv.DesignViewOptions)){
return new zazzle.rlv.DesignViewOptions(opts);}if(opts&&typeof opts==='object'){if(opts.max_dim){this.max_dim=opts.max_dim;}if(opts.rvtype){this.rvtype=opts.rvtype;}if(opts.view){this.view=opts.view;
}if(opts.context){this.context=opts.context;}}this.mergeOpts=function(opts){if(opts.max_dim&& !(this.max_dim)){this.max_dim=opts.max_dim;}if(opts.rvtype&& !(this.rvtype)){this.rvtype=opts.rvtype;}if(opts.context&& !(this.context)){
this.context=opts.context;}};};zazzle.rlv.ZDesign=function ZDesign(opts){if(!(this instanceof zazzle.rlv.ZDesign)){return new zazzle.rlv.ZDesign(opts);}var self=this;this.opts=new zazzle.rlv.DesignOptions(opts);
this.serverRequest='';this.serverResult={};this.emptyAreaGroups=[];this.missingAreaGroups=[];var editUrl='/rlv/svc/edit';var state=zazzle.rlv.DesignState.DIRTY;var areas=[];var views=[];var activeView;
var errorCode=0;var errorMessage='';var errorCategory='';var type;var designId;var attributes={};var constraints=[];var templates=[];var undoable=false;var redoable=false;var canpaste=false;var canpublish=false;
var usedesignspace=true;var registeredListeners=[];var pendingActions=[];var properties=[];if(this.opts.id){designId=this.opts.id;}this.getOpts=function(){return this.opts;};this.useDesignSpace=function(val){
if(typeof val==='boolean'){usedesignspace=val;}};this.getView=function(options){var result;var k;for(k=0;k<views.length;k++){if(views[k].matches(options)){result=views[k];break;}}if(result){result.mergeOptions(options);
}else{if((!options.max_dim)&&this.opts.max_dim&&(typeof this.opts.max_dim==='number')){options.max_dim=this.opts.max_dim;}result=new zazzle.rlv.DesignView(this,options);views.push(result);this.setDirty();
}return result;};this.hasDefaultAreaForView=function(view){var result=false;var viewname;var areaName;var anArea;var k;if(view instanceof zazzle.rlv.DesignView){viewname=view.getOpts().view;for(k=0;k<areas.length;k++){
anArea=areas[k];areaName=anArea.getName();}for(k=0;k<areas.length;k++){if(areas[k].isDefaultForView(viewname)){result=true;break;}}}return result;};this.getDefaultAreaForView=function(view){var result;
var viewname;var k;if(view instanceof zazzle.rlv.DesignView){viewname=view.getOpts().view;for(k=0;k<areas.length;k++){if(areas[k].isDefaultForView(viewname)){result=areas[k];break;}}}return result;};
this.setActiveView=function(view){if(view instanceof zazzle.rlv.DesignView){if(view!==activeView){view.setNeedsAreaRefresh(true);this.setDirty();}activeView=view;}};this.forceReturnAllAreas=function(){
if(activeView){activeView.setNeedsAreaRefresh(true);activeView.setNeedsGridRefresh(true);}};this.getArea=function(name){var result;var k;for(k=0;k<areas.length;k++){if(areas[k].getName()===name){result=areas[k];
break;}}if(!result){if(name){result=new zazzle.rlv.DesignArea(this,name,'','');areas.push(result);}}return result;};this.removeArea=function(name){var area;var k;if(name){for(k=0;k<areas.length;k++){
area=areas[k];if(area.getName()===name){area.markDeleted();}}}};this.addDesignListener=function(handler){var result;var register;if(handler&&typeof handler==='function'){register={};register.seq=zazzle.util.getNextSequenceId();
register.callback=handler;registeredListeners.push(register);result=new zazzle.rlv.DesignListener(register.seq);}return result;};this.removeDesignListener=function(listener){var seq;var k;var index;var arr;
if(listener&&(listener instanceof zazzle.rlv.DesignListener)){seq=listener.getSequenceId();index= -1;for(k=0;k<registeredListeners.length;k++){if(registeredListeners[k].seq===seq){index=k;break;}}if(index>=0){
arr=[];for(k=0;k<registeredListeners.length;k++){if(k!==index){arr.push(registeredListeners[k]);}}registeredListeners=arr;}}};this.getState=function(){return state;};this.getErrorCode=function(){return errorCode;
};this.getErrorMessage=function(){return errorMessage;};this.getErrorCategory=function(){return errorCategory;};this.getType=function(){return type;};this.getId=function(){return designId;};this.getAreas=function(){
return areas;};this.getAttributes=function(){return attributes;};this.getConstraints=function(){return constraints;};this.getTemplates=function(){return templates;};this.isUndoable=function(){return undoable;
};this.isRedoable=function(){return redoable;};this.canPaste=function(){return canpaste;};this.canPublish=function(){return canpublish;};this.setProperty=function(name,value){var k;var prop;var found=false;
for(k=0;k<properties.length;k++){prop=properties[k];if(prop&&(prop instanceof zazzle.rlv.DesignProperty)){if(prop.name===name){found=true;break;}}}if(found){prop.value=value;prop.changed=true;}else{prop=new zazzle.rlv.DesignProperty(name,value);
prop.changed=true;properties.push(prop);}};function notifyListeners(type,success,design,view,additionalCallback){var k;var listener;var event=new zazzle.rlv.DesignEvent(type,success,design,view);for(k=0;k<registeredListeners.length;k++){
listener=registeredListeners[k];listener.callback(event);}additionalCallback&&additionalCallback(event)}function parseAttributeString(attr){var result={};var pieces;var keyval;var k;var key;var val;if(typeof attr==='string'){
pieces=attr.split('&');for(k=0;k<pieces.length;k++){keyval=pieces[k].split('=');if(keyval&&keyval.length>1){key=keyval[0];val=keyval[1];result[key]=val;}}}return result;}function ajaxCallback(response,design,additionalCallback){
var k;var rsparea;var area;var view;var viewname;var areaNames=[];var rspConstraint;var constraint;var rspTemplate;var template;if(Uize.global().localStorage&&localStorage.debug){console.log("DesignModel is loading data",response);
}if(response&&typeof response==='object'&&design&&(design instanceof zazzle.rlv.ZDesign)){design.serverResult=response;if('undo'in response){undoable=response.undo;}if('paste'in response){canpaste=response.paste;
}if('redo'in response){redoable=response.redo;}if('canpublish'in response){canpublish=response.canpublish;}if(response.design){if(response.design.type){type=response.design.type;}if(response.design.id){
designId=response.design.id;}if(response.design.attributes){attributes=parseAttributeString(response.design.attributes);}constraints=[];if(zazzle.util.isArray(response.design.constraints)){for(k=0;k<response.design.constraints.length;k++){
rspConstraint=response.design.constraints[k];if(rspConstraint&&typeof rspConstraint==='object'){constraint=new zazzle.rlv.DesignConstraint(rspConstraint.area,rspConstraint.level,rspConstraint.objects,rspConstraint.type);
constraints.push(constraint);}}}templates=[];if(zazzle.util.isArray(response.design.templates)){for(k=0;k<response.design.templates.length;k++){rspTemplate=response.design.templates[k];if(rspTemplate&&typeof rspTemplate==='object'){
template=new zazzle.rlv.DesignTemplate(rspTemplate);templates.push(template);}}}if(attributes.view){view=design.getView({view:attributes.view});if(view){view.setNeedsAreaRefresh(false);if(zazzle.util.isArray(response.design.wireframes)){
view.handleResponseWireframes(response.design.wireframes);}}}for(k=0;k<areas.length;k++){areas[k].setMarked(true);}if(response.design.areas){for(k=0;k<response.design.areas.length;k++){areaNames.push(response.design.areas[k].name);
}for(k=0;k<response.design.areas.length;k++){rsparea=response.design.areas[k];area=null;if(rsparea&&rsparea.name){area=design.getArea(rsparea.name);}if(area&&area.handleServerResponse){area.setMarked(false);
if(rsparea.isdefault){if(view){viewname=view.getViewName();area.setAsDefaultForView(viewname);}}area.handleServerResponse(rsparea,view);}}}if(response.design.emptyAreaGroups){self.emptyAreaGroups=response.design.emptyAreaGroups;
}if(response.design.missingAreaGroups){self.missingAreaGroups=response.design.missingAreaGroups;}for(k=0;k<areas.length;k++){area=areas[k];if(area&&area.getMarked()){area.handleAreaIsNowEmpty();}}state=zazzle.rlv.DesignState.SYNCHRONIZED;
notifyListeners('sync',true,design,view,additionalCallback);}else{if(response.Code){errorCode=response.Code;}else{errorCode= -1;}if(response.Message){errorMessage=response.Message;}else{errorMessage='UNKNOWN';
}if(response.Category){errorCategory=response.Category;}else{errorCategory='UNKNOWN';}state=zazzle.rlv.DesignState.ERROR;notifyListeners('error',false,design,null,additionalCallback);}}}function ajaxErrorCallback(err,errmsg,design,additionalCallback){
if(err){errorCode=err;}else{errorCode= -1;}if(errmsg){errorMessage=errmsg;}else{errorMessage='UNKNOWN';}state=zazzle.rlv.DesignState.ERROR;notifyListeners('error',false,design,null,additionalCallback);
}this.update=function(options){options=options||{};var additionalCallback=options.callback;var data;var url;if(state===zazzle.rlv.DesignState.DIRTY){data=this.buildServerRequest(options.ignoreActiveView);
url=editUrl+'?output=js';if(Uize.global().localStorage&&localStorage.debug){var caller=Zazzle.DebugHelpers.getCallerFiltered();var msg="Edit request being made by "+caller+" at "+url;if(localStorage.debug_rlv_verbose){
msg+=" with "+data;}console.log(msg);}if(Uize.global().localStorage&&localStorage.rlv_req_lag){var lag= +localStorage.rlv_req_lag;var laggedCallback=function(){var args=arguments;setTimeout(function(){
ajaxCallback.apply(null,args,additionalCallback);},lag);};zazzle.ajax.post(url,data,laggedCallback,ajaxErrorCallback,this,additionalCallback);}else{zazzle.ajax.post(url,data,ajaxCallback,ajaxErrorCallback,this,additionalCallback);
}state=zazzle.rlv.DesignState.WAITINGFORSERVER;}};this.updateWithResponse=function(response){if(state===zazzle.rlv.DesignState.DIRTY){ajaxCallback(response,this);}};this.undo=function(){if(this.isUndoable()){
var action={};var attribs={};action.verb='undo';action.attribs=attribs;pendingActions.push(action);this.setDirty();}};this.save=function(){var action={};var attribs={};action.verb='save';action.attribs=attribs;
pendingActions.push(action);this.setDirty();};this.redo=function(){if(this.isRedoable()){var action={};var attribs={};action.verb='redo';action.attribs=attribs;pendingActions.push(action);this.setDirty();
}};this.finish=function(forsale){var action={};var attribs={};action.verb='finish';if(forsale){attribs.forsale='true';}action.attribs=attribs;pendingActions.push(action);this.setDirty();};this.buildParamAttribs=function(ignoreActiveView){
var attribs={};var viewopts;var aName;var aValue;var prop;var k;if(designId){attribs.id=designId;}else{if(this.opts.pid){attribs.pid=this.opts.pid;}if(this.opts.pdt){attribs.pdt=this.opts.pdt;}}if(this.opts.pending){
attribs.pending=this.opts.pending;}if(activeView&& !ignoreActiveView){viewopts=activeView.getOpts();if(viewopts.max_dim){attribs.max_dim=viewopts.max_dim;}if(viewopts.rvtype){attribs.rvtype=viewopts.rvtype;
}if(viewopts.view){attribs.view=viewopts.view;}if(viewopts.context){attribs.context=viewopts.context;}if(activeView.needsAreaRefresh()){attribs.returnallareas='true';}else{attribs.returnallareas='false';
}}else{attribs.rvtype='none';if(areas.length===0||ignoreActiveView){attribs.returnallareas='true';attribs.returngrids='true';}}for(aName in this.opts){if(this.opts.hasOwnProperty(aName)){if((aName!=='id')&&(aName!=='pid')&&(aName!=='pending')&&(aName!=='max_dim')&&(aName!=='context')&&(aName!=='rvtype')&&(aName!=='returngrids')&&(aName!=='returnallareas')){
aValue=this.opts[aName];attribs[aName]=aValue;}}}if(usedesignspace&&(attribs.rvtype!=='none')){attribs.returngrids='false';attribs.coordspace='design';if(activeView){if(activeView.needsGridRefresh()){
attribs.returngrids='true';attribs.returnallareas='true';}}}for(k=0;k<properties.length;k++){prop=properties[k];aName=prop.name;if((aName!=='id')&&(aName!=='pid')&&(aName!=='pending')&&(aName!=='max_dim')&&(aName!=='context')&&(aName!=='rvtype')&&(aName!=='returngrids')&&(aName!=='returnallareas')){
aValue=prop.value;attribs[aName]=aValue;}}properties=[];return attribs;};this.buildServerRequest=function(ignoreActiveView){var k;var area;var action;var attribs;var req=zazzle.util.xmlStartElement('edit',{version:1});
attribs=this.buildParamAttribs(ignoreActiveView);req=req+zazzle.util.xmlStartElement('params',attribs,true);for(k=0;k<areas.length;k++){area=areas[k];req=req+area.buildServerRequest();}for(k=0;k<pendingActions.length;k++){
action=pendingActions[k];if(action){req=req+zazzle.util.xmlStartElement(action.verb,action.attribs,true);}}pendingActions=[];req=req+zazzle.util.xmlEndElement('edit');this.serverRequest=req;return req;
};this.setDirty=function(){if((state===zazzle.rlv.DesignState.SYNCHRONIZED)||(state===zazzle.rlv.DesignState.ERROR)){state=zazzle.rlv.DesignState.DIRTY;}};};zazzle.rlv.createZDesign=function(opts){var that=new zazzle.rlv.ZDesign(opts);
return that;};zazzle.rlv.DesignView=function DesignView(design,opts){if(!(this instanceof zazzle.rlv.DesignView)){return new zazzle.rlv.DesignView(design,opts);}this.design=design;this.opts=new zazzle.rlv.DesignViewOptions(opts);
var viewUrl='/rlv/svc/view';var needsSync=false;var defaultArea;var viewAreas=[];var viewAnnotations=[];var needsAreaRefresh=true;var needsGridRefresh=true;this.getOpts=function(){return this.opts;};
this.getViewName=function(){var name='';if(this.opts&&this.opts.view){name=this.opts.view;}return name;};this.getZDesign=function(){return this.design;};this.needsSync=function(){return needsSync;};this.needsAreaRefresh=function(){
return needsAreaRefresh;};this.setNeedsAreaRefresh=function(val){if(typeof val==='boolean'){needsAreaRefresh=val;}};this.needsGridRefresh=function(){return needsGridRefresh;};this.setNeedsGridRefresh=function(val){
if(typeof val==='boolean'){needsGridRefresh=val;}};this.matches=function(options){var result=false;if(typeof options==='object'){if(options.view===this.opts.view){result=true;}}return result;};this.mergeOptions=function(options){
if(this.opts&&options){this.opts.mergeOpts(options);}};this.setSync=function(val){if(typeof val==='boolean'){needsSync=val;}};this.sync=function(){};this.getDefaultArea=function(){if(!defaultArea){defaultArea=design.getDefaultAreaForView(this);
}return defaultArea;};this.getViewArea=function(name){var result;var k;var area;for(k=0;k<viewAreas.length;k++){if(viewAreas[k].getName()===name){result=viewAreas[k];break;}}if(!result){area=this.design.getArea(name);
result=new zazzle.rlv.DesignViewArea(this,area);viewAreas.push(result);}return result;};this.getViewAreas=function(){return viewAreas;};this.getAnnotations=function(){return viewAnnotations;};this.getJpegImageSource=function(imagesize){
var result;var attribs=this.buildParamAttribs();attribs.image_type='jpg';if(imagesize&&typeof imagesize==='number'){attribs.max_dim=imagesize;}result=viewUrl+'?'+zazzle.ajax.buildQueryString(attribs);
result=result+'&rnd='+zazzle.util.defeatCacheStr();return result;};this.getPngImageSource=function(imagesize){var result;var attribs=this.buildParamAttribs();attribs.image_type='png';if(imagesize&&typeof imagesize==='number'){
attribs.max_dim=imagesize;}result=viewUrl+'?'+zazzle.ajax.buildQueryString(attribs);result=result+'&rnd='+zazzle.util.defeatCacheStr();return result;};this.buildParamAttribs=function(){var attribs={};
var desopts=design.getOpts();var designId=design.getId();if(designId){attribs.id=designId;}else{if(desopts.pid){attribs.pid=desopts.pid;}if(desopts.pdt){attribs.pdt=desopts.pdt;}}if(desopts.pending){
attribs.pending=desopts.pending;}if(this.opts.max_dim){attribs.max_dim=this.opts.max_dim;}if(this.opts.rvtype){attribs.rvtype=this.opts.rvtype;}if(this.opts.view){attribs.view=this.opts.view;}if(this.opts.context){
attribs.context=this.opts.context;}if(desopts.title){attribs.title=desopts.title;}if(desopts.style){attribs.style=desopts.style;}if(desopts.color){attribs.color=desopts.color;}if(desopts.size){attribs.size=desopts.size;
}return attribs;};this.handleResponseWireframes=function(rspWireframes){var k;var annotation;viewAnnotations=[];for(k=0;k<rspWireframes.length;k++){annotation=new zazzle.rlv.DesignViewAnnotation(this);
annotation.handleServerResponse(rspWireframes[k]);if(annotation.isValid()){viewAnnotations.push(annotation);}}};};zazzle.rlv.DesignArea=function DesignArea(design,thename,thegroup,theselector){if(!(this instanceof zazzle.rlv.DesignArea)){
return new zazzle.rlv.DesignArea(design,thename,thegroup,theselector);}var name=thename;this.groupName="";this.insideBleed=[];this.outsideSafe=[];var group=thegroup;var selector=theselector;var areaFill=null;
var properties=[];var children=[];var childrenLookup={};var stitches=0;var marked=false;var markDeleted=false;var okToDelete=false;var pendingActions=[];var colors=[];var dirty=false;var nameChanged=false;
var chgareaName;var fillSet=false;var firstTime=true;var defaultForViews=[];this.design=design;var getSelectNames=function(objs){var result;var k;var names=[];var obj;var val;if(zazzle.util.isArray(objs)){
for(k=0;k<objs.length;k++){obj=objs[k];if(obj&&typeof obj==='object'&&obj.getName&&typeof obj.getName==='function'){val=obj.getName();names.push(val);}}if(names.length>0){result=names.join(',');}}return result;
};this.getName=function(){return name;};this.setName=function(newname){if(newname&&(typeof newname==='string')){if(name&&(name!==newname)){nameChanged=true;this.setDirty();this.design.forceReturnAllAreas();
}chgareaName=newname;}};this.getColors=function(){return colors;};this.setFill=function(theFill){if(theFill&&(theFill instanceof zazzle.rlv.DesignFill)){areaFill=theFill;fillSet=true;this.setDirty();
}};this.getFill=function(){return areaFill;};this.getProperties=function(){var result={};var k;var prop;for(k=0;k<properties.length;k++){prop=properties[k];if(prop&&(prop instanceof zazzle.rlv.DesignProperty)){
result[prop.name]=prop.value;}}return result;};this.getChildObjects=function(name,match){return children;};this.getChildObjectsLookup=function(name,match){return childrenLookup;};this.getStitches=function(){
return stitches;};this.getMarked=function(){return marked;};this.setMarked=function(val){if(typeof val==='boolean'){marked=val;}};this.reorderAbove=function(objs,target){var action={};var attribs={};
var names=getSelectNames(objs);if(names){if(target&&typeof target==='object'){attribs.above=target.getName();}action.verb='reorder';action.names=names;action.attribs=attribs;pendingActions.push(action);
this.setDirty();}};this.group=function(name,objs){var group;if(name&&typeof name==='string'&&objs){group=new zazzle.rlv.DesignGroup(this,name,objs,true);children.push(group);this.setDirty();}return group;
};this.moveDesignSpace=function(objs,x,y,dx,dy){var action={};var attribs={};var names=getSelectNames(objs);if(names){attribs.space='design';if((typeof x==='number')&&(typeof y==='number')){attribs.x=x;
attribs.y=y;}if((typeof dx==='number')&&(typeof dy==='number')){attribs.dx=dx;attribs.dy=dy;}action.verb='move';action.names=names;action.attribs=attribs;pendingActions.push(action);this.setDirty();}
};this.moveScreenSpace=function(objs,x,y,dx,dy){var action={};var attribs={};var names=getSelectNames(objs);if(names){attribs.space='screen';if((typeof x==='number')&&(typeof y==='number')){attribs.x=x;
attribs.y=y;}if((typeof dx==='number')&&(typeof dy==='number')){attribs.dx=dx;attribs.dy=dy;}action.verb='move';action.names=names;action.attribs=attribs;pendingActions.push(action);this.setDirty();}
};this.addPendingAction=function(action){pendingActions.push(action);this.setDirty();};this.moveObjectSpace=function(objs,x,y,dx,dy){var action={};var attribs={};var names=getSelectNames(objs);if(names){
attribs.space='object';if((typeof x==='number')&&(typeof y==='number')){attribs.x=x;attribs.y=y;}if((typeof dx==='number')&&(typeof dy==='number')){attribs.dx=dx;attribs.dy=dy;}action.verb='move';action.names=names;
action.attribs=attribs;pendingActions.push(action);this.setDirty();}};this.scale=function(objs,xscale,yscale,absolute){var action={};var attribs={};var names=getSelectNames(objs);if(names){if(names.indexOf(',')=== -1){
attribs.xscale=xscale;attribs.yscale=yscale;}else{attribs.scale=xscale;}attribs.abs=absolute?'true':'false';action.verb='scale';action.names=names;action.attribs=attribs;pendingActions.push(action);this.setDirty();
}};this.transfer=function(objs,targetareaname){var action={};var attribs={};var names=getSelectNames(objs);if(names){if(typeof targetareaname==='string'){attribs.area=targetareaname;action.verb='transfer';
action.names=names;action.attribs=attribs;pendingActions.push(action);this.setDirty();}}};this.rotate=function(objs,angle,absolute){var action={};var attribs={};var names=getSelectNames(objs);if(names){
attribs.angle=angle;attribs.abs=absolute?'true':'false';action.verb='rotate';action.names=names;action.attribs=attribs;pendingActions.push(action);this.setDirty();}};this.layout=function(objs,type,params,persist){
var action={};var attribs={};var layoutparams='';var k;var prop;var names=getSelectNames(objs);if(names){if(type&&typeof type==='string'){if(params&&typeof params==='string'){layoutparams=params;}else if(zazzle.util.isArray(params)){
for(k=0;k<params.length;k++){prop=params[k];if(prop&&(prop instanceof zazzle.rlv.DesignProperty)){if(layoutparams.length){layoutparams=layoutparams+'&';}layoutparams=layoutparams+prop.name+'='+prop.value;
}}}if(persist){this.setProperty(objs,'layout',type);this.setProperty(objs,'layoutparams',layoutparams);}else{attribs.type=type;attribs.layoutparams=layoutparams;action.verb='layout';action.names=names;
action.attribs=attribs;pendingActions.push(action);this.setDirty();}}}};this.getAreaProperty=function(name){var result;var k;var prop;for(k=0;k<properties.length;k++){prop=properties[k];if(prop&&(prop instanceof zazzle.rlv.DesignProperty)){
if(prop.name===name){result=prop.value;break;}}}return result;};this.setAreaPropertyParams=function(name,properties){var property=this.getAreaProperty(name)||"";var propertyObj=Uize.Url.fromParams(property);
Uize.forEach(properties,function(prop){propertyObj[prop.name]=prop.value;});this.setAreaProperty(name,Uize.Url.toParams(propertyObj));};this.setAreaProperty=function(name,value){var k;var prop;var found=false;
var propIndex;for(k=0;k<properties.length;k++){prop=properties[k];if(prop&&(prop instanceof zazzle.rlv.DesignProperty)&&prop.name===name){found=true;propIndex=k;break;}}var serialized='';if(value&&typeof value==='string'){
serialized=value;}else if(zazzle.util.isArray(value)){Uize.forEach(value,function(prop){if(prop&&(prop instanceof zazzle.rlv.DesignProperty)){if(serialized.length){serialized=serialized+'&';}serialized=serialized+prop.name+'='+prop.value;
}});if(serialized===''){serialized=null;}}if(found){if(serialized!==null){prop.value=serialized;prop.changed=true;}else properties.splice(propIndex,1);}else if(serialized!==null){prop=new zazzle.rlv.DesignProperty(name,serialized);
prop.changed=true;properties.push(prop);}this.setDirty();return this;};this.setProperty=function(objs,name,value){var k;var obj;if(name&&value&&typeof name==='string'&&typeof value==='string'&&zazzle.util.isArray(objs)){
for(k=0;k<objs.length;k++){obj=objs[k];if(obj&&typeof obj==='object'&&obj.setProperty&&typeof obj.setProperty==='function'){obj.setProperty(name,value);}}}};this.setAttribute=function(objs,name,value){
var k;var obj;if(name&&value&&typeof name==='string'&&typeof value==='string'&&zazzle.util.isArray(objs)){for(k=0;k<objs.length;k++){obj=objs[k];if(obj&&typeof obj==='object'&&obj.setAttribute&&typeof obj.setAttribute==='function'){
obj.setAttribute(name,value);}}}};this.cut=function(objs){var action={};var attribs={};var names=getSelectNames(objs);if(names){action.verb='cut';action.names=names;action.attribs=attribs;pendingActions.push(action);
this.design.forceReturnAllAreas();this.setDirty();}};this.remove=function(objs){var action={};var attribs={};var names=getSelectNames(objs);if(names){action.verb='delete';action.names=names;action.attribs=attribs;
pendingActions.push(action);this.design.forceReturnAllAreas();this.setDirty();}};this.copy=function(objs){var action={};var attribs={};var names=getSelectNames(objs);if(names){action.verb='copy';action.names=names;
action.attribs=attribs;pendingActions.push(action);this.setDirty();}};this.paste=function(){var action={};var attribs={};action.verb='paste';action.attribs=attribs;pendingActions.push(action);this.setDirty();
};this.crop=function(objs,cropArrayStr){var action={};action.verb='set';if(objs.length>1){if(Uize.global().localStorage&&localStorage.debug){console.error("crop does not support multiple objects.");}
return;}if(objs.length===0)return;action.names=objs[0].name.toString();action.attribs={crop:cropArrayStr};pendingActions.push(action);this.setDirty();};this.markDeleted=function(){markDeleted=true;this.setDirty();
};this.canDelete=function(){return okToDelete;};this.setDirty=function(){dirty=true;this.design.setDirty();};this.addImage=function(name,imageid,after){var image;if(name&&typeof name==='string'&&imageid&&typeof imageid==='string'){
image=new zazzle.rlv.DesignImage(this,name,imageid,true);image.setAddAfterObject(after);children.push(image);this.setDirty();}return image;};this.addText=function(name,textvalue,after){var text;if(name&&typeof name==='string'&&textvalue&&typeof textvalue==='string'){
text=new zazzle.rlv.DesignText(this,name,textvalue,true);text.setAddAfterObject(after);children.push(text);this.setDirty();}return text;};this.addEmbeddedDesign=function(name,embedId,embedProductId,embedArea,after){
var embed;if(name&&typeof name==='string'&&embedId&&typeof embedId==='string'&&embedProductId&&typeof embedProductId==='string'){embed=new zazzle.rlv.DesignEmbed(this,name,embedId,embedProductId,embedArea,true);
embed.setAddAfterObject(after);children.push(embed);this.setDirty();}return embed;};this.addPath=function(name,fill,after){var path;if(name&&typeof name==='string'&&fill&&(fill instanceof zazzle.rlv.DesignFill)){
path=new zazzle.rlv.DesignPath(this,name,fill,true);path.setAddAfterObject(after);children.push(path);this.setDirty();}return path;};this.isDefaultForView=function(viewname){var result=false;var k;if(viewname&&typeof viewname==='string'){
for(k=0;k<defaultForViews.length;k++){if(viewname===defaultForViews[k]){result=true;break;}}}return result;};this.setAsDefaultForView=function(viewname){if(viewname&&typeof viewname==='string'){if(!this.isDefaultForView(viewname)){
defaultForViews.push(viewname);}}};this.buildServerRequest=function(){var req='';var attribs;var k;var designObj;var action;if(dirty){if(markDeleted){if(name){req=zazzle.util.xmlStartElement('delarea',{name:name},true);
}markDeleted=false;}else if(nameChanged){req=zazzle.util.xmlStartElement('chgarea',{from:name,to:chgareaName},true);nameChanged=false;}else{attribs={};if(name){attribs.name=name;}if(group){attribs.group=group;
}if(selector){attribs.selector=selector;}req=zazzle.util.xmlStartElement('area',attribs,true);if(fillSet&&areaFill){attribs={};if(areaFill.solid){attribs.type='solid';}if(areaFill.fillcolor){attribs.fillcolor=areaFill.fillcolor;
}if(areaFill.strokecolor){attribs.strokecolor=areaFill.strokecolor;}if(areaFill.strokewidth){attribs.strokewidth=areaFill.strokewidth;}req=req+zazzle.util.xmlStartElement('fill',attribs,true);}var setAttribsChanged=false;
var setUnsafeChars=false;var setAttribs={};pattern=/[\t\n\v\f\r]/;for(k=0;k<properties.length;k++){prop=properties[k];if(prop&&(prop instanceof zazzle.rlv.DesignProperty)){if(prop.changed){setAttribs[prop.name]=prop.value;
if(typeof prop.value==='string'&&prop.value.search(pattern)!== -1)setUnsafeChars=true;setAttribsChanged=true;prop.changed=false;}}}if(setAttribsChanged){if(setUnsafeChars){req=req+zazzle.util.xmlStartElement('set',{},false);
for(aName in setAttribs){if(setAttribs.hasOwnProperty(aName)){aValue=setAttribs[aName];req=req+zazzle.util.xmlStartElement(aName,{},false);req=req+zazzle.util.xmlSafe(aValue,false);req=req+zazzle.util.xmlEndElement(aName);
}}req=req+zazzle.util.xmlEndElement('set');}else req=req+zazzle.util.xmlStartElement('set',setAttribs,true);}for(k=0;k<children.length;k++){designObj=children[k];req=req+designObj.buildServerRequest();
}for(k=0;k<pendingActions.length;k++){action=pendingActions[k];if(action){if(action.names){req=req+zazzle.util.xmlStartElement('select',{name:action.names},true);}req=req+zazzle.util.xmlStartElement(action.verb,action.attribs,true);
}}pendingActions=[];}dirty=false;}return req;};this.handleAreaIsNowEmpty=function(){children=[];stitches=0;marked=false;pendingActions=[];colors=[];areaFill=null;nameChanged=false;dirty=false;};this.handleServerResponse=function(rsparea,view){
var k;var obj;var name;var child;var imageid;var text;var productid;var designid;var fill;var fillcolor;var strokewidth;var strokecolor;var solid;var viewarea;var hasobjects;if(rsparea&&(typeof rsparea==='object')){
if(rsparea.name){name=rsparea.name;}if(rsparea.group){this.groupName=rsparea.group;}if(view){viewarea=view.getViewArea(name);if(viewarea){viewarea.handleServerResponse(rsparea);}}hasobjects=false;if(rsparea.objects&&(rsparea.objects.length>0)){
hasobjects=true;}if(firstTime||hasobjects||rsparea.changed){colors=[];areaFill=null;if(rsparea.colors&&typeof rsparea.colors==='string'){colors=rsparea.colors.split(',');}if(rsparea.fill&&typeof rsparea.fill==='object'){
fillcolor=rsparea.fill.fillcolor;strokewidth=rsparea.fill.strokewidth;strokecolor=rsparea.fill.strokecolor;if(fillcolor){solid=true;}else{solid=false;}areaFill=new zazzle.rlv.DesignFill(solid,fillcolor,strokecolor,strokewidth);
}properties=zazzle.rlv.convertToPropertyArray(rsparea.properties);if(rsparea.insideBleed&&zazzle.util.isArray(rsparea.insideBleed)){this.insideBleed=rsparea.insideBleed;}else{this.insideBleed=[];}if(rsparea.outsideSafe&&zazzle.util.isArray(rsparea.outsideSafe)){
this.outsideSafe=rsparea.outsideSafe;}else{this.outsideSafe=[];}children=[];if(rsparea.objects){for(k=0;k<rsparea.objects.length;k++){obj=rsparea.objects[k];if(obj&&typeof obj==='object'&&obj.type){child=undefined;
if(obj.type==='image'){imageid=zazzle.rlv.lookupResponseProperty(obj.properties,'imageid');if(!imageid){imageid='';}child=new zazzle.rlv.DesignImage(this,obj.name,imageid,false);}else if(obj.type==='text'){
text=zazzle.rlv.lookupResponseProperty(obj.properties,'value');if(!text){text='';}child=new zazzle.rlv.DesignText(this,obj.name,text,false);}else if(obj.type==='embed'){productid=zazzle.rlv.lookupResponseProperty(obj.properties,'productid');
designid=zazzle.rlv.lookupResponseProperty(obj.properties,'designid');child=new zazzle.rlv.DesignEmbed(this,obj.name,designid,productid,undefined,false);}else if(obj.type==='path'){fillcolor=zazzle.rlv.lookupResponseProperty(obj.properties,'fillcolor');
strokewidth=zazzle.rlv.lookupResponseProperty(obj.properties,'strokewidth');strokecolor=zazzle.rlv.lookupResponseProperty(obj.properties,'strokecolor');if(fillcolor){solid=true;}else{solid=false;}fill=new zazzle.rlv.DesignFill(solid,fillcolor,strokecolor,strokewidth);
child=new zazzle.rlv.DesignPath(this,obj.name,fill,false);}else if(obj.type==='group'){child=new zazzle.rlv.DesignGroup(this,obj.name,[],false);}if(child){children.push(child);childrenLookup[obj.name]=child;
child.handleServerResponse(obj);}}}}}firstTime=false;}dirty=false;};};zazzle.rlv.DesignViewArea=function DesignViewArea(view,area){if(!(this instanceof zazzle.rlv.DesignViewArea)){return new zazzle.rlv.DesignViewArea(view,area);
}var outline=[];var grid=[];var designtogridmatrix=[1.0,0.0,0.0,1.0,0.0,0.0];var gridtodesignmatrix=[1.0,0.0,0.0,1.0,0.0,0.0];var visible=false;this.view=view;this.design=view.getZDesign();this.area=area;
var getSelectNames=function(objs){var result;var k;var names=[];var obj;var val;if(zazzle.util.isArray(objs)){for(k=0;k<objs.length;k++){obj=objs[k];if(obj&&typeof obj==='object'&&obj.getName&&typeof obj.getName==='function'){
val=obj.getName();names.push(val);}}if(names.length>0){result=names.join(',');}}return result;};this.getName=function(){var result='unknown';if(this.area){result=this.area.getName();}return result;};
this.getOutline=function(){return outline;};this.getGrid=function(){return grid;};this.getDesignToGridMatrix=function(){return designtogridmatrix;};this.getgridtodesignmatrix=function(){return gridtodesignmatrix;
};this.canMapScreenToDesign=function(){var result=false;if(grid&&(grid.length>0)){result=true;}return result;};this.isVisible=function(){return visible;};this.moveScreenSpace=function(objs,x,y,dx,dy){
var names=getSelectNames(objs);var action={};var attribs={};var xyStartPt;var xyEndPt;var uvStartPt;var uvEndPt;this.design.setActiveView(this.view);if(this.canMapScreenToDesign()){xyStartPt=new zazzle.rlv.Point(x,y);
xyEndPt=new zazzle.rlv.Point(x+dx,y+dy);uvStartPt=this.screenSpaceToDesignSpace(xyStartPt);uvEndPt=this.screenSpaceToDesignSpace(xyEndPt);attribs.space='design';attribs.x=uvStartPt.x;attribs.y=uvStartPt.y;
if(dx!==undefined&&dy!==undefined){attribs.dx=uvEndPt.x-uvStartPt.x;attribs.dy=uvEndPt.y-uvStartPt.y;}}else{attribs.space='screen';attribs.x=x;attribs.y=y;if(dx!==undefined&&dy!==undefined){attribs.dx=dx;
attribs.dy=dy;}}action.verb='move';action.names=names;action.attribs=attribs;this.area.addPendingAction(action);return this;};this.screenSpaceToDesignSpace=function(xyPt){var uvPt=new zazzle.rlv.Point(0,0);
var max_dim=512;var viewOpts=this.view.getOpts();var x;var y;var u;var v;var uPrime;var vPrime;var dx;var dy;var dist;var minError=Number.MAX_VALUE;var k;var foundIndex= -1;this.design.setActiveView(this.view);
if((xyPt instanceof zazzle.rlv.Point)&&grid){if(viewOpts&&viewOpts.max_dim&&typeof viewOpts.max_dim==='number'){max_dim=viewOpts.max_dim;}x=xyPt.x/max_dim;y=xyPt.y/max_dim;for(k=0;k<grid.length;k=k+12){
dx=x-grid[k];dy=y-grid[k+1];dist=dx*dx+dy*dy;if(dist<minError){minError=dist;foundIndex=k;}}if(foundIndex>=0){dx=x-grid[foundIndex];dy=y-grid[foundIndex+1];u=grid[foundIndex+2];v=grid[foundIndex+3];u+=grid[foundIndex+4]*dx;
v+=grid[foundIndex+5]*dx;u+=grid[foundIndex+6]*dy;v+=grid[foundIndex+7]*dy;uPrime=gridtodesignmatrix[0]*u;uPrime=uPrime+gridtodesignmatrix[2]*v;uPrime=uPrime+gridtodesignmatrix[4];vPrime=gridtodesignmatrix[1]*u;
vPrime=vPrime+gridtodesignmatrix[3]*v;vPrime=vPrime+gridtodesignmatrix[5];uvPt.x=uPrime;uvPt.y=vPrime;}}return uvPt;};this.designSpaceToScreenSpace=function(uvPt){var xyPt=new zazzle.rlv.Point(0,0);var max_dim=512;
var viewOpts=this.view.getOpts();var x;var y;var u;var v;var uPrime;var vPrime;var du;var dv;var dist;var minError=Number.MAX_VALUE;var k;var foundIndex= -1;this.design.setActiveView(this.view);if((uvPt instanceof zazzle.rlv.Point)&&grid){
if(viewOpts&&viewOpts.max_dim&&typeof viewOpts.max_dim==='number'){max_dim=viewOpts.max_dim;}uPrime=uvPt.x;vPrime=uvPt.y;u=designtogridmatrix[0]*uPrime;u=u+designtogridmatrix[2]*vPrime;u=u+designtogridmatrix[4];
v=designtogridmatrix[1]*uPrime;v=v+designtogridmatrix[3]*vPrime;v=v+designtogridmatrix[5];for(k=0;k<grid.length;k=k+12){du=u-grid[k+2];dv=v-grid[k+3];dist=du*du+dv*dv;if(dist<minError){minError=dist;
foundIndex=k;}}if(foundIndex>=0){du=u-grid[foundIndex+2];dv=v-grid[foundIndex+3];x=grid[foundIndex];y=grid[foundIndex+1];x+=grid[foundIndex+8]*du;y+=grid[foundIndex+9]*du;x+=grid[foundIndex+10]*dv;y+=grid[foundIndex+11]*dv;
xyPt.x=x*max_dim;xyPt.y=y*max_dim;}}return xyPt;};this.handleServerResponse=function(rsparea){var tempArray;if(rsparea&&typeof rsparea==='object'){tempArray=zazzle.rlv.convertToPointArray(rsparea.outline);
if(tempArray.length>0){outline=tempArray;}if(rsparea.grid){grid=rsparea.grid;view.setNeedsGridRefresh(false);}if(rsparea.designtogridmatrix){if(zazzle.util.isArray(rsparea.designtogridmatrix)){designtogridmatrix=rsparea.designtogridmatrix;
gridtodesignmatrix=zazzle.util.matrixInverse(designtogridmatrix);}}if(rsparea.visible){visible=true;}else{visible=false;}}};this.setGrid=function(newGrid){grid=newGrid;}};zazzle.rlv.DesignImage=function DesignImage(designArea,name,imageid,addToArea){
if(!(this instanceof zazzle.rlv.DesignImage)){return new zazzle.rlv.DesignImage(designArea,name,imageid,addToArea);}this.designArea=designArea;this.name=name;this.imageid=imageid;this.title=imageid;this.addToArea=addToArea;
this.dirty=false;this.children=[];this.properties=[];this.attributes=[];this.template={};this.removeTheTemplate=false;this.bounds=[];this.outline=[];this.matrix=[];this.contentOutline=[];this.colors=[];
this.pendingActions=[];this.addAfterName=undefined;this.urlkey=undefined;this.getImageid=function(){return this.imageid;};this.setImageid=function(val){if(val&&typeof val==='string'){if(val!==this.imageid){
this.imageid=val;if(!this.addToArea){this.setProperty('imageid',val);}}}return this;};this.getTitle=function(){return this.title;};this.buildServerRequest=function(){var req='';if(this.addToArea){if(this.addAfterName){
req=zazzle.util.xmlStartElement('select',{name:this.addAfterName},true);this.addAfterName=undefined;}req=req+zazzle.util.xmlStartElement('image',{name:this.name,imageid:this.imageid},true);}if(this.dirty){
if(!this.addToArea){req=zazzle.util.xmlStartElement('select',{name:this.name},true);}req=req+this.buildSubRequest();}this.addToArea=false;this.dirty=false;return req;};this.handleServerResponseSpecialized=function(rspobj){
this.imageid=this.getProperty('imageid');this.title=this.getProperty('title');};};zazzle.rlv.DesignText=function DesignText(designArea,name,text,addToArea){if(!(this instanceof zazzle.rlv.DesignText)){
return new zazzle.rlv.DesignText(designArea,name,text,addToArea);}this.designArea=designArea;this.name=name;this.text=text;this.addToArea=addToArea;this.align='center';this.paragraphAlign='center';this.arcRadius=undefined;
this.path=undefined;this.scaleMode=undefined;this.wrap=true;this.clip=true;this.styleRuns=[];this.dirty=false;this.children=[];this.properties=[];this.attributes=[];this.template={};this.removeTheTemplate=false;
this.bounds=[];this.outline=[];this.matrix=[];this.contentOutline=[];this.color=undefined;this.pendingActions=[];this.addAfterName=undefined;this.urlkey=undefined;this.colors=[];this.setAlign=function(val){
var newVal='center';if(val===zazzle.rlv.DesignTextAlign.LEADING){newVal='leading';}else if(val===zazzle.rlv.DesignTextAlign.TRAILING){newVal='trailing';}if(this.align!==newVal){this.align=newVal;if(!this.addToArea){
this.setProperty('align',newVal);}this.setDirty();}return this;};this.getAlign=function(){var result=zazzle.rlv.DesignTextAlign.CENTER;if(this.align==='leading'){result=zazzle.rlv.DesignTextAlign.LEADING;
}else if(this.align==='trailing'){result=zazzle.rlv.DesignTextAlign.TRAILING;}return result;};this.setParagraphAlign=function(val){var newVal='center';if(val===zazzle.rlv.DesignTextParagraphAlign.NEAR){
newVal='near';}else if(val===zazzle.rlv.DesignTextParagraphAlign.FAR){newVal='far';}if(this.paragraphAlign!==newVal){this.paragraphAlign=newVal;if(!this.addToArea){this.setProperty('palign',newVal);}
this.setDirty();}return this;};this.getParagraphAlign=function(){var result=zazzle.rlv.DesignTextParagraphAlign.CENTER;if(this.paragraphAlign==='near'){result=zazzle.rlv.DesignTextParagraphAlign.NEAR;
}else if(this.paragraphAlign==='far'){result=zazzle.rlv.DesignTextParagraphAlign.FAR;}return result;};this.setArc=function(radius){if(radius&&typeof radius==='number'){if(radius!==this.arcRadius){this.arcRadius=radius;
if(!this.addToArea){this.setProperty('arcradius',radius.toString());}this.setDirty();}}return this;};this.getArc=function(){return this.arcRadius;};this.setPath=function(val){var path;if(val===zazzle.rlv.DesignTextPath.HORZ){
path='horz';}else if(val===zazzle.rlv.DesignTextPath.VERT){path='vert';}else if(val===zazzle.rlv.DesignTextPath.ARC){path='arc';}else if(val===zazzle.rlv.DesignTextPath.RARC){path='rarc';}if(path&&(path!==this.path)){
this.path=path;if(!this.addToArea){this.setProperty('path',path);}this.setDirty();}return this;};this.getPath=function(){var result=zazzle.rlv.DesignTextPath.HORZ;if(this.path==='vert'){result=zazzle.rlv.DesignTextPath.VERT;
}else if(this.path==='arc'){result=zazzle.rlv.DesignTextPath.ARC;}else if(this.path==='rarc'){result=zazzle.rlv.DesignTextPath.RARC;}return result;};this.setScaleMode=function(val){var newVal='fit';if(val===zazzle.rlv.DesignTextScaleMode.NONE){
newVal='none';}else if(val===zazzle.rlv.DesignTextScaleMode.USER){newVal='user';}if(newVal!==this.scaleMode){this.scaleMode=newVal;if(!this.addToArea){this.setProperty('scalemode',newVal);}this.setDirty();
}return this;};this.getScaleMode=function(){var result=zazzle.rlv.DesignTextScaleMode.FIT;if(this.scaleMode==='none'){result=zazzle.rlv.DesignTextScaleMode.NONE;}else if(this.scaleMode==='user'){result=zazzle.rlv.DesignTextScaleMode.USER;
}return result;};this.setWrap=function(val){if(typeof val==='boolean'){if(val!==this.wrap){this.wrap=val;if(!this.addToArea){this.setProperty('wrap',val?'true':'false');}this.setDirty();}return this;
}};this.getWrap=function(){return this.wrap;};this.setClip=function(val){if(typeof val==='boolean'){if(val!==this.clip){this.clip=val;if(!this.addToArea){this.setProperty('clip',val?'true':'false');}
this.setDirty();}return this;}};this.getClip=function(){return this.clip;};this.getValue=function(){return this.text;};this.setValue=function(val){if(val&&typeof val==='string'){if(val!==this.text){this.text=val;
if(!this.addToArea){this.setProperty('value',val);}this.setDirty();}}return this;};this.addStyleRun=function(font,start,end){var styleRun;if(font&&(font instanceof zazzle.rlv.DesignFont)){styleRun={};
if(font.face){styleRun.face=font.face;}if(font.style){styleRun.style=font.style;}if(font.height){styleRun.height=font.height;}if(font.weight){styleRun.weight=font.weight;}if(font.color){styleRun.color=font.color;
}if(font.minheight){styleRun.minheight=font.minheight;}if(font.maxheight){styleRun.maxheight=font.maxheight;}if(start&&typeof start==='number'){styleRun.start=start;}if(end&&typeof end==='number'){styleRun.end=end;
}this.styleRuns.push(styleRun);this.setDirty();}return this;};this.clearStyleRuns=function(){this.styleRuns=[];this.setDirty();return this;};this.buildServerRequest=function(){var req='';var k;var run;
var attr={};if(this.addToArea){if(this.addAfterName){req=zazzle.util.xmlStartElement('select',{name:this.addAfterName},true);this.addAfterName=undefined;}attr.name=this.name;attr.align=this.align;if(this.path){
attr.path=this.path;}if(this.arcRadius){attr.arc=this.arcRadius;}if(this.paragraphAlign){attr.palign=this.paragraphAlign;}attr.wrap=this.wrap?'true':'false';attr.clip=this.clip?'true':'false';if(this.scaleMode){
attr.scalemode=this.scaleMode;}req=req+zazzle.util.xmlStartElement('text',attr,false);if(this.text){req=req+zazzle.util.xmlStartElement('value');req=req+zazzle.util.xmlSafe(this.text);req=req+zazzle.util.xmlEndElement('value');
}if(this.styleRuns.length>0){for(k=0;k<this.styleRuns.length;k++){run=this.styleRuns[k];req=req+zazzle.util.xmlStartElement('font',run,true);}}req=req+zazzle.util.xmlEndElement('text');}if(this.dirty){
if(!this.addToArea){req=zazzle.util.xmlStartElement('select',{name:this.name},true);}req=req+this.buildSubRequest();}this.addToArea=false;this.dirty=false;return req;};this.handleServerResponseSpecialized=function(rspobj){
var k;var style;var styleRun;var val;if(zazzle.util.isArray(rspobj.styles)){this.styleRuns=[];for(k=0;k<rspobj.styles.length;k++){style=rspobj.styles[k];styleRun={};if(style.face){styleRun.face=style.face;
}if(style.style){styleRun.style=style.style;}if(style.color){styleRun.color=style.color;}if(style.weight){styleRun.weight=style.weight;}if(style.height){styleRun.height=style.height;}if(style.minheight){
styleRun.minheight=style.minheight;}if(style.maxheight){styleRun.maxheight=style.maxheight;}if(style.start){styleRun.start=style.start;}if(style.end){styleRun.end=style.end;}this.styleRuns.push(styleRun);
}}val=this.getProperty('align');if(val){this.align=val;}val=this.getProperty('path');if(val){this.path=val;}val=this.getProperty('palign');if(val){this.paragraphAlign=val;}val=this.getProperty('scalemode');
if(val){this.scalemode=val;}val=this.getProperty('arcradius');if(val){this.arcRadius=val;}val=this.getProperty('wrap');if(typeof val==='boolean'){this.wrap=val;}val=this.getProperty('clip');if(typeof val==='boolean'){
this.clip=val;}val=this.getProperty('value');if(val){this.text=val;}};};zazzle.rlv.DesignGroup=function DesignGroup(designArea,name,objs,addToArea){if(!(this instanceof zazzle.rlv.DesignGroup)){return new zazzle.rlv.DesignGroup(designArea,name,objs,addToArea);
}this.designArea=designArea;this.name=name;this.addToArea=addToArea;this.objnames=[];this.markDeleted=false;this.okToDelete=false;this.dirty=false;this.children=[];this.properties=[];this.attributes=[];
this.template={};this.removeTheTemplate=false;this.bounds=[];this.outline=[];this.matrix=[];this.contentOutline=[];this.color=undefined;this.pendingActions=[];this.addAfterName=undefined;this.urlkey=undefined;
var k;var obj;var val;if(objs){for(k=0;k<objs.length;k++){obj=objs[k];if(obj&&obj.getName&&typeof obj.getName==='function'){val=obj.getName();if(val&&typeof val==='string'){this.objnames.push(val);}}
}}this.canDelete=function(){return this.okToDelete;};this.ungroup=function(){this.markDeleted=true;this.setDirty();};this.buildServerRequest=function(){var req='';var selection;if(this.addToArea){if(this.objnames.length>0){
selection=this.objnames.join(',');req=req+zazzle.util.xmlStartElement('select',{name:selection},true);req=req+zazzle.util.xmlStartElement('group',{name:this.name},true);}}if(this.dirty){if(!this.addToArea){
req=zazzle.util.xmlStartElement('select',{name:this.name},true);if(this.markDeleted){req=req+zazzle.util.xmlStartElement('ungroup',{},true);}}if(!this.markDeleted){req=req+this.buildSubRequest();}}this.addToArea=false;
this.dirty=false;return req;};this.handleServerResponseSpecialized=function(rspobj){var k;var obj;var child;var imageid;var text;var productid;var designid;var fillcolor;var strokewidth;var strokecolor;
var fill;var solid;if(rspobj.objects){for(k=0;k<rspobj.objects.length;k++){obj=rspobj.objects[k];if(obj&&typeof obj==='object'&&obj.type){child=undefined;if(obj.type==='image'){imageid=zazzle.rlv.lookupResponseProperty(obj.properties,'imageid');
if(!imageid){imageid='';}child=new zazzle.rlv.DesignImage(this.designArea,obj.name,imageid,false);}else if(obj.type==='text'){text=zazzle.rlv.lookupResponseProperty(obj.properties,'value');if(!text){
text='';}child=new zazzle.rlv.DesignText(this.designArea,obj.name,text,false);}else if(obj.type==='embed'){productid=zazzle.rlv.lookupResponseProperty(obj.properties,'productid');designid=zazzle.rlv.lookupResponseProperty(obj.properties,'designid');
child=new zazzle.rlv.DesignEmbed(this.designArea,obj.name,designid,productid,undefined,false);}else if(obj.type==='path'){fillcolor=zazzle.rlv.lookupResponseProperty(obj.properties,'fillcolor');strokewidth=zazzle.rlv.lookupResponseProperty(obj.properties,'strokewidth');
strokecolor=zazzle.rlv.lookupResponseProperty(obj.properties,'strokecolor');if(fillcolor){solid=true;}else{solid=false;}fill=new zazzle.rlv.DesignFill(solid,fillcolor,strokecolor,strokewidth);child=new zazzle.rlv.DesignPath(this.designArea,obj.name,fill,false);
}else if(obj.type==='group'){child=new zazzle.rlv.DesignGroup(this.designArea,obj.name,[],false);}if(child){this.children.push(child);child.handleServerResponse(obj);}}}}};};zazzle.rlv.DesignEmbed=function DesignEmbed(designArea,name,embedId,embedProductId,embedArea,addToArea){
if(!(this instanceof zazzle.rlv.DesignEmbed)){return new zazzle.rlv.DesignEmbed(designArea,name,embedId,embedProductId,embedArea,addToArea);}this.designArea=designArea;this.name=name;this.embedId=embedId;
this.embedProductId=embedProductId;this.embedArea=embedArea;this.addToArea=addToArea;this.params=[];this.dirty=false;this.children=[];this.properties=[];this.attributes=[];this.template={};this.removeTheTemplate=false;
this.bounds=[];this.outline=[];this.matrix=[];this.contentOutline=[];this.color=undefined;this.pendingActions=[];this.addAfterName=undefined;this.urlkey=undefined;this.setParam=function(name,value){this.setPropertyHelper(this.params,name,value);
this.setDirty();return this;};this.buildServerRequest=function(){var req='';var k;var attr={};var name;var value;var pair;var regexp=/%20/g;var pairs=[];if(this.addToArea){if(this.addAfterName){req=zazzle.util.xmlStartElement('select',{name:this.addAfterName},true);
this.addAfterName=undefined;}attr.name=this.name;attr.designid=this.embedId;attr.productid=this.embedProductId;if(this.embedArea){attr.area=this.embedArea;}if(this.params.length>0){for(k=0;k<this.params.length;k++){
name=this.params[k].name;value=this.params[k].value;pair=encodeURIComponent(name).replace(regexp,'+')+'='+encodeURIComponent(value).replace(regexp,'+');pairs.push(pair);}attr.params=pairs.join('&');}
req=req+zazzle.util.xmlStartElement('embed',attr,true);}if(this.dirty){if(!this.addToArea){req=zazzle.util.xmlStartElement('select',{name:this.name},true);}req=req+this.buildSubRequest();}this.addToArea=false;
this.dirty=false;return req;};this.handleServerResponseSpecialized=function(rspobj){this.embedId=this.getProperty('designid');this.embedProductId=this.getProperty('productid');this.embedArea=this.getProperty('designarea');
};};zazzle.rlv.DesignPath=function DesignPath(designArea,name,fill,addToArea){if(!(this instanceof zazzle.rlv.DesignPath)){return new zazzle.rlv.DesignPath(designArea,name,fill,addToArea);}this.designArea=designArea;
this.name=name;this.fill=fill;this.addToArea=addToArea;this.segment='';this.dirty=false;this.children=[];this.properties=[];this.attributes=[];this.template={};this.removeTheTemplate=false;this.bounds=[];
this.outline=[];this.matrix=[];this.contentOutline=[];this.color=undefined;this.pendingActions=[];this.addAfterName=undefined;this.urlkey=undefined;this.setSegment=function(segment){if(segment&&typeof segment==='string'){
this.segment=segment;this.setDirty();}return this;};this.getSegment=function(){return this.segment;};this.setFill=function(theFill){if(theFill&&(theFill instanceof zazzle.rlv.DesignFill)){this.fill=theFill;
this.setDirty();}return this;};this.getFill=function(){return this.fill;};this.buildServerRequest=function(){var req='';var attribs;if(this.addToArea){if(this.addAfterName){req=zazzle.util.xmlStartElement('select',{name:this.addAfterName},true);
this.addAfterName=undefined;}req=req+zazzle.util.xmlStartElement('path',{name:this.name},false);if(this.segment){req=req+zazzle.util.xmlStartElement('segment');req=req+zazzle.util.xmlSafe(this.segment);
req=req+zazzle.util.xmlEndElement('segment');}if(this.fill){attribs={};if(this.fill.solid){attribs.type='solid';}if(this.fill.fillcolor){attribs.fillcolor=fill.fillcolor;}if(this.fill.strokecolor){attribs.strokecolor=fill.strokecolor;
}if(this.fill.strokewidth){attribs.strokewidth=fill.strokewidth;}req=req+zazzle.util.xmlStartElement('fill',attribs,true);}req=req+zazzle.util.xmlEndElement('path');}if(this.dirty){if(!this.addToArea){
req=zazzle.util.xmlStartElement('select',{name:this.name},true);}req=req+this.buildSubRequest();}this.addToArea=false;this.dirty=false;return req;};this.handleServerResponseSpecialized=function(rspobj){
var val;var solid;var fillcolor;var strokecolor;var strokewidth;var segment;segment=this.getProperty('segments');if(segment){this.segment=segment;}val=this.getProperty('filltype');solid=val==='solid';
fillcolor=this.getProperty('fillcolor');strokecolor=this.getProperty('strokecolor');strokewidth=this.getProperty('strokewidth');this.fill=new zazzle.rlv.DesignFill(solid,fillcolor,strokecolor,strokewidth);
};};(function(){var f=function(proto){function getPropertyHelper(propArray,name){var result;var k;var prop;for(k=0;k<propArray.length;k++){prop=propArray[k];if(prop&&(prop instanceof zazzle.rlv.DesignProperty)){
if(prop.name===name){result=prop.value;break;}}}return result;}function setPropertyHelper(propArray,name,value){var k;var prop;var found=false;for(k=0;k<propArray.length;k++){prop=propArray[k];if(prop&&(prop instanceof zazzle.rlv.DesignProperty)){
if(prop.name===name){found=true;break;}}}if(found){prop.value=value;prop.changed=true;}else{prop=new zazzle.rlv.DesignProperty(name,value);prop.changed=true;propArray.push(prop);}}proto.setPropertyHelper=setPropertyHelper;
function getProperties(){var result={};var k;var prop;for(k=0;k<this.properties.length;k++){prop=this.properties[k];if(prop&&(prop instanceof zazzle.rlv.DesignProperty)){result[prop.name]=prop.value;
}}return result;}proto.getProperties=getProperties;function getProperty(name){return getPropertyHelper(this.properties,name);}proto.getProperty=getProperty;function setProperty(name,value){setPropertyHelper(this.properties,name,value);
this.setDirty();return this;}proto.setProperty=setProperty;function setAttribute(name,value){setPropertyHelper(this.attributes,name,value);this.setDirty();return this;}proto.setAttribute=setAttribute;
function getChildObjects(){return this.children;}proto.getChildObjects=getChildObjects;function setTemplate(urlkey,title,ppshow){this.template={};if(urlkey&&typeof urlkey==='string'){this.template.urlkey=urlkey;
}if(title&&typeof title==='string'){this.template.title=title;}if(typeof ppshow==='boolean'){this.template.ppshow=ppshow;}this.setDirty();return this;}proto.setTemplate=setTemplate;function removeTemplate(){
this.removeTheTemplate=true;this.template={};this.setDirty();return this;}proto.removeTemplate=removeTemplate;function getName(){return this.name;}proto.getName=getName;function getMatrix(){return this.matrix;
}proto.getMatrix=getMatrix;function getRotationAngle(){var angle=0.0;var theta;var a;var aPrime;var b;var c;if(this.matrix&&(this.matrix.length===6)){a=this.matrix[0];b=this.matrix[1];c=Math.sqrt((a*a)+(b*b));
if(c>0.0001){aPrime=a/c;theta=Math.acos(aPrime);if(b>0.0){theta=(Math.PI*2.0)-theta;}angle=360.0*(theta/(Math.PI*2.0));if(angle>359.5){angle=0.0;}}}return angle;}proto.getRotationAngle=getRotationAngle;
function getViewAreaForView(view){var result=null;var areaName='unknown';if(view&&view instanceof zazzle.rlv.DesignView){if(this.designArea){areaName=this.designArea.getName();result=view.getViewArea(areaName);
}}return result;}proto.getViewAreaForView=getViewAreaForView;function getBounds(view){var result=this.bounds;var xyPt;var minXY;var maxXY;var k;var viewArea;var rect;viewArea=this.getViewAreaForView(view);
if(this.bounds&&this.bounds.length>=2&&viewArea&&viewArea.canMapScreenToDesign()){result=[];rect=[];xyPt=new zazzle.rlv.Point(this.bounds[0].x,this.bounds[0].y);rect.push(xyPt);xyPt=new zazzle.rlv.Point(this.bounds[1].x,this.bounds[0].y);
rect.push(xyPt);xyPt=new zazzle.rlv.Point(this.bounds[1].x,this.bounds[1].y);rect.push(xyPt);xyPt=new zazzle.rlv.Point(this.bounds[0].x,this.bounds[1].y);rect.push(xyPt);minXY=new zazzle.rlv.Point(Number.MAX_VALUE,Number.MAX_VALUE);
maxXY=new zazzle.rlv.Point(-Number.MAX_VALUE,-Number.MAX_VALUE);for(k=0;k<rect.length;k++){xyPt=viewArea.designSpaceToScreenSpace(rect[k]);minXY.x=Math.min(minXY.x,xyPt.x);minXY.y=Math.min(minXY.y,xyPt.y);
maxXY.x=Math.max(maxXY.x,xyPt.x);maxXY.y=Math.max(maxXY.y,xyPt.y);}result.push(minXY);result.push(maxXY);}return result;}proto.getBounds=getBounds;function getOutline(view){var result=this.outline;var xyPt;
var k;var viewArea;viewArea=this.getViewAreaForView(view);if(this.outline&&viewArea&&viewArea.canMapScreenToDesign()){result=[];for(k=0;k<this.outline.length;k++){xyPt=viewArea.designSpaceToScreenSpace(this.outline[k]);
result.push(xyPt);}}return result;}proto.getOutline=getOutline;function getContentOutline(view){var result=this.contentOutline;var xyPt;var k;var viewArea;viewArea=this.getViewAreaForView(view);if(this.contentOutline&&viewArea&&viewArea.canMapScreenToDesign()){
result=[];for(k=0;k<this.contentOutline.length;k++){xyPt=viewArea.designSpaceToScreenSpace(this.contentOutline[k]);result.push(xyPt);}}return result;}proto.getContentOutline=getContentOutline;function getColors(){
return this.colors;}proto.getColors=getColors;function isLocked(){var result=false;var val=this.getProperty('locked');if(val&&(val==='true')){result=true;}return result;}proto.isLocked=isLocked;function moveScreenSpace(view,x,y,dx,dy){
var action={};var attribs={};var xyStartPt;var xyEndPt;var uvStartPt;var uvEndPt;var viewArea;viewArea=this.getViewAreaForView(view);if(viewArea&&viewArea.canMapScreenToDesign()){xyStartPt=new zazzle.rlv.Point(x,y);
xyEndPt=new zazzle.rlv.Point(x+dx,y+dy);uvStartPt=viewArea.screenSpaceToDesignSpace(xyStartPt);uvEndPt=viewArea.screenSpaceToDesignSpace(xyEndPt);attribs.space='design';attribs.x=uvStartPt.x;attribs.y=uvStartPt.y;
attribs.dx=uvEndPt.x-uvStartPt.x;attribs.dy=uvEndPt.y-uvStartPt.y;}else{attribs.space='screen';attribs.x=x;attribs.y=y;attribs.dx=dx;attribs.dy=dy;}action.verb='move';action.attribs=attribs;this.pendingActions.push(action);
this.setDirty();return this;}proto.moveScreenSpace=moveScreenSpace;function moveDesignSpace(x,y,dx,dy){var action={};var attribs={};attribs.space='design';if((typeof x==='number')&&(typeof y==='number')){
attribs.x=x;attribs.y=y;}if((typeof dx==='number')&&(typeof dy==='number')){attribs.dx=dx;attribs.dy=dy;}action.verb='move';action.attribs=attribs;this.pendingActions.push(action);this.setDirty();return this;
}proto.moveDesignSpace=moveDesignSpace;function moveObjectSpace(x,y,dx,dy){var action={};var attribs={};attribs.space='object';if((typeof x==='number')&&(typeof y==='number')){attribs.x=x;attribs.y=y;
}if((typeof dx==='number')&&(typeof dy==='number')){attribs.dx=dx;attribs.dy=dy;}action.verb='move';action.attribs=attribs;this.pendingActions.push(action);this.setDirty();return this;}proto.moveObjectSpace=moveObjectSpace;
function scale(xscale,yscale,absolute){var action={};var attribs={};attribs.xscale=xscale;attribs.yscale=yscale;attribs.abs=absolute?'true':'false';action.verb='scale';action.attribs=attribs;this.pendingActions.push(action);
this.setDirty();return this;}proto.scale=scale;function rotate(angle,absolute){var action={};var attribs={};attribs.angle=angle;attribs.abs=absolute?'true':'false';action.verb='rotate';action.attribs=attribs;
this.pendingActions.push(action);this.setDirty();return this;}proto.rotate=rotate;function setDirty(){this.dirty=true;this.designArea.setDirty();}proto.setDirty=setDirty;function buildSubRequest(){var req='';
var k;var prop;var action;var setAttribs={};var setAttribsChanged;var setUnsafeChars;var pattern;var aName;var aValue;setAttribsChanged=false;setUnsafeChars=false;setAttribs={};pattern=/[\t\n\v\f\r]/;
for(k=0;k<this.properties.length;k++){prop=this.properties[k];if(prop&&(prop instanceof zazzle.rlv.DesignProperty)){if(prop.changed){setAttribs[prop.name]=prop.value;if(typeof prop.value==='string'&&prop.value.search(pattern)!== -1){
setUnsafeChars=true;}setAttribsChanged=true;prop.changed=false;}}}if(setAttribsChanged){if(setUnsafeChars){req=req+zazzle.util.xmlStartElement('set',{},false);for(aName in setAttribs){if(setAttribs.hasOwnProperty(aName)){
aValue=setAttribs[aName];req=req+zazzle.util.xmlStartElement(aName,{},false);req=req+zazzle.util.xmlSafe(aValue,false);req=req+zazzle.util.xmlEndElement(aName);}}req=req+zazzle.util.xmlEndElement('set');
}else{req=req+zazzle.util.xmlStartElement('set',setAttribs,true);}}setAttribsChanged=false;setAttribs={};for(k=0;k<this.attributes.length;k++){prop=this.attributes[k];if(prop&&(prop instanceof zazzle.rlv.DesignProperty)){
if(prop.changed){setAttribs[prop.name]=prop.value;setAttribsChanged=true;prop.changed=false;}}}if(setAttribsChanged){req=req+zazzle.util.xmlStartElement('setattr',setAttribs,true);}if(this.removeTheTemplate){
req=req+zazzle.util.xmlStartElement('template',{},true);this.removeTheTemplate=false;}if(this.template.urlkey){req=req+zazzle.util.xmlStartElement('template',this.template,true);this.template={};}if(this.pendingActions.length>0){
for(k=0;k<this.pendingActions.length;k++){action=this.pendingActions[k];req=req+zazzle.util.xmlStartElement(action.verb,action.attribs,true);}this.pendingActions=[];}return req;}proto.buildSubRequest=buildSubRequest;
function handleServerResponse(rspobj){var tempArray;if(rspobj&&typeof rspobj==='object'){if(rspobj.name){this.name=rspobj.name;}tempArray=zazzle.rlv.convertToPointArray(rspobj.bounds);if(tempArray.length>0){
this.bounds=tempArray;}tempArray=zazzle.rlv.convertToPointArray(rspobj.outline);if(tempArray.length>0){this.outline=tempArray;}tempArray=zazzle.rlv.convertToPointArray(rspobj.contentoutline);if(tempArray.length>0){
this.contentOutline=tempArray;}this.properties=zazzle.rlv.convertToPropertyArray(rspobj.properties);if(rspobj.matrix){this.matrix=rspobj.matrix;}if(rspobj.urlkey){this.urlkey=rspobj.urlkey;}if(rspobj.colors&&typeof rspobj.colors==='string'){
this.colors=rspobj.colors.split(',');}this.handleServerResponseSpecialized(rspobj);this.dirty=false;}}proto.handleServerResponse=handleServerResponse;function setAddAfterObject(afterObj){if(afterObj&&(afterObj instanceof zazzle.rlv.DesignObject)){
this.addAfterName=afterObj.getName();}}proto.setAddAfterObject=setAddAfterObject;function getUrlKey(){return this.urlkey;}proto.getUrlKey=getUrlKey;};f(zazzle.rlv.DesignImage.prototype);f(zazzle.rlv.DesignText.prototype);
f(zazzle.rlv.DesignGroup.prototype);f(zazzle.rlv.DesignEmbed.prototype);f(zazzle.rlv.DesignPath.prototype);}());(function(){zazzle.rlv.DesignEvent=function DesignEvent(type,success,design,view){if(!(this instanceof zazzle.rlv.DesignEvent)){
return new zazzle.rlv.DesignEvent(type,success,design,view);}this.type=type;this.success=success;this.design=design;this.view=view;};zazzle.rlv.DesignListener=function DesignListener(sequenceId){if(!(this instanceof zazzle.rlv.DesignListener)){
return new zazzle.rlv.DesignListener(sequenceId);}this.getSequenceId=function(){return sequenceId;};};}());zazzle.rlv.DesignViewAnnotation=function DesignViewAnnotation(view){if(!(this instanceof zazzle.rlv.DesignViewAnnotation)){
return new zazzle.rlv.DesignViewArea(view);}var grid=[];var ident='';this.view=view;this.design=view.getZDesign();this.isValid=function(){var result=false;if((ident.length>0)&&(grid.length===12)){result=true;
}return result;};this.getIdent=function(){return ident;};this.getBounds=function(){var xCenter;var yCenter;var width;var height;var ptMin=new zazzle.rlv.Point(0.0,0.0);var ptMax=new zazzle.rlv.Point(0.0,0.0);
var maxDim=this.view.opts.max_dim;if(typeof maxDim!=='number'){maxDim=512;}if(grid.length===12){xCenter=grid[0];yCenter=grid[1];width=grid[8];height=grid[9];ptMin.x=(xCenter-(width/2.0))*maxDim;ptMin.y=(yCenter-(height/2.0))*maxDim;
ptMax.x=(xCenter+(width/2.0))*maxDim;ptMax.y=(yCenter+(height/2.0))*maxDim;}var result=[ptMin,ptMax];return result;};this.handleServerResponse=function(rspwireframe){var tempArray;if(rspwireframe&&typeof rspwireframe==='object'){
tempArray=zazzle.rlv.convertToPointArray(rspwireframe.grid);if(tempArray.length>0){grid=tempArray;}if(rspwireframe.annotation&&typeof rspwireframe.annotation==='string'){ident=rspwireframe.annotation;
}}};};zazzle.rlv.DesignConstraint=function DesignConstraint(area,level,objects,type){if(!(this instanceof zazzle.rlv.DesignConstraint)){return new zazzle.rlv.DesignConstraint(area,level,objects,type);
}this.area='';if(area&&typeof area==='string'){this.area=area;}this.level='';if(level&&typeof level==='string'){this.level=level;}this.objects='';if(objects&&typeof objects==='string'){this.objects=objects;
}this.type='';if(type&&typeof type==='string'){this.type=type;}};zazzle.rlv.DesignTemplate=function DesignTemplate(data){if(!(this instanceof zazzle.rlv.DesignTemplate)){return new zazzle.rlv.DesignTemplate(data);
}this.type=0;this.value='';this.ppshow=false;this.title='';this.urlkey='';for(var key in data){var newValue=data[key];var prevValue=this[key];if(prevValue!==undefined&&typeof newValue!==typeof prevValue){
continue;}this[key]=newValue;}};zazzle.rlv.DesignProperty=function DesignProperty(name,value){if(!(this instanceof zazzle.rlv.DesignProperty)){return new zazzle.rlv.DesignProperty(name,value);}this.name=name;
this.value=value;this.changed=false;};zazzle.rlv.DesignFill=function DesignFill(solid,fillcolor,strokecolor,strokewidth){if(!(this instanceof zazzle.rlv.DesignFill)){return new zazzle.rlv.DesignFill(solid,fillcolor,strokecolor,strokewidth);
}if(typeof solid==='boolean'){this.solid=solid;}if(fillcolor&&typeof fillcolor==='string'){this.fillcolor=fillcolor;}if(strokecolor&&typeof strokecolor==='string'){this.strokecolor=strokecolor;}if(strokewidth&&typeof strokewidth==='number'){
this.strokewidth=strokewidth;}};zazzle.rlv.DesignFont=function DesignFont(face,style,height,weight,color,minheight,maxheight){if(!(this instanceof zazzle.rlv.DesignFont)){return new zazzle.rlv.DesignFont(face,style,height,weight,color,minheight,maxheight);
}this.face=face;this.style=style;this.height=height;this.weight=weight;this.color=color;this.minheight=minheight;this.maxheight=maxheight;};zazzle.rlv.Point=function Point(x,y){if(!(this instanceof zazzle.rlv.Point)){
return new zazzle.rlv.Point(x,y);}this.x=x;this.y=y;};zazzle.rlv.convertToPointArray=function(inarray){var outarray=[];var p;var k;if(zazzle.util.isArray(inarray)){for(k=0;k<inarray.length;k=k+2){p=new zazzle.rlv.Point(inarray[k],inarray[k+1]);
outarray.push(p);}}return outarray;};zazzle.rlv.convertToPropertyArray=function(inarray){var properties=[];var obj;var name;var value;var prop;var k;if(zazzle.util.isArray(inarray)){for(k=0;k<inarray.length;k++){
obj=inarray[k];if(obj&&typeof obj==='object'){name=obj.name;value=obj.value;if(name&&value&&typeof name==='string'){prop=new zazzle.rlv.DesignProperty(name,value);properties.push(prop);}}}}return properties;
};zazzle.rlv.lookupResponseProperty=function(inarray,propname){var k;var obj;var result;if(zazzle.util.isArray(inarray)&&propname&&typeof propname==='string'){for(k=0;k<inarray.length;k++){obj=inarray[k];
if(obj&&typeof obj==='object'&&propname===obj.name){result=obj.value;break;}}}return result;};if(typeof zazzle.product==='undefined')zazzle.product={};zazzle.product.Realviews=function Realviews(opts){
if(!(this instanceof zazzle.product.Realviews))return new zazzle.product.Realviews(opts);this.opts=opts;this.ready=false;this.success=false;var url='/svc/product/realviews/get?output=js';var onsuccess;
var onerror;var m=this;function ajaxCallback(response){if(response&&typeof response==='object'){m.ready=true;if(response.success&&response.data){m.success=true;m.realviews=response.data.realviews;m.contexts=response.data.contexts;
onsuccess&&onsuccess(m);}else{m.errorMessage=errmsg||'UNKNOWN';onerror&&onerror(m);}}}function ajaxErrorCallback(err,errmsg){m.ready=true;m.err=err;m.errorMessage=errmsg||'UNKNOWN';onerror&&onerror(m);
}if(opts&&typeof opts==='object'){onsuccess=opts.onsuccess;onerror=opts.onerror;for(var key in{pt:1,pd:1,dz:1,att:1,ppd:1,patt:1}){var value=opts[key];if(value)url=url+'&'+key+'='+escape(value);}zazzle.ajax.post(url,'',ajaxCallback,ajaxErrorCallback,this);
}};}});
Uize.module('Zazzle.Models');
Uize.module('Zazzle.Models.Rooter');
Uize.module({name:'Zazzle.Models.Rooter.DesignObject',superclass:'Zazzle.Model',required:['Uize.Data.Compare','Uize.Url','Zazzle.DesignModel'],builder:function(d_$){'use strict';var d__=true,d_a=false,
d_b=null,d_c,d_d=Uize,d_e=zazzle.rlv,d_f='none',d_g='fill',d_h='fit',d_i='center',d_j='leading',d_k='trailing',d_l='horz',d_m='vert',d_n='arc',d_o='rarc',d_p='group',d_q='image',d_r='text',d_s=d_b,d_t=function(d_u){return d_u=='true'},
d_v=function(d_w){return d_w+''},d_x=Math.pow(10,7),d_y=function(d_w){return Math.round(d_w*d_x)/d_x},d_z={d_A:{d_B:'alignI',d_C:'aligni'},d_D:{d_B:'alwaysVisible',d_C:'showalways',d_E:{bToA:d_t}},d_F:{
d_B:'cropBounds',d_C:'crop',d_E:{bToA:function(d_u){if(d_u){var d_F=d_u.split(',');return{left:d_F[0]*1,top:d_F[1]*1,width:d_F[2]-d_F[0],height:d_F[3]-d_F[1]};}else return d_u;}}},d_G:{d_B:'font',d_C:'face'
},d_H:{d_B:'fontSize',d_C:'height',d_E:{aToB:function(d_I){return d_y(d_I*this.d_J)+''},bToA:function(d_u){return d_y(+d_u/this.d_J)}}},d_K:{d_B:'imageTitle',d_C:'title'},d_L:{d_B:'imageType',d_C:'imagetype'
},d_M:{d_B:'layout',d_C:'layout'},d_N:{d_B:'locked',d_C:'locked',d_E:{bToA:d_t}},d_O:{d_B:'onTop',d_C:'ontop',d_E:{bToA:d_t}},d_P:{d_B:'textAlign',d_C:'align'},d_Q:{d_B:'textColor',d_C:'color'},d_R:{
d_B:'textPath',d_C:'path'},d_S:{d_B:'textPathArcRadius',d_C:'arcradius',d_E:{bToA:d_d.toNumber}},d_T:{d_B:'whiteAsTransparent',d_C:'whitetransparent',d_E:{bToA:d_t}}},d_U=(function(){var d_V={};for(var d_W in d_z){
var d_X=d_z[d_W],d_E=d_X.d_E=d_X.d_E||{};d_V[d_X.d_B]=d_X;d_X.d_W=d_W;d_E.aToB=d_E.aToB||d_v;d_E.bToA=d_E.bToA||d_d.returnX;}return d_V;})(),d_Y=d_d.map(d_U,function(d_X){return d_X.d_C}),d_Z=d_d.reverseLookup(d_Y),
d_0=d_d.Data.Compare.identical,d_1=function(d_2,d_3){return d_0(d_2,d_3)?d_3:d_2;},d_4=function(d_5){return d_Y[d_5];},d_6=function(){!this.is('preventRequestPush')&&this.fire('Request Push');},d_7=function(d_8){
return d_Z[d_8];},d_9=function(){var m=this,d_$_=m.d___(),d_a_=m.d_b_;if(!m.is('preventRequestPush')){if(d_a_)d_$_.setTemplate(d_a_,m.d_c_,m.d_d_);else d_$_.removeTemplate();if(m.d_e_==d_q)m.d_f_('fillmode',m.d_g_||d_f);
m.d_6();}};return d_$.subclass({staticProperties:{FillMode:{None:d_f,Fill:d_g,Fit:d_h},TextAlign:{Center:d_i,Left:d_j,Right:d_k},TextPath:{Horizontal:d_l,Vertical:d_m,ArcUp:d_n,ArcDown:d_o},Type:{Group:d_p,
Image:d_q,Text:d_r,Unknown:d_s}},stateProperties:d_d.copyInto({d_h_:{name:'brokenConstraints',conformer:d_1},d_i_:'bounds',d_j_:{name:'canUnlock',value:d__},d_k_:{name:'childDesignObjects',conformer:d_1
},d_l_:{name:'childrenLookup',conformer:d_1,derived:{properties:'childDesignObjects',derivation:function(d_m_){var d_n_={};d_d.forEach(d_m_,function(d_o_){d_n_[d_o_.get('name')]=d_o_;});return d_n_;}
}},d_p_:'colors',d_q_:'contentOutline',d_r_:{name:'filteredBrokenConstraints',conformer:d_1},d_J:{name:'fontSizeFactor',onChange:function(){var m=this,d_s_=m.d_s_,d_t_=d_4('fontSize');if(d_s_&&d_t_ in d_s_){
var d_u_=m.d_v_;m.met('preventRequestPush');m.set({d_H:d_U.fontSize.d_E.bToA.call(this,d_s_[d_t_])});m.set('preventRequestPush',d_u_);}},value:10},d_w_:{name:'hasBrokenConstraints',derived:'brokenConstraints:!Uize.isEmpty(brokenConstraints)'
},d_x_:{name:'hasFilteredBrokenConstraints',derived:'filteredBrokenConstraints:!Uize.isEmpty(filteredBrokenConstraints)'},d_y_:'index',d_z_:'isInsideBleed',d_A_:'isOutsideSafeArea',d_B:'name',d_B_:'matrix',
d_C_:'outline',d_v_:'preventRequestPush',d_s_:{name:'properties',onChange:function(){var m=this,d_s_=m.d_s_,d_D_={};for(var d_8 in d_s_){var d_X=d_U[d_7(d_8)];if(d_X)d_D_[d_X.d_W]=d_X.d_E.bToA.call(m,d_s_[d_8]);
}m.set(d_D_);}},d_E_:'selected',d_F_:'styleRuns',d_g_:{name:'templateFillMode',onChange:d_9},d_d_:{name:'templateIsVisible',onChange:d_9},d_c_:{name:'templateTitle',onChange:d_9},d_b_:{name:'templateUrlKey',
onChange:d_9},d_G_:'temporaryZDesignObject',d_H_:'tentativelySelected',d_R:'textPath',d_I_:{name:'title',derived:{properties:'type,value,imageTitle',derivation:function(d_e_,d_w,d_K){var d_I_;if(d_e_==d_q)
d_I_=d_K;else if(d_e_==d_r)d_I_=d_w;return d_I_;}}},d_e_:'type',d_w:{name:'value',onChange:function(){var m=this,d_e_=m.d_e_,d_w=m.d_w,d_$_=m.d___();if(!m.is('preventRequestPush')){if(d_e_==d_q)d_$_.setImageid(d_w);
else if(d_e_==d_r)d_$_.setValue(d_w);m.d_6();}}}},d_d.map(d_z,function(d_X){var d_J_=d_X.d_B;return{name:d_J_,onChange:function(){var m=this;if(!m.is('preventRequestPush')){m.setRlvProperty(d_4(d_J_),
d_X.d_E.aToB.call(m,m.get(d_J_)));}}};})),staticMethods:{create:function(d_$_){var d_K_=new this();d_K_.update(d_$_);return d_K_;}},instanceMethods:{d___:function(){var d_$_=this.d_G_;if(!d_$_)this.fire({
name:'zdesignObject Needed',callback:function(d_L_){d_$_=d_L_;}});return d_$_;},d_6:d_6,d_f_:function(d_M_,d_u){var m=this,d_$_=m.d___(),d_N_=d_7(d_M_),d_X=d_U[d_N_];m.d_s_[d_M_]=d_u;if(d_$_.getProperty(d_M_)!=d_u){
d_$_.setProperty(d_M_,d_u);}if(d_N_)m.set(d_N_,d_X.d_E.bToA.call(m,d_u));},getRotationAngle:function(){return this.d___().getRotationAngle();},getThumbnailUrl:function(d_O_,d_P_,d_Q_,d_R_){return this.d_e_==d_q
?d_d.Url.resolve(d_O_,[{action:'getimage',max_dim:d_P_,id:this.d_w,square_it:d__,bg:d_Q_},d_R_]):d_b;},setRlvProperty:function(d_8,d_u){var m=this;if(!m.is('preventRequestPush')){m.d_f_(d_8,d_u);m.d_6();
}},update:function(d_$_){var m=this,d_S_=d_$_.properties,d_T_=d_$_.constructor,d_e_=d_T_==d_e.DesignImage?d_q:(d_T_==d_e.DesignText?d_r:(d_T_==d_e.DesignGroup?d_p:d_c)),d_s_={},d_g_,d_u_=m.d_v_;m.met('preventRequestPush');
for(var d_U_= -1;++d_U_<d_S_.length;){var d_V_=d_S_[d_U_],d_W_=d_V_.name,d_X_=d_V_.value;d_s_[d_W_]=d_X_;if(d_W_=='fillmode')d_g_=d_X_;}m.set(d_d.copyInto({d_s_:d_s_,d_F_:d_$_.styleRuns,d_G_:d_c,d_e_:d_e_,
d_g_:d_g_,d_b_:d_$_.urlkey,d_w:d_e_==d_q?d_$_.getImageid():(d_e_==d_r?d_$_.getValue():d_c)},d_d.map({bounds:1,colors:1,contentOutline:1,matrix:1,name:1},function(a,d_B){if(d_B=='bounds')return d_d.copy(d_$_[d_B]);
else return d_$_[d_B]})));var d_Y_={},d_Z_=[],d_0_,d_l_=m.d_l_||{};if(d_e_==d_p){d_d.forEach(d_$_.children,function(d_o_){d_Y_[d_o_.name]=d__;if(d_o_.name in d_l_){d_0_=d_l_[d_o_.name].update(d_o_);}
else{d_0_=Zazzle.Models.Rooter.DesignObject.create(d_o_);}});d_Z_.push(d_0_);}else d_d.forEach(d_l_,function(d_o_,d_B){if(!d_Y_[d_B]){d_o_.kill();delete m.d_k_[d_B];}});m.set({d_v_:d_u_});}}});}});
Uize.module({name:'Zazzle.Models.Rooter.DesignArea',superclass:'Zazzle.Model',required:['Uize.Data.Compare','Zazzle.DesignModel','Zazzle.Models.Rooter.DesignObject','Uize.Url'],builder:function(d_$){'use strict';
function d__(obj){var d_a={};Uize.forEach(obj,function(value,key){if(Uize.global().localStorage&&localStorage.debug){if(value in d_a){throw new Error("Object cannot be inverted as there are at least two keys ("+d_a[value]+", "+key+") with the same value ("+value+")");
}}d_a[value]=key;});return d_a;}var d_b=true,d_c=false,d_d=null,d_e,d_f=Uize,d_g=Zazzle,d_h=d_g.Models.Rooter.DesignObject,d_i=zazzle.rlv,d_j=1,d_k=2,d_l=4,d_m=8,d_n=16,d_o=32,d_p=512,d_q= -1,d_r='rdo',
d_s=d_h.Type,d_t=d_s.Group,d_u=d_s.Image,d_v=d_s.Text,d_w='horz',d_x='vert',d_y='group',d_z='individual',d_A=11,d_B=72,d_C=36,d_D=d_B/d_A/d_C,d_E='normal',d_F='macro',d_G='micro',d_H={position:.05,rotation:45,
scale:.1},d_I={position:{normal:1,macro:3,micro:.2},rotation:{normal:1,macro:2,micro:.5},scale:{normal:1,macro:3,micro:.2}},d_J=d_f.Data.Compare.identical,d_K=function(d_L,d_M){var d_N=d_E,d_O=d_H[d_L]
;if(d_M&&d_M.nudgeType)d_N=d_M.nudgeType;if(d_M&&d_M.nudgeAmount!==d_e)d_O=d_M.nudgeAmount;return d_I[d_L][d_N]*d_O;},d_P=function(d_Q){if(!d_f.isNumber(d_Q))return 0;else if(d_Q<0)return-1;else if(d_Q>0)
return 1;else return 0;},d_R=function(d_S,d_T){return d_J(d_S,d_T)?d_T:d_S;},d_U=function(d_V){return Math.round(d_V*Math.pow(10,14))/Math.pow(10,14);},d_W=function(d_X){function d_Y(d_Z){return(d_Z+0.5)*100}
return d_f.isPrimitive(d_X)?d_Y(d_X):d_f.map(d_X,d_Y);},d_0=function(d_1,d_2){return d_1*100/(d_2||d_p);},d_3=function(){return d_r+ ++d_q;},d_4={width:'width',height:'height',mirrorU:'mirroru',mirrorV:'mirrorv',
offsetU:'offsetu',offsetV:'offsetv',staggerU:'staggeru',staggerV:'staggerv',stepW:'stepw',stepH:'steph',stepR:'stepr',rotation:'rotate',pattern:'pattern',iScale:'iscale'},d_5=d__(d_4),d_6=function(d_M){
d_M=d_M||{};var d_7=[];Uize.forEach(d_M,function(d_Z,d_8){if(!(d_8 in d_4)){if(Uize.global().localStorage&&localStorage.debug){console.error("Passed tile parameter '"+d_8+"' which is unrecognized and so will be ignored valid values are: ",Uize.keys(d_4));
}return;}d_7.push(new d_i.DesignProperty(d_4[d_8],d_Z));});return d_7;},d_9=function(d_$_){var d___=Uize.Url.fromParams(d_$_);var d_a={};Uize.forEach(d___,function(value,key){if(!(key in d_5)){if(Uize.global().localStorage&&localStorage.debug){
console.error("Passed tile parameter '"+key+"' which is unrecognized and so will be ignored valid values are: ",Uize.keys(d_5));}return;}d_a[d_5[key]]=value;});return d_a;},d_a_=function(d_b_){var d_c_=[
'bottom','hcenter','vcenter','left','right','top'],d_d_=[];d_f.forEach(d_c_,function(d_e_,d_f_){if(1<<d_f_&d_b_)d_d_.push(d_e_);});if(d_d_.length==0)d_d_.push('hcenter');return d_d_;},d_g_=function(d_h_){
var d_i_={};d_f.forEach(d_h_,function(d_j_){for(var d_k_ in d_j_.designObjects){var d_l_=d_f.copy(d_j_);delete d_l_.designObjects;(d_i_[d_k_]=d_i_[d_k_]||[]).push(d_l_);}});return d_i_;},d_m_=function(d_n_,d_o_){
var d_p_={},d_q_=d_o_?d_f.keys(d_o_):d_d;d_f.forEach(d_n_,function(d_r_){if(d_f.isEmpty(d_q_)||d_J(d_o_,d_r_.get(d_q_)))d_p_[d_r_.get('name')]=d_r_;});return d_p_;},d_s_=function(d_M){if(!this.is('preventRequestPush'))
this.fire(d_f.copyInto({name:'Request Push'},d_M));},d_t_=function(d_X){function d_u_(d_Z){return d_Z/100-0.5}return d_f.isPrimitive(d_X)?d_u_(d_X):d_f.map(d_X,d_u_);},d_v_=function(d_w_,d_2){return d_w_/100*(d_2||d_p);
};return d_$.subclass({staticProperties:{AlignType:{Bottom:d_j,HorizontalCenter:d_k,VerticalCenter:d_l,Left:d_m,Right:d_n,Top:d_o},DistributeType:{Horizontal:d_w,Vertical:d_x},GroupingType:{Individual:d_z,
Group:d_y},NudgeType:{Normal:d_E,Macro:d_F,Micro:d_G},TilingTypes:Uize.map({none:{pattern:'none'},basic:{pattern:'basic'},halfBrick:{pattern:'halfBrick',staggerU:.5},halfDrop:{pattern:'halfDrop',staggerV:.5
},mirror:{pattern:'mirror',mirrorU: -1,mirrorV: -1}},function(d_Z){return Uize.copyInto({staggerU:0,staggerV:0,mirrorU:0,mirrorV:0},d_Z);})},stateProperties:{d_x_:'allowFill',d_y_:{name:'alwaysVisibleDesignObjects',
conformer:d_R,derived:{properties:'designObjects',derivation:function(d_n_){return d_m_(d_n_,{alwaysVisible:d_b});}}},d_z_:{name:'alwaysVisibleSelectedDesignObjects',conformer:d_R,derived:'selectedDesignObjects,alwaysVisibleDesignObjects:Uize.Data.Compare.intersection(selectedDesignObjects,alwaysVisibleDesignObjects)'
},d_A_:'areaGroupName',d_B_:'backgroundColor',d_C_:'backgroundIsSolid',d_D_:'bleedMargins',d_E_:'borderColor',d_F_:'borderWidth',d_h_:{name:'brokenConstraints',conformer:d_R},d_G_:{derived:'brokenConstraints,designObjectsLookup:Math.random()',
onChange:function(){var m=this,d_p_=m.d_p_;if(!d_f.isEmpty(d_p_)){var d_i_=d_g_(m.d_h_);for(var d_H_ in d_p_){d_p_[d_H_].set('bBrokenConstraints',d_i_[d_H_]||[]);}}}},d_I_:'canEditDesignObjectLock',d_J_:{
name:'colors',conformer:d_R},d_K_:'deferAddingDesignObjects',d_L_:{derived:{properties:'backgroundColor,backgroundIsSolid,borderColor,borderWidth',derivation:function(d_B_,d_C_,d_E_,d_F_){return new d_i.DesignFill(d_C_,d_B_,d_E_,d_F_);
}},onChange:function(){var m=this,d_M_=m.d_M_;if(d_M_){var d_L_=m.d_L_,d_N_=d_M_.getFill()||new d_i.DesignFill(),d_O_=function(d_P_){var d_Q_=d_N_[d_P_]&&d_N_[d_P_].toLowerCase(),d_R_=d_L_[d_P_]&&d_L_[d_P_].toLowerCase(),
d_O_=d_c;if(!d_Q_&&d_R_&&d_R_!='00ffffff')d_O_=d_b;else if(d_Q_&&d_Q_!=d_R_)d_O_=d_b;return d_O_;};if(d_N_.solid!=d_L_.solid||d_O_('fillcolor')||d_O_('strokecolor')||d_N_.strokewidth!=d_L_.strokewidth
){d_M_.setFill(d_L_);m.d_s_();}}}},d_n_:{name:'designObjects',onChange:function(){var m=this;d_f.forEach(m.d_n_,function(d_r_,d_S_){d_r_.set('index',d_S_)});}},d_T_:{name:'designObjectsBoundsInDesignSpace',
conformer:d_R,derived:{properties:'designObjects,updateCount',derivation:function(d_n_){return d_f.map(d_n_,function(d_r_){return d_r_.get('bounds')});}}},d_U_:{name:'designObjectsInsideBleed',conformer:d_R,
onChange:function(){var m=this,d_U_=m.d_U_;d_f.forEach(m.d_n_,function(d_r_){d_r_.set('isInsideBleed',d_r_.get('name')in d_U_);});}},d_p_:{name:'designObjectsLookup',conformer:d_R,derived:{properties:'designObjects',
derivation:function(d_n_){var d_p_={};if(!d_f.isEmpty(d_n_)){for(var d_V_= -1;++d_V_<d_n_.length;){var d_r_=d_n_[d_V_];d_p_[d_r_.get('name')]=d_r_;}}return d_p_;}}},d_W_:{name:'designObjectsOutsideSafeArea',
conformer:d_R,onChange:function(){var m=this,d_W_=m.d_W_;d_f.forEach(m.d_n_,function(d_r_){d_r_.set('isOutsideSafeArea',d_r_.get('name')in d_W_);});}},d_X_:{name:'filteredBrokenConstraints',conformer:d_R
},d_Y_:{derived:'filteredBrokenConstraints,designObjects:Math.random()',onChange:function(){var m=this,d_p_=m.d_p_;if(!d_f.isEmpty(d_p_)){var d_i_=d_g_(m.d_X_);for(var d_H_ in d_p_){d_p_[d_H_].set('filteredBrokenConstraints',d_i_[d_H_]||[]);
}}}},d_Z_:{name:'firstSelectedDesignObject',derived:'selectedDesignObjects: !Uize.isEmpty(selectedDesignObjects) && selectedDesignObjects[Uize.keys(selectedDesignObjects)[0]]'},d_0_:{name:'fontSizeFactor',
derived:{properties:'physicalWidth,physicalHeight',derivation:function(d_1_,d_2_){return d_D*Math.max(d_1_,d_2_);}}},d_3_:{derived:'designObjects,fontSizeFactor:Math.random()',onChange:function(){var m=this;
m.d_4_({fontSizeFactor:m.d_0_},{objectBlob:m.d_n_});}},d_5_:{name:'groupDesignObjects',conformer:d_R,derived:{properties:'designObjects',derivation:function(d_n_){return d_m_(d_n_,{type:d_t});}}},d_6_:{
name:'hasAllSelectedDesignObjects',derived:'totalSelectedDesignObjects,totalDesignObjects:totalSelectedDesignObjects == totalDesignObjects'},d_7_:{name:'hasAllSelectedDesignObjectsAlwaysVisible',derived:'totalAlwaysVisibleSelectedDesignObjects,totalSelectedDesignObjects:totalAlwaysVisibleSelectedDesignObjects == totalSelectedDesignObjects'
},d_8_:{name:'hasAllSelectedDesignObjectsLocked',derived:'totalLockedSelectedDesignObjects,totalSelectedDesignObjects:totalLockedSelectedDesignObjects == totalSelectedDesignObjects'},d_9_:{name:'hasAllSelectedDesignObjectsTemplated',
derived:{properties:'selectedDesignObjects',derivation:function(d_$a){var d__a=true;for(var d_H_ in d_$a)if(!d_$a[d_H_].get('templateUrlKey')){d__a=false;break;}return d__a;}}},d_aa:{name:'hasAllSelectedDesignObjectsTiledLegacy',
derived:{properties:'selectedDesignObjects',derivation:function(d_$a){return d_f.keys(d_m_(d_$a,{layout:'tile'})).length==d_f.keys(d_$a).length;}}},d_ba:{name:'hasAllSelectedDesignObjectsUnlocked',derived:'totalLockedSelectedDesignObjects,totalSelectedDesignObjects:totalLockedSelectedDesignObjects == 0 && totalSelectedDesignObjects > 0'
},d_ca:{name:'hasAllSelectedDesignObjectsWhiteAsTransparent',derived:{properties:'selectedDesignObjects',derivation:function(d_$a){return d_f.keys(d_m_(d_$a,{whiteAsTransparent:d_b})).length==d_f.keys(d_$a).length;
}}},d_da:{name:'hasBleed',derived:{properties:'bleedMargins',derivation:function(d_D_){return d_D_&&(d_D_.bottom!=0||d_D_.left!=0||d_D_.right!=0||d_D_.top!=0);}}},d_ea:{name:'hasBrokenConstraints',derived:'brokenConstraints:!Uize.isEmpty(brokenConstraints)'
},d_fa:{name:'hasDesignObjects',derived:'totalDesignObjects:!Uize.isEmpty(totalDesignObjects)'},d_ga:{name:'hasFilteredBrokenConstraints',derived:'filteredBrokenConstraints:!Uize.isEmpty(filteredBrokenConstraints)'
},d_ha:{name:'hasMultipleDesignObjects',derived:'totalDesignObjects:totalDesignObjects > 1'},d_ia:{name:'hasMultipleSelectedDesignObjects',derived:'totalSelectedDesignObjects:totalSelectedDesignObjects > 1'
},d_ja:{name:'hasMultipleUnlockedSelectedDesignObjects',derived:'totalUnlockedSelectedDesignObjects:totalUnlockedSelectedDesignObjects > 1'},d_ka:{name:'hasSafeArea',derived:{properties:'safeAreaMargins',
derivation:function(d_la){return d_la&&(d_la.bottom!=0||d_la.left!=0||d_la.right!=0||d_la.top!=0);}}},d_ma:{name:'hasSelectedDesignObjects',derived:'totalSelectedDesignObjects:!Uize.isEmpty(totalSelectedDesignObjects)'
},d_na:{name:'hasSingleDesignObject',derived:'totalDesignObjects:totalDesignObjects == 1'},d_oa:{name:'hasSingleSelectedDesignObject',derived:'totalSelectedDesignObjects:totalSelectedDesignObjects == 1'
},d_pa:{name:'hasSingleSelectedDesignObjectTypeIsImage',derived:'hasSingleSelectedDesignObject,selectedDesignObjectsTypeIsImage'},d_qa:{name:'hasSingleSelectedDesignObjectTypeIsText',derived:'hasSingleSelectedDesignObject,selectedDesignObjectsTypeIsText'
},d_ra:{name:'hasSingleUnlockedSelectedDesignObjectTypeIsImage',derived:'hasSingleSelectedDesignObjectTypeIsImage,totalUnlockedSelectedDesignObjects:hasSingleSelectedDesignObjectTypeIsImage && totalUnlockedSelectedDesignObjects > 0'
},d_sa:{name:'hasUnlockedSelectedDesignObjects',derived:'totalUnlockedSelectedDesignObjects:totalUnlockedSelectedDesignObjects > 0'},d_ta:{name:'hasTemplateFields',derived:'templateFields:!Uize.isEmpty(templateFields)'
},d_ua:{name:'imageDesignObjects',conformer:d_R,derived:{properties:'designObjects',derivation:function(d_n_){return d_m_(d_n_,{type:d_u});}}},d_va:{name:'isEmpty',derived:{properties:'designObjects,backgroundColor,borderColor',
derivation:function(d_n_,d_B_,d_E_){return d_f.isEmpty(d_n_)&&d_f.isEmpty(d_B_)&&d_f.isEmpty(d_E_);}}},d_wa:{name:'isTilable',derived:'properties: !!properties.zigtile'},d_xa:{name:'lastDesignObject',
derived:'designObjects: !Uize.isEmpty(designObjects) && designObjects[designObjects.length - 1]'},d_ya:{name:'lockedDesignObjects',conformer:d_R,derived:{properties:'designObjects',derivation:function(d_n_){
return d_m_(d_n_,{locked:d_b});}}},d_za:{name:'lockedSelectedDesignObjects',conformer:d_R,derived:'selectedDesignObjects,lockedDesignObjects:Uize.Data.Compare.intersection(selectedDesignObjects,lockedDesignObjects)'
},d_e_:{name:'name',onChange:function(){var m=this;if(!m.is('preventRequestPush')){m.d_M_.setName(m.d_e_);m.fire('Start Queueing View Area Needed Requests');m.d_s_();}}},d_2_:{name:'physicalHeight',value:1
},d_1_:{name:'physicalWidth',value:1},d_Aa:'preventRequestPush',d_Ba:{name:'properties',conformer:d_R},d_Ca:{name:'RLVProperties',value:{}},d_Da:{name:'RLVLayout',derived:'RLVProperties: RLVProperties.layout || ""'
},d_Ea:{name:'RLVLayoutParams',conformer:d_R,derived:{properties:'RLVProperties',derivation:function(RLVProperties){return d_9(RLVProperties.layoutparams||"");}}},d_Fa:{name:'RLVLayoutRotation',derived:'RLVLayoutParams: RLVLayoutParams["rotation"]'
},d_Ga:{name:'ratio',derived:'physicalHeight,physicalWidth:physicalHeight == 0 ? 0 : physicalWidth / physicalHeight'},d_la:'safeAreaMargins',d_$a:'selectedDesignObjects',d_Ha:{name:'selectedDesignObjectsType',
conformer:d_R,derived:{properties:'selectedDesignObjects',derivation:function(d_$a){var d_Ha=d_e;for(var d_H_ in d_$a){var d_Ia=d_$a[d_H_].get('type');if(d_Ha&&d_Ha!=d_Ia){d_Ha=d_d;break;}else d_Ha=d_Ia;
}return d_Ha;}}},d_Ja:{name:'selectedDesignObjectsTypeIsImage',derived:'selectedDesignObjectsType:selectedDesignObjectsType == Zazzle.Models.Rooter.DesignObject.Type.Image'},d_Ka:{name:'selectedDesignObjectsTypeIsMixed',
derived:'selectedDesignObjectsType,hasSelectedDesignObjects:hasSelectedDesignObjects && selectedDesignObjectsType == undefined'},d_La:{name:'selectedDesignObjectsTypeIsText',derived:'selectedDesignObjectsType: selectedDesignObjectsType == Zazzle.Models.Rooter.DesignObject.Type.Text'
},d_Ma:{name:'singleSelectedDesignObject',derived:{properties:'hasSingleSelectedDesignObject,selectedDesignObjects',derivation:function(d_oa,d_$a){var d_r_;if(d_oa){for(var d_H_ in d_$a)d_r_=d_$a[d_H_];
}return d_r_;}}},d_Na:{name:'singleSelectedImageDesignObject',derived:'singleSelectedDesignObject,selectedDesignObjectsTypeIsImage:selectedDesignObjectsTypeIsImage ? singleSelectedDesignObject : undefined'
},d_Oa:{name:'singleSelectedTextDesignObject',derived:'singleSelectedDesignObject,selectedDesignObjectsTypeIsText:selectedDesignObjectsTypeIsText ? singleSelectedDesignObject : undefined'},d_Pa:{name:'templateFieldNames',
derived:'templateFields: Uize.map(templateFields, function(templateField) { return templateField.name })'},d_Qa:{name:'templateFields',conformer:d_R,onChange:function(){var m=this,d_Qa=m.d_Qa,d_Ra={}
;d_f.forEach(d_Qa,function(d_Sa){d_Ra[d_Sa.name]=d_Sa;});m.d_Ta(function(d_r_){var d_Ua=d_r_.get('templateUrlKey');if(!d_f.isEmpty(d_Ra)&&d_Ua in d_Ra){var d_Va=d_Ra[d_Ua],d_Wa=d_r_.get('preventRequestPush')
;d_r_.met('preventRequestPush');d_r_.set({templateTitle:d_Va.nameVerbose,templateIsVisible:d_Va.ppShow});d_r_.set('preventRequestPush',d_Wa);}},m.d_n_);}},d_Xa:{name:'textDesignObjects',conformer:d_R,
derived:{properties:'designObjects',derivation:function(d_n_){return d_m_(d_n_,{type:d_v});}}},d_Ya:'title',d_Za:{name:'totalAlwaysVisibleSelectedDesignObjects',derived:'alwaysVisibleSelectedDesignObjects:Uize.keys(alwaysVisibleSelectedDesignObjects).length'
},d_0a:{name:'totalDesignObjects',derived:'designObjects:designObjects.length'},d_1a:{name:'totalLockedDesignObjects',derived:'lockedDesignObjects:Uize.keys(lockedDesignObjects).length'},d_2a:{name:'totalLockedSelectedDesignObjects',
derived:'lockedSelectedDesignObjects:Uize.keys(lockedSelectedDesignObjects).length'},d_3a:{name:'totalSelectedDesignObjects',derived:'selectedDesignObjects:Uize.keys(selectedDesignObjects).length'},d_4a:{
name:'totalUnlockedDesignObjects',derived:'unlockedDesignObjects:Uize.keys(unlockedDesignObjects).length'},d_5a:{name:'totalUnlockedSelectedDesignObjects',derived:'unlockedSelectedDesignObjects:Uize.keys(unlockedSelectedDesignObjects).length'
},d_6a:'transferableAreas',d_7a:{name:'unlockedDesignObjects',conformer:d_R,derived:{properties:'designObjects',derivation:function(d_n_){return d_m_(d_n_,{locked:d_c});}}},d_8a:{name:'unlockedSelectedDesignObjects',
conformer:d_R,derived:'selectedDesignObjects,unlockedDesignObjects:Uize.Data.Compare.intersection(selectedDesignObjects,unlockedDesignObjects)'},d_9a:{name:'unlockedSelectedDesignObjectsBoundsInDesignSpace',
derived:{properties:'unlockedSelectedDesignObjects,updateCount',derivation:function(d_8a){var d_$b=Infinity,d__b=Infinity,d_ab= -Infinity,d_bb= -Infinity;this.d_Ta(function(d_r_){var d_cb=d_r_.get('bounds');
if(!d_f.isEmpty(d_cb)){d_$b=Math.min(d_$b,d_cb[0].x);d__b=Math.min(d__b,d_cb[0].y);d_ab=Math.max(d_ab,d_cb[1].x);d_bb=Math.max(d_bb,d_cb[1].y);}},d_8a);return d_$b!=Infinity?[new d_i.Point(d_$b,d__b),
new d_i.Point(d_ab,d_bb)]:d_e;}}},d_db:{name:'unlockedSelectedDesignObjectsTypeIsImage',derived:'selectedDesignObjectsType,totalLockedSelectedDesignObjects:selectedDesignObjectsType == Zazzle.Models.Rooter.DesignObject.Type.Image && totalLockedSelectedDesignObjects == 0'
},d_eb:{name:'unlockedSelectedGroupDesignObjects',conformer:d_R,derived:'unlockedSelectedDesignObjects,groupDesignObjects:Uize.Data.Compare.intersection(unlockedSelectedDesignObjects,groupDesignObjects)'
},d_fb:{name:'unlockedSelectedImageDesignObjects',conformer:d_R,derived:'unlockedSelectedDesignObjects,imageDesignObjects:Uize.Data.Compare.intersection(unlockedSelectedDesignObjects,imageDesignObjects)'
},d_gb:{name:'unlockedSelectedTextDesignObjects',conformer:d_R,derived:'unlockedSelectedDesignObjects,textDesignObjects:Uize.Data.Compare.intersection(unlockedSelectedDesignObjects,textDesignObjects)'
},d_hb:{name:'updateCount',value:-1}},staticMethods:{create:function(d_M_){var d_ib=new this();d_ib.update(d_M_);return d_ib;},filterDesignObjects:d_m_,fromDesignSpace:d_W,toDesignSpace:d_t_},instanceMethods:{
d_jb:function(d_kb){var m=this;return{x:(d_kb.x+.5)*m.d_1_,y:(d_kb.y+.5)*m.d_2_};},d_Ta:function(d_lb,d_mb){d_f.forEach(this.d_nb(d_mb),d_lb);},d_ob:function(d_mb){var d_$b=Infinity,d__b=Infinity,d_ab= -Infinity,
d_bb= -Infinity;this.d_Ta(function(d_r_){var d_pb=d_r_.get('bounds');d_$b=Math.min(d_$b,d_pb[0].x);d__b=Math.min(d__b,d_pb[0].y);d_ab=Math.max(d_ab,d_pb[1].x);d_bb=Math.max(d_bb,d_pb[1].y);},d_mb);return d_$b!=Infinity
?{left:d_$b,top:d__b,width:d_ab-d_$b,height:d_bb-d_ab}:d_e;},d_nb:function(d_mb){var m=this,d_p_=m.d_p_,d_n_=[];if(!d_mb)d_mb=m.d_8a;if(d_mb&&d_mb.constructor==d_h)d_n_.push(d_mb);else if(d_f.isString(d_mb))
d_n_.push(d_p_[d_mb]);else if(d_f.isArray(d_mb)||d_f.isPlainObject(d_mb))d_f.forEach(d_mb,function(d_qb){m.d_Ta(function(d_r_){d_n_.push(d_r_);},d_qb);});return d_n_;},d_rb:function(d_sb,d_tb){var m=this,
d_ub=m.d_vb(d_tb),d_$b=Infinity,d__b=Infinity,d_ab= -Infinity,d_bb= -Infinity,d_wb=d_sb.view;d_wb.mergeOptions({max_dim:d_p});d_f.forEach(d_ub,function(d_xb){var d_yb=d_xb.getBounds(d_wb);d_$b=Math.min(d_$b,d_yb[0].x);
d__b=Math.min(d__b,d_yb[0].y);d_ab=Math.max(d_ab,d_yb[1].x);d_bb=Math.max(d_bb,d_yb[1].y);});return d_$b!=Infinity?{left:d_0(d_$b),top:d_0(d__b),width:d_0(d_ab-d_$b),height:d_0(d_bb-d__b)}:d_e;},d_vb:function(d_mb
){var m=this,d_ub=[];m.d_Ta(function(d_r_){d_ub.push(m.d_zb(d_r_))},d_mb);return d_ub;},d_zb:function(d_r_){return this.d_M_.getChildObjectsLookup()[d_r_.get('name')];},d_Ab:function(d_Bb){var m=this;
return{x:d_Bb.x/m.d_1_-.5,y:d_Bb.y/m.d_2_-.5};},d_s_:d_s_,d_4_:function(d_Ba,d_M){this.d_Ta(function(d_r_){d_r_.set(d_Ba)},d_M&&d_M.objectBlob);},addDesignObjects:function(d_Cb,d_M){var m=this,d_n_=d_f.isArray(d_Cb)?d_Cb:[d_Cb],
d_M_=m.d_M_;if(!d_f.isEmpty(d_n_)){if(m.d_K_){m.fire({name:'Smart Template Object Added',designObject:d_n_[0]});}else{var d_Db=[];d_f.forEach(d_n_,function(d_Eb){var d_xb,d_Fb;if(d_Eb.type==d_v)d_xb=d_M_.addText(d_3(),d_Eb.value);
else if(d_Eb.type==d_u)d_xb=d_M_.addImage(d_3(),d_Eb.value);if(d_xb){d_Fb=d_h.create(d_xb);d_Fb.set({fontSizeFactor:m.d_0_,temporaryZDesignObject:d_xb});d_Db.push(d_Fb);}});if(!d_f.isEmpty(d_Db)){var
 d_Gb=d_M&&d_M.modifyNewlyCreated,d_s_=function(){m.d_s_()};if(d_f.isFunction(d_Gb))d_Gb.call(m,d_Db,d_s_);else d_s_();}}}},alignDesignObjects:function(d_Hb,d_M){var m=this,d_ub=m.d_vb(d_M&&d_M.objectBlob),
d_c_=d_a_(d_Hb);if(!d_f.isEmpty(d_ub)){d_f.forEach(d_c_,function(d_Ib){m.d_M_.layout(d_ub,'align',[new d_i.DesignProperty('align',d_Ib),new d_i.DesignProperty('alignto','objects'),new d_i.DesignProperty('group',d_c)
],d_M&&d_M.persist);});m.d_s_();}},clearDesignObjects:function(){this.removeDesignObjects({objectBlob:this.d_7a});},clearDesignObjectsTemplates:function(d_M){var m=this,d_ub=m.d_vb(d_M&&d_M.objectBlob)
;if(!d_f.isEmpty(d_ub))d_f.forEach(d_ub,function(d_xb){d_xb.removeTemplate();});},copyDesignObjects:function(d_M){var m=this,d_ub=m.d_vb(d_M&&d_M.objectBlob);if(!d_f.isEmpty(d_ub)){m.d_M_.copy(d_ub);
m.d_s_();}},cropDesignObjects:function(d_Jb,d_M){var m=this,d_ub=m.d_vb((d_M&&d_M.objectBlob)||m.d_fb),d_Kb=[d_Jb.left,d_Jb.top,d_Jb.left+d_Jb.width,d_Jb.top+d_Jb.height],d_Lb='['+d_f.map(d_Kb,function(d_Mb){return d_U(d_Mb)}).join(', ')+']'
;d_f.forEach(d_ub,function(d_xb){m.d_M_.crop([d_xb],d_Lb);});if(!d_f.isEmpty(d_ub))m.d_s_();},cutDesignObjects:function(d_M){var m=this,d_ub=m.d_vb(d_M&&d_M.objectBlob);if(!d_f.isEmpty(d_ub)){m.d_M_.cut(d_ub);
m.d_s_();}},deselectDesignObjects:function(d_M){this.d_4_({selected:d_c},d_f.copyInto({optionsBlob:this.d_n_},d_M));},distributeDesignObjects:function(d_Nb,d_M){var m=this,d_ub=m.d_vb(d_M&&d_M.objectBlob)
;if(!d_f.isEmpty(d_ub)){m.d_M_.layout(d_ub,(d_Nb==d_x)?d_x:d_w,[],d_M&&d_M.persist);m.d_s_();}},duplicateDesignObjects:function(d_M){var m=this,d_ub=m.d_vb(d_M&&d_M.objectBlob);if(!d_f.isEmpty(d_ub)){
m.d_M_.copy(d_ub);m.d_M_.paste();m.d_s_();}},getContainingDesignObjectsInScreenSpace:function(d_Ob,d_Pb,d_Qb,d_M){var m=this,d_tb=(d_M&&d_M.objectBlob)||m.d_7a,d_ub=m.d_vb(d_tb);if(!d_f.isEmpty(d_ub)){
m.fire({name:'View Area Needed',realviewId:d_Pb,callback:function(d_sb){var d_Rb={};m.d_Ta(function(d_r_){var d_Sb=m.d_rb(d_sb,d_r_);if(d_Sb.left>=d_Ob.left&&d_Sb.left+d_Sb.width<=d_Ob.left+d_Ob.width&&
d_Sb.top>=d_Ob.top&&d_Sb.top+d_Sb.height<=d_Ob.top+d_Ob.height)d_Rb[d_r_.get('name')]=d_r_;},d_tb);d_Qb(d_Rb);}});}else d_Qb&&d_Qb();},getDesignObjectsBoundsInScreenSpace:function(d_Pb,d_Qb,d_M){d_M=d_M||{};
var m=this,d_tb=d_M.objectBlob,d_Tb=function(d_Ub){d_f.isFunction(d_Qb)&&d_Qb(d_Ub);};if(!d_f.isEmpty(m.d_vb(d_tb))){m.fire({name:'View Area Needed',realviewId:d_Pb,callback:function(d_sb){if(d_M.groupingType==d_z){
var d_Vb=[];m.d_Ta(function(d_r_){d_Vb.push(m.d_rb(d_sb,d_r_));},d_tb);d_Tb(d_Vb);}else d_Tb(m.d_rb(d_sb,d_tb));}});}else d_Tb();},getIntersectingDesignObjectsInScreenSpace:function(d_Ob,d_Pb,d_Qb,d_M){
var m=this,d_tb=(d_M&&d_M.objectBlob)||m.d_7a,d_ub=m.d_vb(d_tb);if(!d_f.isEmpty(d_ub)){m.fire({name:'View Area Needed',realviewId:d_Pb,callback:function(d_sb){var d_Rb={};m.d_Ta(function(d_r_){var d_Sb=m.d_rb(d_sb,d_r_),
d_Wb=d_Sb.left+d_Sb.width<d_Ob.left||d_Sb.left>d_Ob.left+d_Ob.width||d_Sb.top+d_Sb.height<d_Ob.top||d_Sb.top>d_Ob.top+d_Ob.height;if(!d_Wb)d_Rb[d_r_.get('name')]=d_r_;},d_tb);d_Qb(d_Rb);}});}else d_Qb&&d_Qb();
},groupDesignObjects:function(d_e_,d_M){var m=this,d_M_=m.d_M_,d_ub=m.d_vb(d_M&&d_M.objectBlob);if(!d_f.isEmpty(d_ub)){d_M_.group(d_e_,d_ub);m.d_s_();}},moveDesignObjectsInDesignSpaceBy:function(d_Xb,d_Yb,d_M){
var m=this,d_M_=m.d_M_,d_ub=m.d_vb(d_M&&d_M.objectBlob);if(!d_f.isEmpty(d_ub)){if(d_M&&d_M.groupingType==d_z)d_f.forEach(d_ub,function(d_xb){d_M_.moveDesignSpace([d_xb],d_e,d_e,d_Xb,d_Yb);});else d_M_.moveDesignSpace(d_ub,d_e,d_e,d_Xb,d_Yb);
m.d_s_();}},moveDesignObjectsInDesignSpaceTo:function(d_Zb,d_0b,d_M){d_M=d_M||{};var m=this,d_M_=m.d_M_,d_ub=m.d_vb(d_M.objectBlob);if(!d_f.isEmpty(d_ub)){var d_1b=function(d_2b){d_M_.moveDesignSpace(d_2b,d_Zb,d_0b);
};d_M.groupingType==d_z?d_f.forEach(d_ub,d_1b):d_1b(d_ub);m.d_s_();}},moveDesignObjectsInPhysicalSpaceBy:function(d_Xb,d_Yb,d_M){var m=this;return m.moveDesignObjectsInDesignSpaceBy(d_Xb/m.d_1_,d_Yb/m.d_2_,
d_M);},moveDesignObjectsInPhysicalSpaceTo:function(d_Zb,d_0b,d_M){var m=this,d_kb=m.d_Ab({x:d_Zb,y:d_0b});m.moveDesignObjectsInDesignSpaceTo(d_kb.x,d_kb.y,d_M);},moveDesignObjectsInScreenSpaceBy:function(d_3b,d_4b,d_Xb,d_Yb,d_Pb,d_M){
var m=this,d_ub=m.d_vb(d_M&&d_M.objectBlob);if(!d_f.isEmpty(d_ub)){if(d_M&&d_M.groupingType==d_z)d_f.forEach(d_ub,function(d_xb){m.d_M_.moveScreenSpace([d_xb],d_v_(d_3b),d_v_(d_4b),d_Xb&&d_v_(d_Xb),d_Yb&&d_v_(d_Yb)
);});else m.d_M_.moveScreenSpace(d_ub,d_v_(d_3b),d_v_(d_4b),d_Xb&&d_v_(d_Xb),d_Yb&&d_v_(d_Yb));m.d_s_({realviewId:d_Pb});}},moveDesignObjectsInScreenSpaceTo:function(d_Zb,d_0b,d_Pb,d_M){var m=this;m.getDesignObjectsBoundsInScreenSpace(d_Pb,function(d_Ob){
var d_3b=d_Ob.left+d_Ob.width/2,d_4b=d_Ob.top+d_Ob.height/2;m.moveDesignObjectsInScreenSpaceBy(d_3b,d_4b,d_Zb-d_3b,d_0b-d_4b,d_Pb,d_M);},d_M);},moveDesignObjectsInScreenSpaceToOLD:function(d_Zb,d_0b,d_Pb,d_M){
var m=this;m.moveDesignObjectsInScreenSpaceBy(d_Zb,d_0b,d_e,d_e,d_Pb,d_M);},nudgeDesignObjectsPositionInDesignSpace:function(d_5b,d_6b,d_M){var m=this,d_O=d_K('position',d_M),d_7b=d_U(d_P(d_5b)*d_O),
d_8b=d_U(d_P(d_6b)*d_O);m.moveDesignObjectsInDesignSpaceBy(d_7b,d_8b,d_M);},nudgeDesignObjectsPositionInPhysicalSpace:function(d_5b,d_6b,d_M){var m=this,d_O=d_K('position',d_M),d_7b=d_U(d_P(d_5b)*d_O),
d_8b=d_U(d_P(d_6b)*d_O);m.moveDesignObjectsInPhysicalSpaceBy(d_7b,d_8b,d_M);},nudgeDesignObjectsPositionInScreenSpace:function(d_5b,d_6b,d_Pb,d_M){var m=this,d_O=d_K('position',d_M),d_7b=d_U(d_P(d_5b)*d_O)*100,
d_8b=d_U(d_P(d_6b)*d_O)*100;m.getDesignObjectsBoundsInScreenSpace(d_Pb,function(d_Ob){if(d_Ob)m.moveDesignObjectsInScreenSpaceBy(d_Ob.left+d_Ob.width/2,d_Ob.top+d_Ob.height/2,d_7b,d_8b,d_Pb,d_M);},d_M);
},nudgeDesignObjectsRotation:function(d_9b,d_M){var m=this,d_O=d_K('rotation',d_M),d_$c=d_U(d_P(d_9b)*d_O);m.rotateDesignObjectsBy(d_$c,d_M);},nudgeDesignObjectsSize:function(d__c,d_M){var m=this,d_O=d_K('scale',d_M),
d_ac=d_U(1+d_P(d__c)*d_O);m.scaleDesignObjectsBy(d_ac,d_ac,d_M);},nudgeDesignObjectsTileRotation:function(d_9b,d_M){d_9b=d_P(d_9b);var m=this,d_ub=m.d_vb(d_M&&d_M.objectBlob),d_M_=m.d_M_;if(!d_f.isEmpty(d_ub)){
d_M_.layout(d_ub,'zigtile',[new zazzle.rlv.DesignProperty('rotate',d_9b)]);m.d_s_();}},nudgeDesignObjectsTileSize:function(d_bc,d_cc,d_M){d_bc=d_P(d_bc);d_cc=d_P(d_cc);var m=this,d_ub=m.d_vb(d_M&&d_M.objectBlob),
d_M_=m.d_M_,d_7=[];if(!d_f.isEmpty(d_ub)){if(d_bc)d_7.push(new zazzle.rlv.DesignProperty('stepw',d_bc));if(d_cc)d_7.push(new zazzle.rlv.DesignProperty('steph',d_cc));d_M_.layout(d_ub,'zigtile',d_7);m.d_s_();
}},nudgeTileRotation:function(d_9b){d_9b=d_P(d_9b);var m=this,d_M_=m.d_M_;d_M_.setAreaProperty('layout','zigtile');d_M_.setAreaPropertyParams('layoutparams',[new zazzle.rlv.DesignProperty('stepr',d_9b)]
);m.d_s_();},nudgeTileSize:function(d_bc,d_cc){d_bc=d_P(d_bc);d_cc=d_P(d_cc);var m=this,d_M_=m.d_M_,d_dc=[];if(d_bc)d_dc.push(new zazzle.rlv.DesignProperty('stepw',d_bc));if(d_cc)d_dc.push(new zazzle.rlv.DesignProperty('steph',d_cc));
if(d_f.totalKeys(d_dc)===0)return;d_M_.setAreaProperty('layout','zigtile');d_M_.setAreaPropertyParams('layoutparams',d_dc);m.d_s_();},pasteDesignObjects:function(){var m=this;m.d_M_.paste();m.d_s_();
},removeDesignObjects:function(d_M){var m=this,d_ub=m.d_vb(d_M&&d_M.objectBlob);if(!d_f.isEmpty(d_ub)){m.d_M_.remove(d_ub);m.d_s_();}},reorderDesignObjectsAbove:function(d_ec,d_M){var m=this,d_ub=m.d_vb(d_M&&d_M.objectBlob),
d_fc=d_ec&&m.d_nb(d_ec)[0],d_gc=d_f.indexIn(m.d_n_,d_fc);if(!d_f.isEmpty(d_ub)&& !m.d_6_){if(d_fc&&d_fc.is('selected')){for(var i=d_gc;i>=0;i--){if(!m.d_n_[i].is('selected')){d_fc=m.d_n_[i];break;}}}
m.d_M_.reorderAbove(d_ub,d_fc&&m.d_zb(d_fc));m.d_s_();}},reorderDesignObjectsTo:function(d_f_,d_M){var m=this,d_ub=m.d_vb(d_M&&d_M.objectBlob);if(!d_f.isEmpty(d_ub)&& !m.d_6_){if(d_f_===d_e)d_f_= -1;
if(d_f_<0)d_f_=d_f_%m.d_0a+m.d_0a+1;d_f_=Math.min(d_f_,m.d_0a);m.reorderDesignObjectsAbove(d_f_>0&&m.d_n_[d_f_-1].get('name'),d_M);}},rotateDesignObjectsBy:function(d_hc,d_M){var m=this,d_ub=m.d_vb(d_M&&d_M.objectBlob),
d_ic=(d_M&&d_M.groupingType)||d_y,d_M_=m.d_M_,d_hc= -d_hc;if(!d_f.isEmpty(d_ub)){if(d_ic==d_y)d_M_.rotate(d_ub,d_hc,d_c);else d_f.forEach(d_ub,function(d_xb){d_M_.rotate([d_xb],d_hc,d_c);});m.d_s_();
}},rotateDesignObjectsTo:function(d_hc,d_M){var m=this,d_ub=m.d_vb(d_M&&d_M.objectBlob),d_ic=(d_M&&d_M.groupingType)||d_y,d_M_=m.d_M_,d_hc= -d_hc;if(!d_f.isEmpty(d_ub)){if(d_ic==d_y)d_M_.rotate(d_ub,d_hc,d_b);
else d_f.forEach(d_ub,function(d_xb){d_M_.rotate([d_xb],d_hc,d_b);});m.d_s_();}},scaleDesignObjectsBy:function(d_jc,d_kc,d_M){var m=this,d_ub=m.d_vb(d_M&&d_M.objectBlob);if(!d_f.isEmpty(d_ub)){if(d_M&&d_M.groupingType===d_z){
d_f.forEach(d_ub,function(d_xb){m.d_M_.scale([d_xb],d_jc,d_kc,d_c);});}else m.d_M_.scale(d_ub,d_jc,d_kc,d_c);m.d_s_();}},scaleDesignObjectsToFill:function(d_M){var m=this,d_ub=m.d_vb(d_M&&d_M.objectBlob),
d_M_=m.d_M_;if(!d_f.isEmpty(d_ub)){if(d_M&&d_M.groupingType==d_z)d_f.forEach(d_ub,function(d_xb){d_M_.layout([d_xb],'fill',[new d_i.DesignProperty('fillto','bleed')],d_M&&d_M.persist);});else d_M_.layout(
d_ub,'fill',[new d_i.DesignProperty('fillto','bleed')],d_M&&d_M.persist);m.d_s_();}},scaleDesignObjectsToFit:function(d_M){var m=this,d_ub=m.d_vb(d_M&&d_M.objectBlob),d_M_=m.d_M_;if(!d_f.isEmpty(d_ub)){
if(d_M&&d_M.groupingType==d_z)d_f.forEach(d_ub,function(d_xb){d_M_.layout([d_xb],'fit',[new d_i.DesignProperty('fillto','bleed')],d_M&&d_M.persist);});else d_M_.layout(d_ub,'fit',[new d_i.DesignProperty('fillto','bleed')],
d_M&&d_M.persist);m.d_s_();}},selectDesignObjects:function(d_M){var m=this;m.d_4_({tentativelySelected:d_c},{objectBlob:m.d_n_});m.d_4_({selected:d_b},d_f.copyInto({objectBlob:m.d_7a},d_M));},setDesignObjectsProperties:function(d_Ba,d_M){
this.d_4_(d_Ba,d_M);this.d_s_();},snapDesignObjectsTo:function(d_Hb,d_M){var m=this,d_ub=m.d_vb(d_M&&d_M.objectBlob),d_c_=d_a_(d_Hb);if(!d_f.isEmpty(d_ub)){d_f.forEach(d_c_,function(d_Ib){m.d_M_.layout(
d_ub,'align',[new d_i.DesignProperty('align',d_Ib),new d_i.DesignProperty('alignto','design'),new d_i.DesignProperty('group',!(d_M&&d_M.groupingType==d_z))],d_M&&d_M.persist);});m.d_s_();}},tile:function(d_dc){
if(!d_dc){if(Uize.global().localStorage&&localStorage.debug){console.error("Tile must be passed layout params, as there are multiple patterns we can tile with");}return;}var m=this;var d_M_=m.d_M_;var d_lc=d_dc.pattern==='none'?'':'zigtile';
d_M_.setAreaProperty('layout',d_lc);d_dc=d_6(d_dc);d_M_.setAreaPropertyParams('layoutparams',d_dc);m.d_s_();},tileDesignObjects:function(d_M){d_M=d_M||{};var m=this,d_ub=m.d_vb(d_M.objectBlob),d_M_=m.d_M_
;if(!d_f.isEmpty(d_ub)){d_M_.layout(d_ub,'zigtile',d_6(d_M),d_b);m.d_s_();}},tileDesignObjectsLegacy:function(d_M){d_M=d_M||{};var m=this,d_ub=m.d_vb(d_M.objectBlob),d_M_=m.d_M_,d_7=[];if(!d_f.isEmpty(d_ub)){
if('fillTo'in d_M)d_7.push(new d_i.DesignProperty('fillto',d_M.fillTo));if('clip'in d_M)d_7.push(new d_i.DesignProperty('clip',d_M.clip));if('xSpacing'in d_M)d_7.push(new d_i.DesignProperty('xspace',d_M.xSpacing));
if('ySpacing'in d_M)d_7.push(new d_i.DesignProperty('yspace',d_M.ySpacing));d_M_.layout(d_ub,'tile',d_7,d_b);m.d_s_();}},transferDesignObjects:function(d_mc,d_M){var m=this,d_ub=m.d_vb(d_M&&d_M.objectBlob),
d_nc=typeof d_mc==='string'?m.d_6a[d_mc]:d_mc;if(!d_f.isEmpty(d_ub)&&d_nc){m.d_M_.transfer(d_ub,d_nc.get('name'));m.d_s_();}},ungroupDesignObjects:function(d_M){var m=this,d_oc=m.d_vb((d_M&&d_M.objectBlob)||m.d_5_)
;if(!d_f.isEmpty(d_oc)){d_f.forEach(d_oc,function(d_pc){d_pc.ungroup();});m.d_s_();}},update:function(d_M_){var m=this,d_p_=m.d_p_||{},d_ub=d_M_.getChildObjects(),d_qc=d_M_.getFill(),d_rc={},d_n_=[],
d_sc=function(){var d_$a={};for(var d_H_ in m.d_p_){var d_tc=m.d_p_[d_H_];if(d_tc.get('selected'))d_$a[d_H_]=d_tc;}return d_$a;},d_uc=function(d_vc){return d_f.map(d_f.lookup(d_vc),function(v,d_H_){return d_p_[d_H_]}
);};m.d_M_=d_M_;d_f.forEach(d_ub,function(d_xb){var d_wc=d_xb.name,d_xc= +d_wc.replace(d_r,''),d_r_;d_rc[d_wc]=d_b;if(d_p_[d_wc]){(d_r_=d_p_[d_wc]).update(d_xb);}else{d_r_=d_p_[d_wc]=d_h.create(d_xb);
d_r_.wire({'zdesignObject Needed':function(e){e.callback(m.d_zb(e.source))},'Request Push':function(){m.d_s_()},'Changed.selected':function(){m.set({d_$a:d_sc()});}});m.fire({name:'Design Object Added',
objectName:d_wc,object:d_r_});}if(d_f.isNumber(d_xc))d_q=Math.max(d_q,d_xc);d_r_.set('canUnlock',m.d_I_);d_n_.push(d_r_);});for(var d_wc in d_p_){if(!d_rc[d_wc]){d_p_[d_wc].unmet('selected');d_p_[d_wc].kill();
m.fire({name:'Design Object Removed',objectName:d_wc});}}var newRLVProperties={};Uize.forEach(d_M_.getProperties(),function(value,key){newRLVProperties[key]=value;});m.set({RLVProperties:newRLVProperties});
var d_yc=m.d_Aa;m.met('preventRequestPush');m.set({d_B_:d_qc&&d_qc.fillcolor,d_C_:d_qc&&d_qc.solid,d_E_:d_qc&&d_qc.strokecolor,d_F_:d_qc&&d_qc.strokewidth,d_J_:d_M_.getColors(),d_n_:d_n_,d_U_:d_uc(d_M_.insideBleed),
d_W_:d_uc(d_M_.outsideSafe),d_A_:d_M_.groupName,d_e_:d_M_.getName(),d_$a:d_sc(),d_hb:m.d_hb+1});m.set('preventRequestPush',d_yc);}}});}});
Uize.module({name:'Zazzle.Models.Rooter.RealviewAnnotation',superclass:'Zazzle.Model',required:'Uize.Data.Compare',builder:function(d_$){'use strict';var d__=true,d_a=false,d_b=null,d_c,d_d=Uize,d_e=d_d.keys({d_f:1})[0],
d_g='AreaGroup',d_h='Attribute',d_i='Info',d_j='Unknown',d_k=d_d.Data.Compare.identical,d_l=function(d_m,d_n){return d_k(d_m,d_n)?d_n:d_m;};return d_$.subclass({staticProperties:{Type:{AreaGroup:d_g,
Attribute:d_h,Info:d_i,Unknown:d_j}},stateProperties:d_d.copyInto({d_f:{conformer:d_l}},d_d.map({d_o:'areaGroupName',d_p:{name:'attributeNames',conformer:d_l},d_q:'id',d_r:'infoDescription',d_s:'title',
d_t:'type',d_u:'value',d_v:'viewId',d_w:{name:'xPosition',d_x:'xPos'},d_y:{name:'yPosition',d_x:'yPos'}},function(d_z){d_z=d_d.isPlainObject(d_z)?d_z:{name:d_z};d_z.derived=d_e+':'+d_e+'["'+(d_z.d_x||d_z.name)+'"]';
delete d_z.d_x;return d_z;})),staticMethods:{create:function(d_f){return new this({d_f:d_f})}},instanceMethods:{update:function(d_f){this.set({d_f:d_f})}}});}});
Uize.module({name:'Zazzle.Models.Rooter.Realview',superclass:'Zazzle.Model',required:['Uize.Data.Compare','Uize.Url','Zazzle.Models.Rooter.RealviewAnnotation'],builder:function(d_$){'use strict';var d__=true,
d_a=false,d_b=null,d_c,d_d=Uize,d_e=d_d.Url,d_f=Zazzle,d_g=d_f.Models.Rooter.RealviewAnnotation,d_h=d_d.keys({d_i:1})[0],d_j='attribute',d_k='design',d_l='print',d_m='product',d_n=d_g.Type.AreaGroup,
d_o=d_g.Type.Attribute,d_p=d_g.Type.Info,d_q=d_g.Type.Unknown,d_r=d_d.Data.Compare.identical,d_s=function(d_t,d_u){return d_r(d_t,d_u)?d_u:d_t;},d_v=function(){this.fire('Update URL');};return d_$.subclass({
staticProperties:{Type:{Attribute:d_j,Design:d_k,Print:d_l,Product:d_m}},stateProperties:d_d.copyInto({d_w:{name:'annotations',conformer:d_s},d_i:{conformer:d_s,onChange:function(){var m=this,d_i=m.d_i
;m.set({d_w:d_d.map(d_i.annotations,function(d_x){return d_g.create(d_x)})});}},d_y:{name:'hasAnnotation',derived:'annotations:!Uize.isEmpty(annotations)'},d_z:'isVizLite',d_A:{name:'primaryVisibleAttributeName',
derived:{properties:'annotations',derivation:function(d_w){var d_A;if(!d_d.isEmpty(d_w)){for(var d_B= -1;++d_B<d_w.length;){var d_C=d_w[d_B],d_D;if(d_C.get('type')==d_o&& !d_d.isEmpty(d_D=d_C.get('attributeNames'))){
d_A=d_D[0];break;}}}return d_A;}}},d_E:{name:'primaryVisibleDesignAreaNamesLookup',conformer:d_s,derived:'primaryVisibleDesignAreaNames:Uize.lookup(primaryVisibleDesignAreaNames)'},d_F:{name:'supportsSelectingDesignObjects',
derived:'properties: !("noselect" in properties)'},d_G:{name:'templateParams',conformer:d_s,onChange:d_v},d_H:{name:'visibleDesignAreaNamesLookup',conformer:d_s,derived:'visibleDesignAreaNames:Uize.lookup(visibleDesignAreaNames)'
}},d_d.map({d_I:'canBePreferred',d_J:'contextId',d_K:'description',d_L:{name:'maskParams',conformer:d_s,onChange:d_v},d_M:{name:'primaryVisibleDesignAreaNames',conformer:d_s},d_N:{name:'properties',conformer:d_s
},d_O:{name:'realviewParams',conformer:d_s,onChange:d_v},d_P:'title',d_Q:'type',d_R:{name:'value',d_S:'id'},d_T:{name:'visibleDesignAreaNames',conformer:d_s},d_U:'watermarkRealview'},function(d_V){d_V=d_d.isPlainObject(d_V)
?d_V:{name:d_V};d_V.derived=d_h+':'+d_h+'["'+(d_V.d_S||d_V.name)+'"]';delete d_V.d_S;return d_V;})),alphastructor:function(){this.d_W= +new Date;},staticMethods:{create:function(d_i){return new this({d_i:d_i})}
},instanceMethods:{d_v:d_v,defeatImageUrlCache:function(){this.d_W= +new Date;this.d_v();},getAreaMaskUrl:function(d_X,d_Y,d_Z,d_0,d_1,d_2){},getImageMaskUrl:function(d_X,d_Z,d_1,d_2,d_3){var m=this,
d_L=m.d_L;if(d_3===d_c)d_3=d__;return d_L?d_e.resolve([d_X,d_L,{areamask:'pr',max_dim:d_Z,bg:d_1},d_2,m.d_U?{wm:1}:d_b,(d_3&& !m.d_z)?{r:m.d_W}:d_b]):d_b;},getImageUrl:function(d_X,d_Z,d_1,d_2,d_3){var
 m=this,d_O=m.d_O;if(d_3===d_c)d_3=d__;return d_O?d_e.resolve([d_X,d_O,m.d_G,{max_dim:d_Z,bg:d_1},d_2,m.d_U?{wm:1}:d_b,(d_3&& !m.d_z)?{r:m.d_W}:d_b]):d_b;},isAttributeVisible:function(d_4){var d_w=this.d_w,
d_y=this.d_y,d_5=d_a;if(d_y){for(var d_B= -1;++d_B<d_w.length;){var d_C=d_w[d_B];if(d_C.get('type')==d_o&&d_d.isIn(d_C.get('attributeNames'),d_4)){d_5=d__;break;}}}return!d_y||d_5;},isDesignAreaVisible:function(d_Y,d_6){
var d_H=d_6?this.d_E:this.d_H;return!d_H||d_Y in d_H;},update:function(d_i){this.set({d_i:d_i})}}});}});
Uize.module('Zazzle.Widgets.Rooter');
Uize.module({name:'Zazzle.Widgets.Rooter.mModels',required:'Uize.Widget.mModels',builder:function(){'use strict';var d_$=null,d__=Uize,d_a={design:d_$,pricing:d_$,attributes:d_$,realviews:d_$},d_b='Changed.'
;return function(d_c){d_c.declare({mixins:d__.Widget.mModels,alphastructor:function(){var m=this,d_d=m.models,d_e=m.addedModels,d_f={};d_e.wire(d_b+'*',function(e){var d_g=e.properties;if('product'in d_g){
var d_h=d_d.product,d_i=d_h.models,d_j=d_h.addedModels;if(d_e.isMet('product')){d__.forEach(d_a,function(v,d_k){var d_l=function(){d_j.isMet(d_k)?m.addModel(d_k,d_i[d_k]):m.removeModel(d_k);};d_l();d_f[d_b+d_k]=d_l;
});d_j.wire(d_f);}else d_j.unwire(d_f);}});},models:d__.copyInto({product:d_$},d_a)});};}});
Uize.module({name:'Zazzle.Widgets.Rooter.mObjectsSelector',required:['Uize.Url','Zazzle.Models.Rooter.DesignArea','Zazzle.Models.Rooter.Realview','Zazzle.Widget.mV2','Zazzle.Widgets.Rooter.mModels'],builder:function(){
'use strict';var d_$=false,d__=null,d_a=Uize,d_b=Zazzle;return function(d_c){d_c.declare({mixins:[d_b.Widget.mV2,d_b.Widgets.Rooter.mModels],stateProperties:{bounds:{},heightCss:{derived:'bounds:bounds ? (bounds.height + "%") : 0'
},creatingSelection:{},leftCss:{derived:'bounds:(bounds ? bounds.left : -1000) + "%"'},topCss:{derived:'bounds:(bounds ? bounds.top : -1000) + "%"'},widthCss:{derived:'bounds:bounds ? (bounds.width + "%") : 0'
}}});};}});
Uize.module({name:'Zazzle.Widgets.Rooter.ObjectsSelector',superclass:'Zazzle.Widget.V2',required:['Uize.Widget.Drag','Zazzle.Widgets.Rooter.mObjectsSelector'],builder:function(f_$){'use strict';var f__=null,
f_a=Uize;return f_$.subclass({mixins:Zazzle.Widgets.Rooter.mObjectsSelector,alphastructor:function(){var m=this,f_b;f_b=m.drag=new f_a.Widget.Drag();f_b.wire({'Before Drag Start':function(){m.set('bounds',f__);
},'Changed.inDrag':function(e){m.set('creatingSelection',e.newValue);},'Drag Done':function(e){m.fire('New Selection');},'Drag Update':function(e){var f_c={left:f_b.eventStartPos[0],top:f_b.eventStartPos[1]
},f_d={left:f_c.left+f_b.eventDeltaPos[0],top:f_c.top+f_b.eventDeltaPos[1]},f_e=m.web().coords(),f_f=m.web().width(),f_g=m.web().height(),f_h=function(f_i,f_j){var f_k={left:Math.min(f_i.left,f_j.left),
top:Math.min(f_i.top,f_j.top)};f_k.width=(Math.max(f_i.left,f_j.left)-f_k.left);f_k.height=(Math.max(f_i.top,f_j.top)-f_k.top);return f_k;};f_a.forEach([f_c,f_d],function(f_l){f_l.left=(f_l.left-f_e.left)/f_f*100;
f_l.top=(f_l.top-f_e.top)/f_g*100;});m.set('bounds',f_h(f_c,f_d));}});},cssBindings:{creatingSelection:['','creatingSelection']}});}});
Uize.module('Zazzle.Widgets.Spp');
Uize.module({name:'Zazzle.Widgets.Spp.DesignObjectsSelector',superclass:'Zazzle.Widgets.Rooter.ObjectsSelector',required:['Zazzle.Widgets.Rooter.mObjectsSelector'],builder:function(g_$){'use strict';var
 g__=Uize;return g_$.subclass({htmlBindings:{heightCss:'bounds:style.height',leftCss:'bounds:style.left',topCss:'bounds:style.top',widthCss:'bounds:style.width'},eventBindings:{'#:mousedown':function(e){
this.drag.initiate(e);}}});}});
Uize.module({name:'Uize.Tooltip',required:['Uize.Dom.Basics','Uize.Dom.Pos','Uize.Fade'],builder:function(){'use strict';var b_$=function(){},b__=true,b_a=false,b_b,b_c=Uize.Dom.Basics,b_d=Uize.Dom.Pos,
b_e=Uize.getGuid(),b_f=[],b_g,b_h=16;function b_i(b_j){return b_c.getById(Uize.isFunction(b_j)?b_j():b_j);}function b_k(){b_l()}function b_m(b_n){if(b_n!=b_g){if(b_n){if(b_g){b_o.stop();b_p();}if(!b_n.b_q){
b_c.wire(document.body,'scroll',b_k,b_e);b_c.wire(document.documentElement,'mousemove',b_k,b_e);}b_g=b_n;b_c.setStyle(b_g.b_r,{position:'absolute',zIndex:5000,left:-50000,top:-50000});b_c.display(b_g.b_r);
b_l();}else{b_o.get('duration')>0?b_o.start():b_p();}}else if(b_n){b_o.stop();b_c.setOpacity(b_g.b_r,1);}}b_$.showTooltip=function(b_j,b_s,b_q){if(b_j=b_i(b_j)){if(b_s!==b_a){b_f.push({b_r:b_j,b_q:b_q
});}else{for(var b_t=b_f.length;--b_t> -1;)if(b_f[b_t].b_r==b_j)break;b_t> -1&&b_f.splice(b_t,1);}b_m(b_f[b_f.length-1]);}};b_$.hideTooltip=function(b_j){b_$.showTooltip(b_j,b_a)};var b_l=b_$.positionTooltip=function(b_j,b_u){
b_g&&(b_j===b_b?(b_j=b_g.b_r):b_g.b_r==b_i(b_j))&&b_d.setAbsPos(b_j,b_d.getEventAbsPos(b_u),b_h);};var b_o=b_$.fade=Uize.Fade({duration:0});function b_p(){b_g.b_q||b_c.unwireEventsByOwnerId(b_e);b_c.display(b_g.b_r,b_a);
b_c.setOpacity(b_g.b_r,1);b_g=null;}b_o.wire({'Changed.value':function(){b_c.setOpacity(b_g.b_r,1-b_o.get('progress'))},Done:b_p});return b_$;}});
Uize.module({name:'Uize.Widget.Collection.Dynamic',required:['Uize.Dom.Basics','Uize.Dom.Pos','Uize.Widget.Drag','Uize.Tooltip'],builder:function(e_$){'use strict';var e__=true,e_a=false,e_b=null,e_c=Uize.Dom,
e_d=e_c.Basics,e_e=e_c.Pos,e_f=Uize.Tooltip,e_g={selected:e__};function e_h(m,e_i){var e_j=e_i.properties,e_k=m.makeItemWidgetName(e_j);m.get('items').push(e_j);return m.addItemWidget(e_k,e_i);}function e_l(m){m.fire('Items Changed')};
return e_$.subclass({omegastructor:function(){var m=this;var e_m,e_n,e_o,e_p,e_q,e_r,e_s,e_t,e_u,e_v,e_w,e_x,e_y,e_z,e_A,e_B,e_C,e_D=m.addChild('drag',Uize.Widget.Drag,{nodeMap:{'':e_b}}),e_E=e_a;e_D.wire(
'Changed.inDrag',function(e_F){m.set({e_G:e_F.newValue})});function e_H(e_G){var e_I=e_G?m.e_J:1,e_K=m.getNode('tooltipDragging');for(var e_L=e_p;--e_L> -1;)e_o[e_L].setNodeOpacity('',e_I);e_G&&e_d.setInnerHtml(
e_K,m.localize('draggingToReorder'+(e_p>1?'Plural':'Singular'),{totalItems:e_p}));e_f.showTooltip(e_K,e_G,e__);}e_D.wire({'Drag Start':function(){e_n=m.e_M=='reverse'?1:0;e_m.set({over:e_a});var e_N=e_m.get('selected');
if(!e_N){m.selectAll(e_a);m.e_O&&e_m.set({selected:e__});}if(!m.e_P){if(e_N){for(var e_Q= -1,e_R=m.getSelected(),e_S=e_R.length;++e_Q<e_S;)e_R[e_Q].get('locked')&&e_R[e_Q].set({selected:e_a});e_E= !m.get('totalSelected');
}else if(e_m.get('locked'))e_E=e__;}e_o=e_N?m.getSelected():[e_m];e_p=e_o.length;e_q=[];m.forAll(function(e_T){e_q.push(e_e.getCoords(e_T.getNode()));});var e_U=e_q.length,e_V=e_U-1,e_W=e_q[e_n?e_V:0],
e_X=e_q[e_n?e_V-1:1];e_y=e_V&&e_X.top>=e_W.bottom?1:0;e_B=e_y?'top':'left';e_C=e_y?'height':'width';e_t=e_u=e_v=e_w=e_x=e_b;e_z=m.getNode('insertionMarker');e_A=e_e.getDimensions(e_z);for(var e_Y= -1,
e_Z=e_V?e_X[e_B]-(e_W[e_B]+e_W[e_C]-1):0,e_0=e_Z/2;++e_Y<e_U;){var e_1=e_q[e_Y];e_1[e_B]-=e_0;e_1[e_C]+=e_Z;}e_H(e__);},'Drag Update':function(){var e_2=e_D.eventPos;e_f.positionTooltip(m.getNode('tooltipDragging'),
{pageX:e_2[0],pageY:e_2[1]});function e_3(e_4){return(e_4&&e_e.doRectanglesOverlap(e_4.left,e_4.top,e_4.width,e_4.height,e_2[0],e_2[1],1,1));}if(!e_3(e_s)){e_r=e_s=e_b;m.forAll(function(e_T,e_Y){var e_1=e_q[e_Y];
if(e_3(e_1)){e_r=e_T;e_s=e_1;}return!e_r;});}if(!e_3(e_v)){e_t=e_v=e_b;if(e_r&& !Uize.isIn(e_o,e_r)){var e_5=e_s[e_C],e_6=e_5/2,e_7=e_s[e_B],e_8=e_7+e_6;e_t=e_r;e_u=e_2[e_y]<e_8?0:1;e_v=Uize.clone(e_s);
e_v[e_B]=e_u?e_8:e_7;e_v[e_C]=e_6;}}if(e_t!=e_w||e_u!=e_x){m.displayNode(e_z,!!e_t);if(e_t){var e_9=Uize.clone(e_v);e_9[e_B]+=(e_u?e_v[e_C]:0)-e_A[e_C]/2;delete e_9[e_C];e_e.setCoords(e_z,e_9);}e_w=e_t;
e_x=e_u;}e_D.set({cursor:e_t||e_r?m.e_$_:'not-allowed'});},'Drag Done':function(){if(e_D.get('dragStarted')){e_H(e_a);m.displayNode('insertionMarker',e_a);var e___=function(){if(e_t&& !e_E&& !e_D.get('dragCancelled')){
var e_a_=m.itemWidgets;if(e_u^e_n){var e_b_=e_a_.length,e_c_=Uize.indexIn(e_a_,e_t)+1;e_t=e_b;while(e_c_<e_b_){var e_T=e_a_[e_c_];if(!Uize.isIn(e_o,e_T)){e_t=e_T;break;}else{e_c_++;}}}for(var e_L= -1;++e_L<e_p;)
m.move(e_o[e_L],e_t);m.fire('Items Reordered');e_l(m);}};m.e_d_?m.confirm({state:'warning',title:m.localize('confirmDragToReorderTitle'),message:m.localize('confirmDragToReorderPrompt'),yesHandler:function(){
m.e_d_=e_a;m.fire('Drag Confirmed');e___();},noHandler:function(){e_D.set({dragCancelled:true});}}):e___();}}});m.wire('Item Mouse Down',function(e_F){if(m.e_e_){var e_f_=function(){e_m=e_F.source;e_D.initiate(e_F.domEvent);
};Uize.Dom.Basics.isIe?e_f_():setTimeout(e_f_,0);}e_F.bubble=e_a;});},instanceMethods:{add:function(e_g_){var m=this,e_h_=[];if(!Uize.isArray(e_g_))e_g_=[e_g_];var e_i_=e_g_.length;if(e_i_){m.e_j_&&m.selectAll(e_a);
var e_k_=m.e_j_?e_g:e_b;for(var e_l_= -1;++e_l_<e_i_;)e_h_.push(e_h(m,Uize.copyInto(e_g_[e_l_],e_k_)));}e_l(m);return e_h_;},getItemWidgetProperties:function(){var m=this;return(Uize.copyInto({previewTooltip:
function(){return m.e_e_?m.getNode('tooltipDragToReorder'):e_b}},m.get('itemWidgetProperties')));},move:function(e_m_,e_n_){var m=this,e_o_=m.e_M=='reverse',e_p_=e_n_?e_n_.getNode():e_b,e_q_=m.get('items'),
e_a_=m.itemWidgets,e_r_=e_m_.getNode().parentNode,e_s_=e_m_.getNode(),e_t_=e_o_?(e_p_?e_p_.nextSibling:e_r_.childNodes[0]):e_p_;e_t_?e_r_.insertBefore(e_s_,e_t_):e_r_.appendChild(e_s_);var e_u_=Uize.indexIn(e_a_,e_m_),
e_v_=e_q_[e_u_];e_a_.splice(e_u_,1);e_q_.splice(e_u_,1);var e_w_=e_n_?Uize.indexIn(e_a_,e_n_):e_a_.length;e_a_.splice(e_w_,0,e_m_);e_q_.splice(e_w_,0,e_v_);},getTemplateHtml:function(e_x_){return e_x_.innerHTML;
},processItemTemplate:function(e_x_){var e_y_=this.getTemplateHtml(e_x_);return Uize.Template&&e_x_.tagName=='SCRIPT'&&e_x_.type=='text/jst'?Uize.Template.compile(e_y_,this.e_z_||{openerToken:'[%',closerToken:'%]'})
:function(e_A_){return e_y_.replace(/ITEMWIDGETNAME/g,e_A_.name)};},afterWireUi:function(){},wireUi:function(){var m=this;if(!m.isWired){var e_B_=document.body,e_z=m.getNode('insertionMarker'),e_C_={},
e_D_=m.getNode('itemTemplate');if(e_z&&e_z.parentNode!=e_B_){e_B_.insertBefore(e_z,e_B_.childNodes[0]);m.setNodeStyle(e_z,{display:'none',position:'absolute',zIndex:10000,left:'',top:'',right:'',bottom:''
});}if(e_D_)e_C_.html=m.processItemTemplate(e_D_);e_C_.built=e_a;e_C_.container=m.getNode('items');e_C_.insertionMode=m.e_M=='reverse'?'inner top':'inner bottom';m.get('built')||m.forAll(function(e_T){e_T.set(e_C_)});
m.set({itemWidgetProperties:Uize.copyInto(e_C_,m.get('itemWidgetProperties')||{})});e_$.doMy(m,'wireUi');m.afterWireUi();}}},stateProperties:{e_d_:{name:'confirmToDrag',value:e_a},e_$_:{name:'dragCursor',
value:'move'},e_P:{name:'dragIgnoresLocked',value:e__},e_e_:{name:'dragToReorder',value:e_a},e_O:{name:'ensureItemDraggedIsSelected',value:e_a},e_G:'inDrag',e_M:{name:'itemDisplayOrder',value:'normal'
},e_j_:{name:'makeNewlyAddedSelected',value:e__},e_J:{name:'itemVestigeOpacity',value:.2},e_z_:'templateTokens'}});}});
Uize.module({name:'Zazzle.Widgets.Rooter.mObjectHitbox',required:['Zazzle.Widget.mV2','Zazzle.Widgets.Rooter.mModels'],builder:function(){'use strict';var d_$=false,d__=null,d_a,d_b=Uize,d_c=Zazzle;return function(d_d){
d_d.declare({mixins:[d_c.Widget.mV2,d_c.Widgets.Rooter.mModels],stateProperties:{bounds:{},deselectOnClick:{value:d_$},heightCss:{derived:'bounds:bounds ? (bounds.height + "%") : 0'},leftCss:{derived:'bounds:(bounds ? bounds.left : -1000) + "%"'
},object:{onChange:function(){var m=this;m.removeModel('object');m.set('selected',m.object.get('selected'));m.addModel('object',m.object);}},tentativelySelected:{},topCss:{derived:'bounds:(bounds ? bounds.top : -1000) + "%"'
},widthCss:{derived:'bounds:bounds ? (bounds.width + "%") : 0'}},set:{locked:d_a},modelBindings:{locked:'<-object',selected:'object',tentativelySelected:'<-object'},eventBindings:d_b.copyInto((function(){
var d_e={};d_b.forEach(['locked','tentativelySelected'],function(d_f){d_e[':Changed.'+d_f]=function(e){var d_g=this.object;if(d_g)d_g.set(d_f,e.newValue);};});return d_e;})()),childBindings:{locked:{
property:'enabled',direction:'->',valueAdapter:{aToB:function(d_h){return d_h?false:'inherit'}}}}});};}});
Uize.module({name:'Uize.Widget.CollectionItem',required:['Uize.Widget.Button','Uize.Dom.Classes'],builder:function(d_$){'use strict';var d__=true,d_a=false,d_b;function d_c(m){if(m.isWired){var d_d=m.d_d;
d_d!=d_b&&m.setNodeInnerHtml('title',d_d);}}function d_e(m){if(m.isWired){Uize.Dom.Classes.setState(m.getNode(),['',m.d_f,m.d_g],(m.d_h?2:m.d_i&&1)||0);var d_j=m.d_j,d_k=m.d_k;typeof d_j=='string'&&typeof d_k=='string'&&
Uize.Dom.Classes.setState(m.getNode('preview'),[d_j,d_k],m.d_i);}}function d_l(){d_e(this);}function d_m(m,d_n,d_o){m.fire({name:'Click Selected',domEvent:d_n,forceToggle:d_o});}function d_p(m){var d_q=m.children.select;
d_q.get('state')!='over'&&d_q.set({selected:m.d_h});}return d_$.subclass({alphastructor:function(){this.d_r={};},omegastructor:function(){var m=this;m.addChildButton('select',function(d_s){d_m(m,d_s.domEvent,d__)}
).set({clickToSelect:d__,clickToDeselect:d__});d_p(m);m.addChildButton('remove',function(){m.fire({name:'Remove',byUser:d__})});},instanceMethods:{addChildButton:Uize.Widget.Button.addChildButton,updateUi:function(){
d_e(this);d_c(this);},wireUi:function(){var m=this;if(!m.isWired){var d_t=m.getNode();if(m.d_u&&d_t)d_t.className=m.d_u;var d_v=m.getNode('previewShell')||'imageLink',d_w=function(d_s){m.fire({name:'Item Mouse Down',domEvent:d_s,bubble:d__});
};m.wireNode(d_v,{mouseover:function(){m.set({d_i:d__})},mouseout:function(){m.set({d_i:d_a})},touchend:d_w,mousedown:d_w});if(m.d_x)m.wireNode(d_v,'click',function(d_s){var d_o=m.d_x=='Toggle Selected';
d_o||m.d_x=='Select'?d_m(m,d_s,d_o):m.fire({name:'Click Preview',bubble:d__,domEvent:d_s});});d_$.doMy(m,'wireUi');}}},instanceProperties:{isCollectionItem:d__},stateProperties:{d_g:'cssClassActive',
d_u:'cssClassBase',d_j:'cssClassImage',d_k:'cssClassImageOver',d_f:'cssClassOver',d_y:{name:'locked',value:d_a},d_i:{name:'over',onChange:[function(){var m=this;m.isWired&&m.d_z&&Uize.Tooltip&&Uize.Tooltip.showTooltip(m.d_z,m.d_i)
;},d_l],value:d_a},d_x:'previewClickAction',d_z:'previewTooltip',d_r:{name:'properties',onChange:function(){var d_r=this.d_r;d_r&&'title'in d_r&&this.set({d_d:d_r.title});}},d_h:{name:'selected',onChange:[
function(){this.children.select&&d_p(this)},d_l],value:d_a},d_d:{name:'title',onChange:function(){var m=this,d_r=m.d_r;if(d_r){d_r.title=m.d_d;d_c(m);m.fire({name:'Title Changed',bubble:d__,value:m.d_d});
}}}}});}});
Uize.module({name:'Zazzle.Widgets.Spp.DesignObjectHitbox',superclass:'Uize.Widget.CollectionItem',required:['Uize.Dom.Event','Zazzle.Widgets.Rooter.mObjectHitbox'],builder:function(e_$){'use strict';var
 e__=Uize;return e_$.subclass({mixins:Zazzle.Widgets.Rooter.mObjectHitbox,cssBindings:{locked:['','locked'],selected:['','selected'],tentativelySelected:['','tentativelySelected']},htmlBindings:{heightCss:':style.height',
leftCss:':style.left',topCss:':style.top',widthCss:':style.width'},eventBindings:{'#:mousedown':function(e){var m=this,e_a= !e.ctrlKey&& !e.metaKey;if(!m.is('selected')){if(e_a)m.fire({name:'Deselect All',
bubble:true});m.fire({name:'Initiate Hitbox Drag',domEvent:e,bubble:true});}if(m.deselectOnClick|| !e_a)m.toggle('selected');else m.met('selected');},'#:mouseenter':function(){this.met('tentativelySelected');
},'#:mouseout':function(){this.unmet('tentativelySelected');},'#:click':function(e){e__.Dom.Event.stopPropagation(e);this.fire({name:'Hitbox Clicked',bubble:true});}},set:{v2StateOpacityEnabled:false
}});}});
Uize.module({name:'Zazzle.Widgets.Rooter.mObjectHitboxes',required:['Uize.Data.Compare','Zazzle.Widget.mV2','Zazzle.Widgets.Rooter.mModels'],builder:function(){'use strict';var d_$=Uize,d__=Zazzle,d_a=function(d_b,d_c){
return d_$.Data.Compare.identical(d_b,d_c)?d_c:d_b;};return function(d_d){d_d.declare({mixins:[d__.Widget.mV2,d__.Widgets.Rooter.mModels],stateProperties:{objectsBounds:{conformer:d_a},objects:{conformer:d_a
},objectsBoundsAndWired:{derived:'objectsBounds,objects,isWired:Math.random()',onChange:function(){var m=this,d_e=m.objects,d_f=m.objectsBounds;if(m.isWired&&d_e&&d_f&&d_e.length==d_f.length){var d_g=d_e.length,
d_h=m.itemWidgets,d_i=d_h.length;for(var d_j= -1;++d_j<d_g;){var d_k={object:d_e[d_j],bounds:d_f[d_j],extraClasses:m.cssClass('hitbox')};if(d_j<d_i)d_h[d_j].set(d_k);else m.addItemWidget(m.makeItemWidgetName(),
d_k);}m.remove(d_h.slice(d_g));}}}},eventBindings:{':Items Removed':function(e){d_$.forEach(e.itemWidgetsRemove,function(d_l){d_m.kill()});}}});};}});
Uize.module({name:'Zazzle.Widgets.Spp.DesignObjectHitboxes',superclass:'Uize.Widget.Collection.Dynamic',required:['Zazzle.Widgets.Rooter.mObjectHitboxes','Zazzle.Widgets.Spp.DesignObjectHitbox'],builder:function(f_$){
'use strict';var f__=Zazzle.Widgets;return f_$.subclass({mixins:f__.Rooter.mObjectHitboxes,set:{itemWidgetClass:f__.Spp.DesignObjectHitbox,itemWidgetProperties:{built:false}},eventBindings:{':Deselect All':function(){
this.selectNone();}}});}});
Uize.module({name:'Zazzle.Widgets.Rooter.mSelectedObjectsBounds',required:['Zazzle.Widget.mV2','Zazzle.Widgets.Rooter.mModels'],builder:function(){'use strict';var d_$=false,d__=null,d_a=Uize,d_b=Zazzle
;return function(d_c){d_c.declare({mixins:[d_b.Widget.mV2,d_b.Widgets.Rooter.mModels],stateProperties:{bounds:{onChange:function(){var m=this;if(m.bounds)m.set('delayedBounds',m.bounds);else setTimeout(function(){
m.set('delayedBounds',m.bounds)},75);}},boundsAspect:{derived:{properties:'bounds',derivation:function(d_d){var d_d=d_d||{width:1,height:1};return d_d.width/d_d.height;}}},boundsInPixels:{derived:{properties:'currentBounds,stageSize',
derivation:function(d_e,d_f){var d_g={top: -1000,left: -1000,width:0,height:0};return d_a.map(d_e||d_g,function(d_h){return d_h/100*d_f;});}}},currentBounds:{derived:'bounds,delayedBounds,useDelayedBounds: useDelayedBounds ? delayedBounds : bounds'
},delayedBounds:{},hasBounds:{derived:'bounds: !Uize.isEmpty(bounds)'},objects:{},stageSize:{value:512},useDelayedBounds:{value:true}},childBindings:{boundsInPixels:d_a.map(['top','left','width','height'],
function(d_i){return{property:d_i,direction:'->',valueAdapter:{aToB:function(d_j){return d_j&&d_j[d_i]}}};})}});};}});
Uize.module({name:'Zazzle.Widgets.Rooter.SelectedObjectsBounds',superclass:'Uize.Widget.Resizer',required:['Uize.Dom.Event','Zazzle.Widget.mV2','Zazzle.Widgets.Rooter.mSelectedObjectsBounds'],builder:function(e_$){
'use strict';var e__=Uize;return e_$.subclass({mixins:[Zazzle.Widget.mV2,Zazzle.Widgets.Rooter.mSelectedObjectsBounds],eventBindings:{':Drag Start':function(){var m=this,e_a=m.get('objects');if(e_a.length>1||e_a.length&&e_a[0].get('type')==e_a[0].Class.Type.Image)
m.set('aspectRatio',m.get('boundsAspect'));else m.set('aspectRatio',null);},'#move:click':function(e){e__.Dom.Event.stopPropagation(e);this.fire('Move Node Clicked');}},cssBindings:{hasBounds:['','hasBounds'],
inDrag:['','inDrag']},set:{constrain:false,useDefaultCursors:false}});}});
Uize.module({name:'Zazzle.Widgets.Spp.SelectedDesignObjectsBounds',superclass:'Zazzle.Widgets.Rooter.SelectedObjectsBounds',builder:function(f_$){'use strict';return f_$.subclass();}});
Uize.module({name:'Zazzle.Widgets.Spp.ImageTemplateTweakerHitbox',superclass:'Uize.Widget.CollectionItem',required:['Uize.Widget.mModels','Zazzle.Widget.mV2Web','Zazzle.Widgets.Hammer'],builder:function(e_$){
'use strict';var e__=Uize;return e_$.subclass({mixins:[e__.Widget.mModels,Zazzle.Widget.mV2Web],stateProperties:{e_a:{name:'alignI',conformer:function(e_a){return e__.constrain(e_a,0,1)*1;},value:.5},
e_b:'bounds',e_c:{name:'designObject',onChange:function(){this.e_c&&this.addModel('designObject',this.e_c)}},e_d:{name:'draggableAxisIsHorizontal',derived:'imageAspect,isFill,objectAspect: isFill ? (imageAspect > objectAspect) : (imageAspect < objectAspect)'
},e_e:{name:'dragOffset',value:0},e_f:'imageAspect',e_g:{name:'imageHeight',derived:'imageAspect,isFill,objectAspect,objectWidth: objectWidth / (isFill ? Math.min : Math.max)(imageAspect, objectAspect)'
},e_h:{name:'imageLeft',derived:'draggableAxisIsHorizontal,imageOffset: draggableAxisIsHorizontal ? imageOffset : 0'},e_i:{name:'imageOffset',derived:'alignI,imageOverflowSize,isFill: alignI * imageOverflowSize * (isFill ? -1 : 1)'
},e_j:{name:'imageOverflowSize',derived:'draggableAxisIsHorizontal,imageHeight,imageWidth,objectHeight,objectWidth: Math.abs(draggableAxisIsHorizontal ? (imageWidth - objectWidth) : (imageHeight - objectHeight))'
},e_k:{name:'imageTop',derived:'draggableAxisIsHorizontal,imageOffset: draggableAxisIsHorizontal ? 0 : imageOffset'},e_l:{name:'imageWidth',derived:'imageAspect,isFill,objectAspect,objectHeight: (isFill ? Math.max : Math.min)(imageAspect, objectAspect) * objectHeight'
},e_m:{name:'inDrag',onChange:function(){var m=this;if(m.e_m)m.web(document.body).addClass('noSelect');else m.web(document.body).removeClass('noSelect');}},e_n:'initialDragAlini',e_o:{name:'isFill',derived:'designObject: designObject.get("templateFillMode") === "fill"'
},e_p:'objectAspect',e_q:'objectHeight',e_r:'objectWidth',e_s:'templateName'},alphastructor:function(){var m=this,e_t=function(){m.set({e_q:m.web().height(),e_r:m.web().width()});};m.whenever('wired',function(){
e_t();m.web().resize(function(){e_t();});m.children.hammer.set('element',m.getNode('image'));m.children.hammer.setRecognizerOptions('pan',{direction:Hammer.DIRECTION_ALL,threshold:0});});},children:{
hammer:Zazzle.Widgets.Hammer,paletteMoorer:Uize.Widget},childBindings:{},modelBindings:{alignI:'<-designObject.alignI'},cssBindings:{draggableAxisIsHorizontal:['vertical','horizontal'],inDrag:['','inDrag']
},htmlBindings:{bounds:function(e_b){this.web().css({top:e_b.top+'%',left:e_b.left+'%',width:e_b.width+'%',height:e_b.height+'%'});},imageHeight:'image:style.height',imageLeft:'image:style.left',imageTop:'image:style.top',
imageWidth:'image:style.width'},eventBindings:{'#:mousedown':function(){this.fire({name:'Hitbox Mousedown',bubble:true});},hammer:{'Pan Start':function(e){this.set({e_m:true,e_n:this.e_a});},'Pan Move':function(e){
var m=this,e_u=m.e_n*m.e_j,e_v=m.e_d?e.hammerEvent.deltaX:e.hammerEvent.deltaY,e_w=(e_u+(e_v*(m.e_o? -1:1)))/m.e_j;m.set({e_a:e_w});},'Pan End':function(){var m=this,e_x={};e_x['t_'+m.e_c.get('templateUrlKey')+'_aligni']=m.e_a;
m.fire({name:'New AlignI Value',data:e_x,bubble:true});m.unmet('inDrag');}}}});}});
Uize.module({name:'Zazzle.Widgets.Spp.ImageTemplateTweaker',superclass:'Uize.Widget.Collection.Dynamic',required:['Uize.Comm.Ajax','Uize.Data.Compare','Uize.Url','Uize.Widget.mModels','Zazzle.Models.Rooter.DesignArea',
'Zazzle.Widget.mV2Web','Zazzle.Widgets.Spp.ImageTemplateTweakerHitbox'],builder:function(f_$){'use strict';var f__=Uize,f_a=f__.Data.Compare.identical,f_b=function(f_c,f_d){return f_a(f_c,f_d)?f_d:f_c;
};return f_$.subclass({mixins:[f__.Widget.mModels,Zazzle.Widget.mV2Web],stateProperties:{f_e:{name:'alignIValues',value:{},onChange:function(){var m=this;if(m.models.design)m.models.design.set('templateParams',f__.copy(m.models.design.get('templateParams'),m.f_e));
}},f_f:{name:'designArea',onChange:function(){this.f_f&&this.addModel('designArea',this.f_f);}},f_g:{name:'designObjects',derived:{properties:'designArea,modifiedImageTemplateFields',derivation:function(f_f,f_h){
var m=this,f_g=[];if(f_f)f__.forEach(f_h,function(f_i){for(var i in f_f.get('designObjects')){var f_j=f_f.get('designObjects')[i];if(f_i.name===f_j.get('templateUrlKey')&&f_j.get('templateFillMode')!=='none'){
f_g.push(f_j);break;}}});return f_g;}}},f_k:'hitboxesBounds',f_l:{name:'hitboxesBoundsBridge',derived:{properties:'designArea,designObjects,realview',derivation:function(f_f,f_g,f_m){var m=this;if(f_f&&f_m){
m.f_f.getDesignObjectsBoundsInScreenSpace(f_m.get('value'),function(f_n){m.set({f_k:f_n});},{objectBlob:f_g,groupingType:Zazzle.Models.Rooter.DesignArea.GroupingType.Individual});}}}},f_o:{name:'hitboxesData',
derived:{properties:'hitboxesBounds,imageAspects',derivation:function(f_k,f_p){var m=this,f_o=[];if(f_k&&f_p){f__.forEach(m.f_g,function(f_j,i){var f_q=f_j.get('bounds'),f_r=(f_q[1].x-f_q[0].x)/(f_q[1].y-f_q[0].y)
;if(f_r!=f_p[i])f_o.push({designObject:f_j,objectAspect:(f_k[i].width/f_k[i].height),bounds:f_k[i],imageAspect:f_p[i],templateName:f_j.get('templateUrlKey')});});}return f_o;}},onChange:function(){var
 m=this,f_s;m.remove(m.itemWidgets);f__.forEach(m.f_o,function(f_t){m.addItemWidget(m.makeItemWidgetName(),f__.copy(f_t));});if(m.itemWidgets.length&&m.f_u){var f_v;for(var i=0;i<m.itemWidgets.length;i++){
if(m.itemWidgets[i].get('templateName')==m.f_u){f_v=m.itemWidgets[i];break;}}if(f_v){m.set({f_u:false});m.callInherited('useDialog')({component:{name:'Zazzle.Palette',params:{contents:m.localize('tooltipMessage')
}},widgetProperties:{name:'imageTemplateTweakerPalette',mooringNode:f_v.children.paletteMoorer},'After Show':function(){if(f_s)clearTimeout(f_s);f_s=setTimeout(function(){zPage.children.imageTemplateTweakerPalette.unmet('shown');
},4000);}});}}}},f_p:'imageAspects',f_w:{name:'imageAspectsBridge',derived:{properties:'designObjects',derivation:function(f_g){var m=this,f_p=[],f_x=f_g.length,f_y=function(){f_x--;if(f_x==0)m.set({f_p:f_p});
};f__.forEach(f_g,function(f_j,i){var f_z=f__.findRecord(m.f_h,{name:f_j.get('templateUrlKey')}).value;m.callInherited('performAjax')({serviceUrl:m.getInherited('env').rlvNetService+'imageinfo',id:f_z
},{requestMethod:'GET',callback:function(f_A){f_p[i]=f_A.width/f_A.height;f_y();}});});}}},f_h:{name:'modifiedImageTemplateFields',derived:{properties:'templateFields',derivation:function(f_B){var m=this,
f_h=[];f__.forEach(f_B,function(f_C){if(f_C.type==='image'&&f_C.value&&f_C.value!==f_C.initialValue)f_h.push(f_C);});if(f_h.length){if(m.f_D.length)f__.forEach(f_h,function(f_i){var f_E=f__.findRecord(m.f_D,{name:f_i.name});
if(!f_E||f_E.value!=f_i.value)m.set({f_u:f_i.name});});else m.set({f_u:f_h[0].name});}m.set({f_D:f_h});return f_h;}}},f_u:'nameOfTemplateToTooltipOnHitboxAdd',f_D:{name:'previousModifiedTemplateFields',
value:[]},f_m:'realview',f_B:'templateFields'},alphastructor:function(){var m=this;m.whenever('wired',function(){m.parent.wire('Changed.realview',function(){var f_F=zPage.children.imageTemplateTweakerPalette;
if(f_F)f_F.unmet('shown');});});},modelBindings:{templateFields:'<-design'},modelEventBindings:{'design:Changed.templateParams':function(){var m=this,f_G=m.models.design.get('templateParams'),f_H=Uize.keys(f_G),
f_I=false;for(var i=0;i<f_H.length;i++){if(f_H[i].indexOf('_aligni')> -1){f_I=true;break;}}if(!f_I)m.models.design.set('templateParams',f__.copy(m.models.design.get('templateParams'),m.f_e));}},eventBindings:{
':Hitbox Mousedown':function(){if(zPage.children.imageTemplateTweakerPalette)zPage.children.imageTemplateTweakerPalette.unmet('shown')},':New AlignI Value':function(e){var m=this;m.set({f_e:f__.copy(m.f_e,e.data)});
m.fire({name:'Track Event',extra:{ax:'templateAlignIChanged'},bubble:true});}},set:{itemWidgetClass:Zazzle.Widgets.Spp.ImageTemplateTweakerHitbox,itemWidgetNamePrefix:'hitbox',itemWidgetProperties:{built:false
}}});}});
Uize.module({name:'Zazzle.PreorderBanner',superclass:'Zazzle.Widget.V2',required:['Uize.Widget.Fleeting'],builder:function(f_$){return f_$.subclass({children:{fleeting:Uize.Widget.Fleeting},omegastructor:function(){
var m=this;m.web().mouseover(function(){if(m.f__)m.children.fleeting.set('shown',true);});},stateProperties:{f__:{name:'enableFleeting',value:true}}});}});
Uize.module({name:'Zazzle.Widgets.Rooter.mMainView',required:['Uize.Url','Zazzle.Models.Rooter.DesignArea','Zazzle.Models.Rooter.Realview','Zazzle.Widget.mV2','Zazzle.Widgets.Rooter.mModels'],builder:function(){
'use strict';var d_$=false,d__=null,d_a=Uize,d_b=Zazzle,d_c=d_b.Models.Rooter.Realview.Type.Product,d_d=d_b.Models.Rooter.DesignArea.GroupingType.Individual;return function(d_e){d_e.declare({mixins:[
d_b.Widget.mV2,d_b.Widgets.Rooter.mModels],stateProperties:{activeAttribute:{},activeDesignArea:{onChange:function(){this.activeDesignArea&&this.addModel('activeDesignArea',this.activeDesignArea)}},activeDesignAreaName:{
},allowDesignObjectSelection:{derived:'realview: realview && realview.get("supportsSelectingDesignObjects")'},backgroundImageMaskUrl:{derived:{properties:'realview,uniqueValueId',derivation:function(d_f
){var d_g=this.getInherited('env');return d_f&&d_g?d_f.getImageMaskUrl(d_g.dynamicRealview):'';}}},cropRealview:{derived:'preloadedRequestedImageSize: preloadedRequestedImageSize >= 700'},designAreas:{},
designObjects:{},designObjectsBoundsInDesignSpace:{},designObjectsHitboxBounds:{},designObjectsHitboxBoundsBridge:{derived:'activeDesignArea,designObjects,realview,designObjectsBoundsInDesignSpace:Math.random()',
onChange:function(){var m=this,d_h=m.activeDesignArea,d_i=m.designObjects,d_f=m.realview,d_j=function(d_k){m.set({designObjectsHitboxBounds:d_k||[]})};if(d_h&&d_f&& !d_a.isEmpty(d_i)&&(d_h.get('name')in d_f.get('visibleDesignAreaNamesLookup'))
&&d_i==d_h.get('designObjects'))m.models.design.once('!busy',function(){d_h.getDesignObjectsBoundsInScreenSpace(d_f.get('value'),d_j,{objectBlob:d_i,groupingType:d_d});});else d_j();}},firstComputedValue:{
},imageBackgroundColor:{},imageSize:{value:512},initialPrettyUrl:{},isCustomizing:{},preloadedRequestedImageSize:{},preloadedValue:{},realview:{onChange:function(){this.realview&&this.addModel('realview',this.realview)}
},realviewId:{},realviewsLookup:{},requestedImageSize:{derived:{properties:'imageSize,validRequestedImageSizes',derivation:function(d_l,d_m){var d_n=d_l;if(!d_a.isEmpty(d_m)){for(var d_o= -1;++d_o<d_m.length;){
var d_p=d_m[d_o];if(d_l<=d_p){d_n=d_p;break;}}}return d_n;}}},showBoundaries:{value:d_$},showGrid:{value:d_$},showSelectedBounds:{},stageSize:{value:512},unlockedSelectedDesignObjects:{},unlockedSelectedDesignObjectsBounds:{
},unlockedSelectedDesignObjectsBoundsInDesignSpace:{},unlockedSelectedDesignObjectsBoundsBridge:{derived:'activeDesignArea,unlockedSelectedDesignObjects,realview,unlockedSelectedDesignObjectsBoundsInDesignSpace:Math.random()',
onChange:function(){var m=this,d_h=m.activeDesignArea,d_q=m.unlockedSelectedDesignObjects,d_f=m.realview,d_j=function(d_r){m.set('unlockedSelectedDesignObjectsBounds',d_r||d__)};if(d_h&&d_f&& !d_a.isEmpty(d_q)
&&(d_h.get('name')in d_f.get('visibleDesignAreaNamesLookup'))&&d_q==d_h.get('unlockedSelectedDesignObjects'))m.models.design.once('!busy',function(){d_h.getDesignObjectsBoundsInScreenSpace(d_f.get('value'),
d_j,{objectBlob:d_q});});else d_j();}},uniqueValueId:{},validRequestedImageSizes:{value:[400,512,700,1024,2048]},value:{derived:{properties:'realview,requestedImageSize,imageBackgroundColor,showBoundaries,showGrid,uniqueValueId',
derivation:function(d_f,d_n,d_s,d_t,d_u){var m=this,d_v,d_g=m.getInherited('env');if(!d_g){return d_v;}if(d_f&&d_n){d_v=d_f.getImageUrl(m.models.product.get('isCustomizing')?d_g.dynamicRealview:d_g.staticRealview,
d_n,d_s,{area_grid:d_u?'1':undefined,area_grid_top:d_u?'1':undefined,hide:d_t?undefined:'bleed,safe,visibleMask'});if(!m.firstComputedValue){m.set({firstComputedValue:d_v});d_v=m.initialPrettyUrl;}else if(d_v==m.firstComputedValue)
d_v=m.initialPrettyUrl;}else{d_v=d_g.assets+'s.gif';}return d_v;}},onChange:function(){var m=this,d_w=new Image();d_w.onload=function(){m.set({preloadedValue:m.value,preloadedRequestedImageSize:d_w.naturalWidth
});};d_w.src=m.value;}}},children:{hitboxes:d__,selectedBounds:d__,selector:d__},modelBindings:{activeDesignArea:{property:'activeDesignAreaName',when:'designAreas',valueAdapter:{aToB:function(d_h){return d_h&&d_h.get('name')},
bToA:function(d_x,m){return m.designAreas[d_x]||m.activeDesignArea}}},designAreas:'<-design',designObjects:'<-activeDesignArea',designObjectsBoundsInDesignSpace:'<-activeDesignArea',isCustomizing:'<-design',
realview:{property:'realviewId',when:'realviewsLookup',valueAdapter:{aToB:function(d_f){return d_f&&d_f.get('value')},bToA:function(d_y,m){return m.realviewsLookup[d_y]||m.realview}}},realviewsLookup:'<-realviews',
unlockedSelectedDesignObjects:'<-activeDesignArea',unlockedSelectedDesignObjectsBoundsInDesignSpace:'<-activeDesignArea'},cssBindings:{cropRealview:['','cropRealview']},childBindings:{designObjects:'->hitboxes.objects',
designObjectsHitboxBounds:'->hitboxes.objectsBounds',stageSize:'->selectedBounds',unlockedSelectedDesignObjects:{child:'selectedBounds',property:'objects',direction:'->',valueAdapter:{aToB:'Uize.values(value)'
}},unlockedSelectedDesignObjectsBounds:'->selectedBounds.bounds'},modelEventBindings:{'realview:Update URL':function(){this.set('uniqueValueId',Math.random());this.fire('Update Realview URL');}},eventBindings:{
':Selected Objects Bounds Changed':function(){var m=this,d_z=m.children.selectedBounds,d_A=function(d_B){return d_B/m.imageSize*100;},d_C={top:d_A(d_z.get('top')),left:d_A(d_z.get('left')),width:d_A(d_z.get('width')),
height:d_A(d_z.get('height'))},d_D=m.unlockedSelectedDesignObjectsBounds,d_E=d_C.width/d_D.width,d_F=d_C.height/d_D.height;if(d_E*d_F!==1)m.activeDesignArea.scaleDesignObjectsBy(d_E,d_F);m.activeDesignArea.moveDesignObjectsInScreenSpaceTo(d_C.left+d_C.width/2,d_C.top+d_C.height/2,m.realviewId);
},'selector:New Selection':function(){var m=this,d_r=m.children.selector.get('bounds');if(m.activeDesignArea){m.activeDesignArea.deselectDesignObjects();if(d_r)m.activeDesignArea.getContainingDesignObjectsInScreenSpace(d_r,m.realviewId,function(d_i){
if(d_a.totalKeys(d_i))m.activeDesignArea.selectDesignObjects({objectBlob:d_i});});}}}});};}});
Uize.module({name:'Zazzle.Widgets.Rooter.MainView',superclass:'Zazzle.Widget.V2',required:'Zazzle.Widgets.Rooter.mMainView',builder:function(f_$){'use strict';var f__=null,f_a=Uize;return f_$.subclass({
mixins:Zazzle.Widgets.Rooter.mMainView,cssBindings:{allowDesignObjectSelection:['disallowDesignObjectSelection',''],isCustomizing:['','isCustomizing'],showSelectedBounds:['','showSelectedBounds']},eventBindings:{
'selectedBounds:Drag Done':function(){this.fire('Selected Objects Bounds Changed');},'hitboxes:Changed.totalSelected':function(){var m=this,f_b=m.children.hitboxes.get('itemWidgets'),f_c=m.children.hitboxes.getSelected(),
f_d=m.get('designObjects');if(f_c.length){setTimeout(function(){var f_e=f_c[f_c.length-1].get('object').get('index'),f_f=f_b[f_e],f_g=f_f;if(f_e+1<f_b.length&&f_b[f_e+1].is('locked')){var f_h=f_e+1,f_i=f_b[f_h]
;while(f_i&&f_i.is('locked')){f_h++;f_i=f_b[f_h];}f_g=f_b[f_h-1];}m.web(m.children.selectedBounds).insertAfter(f_g.getNode());},500);}},':Initiate Hitbox Drag':function(e){this.children.selectedBounds.children.move.initiate(e.domEvent);
}}});}});
Uize.module({name:'Zazzle.Widgets.Spp.MainView',superclass:'Zazzle.Widgets.Rooter.MainView',required:['Zazzle.PreorderBanner','Zazzle.Models.Rooter.DesignObject','Zazzle.Widgets.Spp.DesignObjectHitboxes',
'Zazzle.Widgets.Spp.DesignObjectsSelector','Zazzle.Widgets.Spp.SelectedDesignObjectsBounds'],builder:function(g_$){'use strict';var g__=Uize,g_a=Zazzle.Widgets.Spp;return g_$.subclass({stateProperties:{
g_b:{name:'doubleClickThreshold',value:500},g_c:{name:'waitingForDoubleClickOn',onChange:function(){var m=this;if(m.g_c)setTimeout(function(){m.unmet('waitingForDoubleClickOn');},m.g_b);}},g_d:'isPreorder'
},alphastructor:function(){var m=this;m.whenever('wired',function(){m.web(m.children.selector).prependTo(m.children.hitboxes.getNode('items'));m.web(window).resize(function(){m.updateUi();});});},children:{
hitboxes:g_a.DesignObjectHitboxes,imageTemplateTweaker:null,preorderBanner:Zazzle.PreorderBanner,selectedBounds:g_a.SelectedDesignObjectsBounds,selector:g_a.DesignObjectsSelector},childBindings:{activeDesignArea:'->imageTemplateTweaker.designArea',
realview:'->imageTemplateTweaker'},htmlBindings:{preloadedValue:'realview'},cssBindings:{isPreorder:['','isPreorder']},modelBindings:{isPreorder:'<-attributes'},eventBindings:{'hitboxes:Hitbox Clicked':function(){
this.g_e();},'selectedBounds:Move Node Clicked':function(){this.g_e();},'#:click':function(){if(this.get('isCustomizing'))this.g_e();}},instanceMethods:{updateUi:function(){var m=this;var g_f=m.web();
m.set('stageSize',g_f.width());},g_e:function(){var m=this,g_g=m.get('activeDesignArea'),g_h=m.parent.parent.parent.children.areaGroups.get('activeChildAreaGroup'),g_i=g_h&&g_h.children.designTool,g_j=g_g&&g_g.get('firstSelectedDesignObject')
;if(m.g_c&&m.g_c==g_j){if(g_g.get('hasSingleSelectedDesignObject')&&g_g.get('hasAllSelectedDesignObjectsUnlocked'))switch(g_j.get('type')){case Zazzle.Models.Rooter.DesignObject.Type.Text:g_i.getText(
function(g_k){if(g_k){g_j.set('value',g_k);}},m.localize('changeTextDialogTitle'),g_j.get('value'));break;case Zazzle.Models.Rooter.DesignObject.Type.Image:g_i.getImage(function(g_l){if(!g__.isEmpty(g_l)){
g_j.set('value',g_l[0].attributes.id);}});break;}}else m.set({g_c:g_j});}}});}});
Uize.module('Zazzle.Widgets.Spp.TileList');
Uize.module({name:'Zazzle.Widgets.Spp.TileList.mTileQuirks',superclass:'Zazzle.Widget.V2',required:['Zazzle.Widget.mV2','Zazzle.Widgets.Rooter.mModels'],builder:function(f_$){'use strict';var userChangedTilePattern=false;
function IsTileView(realview){return realview.get('properties').tileview==="1";};var us=function(f__){f__.declare({mixins:[Zazzle.Widget.mV2,Zazzle.Widgets.Rooter.mModels],stateProperties:{hideTiledViews:{
derived:'isTiled: !isTiled'},isTilingUIVisible:{derived:'canTileArea, hasDesignObjects: canTileArea && hasDesignObjects'},tilingNoArtView:{derived:'canTileArea'},tilingHideBoundingBoxes:{derived:'isTiled, isShowingTiledView: isTiled && !isShowingTiledView'
},tileDesignArea:{derived:'activeDesignArea, designArea: activeDesignArea || designArea'},RLVLayout:'RLVLayout',realviewsForTileQuirks:{},isTiled:{derived:'RLVLayout: RLVLayout === "zigtile"',onChange:function(f_a){
var m=this;if(!f_a.isTiled){if(m.get('isShowingTiledView')){m.fire({name:'Show Realview Id',viewId:m.get('firstNonTileViewId')});}}if(f_a.isTiled&&userChangedTilePattern){if(!m.get('hasSeenTiledView')){
m.fire({name:'Show Realview Id',viewId:m.get('firstTileViewId')});}}}},canTileArea:{derived:'tileDesignArea: tileDesignArea && tileDesignArea.get("properties")["zigtile"] === "true"'},displayedTiledViews:{
value:{}},isShowingTiledView:{derived:{properties:'displayedTiledViews',derivation:function(displayedTiledViews){return!Uize.isEmpty(displayedTiledViews);}},onChange:function(e){if(e.isShowingTiledView){
this.set({hasSeenTiledView:true});}}},hasSeenTiledView:{value:false},firstTileViewId:{derived:{properties:'realviewsForTileQuirks',derivation:function(realviews){for(var key in realviews){var realview=realviews[key];
if(IsTileView(realview)){return realview.get('value');}}return null;}}},firstNonTileViewId:{derived:{properties:'realviewsForTileQuirks',derivation:function(realviews){for(var key in realviews){var realview=realviews[key];
if(!IsTileView(realview)){return realview.get('value');}}return null;}}}},eventBindings:{':Showed Realview':function(e){if(IsTileView(e.view)){var displayedTiledViews=this.get('displayedTiledViews');
displayedTiledViews[e.view.get('value')]=e.view;this.set('displayedTiledViews',Uize.clone(displayedTiledViews));}},':Hid Realview':function(e){if(IsTileView(e.view)){var displayedTiledViews=this.get('displayedTiledViews');
delete displayedTiledViews[e.view.get('value')];this.set('displayedTiledViews',Uize.clone(displayedTiledViews));}},':Changed.RLVLayoutRotation':function(){var m=this;m.fire({name:'Show Realview Id',viewId:m.get('firstNonTileViewId')});
},tiling:{'tilePatternSet':function(){userChangedTilePattern=true;}},':Changed.isCustomizing':function(e){var m=this;if(e.newValue!==m.prevTileQuirksIsCustomizing&&e.newValue&&m.get('isTiled')){setTimeout(function(){
m.fire({name:'Show Realview Id',viewId:m.get('firstTileViewId')});},0);}m.prevTileQuirksIsCustomizing=e.newValue;}},modelBindings:{RLVLayout:['<-designArea.RLVLayout','<-activeDesignArea.RLVLayout'],
RLVLayoutRotation:['<-designArea.RLVLayoutRotation','<-activeDesignArea.RLVLayoutRotation'],realviewsForTileQuirks:'<-realviews.realviews',isCustomizing:'<-design'}});};us.IsTileView=IsTileView;return us;
}});
Uize.module({name:'Zazzle.Widgets.Rooter.mViewSelectorOption',required:['Zazzle.Widget.mV2','Zazzle.Widgets.Rooter.mModels'],builder:function(){'use strict';var d_$=Uize,d__=Zazzle;return function(d_a){
d_a.declare({mixins:[d__.Widget.mV2,d__.Widgets.Rooter.mModels],stateProperties:{allowHoverState:{value:true},displayType:{},env:{},imageBackgroundColor:{},imageSize:{value:50},imageUrl:{derived:{properties:'value,imageSize,imageBackgroundColor,isCustomizing,env,uniqueValueId',
derivation:function(d_b,d_c,d_d,d_e,d_f){var m=this,d_f=d_f||{},d_g=d_e?d_f.dynamicRealview:d_f.staticRealview;return d_b&&d_g&&d_c&&d_f?d_b.getImageUrl(d_g,d_c,d_d,null,d_e):d_f.assets+'s.gif';}}},isCustomizing:{},
productModel:{onChange:function(){this.productModel&&this.addModel('product',this.productModel)}},realviewsLookup:{},title:{},uniqueValueId:{},value:{onChange:function(){this.value&&this.addModel('realview',this.value)}
},valueId:{}},modelBindings:{isCustomizing:'<-product',realviewsLookup:'<-realviews.realviewsLookup',title:'<-realview.title',valueId:{property:'value',when:'realviewsLookup',valueAdapter:{aToB:function(d_h,m){return m.realviewsLookup[d_h]},
bToA:function(d_b){return d_b&&d_b.get('value')}}}},modelEventBindings:{'realview:Update URL':function(){this.set('uniqueValueId',d_$.now())}}});};}});
Uize.module({name:'Zazzle.Widgets.Rooter.ViewSelectorOption',superclass:'Uize.Widget.Button',required:'Zazzle.Widgets.Rooter.mViewSelectorOption',builder:function(e_$){'use strict';var e__=null,e_a=Uize
;return e_$.subclass({mixins:Zazzle.Widgets.Rooter.mViewSelectorOption,cssBindings:{allowHoverState:['','allowHoverState'],displayType:'value',selected:['','selected']}});}});
Uize.module({name:'Zazzle.Widgets.Spp.ViewSelectorOption',superclass:'Zazzle.Widgets.Rooter.ViewSelectorOption',required:['Zazzle.Widgets.Spp.TileList.mTileQuirks'],builder:function(f_$){'use strict';return f_$.subclass({
stateProperties:{f__:{name:'altSeo',derived:{properties:'productTypeSingularName,title',derivation:function(f_a,f_b){return f_a+': '+(f_b||'');}}},f_c:{name:'isTileView',derived:{properties:'value',derivation:function(value){
return Zazzle.Widgets.Spp.TileList.mTileQuirks.IsTileView(value);}}},f_a:'productTypeSingularName'},htmlBindings:{altSeo:'image:alt',imageUrl:'image',title:'title'},cssBindings:{isTileView:['','tileView']
},modelBindings:{productTypeSingularName:'<-product'}});}});
Uize.module({name:'Zazzle.Widgets.Rooter.mViewSelector',required:['Uize.Data.Compare','Uize.Template','Zazzle.Widget.mV2','Zazzle.Widgets.Rooter.mModels'],builder:function(){'use strict';var d_$=Uize,d__=Zazzle
;return function(d_a){d_a.declare({mixins:[d__.Widget.mV2,d__.Widgets.Rooter.mModels],stateProperties:{allowHoverState:{value:true},displayType:{},imageBackgroundColor:{},imageSize:{value:50},realview:{
},realviewId:{},realviews:{conformer:function(d_b,d_c){return d_$.Data.Compare.identical(d_b,d_c)?d_c:d_b;}},realviewsLookup:{derived:{properties:'realviews',derivation:function(d_d){var d_e={},d_f=d_d?d_d.length:0,
d_g= -1;for(;++d_g<d_f;){var d_h=d_d[d_g];d_e[d_h.get('value')]=d_h;}return d_e;}}},tentativeRealview:{},tentativeRealviewId:{}},set:{optionWidgetProperties:{classNamingForStates:''}},modelBindings:{
realviewId:[{property:'realview',when:'realviewsLookup',valueAdapter:{aToB:function(d_i,m){return m.realviewsLookup[d_i]},bToA:function(d_h){return d_h&&d_h.get('value')}}},'.value'],realviews:{property:'values',
direction:'->',valueAdapter:{aToB:function(d_d){return d_$.map(d_d,function(d_h){return{name:d_h.get('value'),realview:d_h}});}}},tentativeRealviewId:[{property:'tentativeRealview',when:'realviewsLookup',
valueAdapter:{aToB:function(d_j,m){return m.realviewsLookup[d_j]},bToA:function(d_k){return d_k&&d_k.get('value')}}},'.tentativeValue']},instanceMethods:{getOptionProperties:function(d_l,d_m){var m=this,
d_n=m.getInherited('env');return d_$.copyInto(d_a.superclass.doMy(m,'getOptionProperties',[d_l,d_m])||{},{allowHoverState:m.allowHoverState,displayType:m.displayType,env:m.getInherited('env'),imageBackgroundColor:m.imageBackgroundColor,
imageSize:m.imageSize,productModel:m.models.product,value:d_m.realview});}}});};}});
Uize.module({name:'Zazzle.Widgets.Rooter.ViewSelector',superclass:'Uize.Widget.Options',required:'Zazzle.Widgets.Rooter.mViewSelector',builder:function(e_$){'use strict';var e__=null,e_a=Uize;return e_$.subclass({
mixins:Zazzle.Widgets.Rooter.mViewSelector,set:{html:true}});}});
Uize.module({name:'Zazzle.Widgets.Spp.ViewSelector',superclass:'Zazzle.Widgets.Rooter.ViewSelector',required:'Zazzle.Widgets.Spp.ViewSelectorOption',builder:function(f_$){'use strict';return f_$.subclass({
set:{optionWidgetClass:Zazzle.Widgets.Spp.ViewSelectorOption}});}});
Uize.module({name:'Zazzle.Widgets.Rooter.mView',required:['Uize.Data.Compare','Zazzle.Widget.mV2','Zazzle.Widgets.Rooter.mModels','Zazzle.Models.Rooter.Realview'],builder:function(){'use strict';var d_$=true,
d__=false,d_a=null,d_b,d_c=Uize,d_d=Zazzle,d_e=d_d.Models.Rooter.Realview.Type,d_f=d_e.Product,d_g=d_e.Design,d_h=function(d_i,d_j,d_k){return d_k&&d_i?this.models.realviews.getBestViewForDesignArea(
d_k.get('name'),d_i,d_j&&d_j.get('type')==d_f?d_g:d_f):d_b;};return function(d_l){d_l.declare({mixins:[d_d.Widget.mV2,d_d.Widgets.Rooter.mModels],stateProperties:{activeAttribute:{},activeAttributeFromValue:{
derived:{properties:'value,attributes',derivation:function(d_j,d_m){var d_n=this.activeAttribute;return d_j&&d_m?(d_n&&d_j.isAttributeVisible(d_n.get('name'))?d_n:d_m[d_j.get('primaryVisibleAttributeName')])
:d_b;}}},activeDesignArea:{onChange:function(){this.activeDesignArea&&this.addModel('activeDesignArea',this.activeDesignArea)}},activeDesignAreaFromValue:{derived:{properties:'value,designAreas,activeDesignAreasLookup',
derivation:function(d_j,d_o,d_p){var d_q=this.activeDesignArea,d_r;if(d_j){if(d_q&&d_j.isDesignAreaVisible(d_q.get('name'),d_$))d_r=d_q;else if(d_o){var d_s=d_j.get('primaryVisibleDesignAreaNames'),d_t,
d_u;if(!d_c.isEmpty(d_s)){for(var d_v= -1;++d_v<d_s.length;){var d_w=d_s[d_v];if(d_w in d_p){d_t=d_w;break;}else if(!d_u)d_u=d_w;}d_r=d_o[d_t||d_u];}else d_r=d_q;}}return d_r;}}},activeDesignAreaName:{
},activeDesignAreasLookup:{},allRealviews:{},alternateValue:{derived:{properties:'allRealviews,value,activeDesignArea,activeAttribute',derivation:d_h}},attributes:{},designAreas:{},hasMultipleRealviews:{
derived:'numRealviews:numRealviews > 1'},noselect:{derived:'activeDesignArea: activeDesignArea && activeDesignArea.get("properties") && activeDesignArea.get("properties").noselect === "true"'},noArtView:{
derived:'isCustomizing, tilingNoArtView: !isCustomizing || tilingNoArtView'},hideBoundingBoxes:{derived:'noselect, tilingHideBoundingBoxes: noselect || tilingHideBoundingBoxes'},imageBackgroundColor:{
},isCustomizing:{},isUsingTentativeValue:{derived:'tentativeValue,useAlternateValue,value: !useAlternateValue && (tentativeValue != value)'},linkSelectedBoundsVisibilityWithTentativeValue:{value:true
},numRealviews:{derived:'realviews:realviews.length'},d_x:{},realviews:{conformer:function(d_y,d_z){return d_c.Data.Compare.identical(d_y,d_z)?d_z:d_y;}},realviewsLookup:{derived:{properties:'realviews',
derivation:function(d_A){var d_B={},d_C=d_A?d_A.length:0,d_D= -1;for(;++d_D<d_C;){var d_E=d_A[d_D];d_B[d_E.get('value')]=d_E;}return d_B;}}},showBoundaries:{value:d__},showGrid:{value:d__},syncValueFromActiveAttribute:{
value:false},syncValueFromActiveDesignArea:{value:false},tentativeValue:{},useAlternateValue:{value:d__},usedValue:{derived:'value,tentativeValue,alternateValue,useAlternateValue:useAlternateValue ? alternateValue : (tentativeValue || value)'
},value:{},valueId:{},valueFromActiveAttribute:{derived:{properties:'activeAttribute,realviews,realviewsLookup',derivation:function(d_F,d_A,d_B){var m=this,d_G=m.value,d_H=d_F&&d_F.get('name');return d_G&&d_G.isAttributeVisible(d_H)&&(!d_B||d_G.get('value')in d_B)
?d_G:m.models.realviews.getBestViewForAttribute(d_H,d_A);}}},valueFromActiveDesignArea:{derived:{properties:'activeDesignArea,realviews,realviewsLookup',derivation:function(d_k,d_A,d_B){var m=this,d_G=m.value,
d_I=d_k&&d_k.get('name');return d_G&&d_G.isDesignAreaVisible(d_I)&&(!d_B||d_G.get('value')in d_B)?d_G:(d_A&&m.models.realviews.getBestViewForDesignArea(d_I,d_A));}}},workspaceSize:{value:512}},children:{
mainView:d_a,viewSelector:d_a},modelBindings:{activeAttribute:'<-.activeAttributeFromValue:activeAttributeFromValue',activeDesignArea:[{property:'activeDesignAreaName',when:'designAreas',valueAdapter:{
aToB:function(d_k){return d_k&&d_k.get('name')},bToA:function(d_I,m){return m.designAreas[d_I]}}},'<-.activeDesignAreaFromValue:activeDesignAreaFromValue'],activeDesignAreasLookup:'<-design',allRealviews:'<-realviews.realviews',
attributes:'<-attributes',designAreas:'<-design',isCustomizing:'<-design',value:[{property:'valueId',when:'realviewsLookup',valueAdapter:{aToB:function(d_j,m){return d_j&&d_j.get('value')},bToA:function(d_J,m){return m.realviewsLookup[d_J]}
}},{property:'valueFromActiveAttribute',direction:'<-',when:'syncValueFromActiveAttribute'},{property:'valueFromActiveDesignArea',direction:'<-',when:'syncValueFromActiveDesignArea'}]},childBindings:{
activeAttribute:'->mainView',activeDesignArea:'->mainView',imageBackgroundColor:['mainView','viewSelector'],isUsingTentativeValue:{child:'mainView',property:'showSelectedBounds',direction:'->',when:'linkSelectedBoundsVisibilityWithTentativeValue',
valueAdapter:{aToB:'!value'}},realviews:['->viewSelector.realviews',{property:'value',direction:'->',when:'allRealviews',valueAdapter:{aToB:function(d_A,m){return m.getSelectedRealview(d_A)}}}],showBoundaries:'->mainView',
showGrid:'->mainView',tentativeValue:'<-viewSelector.tentativeRealview',usedValue:'->mainView.realview',value:'viewSelector.realview'},eventBindings:{':Show Realview Id':function(d_K){this.set({valueId:d_K.viewId});
},':Changed.value':function(){var m=this,d_E=m.value,d_B=m.realviewsLookup,d_L=d_B&&d_B[m.d_x];m.fire({name:'Showed Realview',view:this.get('value'),bubble:true});if(d_L)m.fire({name:'Hid Realview',view:d_L,
bubble:true});d_E&&m.set({d_x:d_E.get('value')});}},alphastructor:function(){var m=this;m.addedModels.once('realviews',function(){var d_M=m.models.realviews;d_M.once('productRealviews',function(){if(m.isMet('!realviews'))
m.set({realviews:d_M.get('productRealviews')});});});},instanceMethods:{deriveAlternateRealview:d_h,getSelectedRealview:function(d_A){var m=this;return m.models.realviews.getBestMatchingRealview(m.value,d_A);
}}});};}});
Uize.module('Zazzle.BindingHelpers');
Uize.module({name:'Zazzle.BindingHelpers.getObjHash',required:['Uize.Dom.Classes','Uize.Url','Uize.Json'],builder:function(){return function getObjHash(obj){if(obj===null)return"null";if(typeof obj!=="object")return""+obj;
var KVPs=[];for(var c_$ in obj){KVPs.push({c_$:c_$,Value:getObjHash(obj[c_$])});}KVPs.sort(function(a,b){return a.c_$-b.c_$;});return Uize.Json.to(KVPs);};}});
Uize.module({name:'Zazzle.Widgets.Rooter.mDoublecheck',required:['Zazzle.Widget.mV2','Zazzle.Widgets.Rooter.mModels','Uize.Url','Uize.Json','Uize.Widget.mWeb','Zazzle.DesignModel','Zazzle.BindingHelpers.getObjHash'
],builder:function(){'use strict';var d_$=Zazzle.BindingHelpers.getObjHash;function d__(d_a,d_b){var d_c={};for(var d_d in d_a){var val=d_a[d_d];if(d_b(val)){d_c[d_d]=val;}}return d_c;}var d_e={DialogCheckSides:{
name:'DialogCheckSides',inDesignView:true,hide:'bleed,safe,visible',width:53,shouldShow:function(d_f){return!Uize.isEmpty(d_f);},getAssociatedData:function(d_g){var d_h=[];for(var ix=0;ix<d_g.length;ix++){
var d_i=d_g[ix];if(d_i.IsBlank&& !d_i.IsSimpleText){d_h.push(d_i.GroupName);}}return d_h;}},DialogCheckSimpletext:{name:'DialogCheckSimpletext',inDesignView:true,hide:'bleed,safe,visible',width:53,shouldShow:function(d_f){
return!Uize.isEmpty(d_f);},getAssociatedData:function(d_g){var d_h=[];for(var ix=0;ix<d_g.length;ix++){var d_i=d_g[ix];if(d_i.IsSimpleText&&(d_i.IsBlank|| !d_i.IsModified)){d_h.push(d_i.GroupName);}}
return d_h;}},DialogCheckTemplates:{name:'DialogCheckTemplates',inDesignView:true,hide:'bleed,safe,visible',width:43,shouldShow:function(d_f){return!Uize.isEmpty(d_f);},getAssociatedData:function(d_g){
var d_j={};for(var ix=0;ix<d_g.length;ix++){var d_i=d_g[ix];var d_k=(d_i.Texts||[]).concat(d_i.Images||[]);var d_l=d__(d_k,function(obj){return obj.Unmodified;});if(!Uize.isEmpty(d_l)){d_j[d_i.Name]=d_l;
}}return d_j;}},DialogCheckBleed:{name:'DialogCheckBleed',inDesignView:true,width:53,shouldShow:function(d_f){return!Uize.isEmpty(d_f);},getAssociatedData:function(d_g){var d_m={};for(var ix=0;ix<d_g.length;ix++){
var d_i=d_g[ix];var d_n={};if(!Uize.isEmpty(d_i.BleedProblems)){d_n.BleedProblems=d_i.BleedProblems;}if(!Uize.isEmpty(d_i.SafeProblems)){d_n.SafeProblems=d_i.SafeProblems;}if(!Uize.isEmpty(d_n)){d_m[d_i.Name]=d_n;
}}return d_m;}},DialogCheckSpelling:{name:'DialogCheckSpelling',inDesignView:true,hide:'bleed,safe,visible',width:43,shouldShow:function(d_f){return!Uize.isEmpty(d_f);},getAssociatedData:function(d_g){
var d_o={};for(var ix=0;ix<d_g.length;ix++){var d_i=d_g[ix];var d_k={};var d_p=d__(d_i.Texts,function(text){return!text.IsLocked||text.TemplateName;});if(!Uize.isEmpty(d_p)){d_o[d_i.Name]=d_p;}}return d_o;
}}};var d_q={DialogCheckSides:'A',DialogCheckTemplates:'B',DialogCheckBleed:'C',DialogCheckSpelling:'D',d_r:'E',d_s:'F',d_t:'G',d_u:'H',d_v:'J',d_w:'K',DialogCheckSimpletext:'L'};var d_x=[];var d_y=true;
function makeTemplateInfo(d_z,d_k){var obj={Name:d_z.get('name'),Value:d_z.get('value'),IsLocked:d_z.get('locked'),TemplateName:d_z.get('templateUrlKey')||""};if(obj.TemplateName){var d_A=d_k[obj.TemplateName];
if(!d_A){console.warn("Cannot find template for childObject: "+obj.Name+" templateName: "+obj.TemplateName);}else{obj.DisplayName=d_A.nameVerbose;obj.Unmodified= !d_A.isModified;}}return obj;}function constructSide(area){
return{Texts:[],Images:[],Name:area.get('name'),IsBlank:true,GroupName:area.get('areaGroupName'),BleedProblems:[],SafeProblems:[]};}function addAreaToSide(side,area,d_k){var Texts=side.Texts;Uize.forEach(area.get('textDesignObjects'),function(textDesignObject){
Texts.push(makeTemplateInfo(textDesignObject,d_k));});var Images=side.Images;Uize.forEach(area.get('imageDesignObjects'),function(imageDesignObject){Images.push(makeTemplateInfo(imageDesignObject,d_k));
});side.IsBlank=side.IsBlank&&area.get('designObjects').length===0;if(!Uize.isEmpty(area.get('designObjectsInsideBleed'))){side.BleedProblems.push(Uize.Json.to(area.get('designObjectsInsideBleed')));
}if(!Uize.isEmpty(area.get('designObjectsOutsideSafeArea'))){side.SafeProblems.push(Uize.Json.to(area.get('designObjectsOutsideSafeArea')));}}function d_B(d_C){var obj={};obj.GroupName=d_C;obj.IsBlank=true;
return obj;}function createCheckData(d_D,d_E){var sideData=[];var areaMap={};var designAreas=d_D.get('activeDesignAreas');var groupNameToSide={};var templates=d_D.get('templateValuesLookup');Uize.forEach(designAreas,function(designArea){
var groupName=designArea.get('areaGroupName');if(!groupNameToSide[groupName]){groupNameToSide[groupName]=constructSide(designArea);sideData.push(side);}var side=groupNameToSide[groupName];addAreaToSide(side,designArea,templates);
});var missingAreaGroupNames=d_D.get('missingAreaGroupNames');Uize.forEach(missingAreaGroupNames,function(d_F,groupName){groupNameToSide[groupName]=d_B(groupName);});return{sideData:Uize.values(groupNameToSide),
product:Uize.Url.toParams(d_E.serialize())};}return function(d_G){d_G.declare({mixins:[Zazzle.Widget.mV2,Zazzle.Widgets.Rooter.mModels],stateProperties:{isCustomizing:'isCustomizing',d_H:{name:'confirmedDialogData',
value:{}},potentialDoublecheckDialogs:{value:['DialogCheckSides','DialogCheckTemplates','DialogCheckBleed','DialogCheckSpelling']},doubleCheckDialogBlacklist:{derived:{properties:'isCustomizing,isTemplate',
derivation:function(isCustomizing,d_I){var d_J=[];if(isCustomizing){d_J.push('DialogCheckTemplates');}else{d_J.push('DialogCheckBleed');d_J.push('DialogCheckSides');if(!d_I)d_J.push('DialogCheckTemplates');
}return d_J;}}}},modelBindings:{isCustomizing:'<-design',isTemplate:'<-product'},modelEventBindings:{':RegisterBeforeFinish':{handler:function(d_K){var m=this;d_K.waitFor&&d_K.waitFor('DoublecheckFlow',function(d_L){
var doubleCheckData=createCheckData(m.models.design,m.models.product);m.doublecheck(doubleCheckData,m.get('doubleCheckDialogBlacklist'),d_K.finishAction!=='purchase',function(d_M){d_L&&d_L(d_M,'DoublecheckFlow');
},m.get('potentialDoublecheckDialogs'));});}}},instanceMethods:{doublecheckClearData:function(){this.set({confirmedDialogData:{}});},doublecheck:function(d_N,d_O,d_P,d_Q,d_R){var m=this;if(d_y){d_y=false;
m.web(window).unload(function(){d_x.push(d_q.d_w);m.fire({name:'Track Event',bubble:true,extra:{ax:'doublecheck',params:Uize.Json.to(d_x)}});});}if(d_P){d_x.push(d_q.d_r);}else{d_x.push(d_q.d_s);}var d_R=Uize.isArray(d_R)?d_R:['DialogCheckSides','DialogCheckTemplates'];
var d_S=[];for(var ix=0;ix<d_R.length;ix++){var d_T=d_R[ix];if(Uize.indexIn(d_O,d_T)>=0)continue;d_S.push(d_e[d_T]);}var d_U=d_N.sideData;var d_V=d_N.inputParams;for(var ix=d_S.length-1;ix>=0;ix--){var d_W=d_S[ix];
var name=d_W.name;var d_f=d_W.getAssociatedData(d_U);if(Uize.global().localStorage&&localStorage.getItem("showAllDoubleCheckDialogs")){continue;}if(d_$(d_f)===m.d_H[name]){if(Uize.global().localStorage&&localStorage.debug){
console.log("Skipping "+name+" with:\n"+Uize.Json.to(d_f,"","\t"));}d_S.splice(ix,1);}else if(!d_W.shouldShow(d_f)){if(Uize.global().localStorage&&localStorage.debug){console.log("Skipping cached "+name+" with:\n"+Uize.Json.to(d_f,"","\t"));
}d_S.splice(ix,1);}}var d_X=0;for(var ix=0;ix<d_S.length;ix++){var d_Y=d_S[ix].width;if(d_Y>d_X){d_X=d_Y;}}var d_Z={};d_Z.CheckDesignData=Uize.Json.to(d_U);d_Z.product=d_N.product;if(Uize.global().localStorage&&localStorage.debug){
if(d_S.length>0){d_Z.CheckDesignData=Uize.Json.from(d_Z.CheckDesignData);console.log("Starting flow with"+"\n"+Uize.Json.to(d_Z,"","\t")+"\n\n"+Uize.Json.to(d_U,"","\t"));d_Z.CheckDesignData=Uize.Json.to(d_Z.CheckDesignData);
}}d_0();function d_0(){if(d_S.length===0){if(d_P){d_x.push(d_q.d_t);}else{d_x.push(d_q.d_u);}d_Q&&d_Q(true);return;}var d_W=d_S.shift();var name=d_W.name;d_Z.InDesignView=d_W.inDesignView;d_Z.Hide=d_W.hide;
d_Z.noCache= +new Date();if(Uize.global().localStorage&&localStorage.debug){var d_f=d_W.getAssociatedData(d_U,d_Z);d_Z.CheckDesignData=Uize.Json.from(d_Z.CheckDesignData);console.log("Showing "+name+" with:"
+"\n"+Uize.Json.to(d_Z,"","\t")+"\n-->\n"+Uize.Json.to(d_f,"","\t"));d_Z.CheckDesignData=Uize.Json.to(d_Z.CheckDesignData);}var namePath='Zazzle.Widgets.Dialog.Doublecheck.'+name;var d_1;d_x.push(d_q[name]);
m.callInherited('useDialog')({component:{name:namePath,params:d_Z},widgetProperties:{name:name,width:d_X+'em'},widgetEventHandlers:{'After Show':function(){d_1=new Date();},'Cancel':function(){m.fire({
name:'Track Event',bubble:true,extra:{ax:'doublecheckCancelled',duration:new Date()-d_1,name:name},onDoneOrTimeout:function(){d_Q&&d_Q(false);}});},'Close':function(){m.fire({name:'Track Event',bubble:true,
extra:{ax:'doublecheckClosed',duration:new Date()-d_1,name:name}});},'Ok':function(){m.fire({name:'Track Event',bubble:true,extra:{ax:'doublecheckOked',duration:new Date()-d_1,name:name},onDoneOrTimeout:function(){
m.d_H[name]=d_$(d_f);d_0();}});},'Error':function(d_v){m.fire({name:'Track Event',bubble:true,extra:{ax:'doublecheckErrored',duration:new Date()-d_1,name:name},onDoneOrTimeout:function(){console.error(d_v);
d_x.push(d_q.d_v);d_0();}});}}});}}}});};}});
Uize.module({name:'Zazzle.Widgets.Rooter.View',superclass:'Zazzle.Widget.V2',required:['Zazzle.Widgets.Rooter.mView','Zazzle.Widgets.Rooter.mDoublecheck'],builder:function(f_$){'use strict';var f__=null,
f_a=Uize;return f_$.subclass({mixins:[Zazzle.Widgets.Rooter.mView,Zazzle.Widgets.Rooter.mDoublecheck],children:{toggleArtView:f__,toggleBoundaries:f__,toggleGrid:f__},childBindings:{showBoundaries:'toggleBoundaries.selected',
showGrid:'toggleGrid.selected',useAlternateValue:['toggleArtView.selected',{child:'toggleBoundaries',property:'enabled',direction:'->',valueAdapter:{aToB:function(f_b){return f_b?'inherited':false;}}
},{child:'toggleGrid',property:'enabled',direction:'->',valueAdapter:{aToB:function(f_b){return f_b?'inherited':false;}}}]},cssBindings:{hasMultipleRealviews:['','hasMultiViews'],isCustomizing:['','isCustomizing'],
useAlternateValue:['hideArtView','showArtView']},eventBindings:{},instanceMethods:{updateUi:function(){Uize.callOn(this.children,'updateUi');f_$.doMy(this,'updateUi');}}});}});
Uize.module({name:'Zazzle.Widgets.Spp.View',superclass:'Zazzle.Widgets.Rooter.View',required:['Uize.Dom.Event','Uize.Dom.Pos','Uize.Url','Uize.Widget.Button','Uize.Widget.Fleeting','Zazzle.Widgets.Scrolly',
'Zazzle.Widgets.Spp.MainView','Zazzle.Widgets.Spp.ViewSelector','Zazzle.Widgets.Spp.TileList.mTileQuirks'],builder:function(g_$){'use strict';var g__=true,g_a=false,g_b=Uize,g_c=g_b.Widget.Button,g_d=function(a,b){
return((a%b)+b)%b;};return g_$.subclass({mixins:[Zazzle.Widgets.Spp.TileList.mTileQuirks],stateProperties:{g_e:'activeValue',g_f:'canRedo',g_g:'canUndo',g_h:{name:'fullscreenMode',onChange:function(){
var m=this,g_i;if(m.g_h){m.set({g_j:m.children.mainView.get('imageSize')});g_i=m.g_k;}else{g_i=m.g_j;m.web('viewportWrapper').css('padding-top','');}m.children.mainView.set('imageSize',g_i);setTimeout(function(){
m.centerFullscreenView();m.children.scrolly.updateUi();},100);}},g_j:'fullscreenModeInitialViewSize',g_k:'fullscreenModeViewSize',g_l:{name:'showZoomPreview',onChange:function(){var m=this;m.fire({name:'Zoom Preview Toggled',
currentImageUrl:m.children.mainView.get('value'),currentViewSize:m.web('viewport').width(),getImageUrl:function(g_m){return g_b.Url.resolve(m.children.mainView.get('value'),{max_dim:g_m});},shouldShow:m.g_l,
bubble:true});}},g_n:'viewportCoords',g_o:'viewportHeight',g_p:'viewportWidth',g_q:'windowHeight',g_r:'windowWidth',g_s:'zoomPreviewActiveFor',g_t:'zoomPreviewAspect',g_u:{name:'zoomPreviewHeight',derived:'zoomPreviewAspect,zoomPreviewWidth: Math.round(zoomPreviewWidth / zoomPreviewAspect)'
},g_v:{name:'zoomPreviewLeft',conformer:function(g_v){var m=this;return g_b.constrain(g_v,0,m.g_p-m.g_w);}},g_x:{name:'zoomPreviewTop',conformer:function(g_x){var m=this;return g_b.constrain(g_x,0,m.g_o-m.g_u);
}},g_w:{name:'zoomPreviewWidth',derived:'viewportWidth,zoomPreviewWidthPercentage: zoomPreviewWidthPercentage / 100 * viewportWidth'},g_y:'zoomPreviewWidthPercentage',g_z:{name:'zoomToolActive',onChange:function(){
if(this.g_z)this.fire({name:'Track Event',extra:{ax:'zoomToolEnabled',bubble:true}});}}},children:{artViewExplanation:g_b.Widget.Fleeting,fullscreenView:g_c,fullscreenViewClose:g_c,mainView:Zazzle.Widgets.Spp.MainView,
redo:{widgetClass:g_c,classNamingForStates:''},scrolly:Zazzle.Widgets.Scrolly,toggleArtView:{widgetClass:g_c,clickToSelect:g__,clickToDeselect:g__,classNamingForStates:''},toggleBoundaries:{widgetClass:g_c,
clickToSelect:g__,clickToDeselect:g__,classNamingForStates:''},toggleGrid:{widgetClass:g_c,clickToSelect:g__,clickToDeselect:g__,classNamingForStates:''},toggleZoomTool:{widgetClass:g_c,clickToSelect:g__,
clickToDeselect:g__,classNamingForStates:''},undo:{widgetClass:g_c,classNamingForStates:''},viewSelector:Zazzle.Widgets.Spp.ViewSelector},alphastructor:function(){var m=this,g_A=function(){var g_B=m.web('viewport');
m.set({g_n:g_B.coords(),g_p:g_B.width(),g_o:g_B.height(),g_r:m.web(window).width(),g_q:m.web(window).height()});};m.whenever('wired',function(){var g_C=function(){if(!m.g_n|| !m.g_n.top|| !m.g_n.left){
g_A();setTimeout(g_C,100);}};m.web(window).resize(g_A);g_C();});m.web(document.body).keydown(function(e){var g_D=m.children.viewSelector,g_E=m.children.scrolly;if(m.g_h)switch(e.which||e.charCode){case 8:
case 27:case 46:g_b.Dom.Event.preventDefault(e);m.unmet('fullscreenMode');break;case 37:case 38:g_D.set('realview',g_D.realviews[g_d(g_D.get('valueNo')-1,g_D.realviews.length)]);break;case 39:case 40:
g_D.set('realview',g_D.realviews[g_d(g_D.get('valueNo')+1,g_D.realviews.length)]);break;}});},modelBindings:{canRedo:'<-design',canUndo:'<-design',useAlternateValue:['->.showBoundaries',{property:'showGrid',
direction:'->',when:'!useAlternateValue'}]},childBindings:{activeValue:['viewSelector.valueNo','scrolly.activeListItemIndex'],canRedo:{child:'redo',property:'enabled',direction:'->',valueAdapter:{aToB:function(g_f){return g_f?'inherit':g_a}
}},canUndo:{child:'undo',property:'enabled',direction:'->',valueAdapter:{aToB:function(g_f){return g_f?'inherit':g_a}}},fullscreenMode:[{child:'scrolly',property:'centerContentWhenSinglePage',direction:'->',
valueAdapter:{aToB:'!value'}},{child:'mainView',property:'showSelectedBounds',direction:'->',valueAdapter:{aToB:'!value'}},{property:'linkSelectedBoundsVisibilityWithTentativeValue',direction:'->',valueAdapter:{
aToB:'!value'}}],useAlternateValue:{child:'viewSelector',property:'value',direction:'<-',valueAdapter:{bToA:function(){return g_a}}},zoomToolActive:'toggleZoomTool.selected'},cssBindings:{buttonStripOpen:['','buttonStripOpen'],
fullscreenMode:['','fullscreenMode'],hideTiledViews:['','hideTiledViews'],hideBoundingBoxes:['','hideBoundingBoxes'],isShowingTiledView:['','isShowingTiledView'],noArtView:['','noArtView'],showZoomPreview:['','showZoomPreview'],
zoomToolActive:['','zoomToolActive']},eventBindings:{'#viewport':{mousemove:function(e){var m=this,g_F=m.web('zoomPreview'),g_G=g_b.Dom.Event.target(e);if(!m.getInherited('isNarrow')&&((!m.get('isCustomizing')&&m.g_s=='both')
||(m.get('isCustomizing')&&m.g_s!='none'&&m.g_z))){if(g_G==g_F[0]||g_G==m.children.mainView.getNode('realview')||g_G==zPage.children.product.getNode('customizeShell')){var g_H=g_b.Dom.Pos.getEventAbsPos(e);
m.set({g_v:g_H.left-m.g_n.left-m.g_w/2,g_x:g_H.top-m.g_n.top-m.g_u/2,g_l:true});m.fire({name:'Zoom Preview Moved',bounds:{top:m.g_x/m.g_o,left:m.g_v/m.g_p,width:m.g_w/m.g_p,height:m.g_u/m.g_o},bubble:true
});}else m.unmet('showZoomPreview');}},mouseout:function(e){this.unmet('showZoomPreview');}},'fullscreenView:Click':function(){this.met('fullscreenMode');this.fire({name:'Track Event',bubble:true,extra:{
ax:'fullscreenViewButton'}});},'fullscreenViewClose:Click':function(){this.unmet('fullscreenMode');},'redo:Click':function(){this.models.design.redo()},'undo:Click':function(){this.models.design.undo()},
'viewSelector:Changed.children':function(e){if(e.newValue)this.children.scrolly.updateUi();},'viewSelector:Changed.realview':function(){if(this.g_h)this.centerFullscreenView();}},htmlBindings:{fullscreenMode:function(g_h){
this.web(document.body).setClassState('noScroll',g_h);},realviews:function(){this.children.scrolly.updateUi();},windowHeight:function(g_q){var m=this,g_I=m.web('fullscreenView');if(g_I){m.centerFullscreenView();
}},windowWidth:function(g_J){var m=this,g_I=m.web('fullscreenView'),g_B=m.web('viewport'),g_K=m.web('viewportWrapper');if(g_I){if(g_J<1150)g_K.append(g_I);else g_B.append(g_I);}},zoomPreviewHeight:'zoomPreview:style.height',
zoomPreviewWidth:'zoomPreview:style.width',zoomPreviewLeft:'zoomPreview:style.left',zoomPreviewTop:'zoomPreview:style.top'},instanceMethods:{g_L:function(g_M){var m=this,g_N=g_M.getNode(),g_O={node:g_N,
direction:'Top',message:m.web(g_N).attribute('title'),widgetProperties:{allowNegativePositionValues:false}};this.callInherited('wireTooltip')(g_O);},centerFullscreenView:function(){var m=this,g_K=m.web('viewportWrapper'),
g_I=m.web('fullscreenView'),g_B=m.web('viewport');g_K.css('padding-top',Math.max(0,(g_K.height()-g_B.height())/2));g_K.scrollLeft((g_K.scrollWidth()-g_K.width())/2);g_K.scrollTop((g_K.scrollHeight()-g_K.height())/2);
},switchToArtViewAndNotify:function(){var m=this,g_P=window.localStorage,g_Q='artViewExplanationShown',g_R= !g_P|| !g_P.getItem(g_Q);if(!m.get('noArtView')){m.met('useAlternateValue');if(g_R){m.children.artViewExplanation.met('shown');
g_P.setItem(g_Q,true);}}},updateUi:function(){this.children.scrolly.updateUi();g_$.doMy(this,'updateUi');},wireUi:function(){var m=this,g_S=['fullscreenView','toggleArtView','toggleBoundaries','toggleGrid',
'toggleZoomTool'];if(!m.isWired){g_b.forEach(g_S,function(g_T){var g_U=m.children[g_T];if(g_U){m.g_L(g_U);m.web(g_U).removeAttribute('title');}});m.web(window).resize(function(){m.children.scrolly.updateUi();
});g_$.doMy(m,'wireUi');setTimeout(function(){m.children.scrolly.updateUi();},0);}}}});}});
Uize.module({name:'Zazzle.Widgets.Rooter.mViews',required:['Zazzle.Widget.mV2','Zazzle.Widgets.Rooter.mModels'],builder:function(){'use strict';var d_$=true,d__=false,d_a=Uize,d_b=Zazzle,d_c={activeAttribute:{
d_d:'handleChildViewActiveAttributeChange',d_e:'distributeActiveAttribute',d_f:'mostrecent',d_g:'activeAttribute'},activeDesignArea:{d_d:'handleChildViewActiveDesignAreaChange',d_e:'distributeActiveDesignArea',
d_f:'mostrecent',d_g:'activeDesignArea'},preferredView:{d_d:'handleChildViewValueChange',d_e:'distributePreferredView',d_f:'first',d_g:'value'},realviewsToDisplay:{d_e:'distributeRealviewsToDisplay',
d_f:'all',d_g:'realviews'}},d_h=function(d_i){var d_j=d_c[d_i];return function(){this[d_j.d_e](this[d_i])};},d_k=d_h('activeAttribute'),d_l=d_h('activeDesignArea'),d_m=d_h('preferredView'),d_n=d_h('realviewsToDisplay')
;return function(d_o){d_o.declare({mixins:[d_b.Widget.mV2,d_b.Widgets.Rooter.mModels],stateProperties:{activeAttribute:{onChange:d_k},activeDesignArea:{onChange:d_l},childViewWidgetNamePrefix:{value:'view'
},childViews:{onChange:[d_n,d_m,d_l,d_k]},firstChildView:{derived:'childViews,numChildViews:numChildViews > 0 ? childViews[0] : undefined'},hasChildViews:{derived:'numChildViews:numChildViews > 0'},imageBackgroundColor:{
},lastChildView:{derived:'childViews,numChildViews:numChildViews > 0 ? childViews[numChildViews-1] : undefined'},numChildViews:{derived:'childViews:childViews ? childViews.length : 0'},preferredView:{
onChange:d_m},preferredViewsOnly:{value:d__},realviewsToDisplay:{onChange:d_n},singleContextOnly:{value:d_$}},alphastructor:function(){var m=this,d_p=m.children,d_q=m.addedChildren;m.uniqueChildViewWidgetNameIndex=0;
m.childViewWiredEvents={};d_q.wire('Changed.*',function(e){var d_r=m.childViews||[];d_a.forEach(e.properties,function(v,d_s){if(d_q.isMet(d_s)){var d_t=d_p[d_s];if(d_a.isFunction(d_t.getSelectedRealview)){
var d_u=m.childViewWiredEvents[d_s]={};d_a.forEach(d_c,function(d_j){var d_d=d_j.d_d;if(d_d)d_u['Changed.'+d_j.d_g]=function(e){m[d_d](e.newValue,d_t,e);};});d_t.wire(d_u);d_r=d_r.concat([d_t]);m.uniqueChildViewWidgetNameIndex++;
}}else{var d_v=[];for(var d_w= -1;++d_w<d_r.length;){var d_x=d_r[d_w];if(d_x.get('name')!=d_s)d_v.push(d_x);else d_x.unwire(m.childViewWiredEvents[d_s]);}d_r=d_v;}});m.set('childViews',d_r);});},modelBindings:{
realviewsToDisplay:{child:'realviews',property:'realviews',direction:'<-',valueAdapter:{bToA:function(d_y,d_z,m){return m.getRealviewsToDisplay()}}}},instanceMethods:d_a.copyInto({getRealviewsToDisplay:function(){
var m=this,d_z=m.models.realviews,d_A=d_z.get('productRealviews');if(d_A)return d_z.filter(d_A,m.preferredViewsOnly,m.singleContextOnly,m.preferredView);else return[];},addChildView:function(d_B,d_C){
var m=this;return m.addChild(m.getChildViewWidgetName(m.uniqueChildViewWidgetNameIndex),d_B,d_C);},forEachChildView:function(d_D){d_a.forEach(this.childViews,d_D)},getChildViewWidgetName:function(d_E){
return this.childViewWidgetNamePrefix+d_E;}},(function(){var d_F={};d_a.forEach(d_c,function(d_j,d_i){var d_g=d_j.d_g,d_f=d_j.d_f;d_F[d_j.d_e]=d_f!='all'?function(d_G){var m=this,d_H=d__;m.forEachChildView(
function(d_x){if(d_x.get(d_i)==d_G)d_H=d_$;});if(d_G&& !d_H&&m.hasChildViews)m.firstChildView.set(d_g,d_G);}:function(d_G){this.forEachChildView(function(d_x){d_x.set(d_g,d_G)});};if(d_j.d_d){d_F[d_j.d_d]=d_f=='mostrecent'
?function(d_I){this.set(d_i,d_I);}:function(d_I,d_x){var m=this;if(m.firstChildView==d_x)m.set(d_i,d_I);};}});return d_F;})())});};}});
Uize.module({name:'Zazzle.Widgets.Rooter.Views',superclass:'Zazzle.Widget.V2',required:'Zazzle.Widgets.Rooter.mViews',builder:function(f_$){'use strict';return f_$.subclass({mixins:Zazzle.Widgets.Rooter.mViews,
instanceMethods:{updateUi:function(){Uize.callOn(this.children,'updateUi');f_$.doMy(this,'updateUi');}}});}});
Uize.module({name:'Zazzle.Widgets.Spp.Views',superclass:'Zazzle.Widgets.Rooter.Views',required:'Zazzle.Widgets.Spp.View',builder:function(g_$){'use strict';return g_$.subclass({children:{view:Zazzle.Widgets.Spp.View
}});}});
Uize.module({name:'Zazzle.Widgets.Spp.AttributesInfo',superclass:'Zazzle.Widget.V2',required:'Zazzle.Widgets.Rooter.mModels',builder:function(f_$){'use strict';return f_$.subclass({mixins:Zazzle.Widgets.Rooter.mModels,
stateProperties:{f__:'attributeNames',f_a:'blankRealviewParams',f_b:{name:'blankRealviewUrl',derived:{properties:'blankRealviewParams,imageBackgroundColor',derivation:function(f_a,f_c){var m=this,f_d=m.getInherited('env')
;return(f_a&&m.models.attributes.getBlankRealviewUrl(f_d.staticRealview,152,f_c))||f_d.assets+'s.gif';}}},f_c:'imageBackgroundColor',f_e:'value'},modelBindings:{blankRealviewParams:'<-attributes',value:'<-attributes'
},cssBindings:{},htmlBindings:{blankRealviewUrl:'blankRealview',value:function(){var m=this,f_e=m.f_e;if(m.is('wired')&&f_e){var f__=m.f__,f_f=m.models.attributes.get('attributes');for(var f_g= -1;++f_g<f__.length;){
var f_h='attribute'+f_g,f_i=f_f[f__[f_g]],f_j=f_i.get('value'),f_k=f_j&&f_j.get('description');m.web(f_h+'Title').value(f_i.get('title')+':');m.web(f_h+'ValueTitle').value(f_j&&f_j.get('title'));m.web(f_h+'ValueDescription').html(f_k);
m.web(f_h).display(!!f_k);}}}}});}});
Uize.module({name:'Zazzle.FormWarnings',superclass:'Uize.Widget.FormWarnings',required:'Zazzle.Widget.mV2',builder:function(e_$){'use strict';return e_$.subclass({mixins:Zazzle.Widget.mV2});}});
Uize.module({name:'Zazzle.Widgets.Spp.ValueMessaging',superclass:'Zazzle.Widget.V2',required:['Uize.Widget.mModels'],builder:function(f_$){'use strict';var f__=Uize;return f_$.subclass({mixins:f__.Widget.mModels,
stateProperties:{f_a:{name:'availableWidth'},f_b:{name:'hasFreeShipping',onChange:function(){var m=this,f_c=f__.indexIn(m.f_d,'FreeShipping'),f_e=f__.copyList(m.f_d);if(m.f_b){if(f_c> -1)f_e.splice(f_c,1);
}else if(f_c== -1)f_e.push('FreeShipping');m.set({f_d:f_e});}},f_f:'messages',f_d:'messagesToHide',f_g:'recalculateVisibleMessages',f_h:{name:'visibleMessages',derived:{properties:'availableWidth,messages,recalculateVisibleMessages',
derivation:function(f_a,f_f){var m=this,f_h=[];if(f_a&& !f__.isEmpty(f_f)){f__.forEach(f_f,function(f_i,f_j){var f_k=m.web('message'+f_j),f_l=f_k.offset(f_k[0].parentNode).left,f_m=f_l+f_k.width(),f_n=f__.indexIn(m.f_d,f_i)> -1
;if(f_m<=f_a&& !f_n)f_h.push(f_i);})}return f_h;}}}},alphastructor:function(){var m=this;m.whenever('wired',function(){m.web(window).resize(function(){m.f_o();});f__.forEach(m.getNode().querySelectorAll('[title]'),function(f_p){
m.callInherited('wireTooltip')({node:f_p,hideTimeout:10000});});})},htmlBindings:{messagesToHide:function(f_d){var m=this;f__.forEach(m.f_f,function(f_i,f_j){var f_q=f__.indexIn(f_d,f_i)> -1;m.web('message'+f_j).css({display:f_q?'none':'inline-block'});
});m.set({f_g:Math.random()});},visibleMessages:function(f_h){var m=this,f_h=m.f_h;f__.forEach(m.f_f,function(f_i,f_j){var f_r=f__.indexIn(f_h,f_i)> -1;m.web('message'+f_j).css({visibility:f_r?'visible':'hidden'
}).removeClass(m.cssClass('lastVisibleMessage'));});if(f_h.length){var f_s=f__.indexIn(m.f_f,f_h[f_h.length-1]);m.web('message'+f_s).addClass(m.cssClass('lastVisibleMessage'));}}},modelBindings:{hasFreeShipping:'<-attributes'
},instanceMethods:{updateUi:function(){var m=this;if(m.isWired){m.f_o();f_$.doMy(m,'updateUi');}},f_o:function(){this.set({f_a:this.web().width()})}}});}});
Uize.module({name:'Zazzle.Widgets.Rooter.mProductTitle',required:['Zazzle.Widget.mV2','Zazzle.Widgets.Rooter.mModels'],builder:function(){'use strict';var d_$=false,d__=null,d_a=Uize,d_b=Zazzle;return function(d_c){
d_c.declare({mixins:[d_b.Widget.mV2,d_b.Widgets.Rooter.mModels],stateProperties:{customTitle:{onChange:function(){var m=this,d_d=m.customTitle;if(!m.initialCustomTitle)m.set({initialCustomTitle:d_d});
if(!m.customTitleHasChanged&&(d_d!=m.initialCustomTitle))m.met('customTitleHasChanged');if(m.customTitleHasChanged&&m.enableUserTitle&& !m.hasUserTitle)m.set({value:d_d});}},customTitleHasChanged:{},
designerId:{},enableUserTitle:{},hasUserTitle:{},initialCustomTitle:{},value:{}},children:{},modelBindings:{customTitle:'<-attributes',designerId:'<-product',value:'product.title'},childBindings:{},eventBindings:{
},modelEventBindings:{'product:Changed.isCustomizing':function(e){var m=this;if(e.newValue&&m.enableUserTitle&& !m.hasUserTitle&&(m.getInherited('user').id!=m.designerId))m.set({value:m.customTitle});
}},instanceMethods:{}});};}});
Uize.module({name:'Zazzle.Widgets.Rooter.ProductTitle',superclass:'Zazzle.Widget.V2',required:['Zazzle.Widgets.Rooter.mProductTitle'],builder:function(f_$){'use strict';var f__=null,f_a=Uize;return f_$.subclass({
mixins:Zazzle.Widgets.Rooter.mProductTitle,cssBindings:{enableUserTitle:['','enableUserTitle']},instanceMethods:{getNewTitle:function(){var m=this;m.callInherited('useDialog')({component:{name:'Zazzle.Dialog.Input',
params:{useTextArea:false,inputMaxlength:50,inputMinlength:1}},widgetProperties:{name:'changeProductTitleDialog',persistText:false,title:m.localize('renameProduct'),value:m.value,width:500},submitHandler:function(f_b){
m.set({hasUserTitle:true,value:f_b});}});}},eventBindings:{'#:click':function(){var m=this;if(m.get('enableUserTitle')&&m.is('enabledInherited')&& !m.is('busyInherited'))m.getNewTitle();}}});}});
Uize.module({name:'Zazzle.Widgets.Spp.ProductTitle',superclass:'Zazzle.Widgets.Rooter.ProductTitle',builder:function(g_$){'use strict';var g__=Uize;return g_$.subclass({stateProperties:{g_a:{name:'highlightDuration',
value:1000},g_b:{name:'isHighlighting',onChange:function(){var m=this;if(m.g_b)setTimeout(function(){m.unmet('isHighlighting');},m.g_a);}},g_c:'valueHasBeenChanged'},cssBindings:{isHighlighting:['','isHighlighting']
},htmlBindings:{value:'title'},eventBindings:{':Changed.value':function(){var m=this;if(m.get('enableUserTitle')&&m.g_c)m.met('isHighlighting');m.met('valueHasBeenChanged');}}});}});
Uize.module({name:'Zazzle.Widgets.Rooter.mPrice',required:['Zazzle.Widget.mV2','Zazzle.Widgets.Rooter.mModels'],builder:function(){'use strict';var d_$=false,d__=null,d_a=Uize,d_b=Zazzle;return function(d_c){
d_c.declare({mixins:[d_b.Widget.mV2,d_b.Widgets.Rooter.mModels],stateProperties:{discountPercentage:{derived:{properties:'discountedUnitPrice,unitPrice',derivation:function(d_d,d_e){return(1-d_d/d_e)*100
}}},discountedUnitDisplayPrice:{},discountedUnitPrice:{},hasDiscount:{derived:'discountPercentage: discountPercentage > 0'},inStock:{},isPreorder:{},originalUnitPrice:{derived:'discountedUnitDisplayPrice,unitDisplayPrice: (discountedUnitDisplayPrice != unitDisplayPrice) && unitDisplayPrice'
},perUnitLabel:{},unitDisplayPrice:{},unitPrice:{}},modelBindings:{discountedUnitDisplayPrice:'<-pricing',discountedUnitPrice:'<-pricing',inStock:'<-attributes',isPreorder:'<-attributes',perUnitLabel:'<-attributes',
unitDisplayPrice:'<-pricing',unitPrice:'<-pricing'}});};}});
Uize.module({name:'Zazzle.Widgets.Rooter.Price',superclass:'Zazzle.Widget.V2',required:'Zazzle.Widgets.Rooter.mPrice',builder:function(f_$){'use strict';return f_$.subclass({mixins:Zazzle.Widgets.Rooter.mPrice,
stateProperties:{f__:{name:'schemaOrgAvailabilityMetaContent',derived:{properties:'inStock,isPreorder,schemaOrgAvailabilityMetaContentUrls',derivation:function(f_a,f_b,f_c){var f_d=f_a?'inStock':(f_b?'preorder':'oos');
return f_c[f_d];}}},f_c:'schemaOrgAvailabilityMetaContentUrls'},cssBindings:{hasDiscount:['','hasDiscount']}});}});
Uize.module({name:'Zazzle.Widgets.Spp.Price',superclass:'Zazzle.Widgets.Rooter.Price',builder:function(g_$){'use strict';var g__=Uize;return g_$.subclass({stateProperties:{},children:{},childBindings:{
},cssBindings:{},htmlBindings:{discountedUnitDisplayPrice:'price',originalUnitPrice:function(g_a){this.web('originalPrice').html(g_a||'');},perUnitLabel:'perUnitLabel',schemaOrgAvailabilityMetaContent:'availabilityMeta:content'
}});}});
Uize.module({name:'Zazzle.Models.Rooter.AttributeValue',superclass:'Zazzle.Model',required:['Uize.Data.Compare','Uize.Url'],builder:function(d_$){'use strict';var d__=null,d_a,d_b=Uize,d_c=d_b.Url,d_d=d_b.keys({d_e:1})[0],
d_f=d_b.Data.Compare.identical,d_g=function(d_h,d_i){return d_f(d_h,d_i)?d_i:d_h;},d_j=function(){this.fire('Update URL');};return d_$.subclass({stateProperties:d_b.copyInto({d_e:{conformer:d_g,onChange:function(){this.fire('Data Updated')}
},d_k:{name:'templateParams',conformer:d_g,onChange:d_j}},d_b.map({d_l:{name:'blankRealviewParams',conformer:d_g,onChange:d_j},d_m:'callouts',d_n:'description',d_o:'displayPrice',d_p:'displayPriceDifferential',
d_q:{name:'iconParams',conformer:d_g,onChange:d_j},d_r:'inStock',d_s:'isBestValue',d_t:'isPopular',d_u:'name',d_v:'price',d_w:'priceDifferential',d_x:{name:'properties',conformer:d_g},d_y:{name:'realviewParams',
conformer:d_g,onChange:d_j},d_z:'shortDescription',d_A:'shortTitle',d_B:'title',d_C:'totalPrice',d_D:'totalDisplayPrice'},function(d_E){d_E=d_b.isPlainObject(d_E)?d_E:{name:d_E};d_E.derived=d_d+':'+d_d+'["'+(d_E.d_F||d_E.name)+'"]';
delete d_E.d_F;return d_E;})),staticMethods:{create:function(d_e){return new this({d_e:d_e})}},alphastructor:function(){this.d_G=0;},instanceMethods:{d_j:d_j,defeatRealviewUrlCache:function(){++this.d_G;
this.d_j();},getBlankRealviewUrl:function(d_H,d_I,d_J,d_K){var m=this,d_l=m.d_l;return d_l?d_c.resolve([d_H,d_l,{max_dim:d_I,bg:d_J},d_K]):d__;},getIconUrl:function(d_H,d_I,d_J,d_K){var m=this,d_q=m.d_q
;return d_q?d_c.resolve([d_H,d_q,{max_dim:d_I,bg:d_J},d_K]):d__;},getRealviewUrl:function(d_H,d_I,d_J,d_K){var m=this,d_y=m.d_y;return d_y?d_c.resolve([d_H,d_y,m.d_k,{max_dim:d_I,bg:d_J},m.d_G!=0&&{r:m.d_G},
d_K]):d__;},toValueDetails:function(d_L,d_M,d_N){d_N=d_N||{};var m=this,d_O=d_N.thumbnailBackgroundColor,d_P=d_N.additionalThumbnailUrlParams;return{name:m.d_u,displayName:m.d_B,displayNameAlt:m.d_A,
importantInfo:d_N.usePriceDifferential?(m.d_w!=0?((m.d_w>0?'+':'-')+m.d_p):d_a):m.d_D,thumbnailUrl:d_N.useBlankThumbnailRealview?m.getBlankRealviewUrl(d_L,d_M,d_O,d_P):m.getRealviewUrl(d_L,d_M,d_O,d_P),
thumbnailUrlAlt:m.getIconUrl(d_L,d_M,d_O,d_P),description:m.d_n,descriptionAlt:m.d_z,callouts:m.d_m,attributes:m.d_x};},update:function(d_e){this.set({d_e:d_e})}}});}});
Uize.module({name:'Zazzle.Models.Rooter.Attribute',superclass:'Zazzle.Model',required:['Uize.Data.Compare','Zazzle.Models.Rooter.AttributeValue'],builder:function(d_$){'use strict';var d__=Uize,d_a=Zazzle,
d_b=d_a.Models.Rooter.AttributeValue,d_c=d__.keys({d_d:1})[0],d_e=d__.Data.Compare.identical,d_f=function(d_g,d_h){return d_e(d_g,d_h)?d_h:d_g;};return d_$.subclass({stateProperties:d__.copyInto({d_i:{
name:'bestValue',derived:'valuesLookup,bestValueName:valuesLookup[bestValueName]'},d_d:{conformer:d_f,onChange:function(){var m=this,d_d=m.d_d;m.set({d_j:d_d.value});}},d_k:{name:'hasMultipleValues',
derived:'totalValues:totalValues > 1'},d_l:{name:'hasValues',derived:'totalValues:totalValues > 0'},d_m:{name:'popularValues',conformer:d_f,derived:{properties:'valuesLookup,popularValueNames',derivation:function(d_n,d_o){
return d__.map(d_o,function(v,d_p){return d_n[d_p]});}}},d_q:{name:'templateParams'},d_r:{name:'templateParamsSync',derived:'values, templateParams: Math.random()',onChange:function(){var m=this,d_s=m.d_s,
d_q=m.d_q;for(var d_t= -1;++d_t<d_s.length;)d_s[d_t].set('templateParams',d_q);}},d_u:{name:'value',derived:'valuesLookup,valueName:valuesLookup && valuesLookup[valueName]'},d_j:'valueName',d_s:{name:'values',
conformer:d_f,derived:{properties:d_c,derivation:function(d_d){var m=this,d_v=d_d.values,d_w=d_v.length,d_x=d__.copy(m.d_n),d_s=[];for(var d_t= -1;++d_t<d_w;){var d_y=d_v[d_t],d_j=d_y.name;if(d_j in d_x){
var d_z=d_x[d_j];d_z.update(d_y);d_s.push(d_z);delete d_x[d_j];}else{d_s.push(d_b.create(d_y));}}for(var d_A in d_x)d_x[d_A].kill();return d_s;}}},d_n:{name:'valuesLookup',conformer:d_f,derived:{properties:'values',
derivation:function(d_s){var d_n={};for(var d_t= -1;++d_t<d_s.length;){var d_B=d_s[d_t];d_n[d_B.get('name')]=d_B;}return d_n;}}},d_C:{name:'totalValues',derived:'values:values.length'}},d__.map({d_D:{
d_E:'higherUpsell',d_F:'higher'},d_G:{d_E:'highestUpsell',d_F:'highest'},d_H:{d_E:'lowerDownsell',d_F:'lower'},d_I:{d_E:'lowestDownsell',d_F:'lowest'}},function(d_J){return{name:d_J.d_E,derived:d_c+',valuesLookup:valuesLookup['+d_c+'.upsellInfo.'+d_J.d_F+']'
};}),d__.map({d_K:{name:'bestValueName',d_L:'bestValue'},d_M:'description',d_N:'hasIncompleteValues',d_O:'name',d_o:{name:'popularValueNames',d_L:'popularValues'},d_J:'properties',d_P:'title',d_Q:'totalValuesCount'
},function(d_R){d_R=d__.isPlainObject(d_R)?d_R:{name:d_R};d_R.derived=d_c+':'+d_c+'["'+(d_R.d_L||d_R.name)+'"]';delete d_R.d_L;return d_R;})),staticMethods:{create:function(d_d){return new this({d_d:d_d})}
},instanceMethods:{defeatRealviewUrlCache:function(){d__.callOn(this.d_s,'defeatRealviewUrlCache');},update:function(d_d){this.set({d_d:d_d})}}});}});
Uize.module({name:'Zazzle.Models.Rooter.Attributes',superclass:'Zazzle.Model',required:['Uize.Data.Compare','Uize.Url','Zazzle.Models.Rooter.Attribute'],builder:function(d_$){'use strict';var d__=true,
d_a=null,d_b,d_c=Uize,d_d=Zazzle,d_e=d_d.Models.Rooter.Attribute,d_f=d_c.keys({d_g:1})[0],d_h='getAttributesInfo',d_i='Primary',d_j='Purchase',d_k=d_c.Data.Compare.identical,d_l=function(d_m){return d_m instanceof Date
?d_m:new Date(d_m);},d_n=function(d_m,d_o){return d_k(d_m,d_o)?d_o:d_m;};return d_$.subclass({staticProperties:{SectionType:{Primary:d_i,Purchase:d_j}},stateProperties:d_c.copyInto({d_p:{name:'attributes',
derived:{conformer:d_n,properties:d_f,derivation:function(d_g){var m=this,d_p=m.d_p||{},d_q=d_g.attributes;d_c.forEach(d_q,function(d_r,d_s){if(d_s in d_p){d_p[d_s].update(d_r);}else{var d_t=d_p[d_s]
=d_e.create(d_q[d_s]);d_t.wire({'Changed.valueName':function(){m.setAttributeValue(d_s,d_t.get('valueName'));}});}});for(var d_s in d_p){if(!(d_s in d_q)){d_p[d_s].kill();delete d_p[d_s];}}return d_p;
}}},d_u:'attributesInfoUrlEndPoint',d_g:{conformer:d_n,onChange:function(){var m=this,d_g=m.d_g;m.set({d_v:d_g.priceMarkup,d_w:d_g.preferredViewId,d_x:m.d_x+1});}},d_y:{name:'oosAttributes',conformer:d_n,
derived:{properties:'attributes',derivation:function(d_p){var d_y={};for(var d_s in d_p){var d_t=d_p[d_s],d_z=d_t.get('value');if(d_z&& !d_z.isMet('inStock'))d_y[d_s]=d_t;}return d_y;}}},d_w:{name:'preferredViewId',
onChange:d_h},d_v:{name:'priceMarkup',conformer:function(d_A){return d_c.constrain(d_A,0,1)},onChange:d_h,value:0.05},d_B:{name:'templateParams',conformer:d_n},d_C:{name:'templateParamsSync',derived:'attributes, templateParams: Math.random()',
onChange:function(){var m=this,d_p=m.d_p,d_B=m.d_B;for(var d_s in d_p)d_p[d_s].set('templateParams',d_B);}},d_x:{name:'updateCount',value:0},d_A:{name:'value',derived:{properties:'attributes,updateCount',
derivation:function(d_p){return d_c.map(d_p,function(d_t){return d_t.get('value')});}}}},d_c.map({d_D:'amountPerPack',d_E:'blankRealviewParams',d_F:'customTitle',d_G:'departmentId',d_H:{name:'dependencies',
conformer:d_n},d_I:'description',d_J:'forcedQuantities',d_K:'hasForcedQuantities',d_L:'hasFreeShipping',d_M:'inStock',d_N:'isPreorder',d_O:'isVizLite',d_P:'preorderAvailableDate',d_Q:'makeDateIsTomorrow',
d_R:'maxDisplayMakeDates',d_S:{name:'maxMakeDate',conformer:d_l},d_T:'maxMakeDays',d_U:'maxQuantity',d_V:'minDisplayMakeDates',d_W:{name:'minMakeDate',conformer:d_l},d_X:'minMakeDays',d_Y:'minQuantity',
d_Z:'perUnitLabel',d_0:'pluralUnitLabel',d_1:'prop65Message',d_2:'quantityIncrement',d_3:'safetyWarning',d_4:'shortDescription',d_5:'shortTitle',d_6:'singularUnitLabel',d_7:'supportedDesignAreaNames',
d_8:'technicalSpecs',d_9:'title',d_$_:'warrantyMessage'},function(d___){d___=d_c.isPlainObject(d___)?d___:{name:d___};d___.derived=d_f+':'+d_f+'["'+(d___.d_a_||d___.name)+'"]';delete d___.d_a_;return d___;
})),instanceMethods:{getAttributesInfo:function(){var m=this,d_b_=m.getAttributesInfoServiceParams();!m.d_c_&& !d_c.isEmpty(d_b_)&&m.ajax(m.d_u,d_b_,{requestOverrides:{cache:'memory'},callbackSuccess:function(d_d_){
var d_c_=m.d_c_;m.d_c_=d__;m.processInfoData(m.normalizeInfoServiceResponse(d_d_.data));m.d_c_=d_c_;},callbackFail:function(){}});},getAttributesInfoServiceParams:function(){var m=this;return{mu:m.d_v,
preferredViewId:m.d_w};},normalizeInfoServiceResponse:function(d_e_){return d_e_;},processInfoData:function(d_f_){this.set({d_g:d_f_});},defeatRealviewUrlCache:function(){d_c.callOn(this.d_p,'defeatRealviewUrlCache');
},getBlankRealviewUrl:function(d_g_,d_h_,d_i_,d_j_){var m=this,d_E=m.d_E;return d_E?d_c.Url.resolve([d_g_,d_E,{max_dim:d_h_,bg:d_i_},d_j_]):d_a;},initialize:function(d_g){var m=this,d_c_=m.d_c_;m.d_c_=d__;
!d_c.isEmpty(d_g)&&m.processInfoData(d_g);m.d_c_=d_c_;},reset:function(d_k_){this.set(d_c.copyInto({},d_k_));},setAttributeValue:function(){}}});}});
Uize.module({name:'Zazzle.Models.Rooter.Product',superclass:'Zazzle.Model',required:['Uize.Data.Compare','Uize.Url','Zazzle.Models.Rooter.Realview'],builder:function(d_$){'use strict';var d__=true,d_a=false,
d_b=null,d_c=Uize,d_d=Zazzle.Models.Rooter.Realview.Type,d_e=d_c.keys({d_f:1})[0],d_g='None',d_h='ProductDesign',d_i='ProductConfiguration',d_j=d_c.Data.Compare.identical,d_k=function(d_l){return d_l instanceof Date
?d_l:new Date(d_l);},d_m=function(d_l,d_n){return d_j(d_l,d_n)?d_n:d_l;};return d_$.subclass({models:{design:d_b,pricing:d_b,attributes:d_b,realviews:d_b},staticProperties:{ExperienceType:{None:d_g,ProductDesign:d_h,
ProductConfiguration:d_i}},stateProperties:d_c.copyInto({d_o:'activeDesignAreasLookup',d_p:{},d_f:{conformer:d_m,onChange:function(){var m=this,d_f=m.d_f;m.set({d_q:d_f.priceMarkup,d_r:d_f.preferredViewId,
d_s:d_f.title});}},d_t:'designAreas',d_u:'designRealviews',d_v:'isCustomizing',d_w:{name:'mainDesignView',derived:{properties:['activeDesignAreasLookup',d_c.keys({d_p:1})[0],'designAreas','designRealviews','preferredView','preferredViewId'],
derivation:function(d_o,d_p,d_t,d_u,d_x,d_r){var m=this,d_y=d_c.keys(d_o),d_z=d_x?d_x.get('visibleDesignAreaNames'):[],d_A;for(var i in d_z){var d_B=d_z[i];if(d_B in d_o){d_A=d_B;break;}}if(d_A){var d_C=d_t[d_A];
if(d_C&&d_C.get('isTilable')){return d_x;}var d_D=m.models.realviews.getViewsForDesignArea(d_A,null,d_d.Design);if(d_D.length)return d_p[d_D[0]];}var d_E;for(var d_F in d_u){var d_G=d_u[d_F],d_H=d_a;
for(var d_I in d_G.get('primaryVisibleDesignAreaNamesLookup')){if(d_I in d_o){d_H=d__;d_E=d_G;break;}}if(d_H)break;}if(d_E)return d_E;for(var d_F in d_u){var d_G=d_u[d_F],d_J=d_u[d_F].get('visibleDesignAreaNames')
;for(var i in d_J){var d_K=d_J[i];if(d_K in d_o)return d_G;}}}}},d_x:{name:'preferredView',derived:{properties:['preferredViewId',d_c.keys({d_p:1})[0]],derivation:function(d_r,d_p){return d_p&&d_p[d_r];
}}},d_r:'preferredViewId',d_L:'publishedViewId',d_M:'productInfoUrlEndPoint',d_q:{name:'priceMarkup',conformer:function(d_N){return d_c.constrain(d_N,0,1)},value:0.05},d_O:{},d_P:{name:'templateParams',
conformer:d_m},d_s:'title'},d_c.map({d_Q:'canEditDesignObjectLock',d_R:{name:'createdDate',conformer:d_k},d_S:'createdDisplayDates',d_T:'description',d_U:'designerId',d_V:'displayPrice',d_W:'eventCategory',
d_X:'imageUrl',d_Y:'isBlankInstance',d_Z:'isBundle',d_0:'isCustomizable',d_1:'isCustomized',d_2:'isInstance',d_3:'isPrivate',d_4:'isPublic',d_5:'isTemplate',d_6:'isVizLite',d_7:'keywords',d_8:'mainDesignImageUrl',
d_9:'makerId',d_$_:'makerName',d___:'makespace',d_a_:'marketplaceCategories',d_b_:'maturity',d_c_:'merchantSellerId',d_d_:{name:'modifiedDate',conformer:d_k},d_e_:'modifiedDisplayDates',d_f_:'price',
d_g_:'productTypePluralName',d_h_:'productTypeSingularName',d_i_:'rawTitle',d_j_:'recipientCategory',d_k_:'storeCategories',d_l_:'storeHandle',d_m_:'storeId',d_n_:'url'},function(d_o_){d_o_=d_c.isPlainObject(d_o_)
?d_o_:{name:d_o_};d_o_.derived=d_e+':'+d_e+'["'+(d_o_.d_p_||d_o_.name)+'"]';delete d_o_.d_p_;return d_o_;})),staticMethods:{create:function(d_f,d_q_){var d_r_=new this(d_q_);if(d_f){var d_s_=d_r_.models;
for(var d_t_ in d_s_)d_t_ in d_f&&d_s_[d_t_].initialize(d_f[d_t_]);d_r_.initialize(d_f.info);}return d_r_;}},modelBindings:{activeDesignAreasLookup:'<-design',d_p:'<-realviews.realviewsLookup',canEditDesignObjectLock:'->design',
csrfToken:['->attributes','->design','->pricing','->realviews'],designAreas:'<-design',designRealviews:'<-realviews',isCustomizing:'<-design',priceMarkup:['->attributes','pricing'],preferredViewId:'->attributes',
serviceUrlBase:['->attributes','->design','->pricing','->realviews'],d_O:['<-attributes.supportedDesignAreaNames','->design.designAreaNames'],templateParams:['->attributes','design','->realviews']},modelEventBindings:{
'design:Design Push Success':{fireIf:'isCustomizing',handler:function(){var d_s_=this.models;d_s_.realviews.defeatImageUrlCache();d_s_.attributes.defeatRealviewUrlCache();}},'design:Design Saved':{fireIf:'isCustomizing',
handler:function(){var m=this;m.ajax('rooter/product/changedesigntitle',{designId:m.models.design.get('designId'),title:m.get('title')});}}},instanceMethods:{getData:function(){return this.get(d_c.keys(this.d_f));
},getProductInfoServiceParams:function(){return{};},getQueryParams:function(){return{};},normalizeInfoServiceResponse:function(d_u_){return d_u_;},processInfoData:function(d_v_){this.set({d_f:d_v_});
},updateProductInfo:function(){var m=this;m.getProductInfo(function(d_w_){m.processInfoData(m.normalizeInfoServiceResponse(d_w_.data));});},getProductInfo:function(d_x_,d_y_){var m=this,d_z_=d_c.copy(
m.getProductInfoServiceParams(),d_y_);!m.d_A_&& !d_c.isEmpty(d_z_)&&m.ajax(m.d_M,d_z_,{requestOverrides:{cache:'memory'},callbackSuccess:function(d_w_){var d_A_=m.d_A_;m.d_A_=d__;d_x_&&d_x_(d_w_);m.d_A_=d_A_;
},callbackFail:function(){}});},initialize:function(d_f){var m=this,d_A_=m.d_A_;m.d_A_=d__;!d_c.isEmpty(d_f)&&m.processInfoData(d_f);m.d_A_=d_A_;},reset:function(d_B_){var m=this,d_s_=m.models;m.set(
d_c.copyInto({},d_B_));d_s_.design.reset();d_s_.pricing.reset();d_s_.attributes.reset();d_s_.realviews.reset();},serialize:function(){var m=this;return d_c.copyInto(m.get(['preferredViewId','priceMarkup']),
{templateParams:m.d_P&&d_c.Url.toParams(m.d_P)});}}});}});
Uize.module({name:'Zazzle.Widgets.Rooter.mAttributeGroup',required:['Uize.Data.Compare','Zazzle.Models.Rooter.Attributes','Zazzle.Models.Rooter.Product','Zazzle.Widget.mV2','Zazzle.Widgets.Rooter.mModels'
],builder:function(){'use strict';var d_$=true,d__=false,d_a=Uize,d_b=Zazzle,d_c=d_a.map,d_d=d_a.Data.Compare.identical,d_e=function(d_f,d_g){return d_d(d_f,d_g)?d_g:d_f;},d_h=function(d_i){return function(){
var m=this,d_j=m.get(d_i);m.forEachChildAttribute(function(d_k){d_k.set(d_i,d_j)});};},d_l=d_h('experience'),d_m=d_h('imageBackgroundColor'),d_n=d_h('section');return function(d_o){d_o.declare({mixins:[
d_b.Widget.mV2,d_b.Widgets.Rooter.mModels],stateProperties:{activeAttribute:{},activeAttributeName:{},activeChildAttribute:{derived:{properties:'childAttributesLookup,activeAttributeName',derivation:function(d_p,d_q){
var d_r;if(d_p&&d_q)d_r=d_p[d_q];return d_r;}},onChange:function(){var m=this;m.forEachChildAttribute(function(d_k){d_k.set('isActive',d_k==m.activeChildAttribute)});}},allAttributes:{},attributeGroup:{
conformer:d_e},attributeGroupLookup:{derived:{properties:'attributeGroup',derivation:function(d_s){var d_t={},d_u= -1,d_v=d_s.length;for(;++d_u<d_v;){var d_w=d_s[d_u];d_t[d_w.get('name')]=d_w;}return d_t;
}}},attributeGroupNames:{conformer:d_e},childAttributes:{onChange:[d_l,d_m,d_n]},childAttributesLookup:{derived:{properties:'childAttributes',derivation:function(d_x){var d_p={},d_u= -1,d_v=d_x.length
;for(;++d_u<d_v;){var d_k=d_x[d_u];d_p[d_k.get('name')]=d_k;}return d_p;}}},childAttributeWidgetNamePrefix:{value:'attribute'},childVisibilityListCount:{value:0},experience:{onChange:d_l,value:d_b.Models.Rooter.Product.ExperienceType.None
},firstChildAttribute:{derived:'childAttributes,numChildAttributes:numChildAttributes > 0 ? childAttributes[0] : undefined'},hasChildAttributes:{derived:'numChildAttributes:numChildAttributes > 0'},imageBackgroundColor:{
onChange:d_m},isActive:{derived:'activeAttributeName,attributeGroupLookup:attributeGroupLookup && activeAttributeName in attributeGroupLookup'},isVisible:{derived:{properties:'childAttributesLookup,childVisibilityListCount',
derivation:function(d_p){var d_y=d__;for(var d_z in d_p){if(d_p[d_z].get('isVisible')){d_y=d_$;break;}}return d_y;}}},lastChildAttribute:{derived:'childAttributes,numChildAttributes:numChildAttributes > 0 ? childAttributes[numChildAttributes-1] : undefined'
},numChildAttributes:{derived:'childAttributes:childAttributes ? childAttributes.length : 0'},section:{onChange:d_n,value:d_b.Models.Rooter.Attributes.SectionType.Primary}},modelBindings:{allAttributes:'<-attributes.attributes',
activeAttributeName:{property:'activeAttribute',when:'allAttributes',valueAdapter:{aToB:function(d_z,m){return m.allAttributes[d_z]},bToA:function(d_w){return d_w&&d_w.get('name')}}},attributeGroupNames:{
property:'attributeGroup',when:'allAttributes',valueAdapter:{aToB:function(d_A,m){var d_B=m.allAttributes;return d_c(d_A,function(d_z){return d_B[d_z]});},bToA:function(d_s){return d_c(d_s,function(d_w){return d_w.get('name')}
);}}}},alphastructor:function(){var m=this,d_C=m.children,d_D=m.addedChildren;m.uniqueChildAttributeWidgetNameIndex=0;m.childAttributeWiredEvents={};d_D.wire('Changed.*',function(e){var d_x=m.childAttributes||[];
d_a.forEach(e.properties,function(v,d_E){if(d_D.isMet(d_E)){var d_F=d_C[d_E];if(true){var d_G=m.childAttributeWiredEvents[d_E]={'Changed.value':function(e){m.handleChildAttributeValueChange(e.source,d_F,e);
},'Changed.isVisible':function(){m.set('childVisibilityListCount',m.childVisibilityListCount+1);}};d_F.wire(d_G);d_x=d_x.concat([d_F]);m.uniqueChildAttributeWidgetNameIndex++;}}else{var d_H=[];for(var d_I= -1;++d_I<d_x.length;){
var d_k=d_x[d_I];if(d_k.get('name')!=d_E)d_H.push(d_k);else d_k.unwire(m.childAttributeWiredEvents[d_E]);}d_x=d_H;}});m.set('childAttributes',d_x);});},instanceMethods:{handleChildAttributeValueChange:function(d_J
){this.set('activeAttribute',d_J.get('attribute'));},forEachChildAttribute:function(d_K){d_a.forEach(this.childAttributes,d_K)},getChildAttributeWidgetName:function(d_u){return this.childAttributeWidgetNamePrefix+d_u;
}}});};}});
Uize.module({name:'Zazzle.Widgets.Rooter.AttributeGroup',superclass:'Zazzle.Widget.V2',required:'Zazzle.Widgets.Rooter.mAttributeGroup',builder:function(f_$){'use strict';var f__=null,f_a=Uize;return f_$.subclass({
mixins:Zazzle.Widgets.Rooter.mAttributeGroup,cssBindings:{experience:'value',isActive:['','active'],isVisible:['hidden',''],section:'value'}});}});
Uize.module({name:'Zazzle.Widgets.Spp.AttributeGroup',superclass:'Zazzle.Widgets.Rooter.AttributeGroup',builder:function(g_$){'use strict';var g__=Uize;return g_$.subclass({stateProperties:{},children:{
},childBindings:{},cssBindings:{},htmlBindings:{},eventBindings:{}});}});
Uize.module({name:'Zazzle.SelectorValueDisplay.DroplistButton',required:['Uize.Widget.Button','Uize.Dom.Util'],builder:function(i_$){'use strict';var i__=function(){var m=this,i_a=m.i_a;if(m.isWired){m.web(m.children.right).display(i_a);
Uize.Dom.Util.showClickable(m.web('displayName')[0],i_a&&m.get('enabledInherited'));}};return i_$.subclass({omegastructor:function(){var m=this,i_b=m.addChild('left',Uize.Widget.Button),i_c=m.addChild('right',Uize.Widget.Button)
;m.wire('Changed.selected',function(){var i_d=m.get('selected');i_b.set({selected:i_d});i_c.set({selected:i_d});});},instanceMethods:{i__:i__,updateUi:function(){var m=this;if(m.isWired&&m.canUpdate){
m.i__();i_$.doMy(m,'updateUi');}}},stateProperties:{i_a:{name:'allowSelection',onChange:[function(){this.set({enabled:this.i_a?'inherit':false})},i__],value:true}}});}});
Uize.module({name:'Zazzle.Validator',requires:['Uize.Comm.Ajax','Uize.Data'],builder:function(){'use strict';var b_$=function(){},b__=null,b_a=true,b_b=false,b_c='string',b_d;function b_e(b_f,b_g,b_h){
(b_h.commObject||new Uize.Comm.Ajax).request({url:[b_h.envUrl+b_f,b_g],returnType:'json',requestMethod:'POST',cache:'memory',callback:b_h.callback})}b_$.alphaNumeric=function(b_i){return typeof b_i==b_c&&/^\w+$/.test(b_i)
};b_$.categoryId=function(b_j){return b_$.zid(b_j,103)};b_$.storeId=function(b_j){return b_$.zid(b_j,196)};b_$.checkbox=function(b_i){return b_i};b_$.comboBoxSelectOne=function(b_k,b_l){return!b_l||b_k.selectedIndex>0
};b_$.phone=function(b_m,b_n,b_o){var b_p=b_m.replace(/\D/g,'').length;return(!!b_m&&typeof b_m==b_c&&b_p<=b_o&&b_p>=b_n&&/^([0-9]|[\s]|[()]|[-]|[+])+$/.test(b_m));};b_$.email=function(b_q){return(!!b_q&&
typeof b_q==b_c&&b_q.length<=50&&/^(([A-Za-z0-9])|(\w[-\w\.\+]*[\w\+]))@([-A-Za-z0-9]+\.)+[A-Za-z]{2,4}$/.test(b_q));};b_$.emailList=function(b_r){return(typeof b_r==b_c&&/^(([A-Za-z0-9])|(\w[-\w\.\+]*[\w\+]))@([-A-Za-z0-9]+\.)+[A-Za-z]{2,4}[\s,;]*([\s,;]+(([A-Za-z0-9])|(\w[-\w\.\+]*[\w\+]))@([-A-Za-z0-9]+\.)+[A-Za-z]{2,4})*$/.test(b_r)
);};b_$.handle=function(b_s,b_h){var b_t=/^\d{6,20}$/.test(b_s);if(b_s&&/^\w{6,20}$/.test(b_s)&& !b_t){b_e('lgn/checkhandle',{ch:b_s},b_h);return b__;}else{if(b_h.callback)b_h.callback({exists:b_b,badFormatting:b_a,allNumeric:b_t})
;return b_b;}};b_$.storehandle=function(b_s,b_h){var b_t=/^\d{6,20}$/.test(b_s);if(b_h.envUrl==null)b_h.envUrl=this.getInherited('env').service;if(b_s&&/^\w{6,20}$/.test(b_s)&& !b_t){b_e('store/checkhandle',{gl:b_s,mks:false},b_h);
return b__;}else{if(b_h.callback)b_h.callback({exists:b_b,badFormatting:b_a,allNumeric:b_t});return b_b;}};b_$.makespaceFormat=function(b_s){return!Uize.isNully(b_s)&&Uize.isString(b_s)&&b_s.length<=20&&
b_s.length>=6&&/^[A-Za-z][A-Za-z0-9_]{5,19}$/.test(Uize.Str.Trim.trim(b_s));};b_$.makespaceAvailable=function(b_s,b_u){b_e('store/checkhandle',{gl:Uize.Str.Trim.trim(b_s),mks:true},{commObject:this.getInherited('commObject'),
envUrl:this.getInherited('env').service,callback:function(b_v){b_u(!b_v.exists);}});return b__;};b_$.integer=function(b_i){return(b_i%1)===0};b_$.loginEmail=function(b_q,b_u){return b_$.email(b_q)&&b_$.serviceValidator(
'lgn/checkloginemail',{em:b_q},this,b_u);};b_$.nonEmpty=function(b_i){return!Uize.isEmpty(b_i)};b_$.radio=function(b_i){return b_i!=b__&&b_i!=b_d};b_$.state=function(b_w,b_x,b_h){function b_y(b_z){if(b_h.callback)
b_h.callback({success:b_z});}var b_A=b_x.toLowerCase();if(!b_x||(b_A!='united states'&&b_A!='canada'&&b_A!='mexico'&&b_A!='spain'&&b_A!='brazil')){var b_z= !!b_x;b_y(b_z);return b_z;}else{b_e('my/account/validatestate',
{state:b_w,country:b_x},b_h);return b__;}};b_$.zid=function(b_j,b_B){if(!b_j)return b_b;b_j=b_j.replace(/[\s-]/g,'');if(b_B)return b_B.length==3&&new RegExp('^'+b_B+'\\d{15}$').test(b_j);else return b_j.length==18;
};b_$.mid=function(b_j,b_B){if(!b_j)return b_b;b_j=b_j.replace(/[\s-]/g,'');if(b_B)return b_B.length==5&&new RegExp('^'+b_B+'\\d{14}$').test(b_j);else return b_j.length==19;};b_$.serviceValidator=function(b_C,b_g,b_D,b_u){
b_D.set({busy:b_a});b_e(b_C,b_g,{commObject:b_D.getInherited('commObject'),envUrl:b_D.getInherited('env').service,callback:function(b_v){b_D.set({busy:b_b});b_u(b_v.isValid,b_v.warningMessage);}});return b__;
};return b_$;}});
Uize.module({name:'Zazzle.OptionsSelector',superclass:'Uize.Widget.Options.Selector',required:['Uize.Node','Zazzle.SelectorValueDisplay','Uize.Widget.mWeb'],builder:function(f_$){'use strict';var f__=true,
f_a=false,f_b=Uize.Node;var f_c=f_$.subclass(null,function(){var m=this;m.wire('Changed.values',function(){m.unmet('optionsUpdated');m.f_d();m.f_e();});}),f_f=f_c.prototype;f_c.mixins(Uize.Widget.mWeb);
f_f.f_g=function(){var m=this;m.forAll(function(f_h){f_h&&f_h.set({valueDisplayInfo:m.f_i})})};f_f.f_j=function(){var m=this;if(m.isWired){var f_k=m.f_k||[],f_l=Uize.lookup(f_k),f_m= !!m.f_m,f_n=m.get('values')
;m.forAll(function(f_o,f_p){if(f_o){var f_q= !!f_l[f_n[f_p].name];f_o.set({enabled:f_q?f_a:'inherit'});if(f_m){m.web('option'+f_p).display(!f_q);m.web(f_o).display(!f_q);}}});}};f_f.f_e=function(){var
 m=this,f_i=m.f_i;if(m.isWired&&m.get('values')&&m.isMet('!optionsUpdated')){var f_r=m.getNode('options');if(f_r&&f_i&&f_i.layout=='Vertical'){var f_s=0,f_t=0,f_u=f__,f_v=f__,f_w=f_i.showThumbnail!='None'
;m.forAll(function(f_o,f_p){var f_x=m.web('option'+f_p).dimensions(),f_y=f_x.height,f_z=f_x.width;f_s=f_y>f_s?f_y:f_s;f_t=f_z>f_t?f_z:f_t;f_u&=(!f_p||f_y===f_s);f_v&=(!f_p||f_z===f_t);});f_s&&f_t&& !(f_u&&f_v)
&&m.forAll(function(f_o,f_p){var f_A={};f_A.height=f_s;if(f_w)f_A.width=f_t;!Uize.isEmpty(f_A)&&m.web('option'+f_p).css(f_A);});f_s&&f_t&&m.met('optionsUpdated');}}};f_f.getOptionProperties=function(f_B,f_C){
return Uize.copyInto(f_$.doMy(this,'getOptionProperties',[f_B,f_C])||{},{valueDisplayInfo:this.f_i})};f_f.updateUiOptionsSeen=f_f.f_d=function(){var m=this;if(m.isWired){var f_r=m.web('options');if(f_r.length){
var f_D=m.get('valueNo'),f_E=0,f_F=0,f_G=0,f_H=0,f_I=null,f_J=function(){return f_I!==null?f_I:(f_I=(f_r.scrollHeight())>(f_H=f_H||f_r.height())||(f_r.scrollWidth())>(f_G=f_G||f_r.width()));},f_K=f_a
;m.forAll(function(f_o,f_B){var f_L=function(){var f_M=m.web('option'+f_B),f_N=f_M.dimensions(),f_O=f_M.offset();return f_M.length&&f_b.doRectanglesOverlap(f_E=f_E||f_r.scrollLeft(),f_F=f_F||f_r.scrollTop(),
f_G=f_G||f_r.width(),f_H=f_H||f_r.height(),f_O.left,f_O.top,f_N.width,f_N.height);},f_P=f_o.get('seen')||f_B==f_D;if(!f_P&&(!f_J()||f_L()))f_P=f_K=true;f_o.set({seen:f_P});return!f_K||f_P;});}}};f_f.updateUi=function(){
var m=this;if(m.isWired){m.f_d();m.f_e();m.f_j();f_$.doMy(m,'updateUi');}};f_f.wireUi=function(){var m=this;if(!m.isWired){m.web('options').scroll(function(){m.f_d()},500);f_$.doMy(m,'wireUi');}};f_c.stateProperties({
f_k:{name:'disabledList',onChange:f_f.f_j},f_m:{name:'hideDisabledOptions',value:f_a},f_Q:'optionsUpdated',f_i:{name:'valueDisplayInfo',onChange:f_f.f_g}});f_c.set({optionWidgetClass:Zazzle.SelectorValueDisplay,
html:true});return f_c;}});
Uize.module({name:'Uize.Util.Coupler',superclass:'Uize.Class',builder:function(c_$){'use strict';var c__={};function c_a(){var m=this,c_b=m.c_b;if(c_b){for(var c_c= -1,c_d=c_b.length,c_e;++c_c<c_d;)(c_e=c_b[c_c]).c_f.unwire(c_e.c_g,c_e.c_h)
;c_b=m.c_b=null;}if(m.c_i){var c_j=m.c_j,c_k=m.c_k;if(c_j&&c_k){Uize.callOn(c_j,'set',[c_j[0].get(c_k)]);var c_l=c_k.length,c_m=c_k.concat().sort()+'',c_n=c__[c_m];if(!c_n){var c_o=['if (target.UIZE_UTIL_COUPLER_driver) return;'];
if(c_l>1){c_o.push('var properties, changedMap = eventObj.properties;');for(var c_p= -1;++c_p<c_l;){var c_q='\''+c_k[c_p]+'\'';c_o.push('if ('+c_q+' in changedMap) (properties || (properties = {})) ['+c_q+'] = changedMap ['+c_q+'];'
);}c_o.push('if (!properties) return;');}else{var c_q='\''+c_k[0]+'\'';c_o.push('var properties = {'+c_q+':eventObj.source.get ('+c_q+')};');}c_o.push('var source = eventObj.source;','source.UIZE_UTIL_COUPLER_driver = 1;',
'target.set (properties);','delete source.UIZE_UTIL_COUPLER_driver;');c_n=c__[c_m]=Function('eventObj,target',c_o.join(''));}c_b=m.c_b=[];var c_g='Changed.'+(c_l>1?'*':c_k[0]),c_r=function(c_s,c_t){var c_h=function(c_u){c_n(c_u,c_t)};
c_b.push({c_f:c_s,c_g:c_g,c_h:c_h});c_s.wire(c_g,c_h);};for(var c_v= -1,c_w=c_j.length;++c_v<c_j.length;)c_r(c_j[c_v],c_j[(c_v+1)%c_w]);}}}return c_$.subclass({stateProperties:{c_i:{name:'coupled',onChange:c_a,
value:true},c_j:{name:'instances',onChange:c_a},c_k:{name:'properties',onChange:c_a}}});}});
Uize.module({name:'Uize.Widget.Button.Checkbox',builder:function(e_$){'use strict';return e_$.subclass({set:{clickToSelect:true,clickToDeselect:true}});}});
Uize.module({name:'Uize.Widget.Dialog.mPicker',required:'Uize.Widget.Button.Checkbox',builder:function(){'use strict';var e_$=false,e__=true;function e_a(m){m.pickerWidgetsAdded&&m.children.keepOpen.set({selected:m.keepOpen});
}return function(e_b){e_b.declare({omegastructor:function(){var m=this;function e_c(e_d){var e_e=m.children.value,e_f=e_e.get('valueDetails'),e_g;m.submittedValue=e__;m.fireSubmissionComplete(e_d,Uize.copyInto(
{value:e_e.valueOf()},e_f!==e_g?{valueDetails:e_f}:e_g,m.pipedProperties&&e_e.get(m.pipedProperties)));}m.addChild('value',m.valueWidgetClass).wire('Changed.value',function(){!m.beforeShow&&setTimeout(
function(){e_c(m.keepOpen);m.keepOpen||m.set({shown:e_$});},0);});m.addChild('keepOpen',Uize.Widget.Button.Checkbox).wire('Changed.selected',function(e_h){m.set({e_d:e_h.source.get('selected')})});function e_i(){
if(window.bar)debugger;if(m.submittedValue){m.children.value.set({value:m.initialValue});e_c(e_$);}}m.wire({Ok:function(){e_c()},Cancel:e_i,Close:e_i,'Before Show':function(){m.beforeShow=e__;m.children.value.set(m.get((m.pipedProperties||[]).concat('value')));
m.initialValue=m.value;m.beforeShow=m.submittedValue=e_$;}});m.pickerWidgetsAdded=e__;e_a(m);},instanceMethods:{fireSubmissionComplete:function(e_d,e_j){var m=this;m.get('shown')&&m.fire({name:'Submission Complete',
result:e_j,keepOpen:e_d});}},stateProperties:{keepOpen:{name:'keepOpen',onChange:function(){e_a(this)},value:e_$},valueWidgetClass:'valueWidgetClass',picker:'picker',pipedProperties:'pipedProperties',
value:'value'},set:{shieldOpacity:0.01}});};}});
Uize.module({name:'Uize.Widget.Dialog.Picker',required:'Uize.Widget.Dialog.mPicker',builder:function(e_$){'use strict';return e_$.subclass({mixins:Uize.Widget.Dialog.mPicker});}});
Uize.module({name:'Uize.Widget.Dialog.Picker.mPalette',required:['Uize.Dom.Basics','Uize.Util.Coupler'],builder:function(){'use strict';function f_$(m){if(m.isWired&&m.minWidth){m.setNodeStyle('',{minWidth:m.minWidth}
);Uize.Dom.Basics.isIe&&Uize.Dom.Basics.ieMajorVersion<=7&&m.setNodeStyle('valueShell',{minWidth:m.minWidth});}}return function(f__){f__.declare({omegastructor:function(){var m=this;Uize.Util.Coupler({
instances:[m,m.children.value],properties:['tentativeValue','tentativeValueDetails']});m.wire('After Show',function(){m.children.value.updateUi();f_$(m);});},stateProperties:{minWidth:{name:'minWidth',
onChange:function(){f_$(this)}},tentativeValue:{name:'tentativeValue',onChange:function(){var m=this;setTimeout(function(){m.fireSubmissionComplete(true,{tentativeValue:m.tentativeValue,tentativeValueDetails:m.tentativeValueDetails
});},0);},value:null},tentativeValueDetails:'tentativeValueDetails'},set:{dismissOnShieldClick:true}});};}});
Uize.module({name:'Zazzle.Dialog.Picker',required:'Uize.Widget.Dialog.mPicker',builder:function(f_$){'use strict';return f_$.subclass({mixins:Uize.Widget.Dialog.mPicker});}});
Uize.module({name:'Zazzle.Dialog.Picker.Palette',required:'Uize.Widget.Dialog.Picker.mPalette',builder:function(g_$){'use strict';return g_$.subclass({mixins:Uize.Widget.Dialog.Picker.mPalette});}});
Uize.module({name:'Uize.Widget.Dialog.Picker.Palette',required:'Uize.Widget.Dialog.Picker.mPalette',builder:function(f_$){'use strict';return f_$.subclass({mixins:Uize.Widget.Dialog.Picker.mPalette});}
});
Uize.module({name:'Uize.Widget.Dialog.Picker.Palette.mSelector',required:['Uize.Widget.Options.Selector','Uize.Util.Coupler'],builder:function(){'use strict';function g_$(g__){this.fireSubmissionComplete(true,g__);
}return function(g_a){g_a.declare({omegastructor:function(){var m=this,g_b=m.children.value;m.wire('After Show',function(){g_b.updateUi()});Uize.Util.Coupler({instances:[m,g_b],properties:['valueNo','tentativeValueNo']
});},stateProperties:{tentativeValueNo:{name:'tentativeValueNo',onChange:g_$,value:-1},valueNo:{name:'valueNo',onChange:g_$,value:-1},values:{name:'values',value:[]}},set:{pipedProperties:['values'],
valueWidgetClass:Uize.Widget.Options.Selector,shieldOpacity:.01}});};}});
Uize.module({name:'Zazzle.DroplistPalette',superclass:'Zazzle.Dialog.Picker.Palette',required:['Uize.Widget.Dialog.Picker.Palette.mSelector','Zazzle.OptionsSelector'],builder:function(h_$){'use strict';
var h__=h_$.subclass({mixins:Uize.Widget.Dialog.Picker.Palette.mSelector,stateProperties:{h_a:'disabledList',h_b:'hideDisabledOptions'}});h__.set({pipedProperties:(h__.get('pipedProperties')||[]).concat('disabledList','hideDisabledOptions'),
valueWidgetClass:Zazzle.OptionsSelector});return h__;}});
Uize.module({name:'Zazzle.DroplistPalette.ComboBox',required:['Uize.Util.PropertyAdapter','Uize.Widget.Button','Uize.Widget.FormElement.Text'],builder:function(i_$){'use strict';var i__={nearest:'round',
up:'ceil',down:'floor'};var i_a=i_$.subclass(null,function(){var m=this,i_b=m.children.value,i_c=m.addChild('input',Uize.Widget.FormElement.Text),i_d=m.addChild('increment',Uize.Widget.Button),i_e=m.addChild('decrement',Uize.Widget.Button),
i_f=function(i_g){i_g=(i_g||1)>0?1: -1;m.met('keepOpen');i_c.set('value',i_c.get('value')*1+m.i_h*i_g);setTimeout(function(){m.set('initialValue',i_b.get('value'));m.unmet('keepOpen');},0);};Uize.Util.PropertyAdapter({
propertyA:i_b,propertyB:i_c,valueAdapter:{aToB:function(i_i){return i_i},bToA:function(i_i){var i_h=m.i_h,i_j=m.i_j,i_k=Uize.constrain(i_i,m.i_l,m.i_m);if(i_h&&i_h!=1){i_j=i_j&&i__[i_j]?i_j:'nearest'
;var i_n=function(i_o){return Math.round(i_o*Math.pow(10,14))/Math.pow(10,14)};i_k=Uize.isNumber(+i_k)?(i_n(Math[i__[i_j]](i_n(i_k/i_h))*i_h)):i_k;}i_i!=i_k&&i_c.set('value',i_k);return i_k;}}});i_d.wire(
'Click',function(){i_f(1)});i_e.wire('Click',function(){i_f(-1)});});i_a.stateProperties({i_m:{name:'maxValue',value:-Infinity},i_l:{name:'minValue',value:Infinity},i_j:{name:'roundDirection',value:'nearest'
},i_h:{name:'valueIncrement',value:1}});return i_a;}});
Uize.module({name:'Uize.Widget.Picker',superclass:'Uize.Widget.FormElement',required:['Uize.Widget.Button.ValueDisplay','Uize.Dom.Pos','Uize.Dom.Event'],builder:function(e_$){'use strict';var e__=null;
return e_$.subclass({omegastructor:function(){var m=this,e_a=function(){m.pickValue()};m.wire('Changed.focused',function(){m.get('focused')&& !m.e_b&&e_a()});m.addChild('selector',m.e_c||Uize.Widget.Button.ValueDisplay,
m.e_d).wire('Click',e_a);},instanceMethods:{getDialogWidgetProperties:function(){return e__},getMoreDialogEventHandlers:function(){return e__},getMooringNode:function(){return this.children.selector.getNode()||this.getNode('input');
},handleDialogSubmit:function(e_e){var m=this,e_f=e_e.value,e_g=e_e.valueDetails,e_h;m.set(Uize.copy(e_g!==e_h?{valueDetails:e_g}:e_h,e_f!==e_h?({value:e_f!=e__?(m.e_i?m.e_i.call(m,e_f):e_f):''}):e_h
));},pickValue:function(){var m=this;m.set({focused:false});var e_j=m.getMooringNode(),e_k=Uize.Dom.Pos.getDimensions(e_j);function e_l(){m.e_b&&m.set({focused:true});}m.callInherited('useDialog')({component:m.e_m
?Uize.copyInto(m.e_m,{value:m.get('value')}):e__,widgetClassName:m.e_n,widgetProperties:Uize.copyInto({name:m.e_o||'dialog'+m.e_n.replace(/\./g,''),picker:m,mooringNode:e_j,offsetX:e_k.width>>1,offsetY:e_k.height>>1,
preventPageScrollWhenShown:m.e_p},m.getDialogWidgetProperties(),m.get((m.e_q||[]).concat('value','valueDetails'))),submitHandler:function(e_e,e_r){m.handleDialogSubmit(e_e);e_r&&e_r.keepOpen||e_l();},
dismissHandler:e_l,widgetEventHandlers:m.getMoreDialogEventHandlers()});},wireUi:function(){var m=this;if(!m.isWired){m.wireNode('input','mousedown',function(e_r){if(!m.e_b){Uize.Dom.Event.abort(e_r);
m.pickValue();}});e_$.doMy(m,'wireUi');}}},stateProperties:{e_b:{name:'allowManualEntry',value:true},e_m:'dialogComponent',e_o:'dialogName',e_n:'dialogWidgetClass',e_p:{name:'dialogPreventScrollWhenShown',
value:false},e_q:'pipedProperties',e_c:'selectorButtonWidgetClass',e_d:'selectorButtonWidgetProperties',e_g:{name:'valueDetails',onChange:function(){var e_s=this.children.selector;e_s&&e_s.set({valueDetails:this.e_g});
}},e_i:'valueFormatter'},set:{value:e__}});}});
Uize.module({name:'Uize.Widget.Picker.Palette',required:['Uize.Dom.Basics','Uize.Dom.Pos'],builder:function(f_$){'use strict';var f__=true,f_a=false,f_b=Uize.Dom.Pos.getDimensions,f_c=Uize.copyInto;function f_d(m){
var f_e=m.getMooringNode();return f_e?f_b(f_e).width:undefined;}function f_f(m){if(m.isWired){var f_g=m.children.selector.getNode('valueDisplayShell'),f_h=f_b(f_g).width,f_i=parseInt(m.getNodeStyle(f_g,'maxWidth')),
f_j=m.f_j;if(f_j&&f_h<f_j){m.setNodeStyle(f_g,{minWidth:f_i?Math.min(f_j,f_i):f_j});}else if(f_h){m.f_j=f_h;m.palette&&m.palette.set({minWidth:f_d(m)});}}}return f_$.subclass({omegastructor:function(){
var m=this;m.wire('Changed.valueDetails',function(){m.set({f_k:m.get('valueDetails')});f_f(m);});m.f_j=0;},instanceMethods:{getDialogWidgetProperties:function(){var m=this;return f_c(f_$.doMy(m,'getDialogWidgetProperties')||{},
{parent:m,offsetX:'adjacent',offsetY:'adjacent',minWidth:f_d(m)});},getMoreDialogEventHandlers:function(){var m=this,f_l=m.children.selector,f_m;function f_n(f_o){return Uize.pairUp('Changed.'+f_o,function(f_p){
m.palette=f_p.source;var f_q=m.palette.get(f_o);f_q!==f_m&&m.set(f_o,f_q);});}return f_c(f_$.doMy(m,'getMoreDialogEventHandlers')||{},f_n('tentativeValue'),f_n('tentativeValueDetails'),{'Before Show':function(f_p){
var f_r=m.palette=f_p.source;f_l.set({selected:f__});m.set({focused:f__});f_r.set({minWidth:f_d(m)});if(!m.f_s){m.f_s=f__;var f_t=f_r.getNode(),f_u=document.body;if(f_t&&f_t.parentNode!=f_u){var f_v=f_r.getNode('shield');
Uize.Dom.Basics.remove([f_t,f_v]);f_v&&f_u.appendChild(f_v);f_u.appendChild(f_t);}}},'After Hide':function(){m.set({focused:f_a});f_l.set({selected:f_a});m.palette=f_m;}});},updateUi:function(){var m=this;
if(m.isWired){f_f(m);f_$.doMy(m,'updateUi');}}},stateProperties:{f_w:{name:'syncTentativeValue',value:f__},f_k:{name:'tentativeValueDetails',onChange:function(){var m=this;m.f_w&&m.children.selector.set({valueDetails:m.f_k})
;f_f(m);}}},set:{dialogName:'palette'}});}});
Uize.module('Zazzle.Picker');
Uize.module({name:'Zazzle.Picker.Palette',superclass:'Uize.Widget.Picker.Palette',required:'Zazzle.Widget.mV2',builder:function(g_$){'use strict';return g_$.subclass({mixins:Zazzle.Widget.mV2,stateProperties:{
g__:{name:'isVariableWidth',value:true}},cssBindings:{isVariableWidth:['fixed','variable']}});}});
Uize.module({name:'Uize.Widget.FormElement.Select',builder:function(e_$){'use strict';function e__(m){if(m.isWired){var e_a=m.get('value'),e_b=m.e_b,e_c=m.getNode('input');if(e_b&&e_c&&m.get('type')=='select-one'){
var e_d=false;m.e_e= -1;for(var e_e= -1,e_f=e_b.length,e_g=e_c.options,e_h=e_g.length;++e_e<e_f;){var e_i=e_b[e_e],e_j=e_i.name,e_k=e_a==e_j,e_l;if(e_e<e_h)e_l=e_g[e_e];else{e_l=document.createElement('option');
try{e_c.add(e_l,null)}catch(e_m){e_c.add(e_l)}}m.setNodeProperties(e_l,{value:e_j,text:(e_i.valueDetails&&e_i.valueDetails.displayName)||e_i.displayName||e_j,selected:e_k});if(e_k)e_d=true;}for(var e_n=e_h-1;e_n>=e_e;e_n--)
e_c.remove(e_n);if(!(e_d&&e_a)&&e_b.length)m.set({value:e_b[0].name});}}}return e_$.subclass({alphastructor:function(){this.e_b=[]},omegastructor:function(){var m=this;m.wire('Changed.value',function(){
if(m.isWired){var e_c=m.getNode('input');e_c&&m.set({e_e:e_c.selectedIndex});}});},instanceMethods:{wireUi:function(){var m=this;if(!m.isWired){e_$.doMy(m,'wireUi');var e_b=m.e_b||[],e_c=m.getNode('input')
;if(e_b.length)e__(m);else if(e_c&&m.get('type')=='select-one'){for(var e_o=m.get('value'),e_g=e_c.options,e_n= -1,e_h=e_g.length;++e_n<e_h;){var e_l=e_g[e_n],e_p=e_l.value,e_q=e_l.text,e_j=e_p!=null?e_p:e_q
;e_b.push({name:e_j,displayName:e_q});if(e_j==e_o)e_l.selected=true;}(m.e_e=e_c.selectedIndex)> -1&&m.set({value:e_b[m.e_e].name});}}}},stateProperties:{e_e:{name:'valueNo',value:-1},e_b:{name:'values',
onChange:function(){e__(this)}}}});}});
Uize.module({name:'Uize.Widget.Picker.Palette.mSelector',required:'Uize.Widget.Button.ValueDisplay.Selector',builder:function(g_$){'use strict';return function(g__){g__.declare({omegastructor:function(){
var m=this;function g_a(){var g_b=m.getValueObject();m.set({valueDetails:g_b?g_b.valueDetails:null});}m.wire({'Changed.value':g_a,'Changed.values':g_a});g_a();},instanceMethods:{getValueObject:function(g_c){
return Uize.findRecord(this.values,{name:g_c==undefined?this+'':g_c});},getMoreDialogEventHandlers:function(){var m=this;function g_d(g_e){return Uize.pairUp('Changed.'+g_e,function(g_f){var g_g=g_f.source.get(g_e);
g_g!==undefined&&m.set(g_e,g_g);});}return Uize.copyInto(g_$.doMy(m,'getMoreDialogEventHandlers')||{},g_d('valueNo'),g_d('tentativeValueNo'));}},stateProperties:{tentativeValueNo:{name:'tentativeValueNo',
value:-1},valueNo:{value:-1},values:{value:[]}},set:{pipedProperties:['values','valueNo','tentativeValueNo'],selectorButtonWidgetClass:Uize.Widget.Button.ValueDisplay.Selector,dialogWidgetClass:'Uize.Widget.Dialog.Picker.Palette.Selector'
}});};}});
Uize.module({name:'Zazzle.Picker.Palette.Selector',required:['Uize.Widget.Picker.Palette.mSelector','Zazzle.SelectorValueDisplay.DroplistButton'],builder:function(h_$){'use strict';var h__=h_$.subclass({
mixins:Uize.Widget.Picker.Palette.mSelector,stateProperties:{h_a:'disabledList',h_b:'hideDisabledOptions'},set:{selectorButtonWidgetClass:Zazzle.SelectorValueDisplay.DroplistButton,dialogWidgetClass:'Zazzle.DroplistPalette'
},instanceMethods:{getMooringNode:function(){return this.children.selector.getNode('shell')||h_$.doMy(this,'getMooringNode');}}});h__.set({pipedProperties:(h__.get('pipedProperties')||[]).concat('disabledList','hideDisabledOptions')
});return h__;}});
Uize.module({name:'Zazzle.Picker.Palette.DroplistShim',superclass:'Zazzle.Picker.Palette.Selector',required:['Uize.Widget.FormElement.Select','Uize.Widget.mChildBindings','Uize.Widget.mWeb'],builder:function(i_$){
'use strict';return i_$.subclass({mixins:[Uize.Widget.mWeb,Uize.Widget.mChildBindings],omegastructor:function(){var m=this,i__=function(){var i_a=m.get('values'),i_b=[];if(i_a){for(var i_c= -1;++i_c<i_a.length;){
var i_d=i_a[i_c];i_b.push({name:i_d.name,displayName:i_d.valueDetails?i_d.valueDetails.displayName:null});}}return i_a;},i_e=m.addChild('select',Uize.Widget.FormElement.Select,{values:i__(),value:m+''
}),i_f=m.children.selector,i_g=function(i_h){i_f.children[i_h].wire('Click',function(){m.pickValue()});};m.wire({'Changed.value':function(){i_e.set({value:m+''});m.validate();},'Changed.values':function(){i_e.set({values:i__()})}
});i_g('left');i_g('right');},instanceMethods:{wireUi:function(){var m=this;if(!m.isWired){var i_i=m.children,i_j=i_i.selector.web('shell'),i_k=i_j.length,i_e=i_i.select,i_l=m.web(i_e.getRootNode());
i_j.display();i_l.display(!i_k);if(!i_k&&i_l.length){var i_m=function(){var i_a=m.get('values');i_a&&i_a.length&&m.set({value:i_e.get('value')});};i_e.wire('Changed.value',i_m);i_m();}i_$.doMy(m,'wireUi');
}}},stateProperties:{i_n:'label'},childBindings:{label:'selector.label'}});}});
Uize.module({name:'Zazzle.Droplist',superclass:'Zazzle.Picker.Palette.DroplistShim',builder:function(j_$){'use strict';return j_$.subclass({});}});
Uize.module({name:'Zazzle.Droplist.ComboBox',builder:function(k_$){'use strict';var k__={nearest:'round',up:'ceil',down:'floor'};var k_a=k_$.subclass(),k_b=k_a.prototype;k_b.valueConformer=function(k_c){
var m=this,k_d=m.k_d,k_e=m.k_e,k_f=Uize.constrain(k_$.doMy(m,'valueConformer',[k_c]),m.k_g,m.k_h);if(k_d&&k_d!=1){k_e=k_e&&k__[k_e]?k_e:'nearest';var k_i=function(k_c){return Math.round(k_c*Math.pow(10,14))/Math.pow(10,14)};
k_f=Uize.isNumber(+k_f)?(k_i(Math[k__[k_e]](k_i(k_f/k_d))*k_d)):k_f;}return k_f;};k_b.wireUi=function(){var m=this;if(!m.isWired){var k_j=m.web('inputLabel');if(m.children.selector.getNode()){m.wire(
'Changed.value',function(){k_j.html(m+'')});m.web('input').hide();k_j.display();}k_$.doMy(m,'wireUi');}};k_a.stateProperties({k_h:{name:'maxValue',value:-Infinity},k_g:{name:'minValue',value:Infinity
},k_e:{name:'roundDirection',value:'nearest'},k_d:{name:'valueIncrement',value:1}});return k_a;}});
Uize.module({name:'Zazzle.Widgets.Rooter.mQuantitySelector',required:['Uize.Data.Compare','Zazzle.Widget.mV2','Zazzle.Widgets.Rooter.mModels'],builder:function(){'use strict';var d_$=false,d__=null,d_a=Uize,
d_b=Zazzle,d_c=function(d_d,d_e){return d_a.Data.Compare.identical(d_d,d_e)?d_e:d_d;};return function(d_f){d_f.declare({mixins:[d_b.Widget.mV2,d_b.Widgets.Rooter.mModels],stateProperties:{baseValues:{
},closenessThreshold:{},hasForcedQuantities:'hasForcedQuantities',hasVolumeDiscountTiers:{derived:'volumeDiscountTiers: !Uize.isEmpty(volumeDiscountTiers)'},mostDiscountedUnitDisplayPrice:{},pluralUnitLabel:{
},singularUnitLabel:{},valuesToDisplay:{derived:{properties:'baseValues,closenessThreshold,pluralUnitLabel,singularUnitLabel,volumeDiscountTiers',derivation:function(){return d_c(this.generateValuesWithDiscounts(),
this.valuesToDisplay);}}},volumeDiscountTiers:{}},children:{},modelBindings:{hasForcedQuantities:'<-attributes',mostDiscountedUnitDisplayPrice:'<-pricing',pluralUnitLabel:'<-attributes',singularUnitLabel:'<-attributes',
value:'pricing.quantity',volumeDiscountTiers:'<-pricing.validVolumeDiscountTiers'},childBindings:{valuesToDisplay:{property:'values',direction:'->'}},eventBindings:{},instanceMethods:{generateValuesWithDiscounts:function(){
var m=this,d_g=m.volumeDiscountTiers||[],d_h=d_g.length,d_i=m.closenessThreshold,d_j=m.baseValues||[],d_k=d_j.length,d_l=[],d_m=function(d_n){return d_n+' '+m.generateUnitLabel(+d_n);},d_o=function(d_p){
if(d_p)return m.localize(d_p.discount.indexOf('%')> -1?'quantitySelectorDiscountMsgPct':'quantitySelectorDiscountMsgAmt',{discount:d_p.discount});};if(d_h>0){if(m.hasForcedQuantities){d_a.forEach(d_j,function(d_q){
var d_r;for(var i in d_g){var d_p=d_g[i];if(d_p.minQuantity<=d_q.name)d_r=d_p;else break;}d_l.push({name:d_q.name,valueDetails:{value:d_q.name,displayName:d_m(d_q.name),importantInfo:d_o(d_r)}});});}
else{var d_s=0,d_q,d_t=0,d_p,d_r;while(d_s<d_k||d_t<d_h){d_q=d_j[d_s];d_p=d_g[d_t];if(d_q&&(!d_p||d_q.name<d_p.minQuantity)){d_l.push({name:d_q.name,valueDetails:{value:d_q.name,displayName:d_m(d_q.name),
importantInfo:d_o(d_r)}});d_s++;}else{d_l.push({name:d_p.minQuantity,valueDetails:{value:d_p.minQuantity,displayName:d_m(d_p.minQuantity),importantInfo:d_o(d_p),isDiscountTier:true}});d_t++;d_r=d_p;}
}var d_u,d_v,d_w=function(n){d_l.splice(n,1);i--;};for(var i=0;i<d_l.length-1;++i){d_u=d_l[i];d_v=d_l[i+1];if(d_v.name*(1-d_i)<d_u.name){if(!d_u.valueDetails.importantInfo&&d_v.valueDetails.importantInfo)
d_w(i);else if(d_u.valueDetails.importantInfo&& !d_v.valueDetails.importantInfo)d_w(i+1);else if(d_u.valueDetails.importantInfo&&d_v.valueDetails.importantInfo){if(d_u.valueDetails.isDiscountTier)d_w(i+1);
else d_w(i);}}}}return d_l;}else return m.baseValues;},generateUnitLabel:function(d_n){return this.get(d_n==1?'singularUnitLabel':'pluralUnitLabel');}}});};}});
Uize.module({name:'Zazzle.Widgets.Rooter.QuantitySelector',superclass:'Zazzle.Droplist.ComboBox',required:'Zazzle.Widgets.Rooter.mQuantitySelector',builder:function(l_$){'use strict';var l__=null,l_a=Uize
;return l_$.subclass({mixins:Zazzle.Widgets.Rooter.mQuantitySelector,stateProperties:{unitLabelDisplay:{derived:'pluralUnitLabel,singularUnitLabel,value: value == 1 ? singularUnitLabel : pluralUnitLabel'
}},cssBindings:{hasVolumeDiscountTiers:['','hasVolumeDiscountTiers']},htmlBindings:{unitLabelDisplay:'unitLabel'},instanceMethods:{},eventBindings:{}});}});
Uize.module({name:'Zazzle.Droplist.ComboBox.SppQuantitySelectorShim',superclass:'Zazzle.Widgets.Rooter.QuantitySelector',required:['Uize.Widget.Button'],builder:function(m_$){'use strict';var m__=Uize;
return m_$.subclass({children:{showPriceChart:m__.Widget.Button},childBindings:{},htmlBindings:{mostDiscountedUnitDisplayPrice:'lowestUnitPrice'},eventBindings:{'showPriceChart:Click':function(){var m=this,
m_a=m.get('minValue'),m_b=m.children.showPriceChart.getNode();m.callInherited('useDialog')({component:{name:'Zazzle.Widgets.Spp.Dialog.VolumeDiscounts'},widgetProperties:{name:'volumeDiscountsDialog',
minQuantity:m_a,preventPageScrollWhenShown:false,pricingModel:m.models.pricing}});}}});}});
Uize.module({name:'Zazzle.Widgets.Spp.QuantitySelector',superclass:'Zazzle.Droplist.ComboBox.SppQuantitySelectorShim',builder:function(n_$){'use strict';var n__=Uize;return n_$.subclass({stateProperties:{
},children:{},childBindings:{},cssBindings:{useAlternateFont:['','arialize']},htmlBindings:{},eventBindings:{}});}});
Uize.module({name:'Zazzle.Widgets.Spp.ShippingEstimates2015',superclass:'Zazzle.Widget.V2',required:['Uize.Dom.Event','Uize.Url','Uize.Widget.mModels'],builder:function(f_$){'use strict';var f__=Uize,f_a='shippingEstimatesZip'
;return f_$.subclass({mixins:f__.Widget.mModels,alphastructor:function(){var m=this;m.once('wired',function(){if(window.localStorage)m.set({f_b:window.localStorage.getItem(f_a)});m.reload();document.body.addEventListener('click',function(e){
var f_c=f__.Dom.Event.target(e),f_d=m.getNode();while(f_c.parentElement){if(f_c==f_d||f_c.parentElement==f_d)return;f_c=f_c.parentElement;}m.unmet('paletteShown');},true);});},stateProperties:{f_e:'paletteCloseTimeout',
f_f:{name:'paletteShown',onChange:function(){var m=this;if(m.f_f&&m.f_g)m.f_h();}},f_i:{name:'productOption',onChange:'reload'},f_j:{name:'quantity',onChange:'reload'},f_k:'reloadLock',f_g:{name:'shouldFocusZipCodeInput',
derived:'zipCode,zipCodeError: !zipCode || zipCodeError'},f_b:'zipCode',f_l:'zipCodeError'},children:{},childBindings:{},modelBindings:{productOption:'product',quantity:'pricing'},cssBindings:{paletteShown:['','paletteShown']
},htmlBindings:{zipCode:'zipCode'},eventBindings:{'#blackLink:click':function(e){var m=this;f__.Dom.Event.preventDefault(e);m.fire({name:'Track Event',bubble:true,extra:{ax:'ShippingEstimatesModalBlack'
}});setTimeout(function(){window.open(m.getNode('blackLink').href,'_blank');},0);},'#holidayShippingLink:click':function(e){var m=this;f__.Dom.Event.preventDefault(e);m.fire({name:'Track Event',bubble:true,
extra:{ax:'ShippingEstimatesModalXmasProds'}});setTimeout(function(){window.location.href=m.getNode('holidayShippingLink').href;},0);},'#:mouseenter':function(){var m=this;if(m.f_e)clearInterval(m.f_e);
},'#:mouseout':function(){var m=this;m.f_e=setTimeout(function(){m.unmet('paletteShown');},500);},'#showPaletteLink:click':function(){this.toggle('paletteShown');if(this.f_f)this.fire({name:'Track Event',
bubble:true,extra:{ax:'ShippingEstimatesModal'}});},'#zipCodeForm:submit':function(e){var m=this;f__.Dom.Event.preventDefault(e);m.set({f_b:m.getNodeValue('zipCode')});if(window.localStorage){try{window.localStorage.setItem(f_a,m.f_b);
}catch(e){}}m.reload();m.fire({name:'Track Event',bubble:true,extra:{ax:'ShippingEstimatesModalZip'}});}},instanceMethods:{f_h:function(){var m=this;setTimeout(function(){m.getNode('zipCode').focus();
m.getNode('zipCode').select();},1000*.25);},reload:function(){var m=this;if(m.isWired&&m.get('enabledInherited')&& !m.f_k){m.met('reloadLock');m.callInherited('loadHtmlIntoNode')({node:m.getNode(),injectMode:'outer replace'
},{cp:m.Class.moduleName,idPrefix:m.get('idPrefix'),product:f__.Url.toParams(m.models.product.serialize()),qty:m.f_j,zipCode:m.f_b},{cache:'never',beforeInject:function(f_m,f_n){m.unwireUi();f_m();m.wireUi();
},callback:function(){m.unmet('reloadLock');if(m.f_g)m.f_h();}});}}}});}});
Uize.module({name:'Zazzle.Models.Rooter.Design',superclass:'Zazzle.Model',required:['Uize.Data.Compare','Uize.Url','Uize.Widget.mEventBindings','Zazzle.DesignModel','Zazzle.Models.Rooter.DesignArea','Zazzle.Models.Rooter.DesignObject'
],builder:function(d_$){'use strict';var d__=true,d_a=false,d_b=null,d_c,d_d=Uize,d_e=d_d.Url,d_f=Zazzle,d_g=d_f.Models.Rooter.DesignArea,d_h=d_f.Models.Rooter.DesignObject.Type,d_i=zazzle.rlv,d_j=d_d.keys({d_k:1})[0],
d_l='none',d_m='nobuy',d_n='nopost',d_o='warn',d_p='customizeError',d_q='rlvnetError',d_r='designReadOnlyError',d_s='designNotPermitted',d_t='imagePermissionsError',d_u='propertyInvalidError',d_v={105:d_r,
106:d_u,108:d_s,301:d_t,302:d_p},d_w=d_d.Data.Compare.identical,d_x=function(d_y,d_z){return d_w(d_y,d_z)?d_z:d_y;},d_A=function(d_B){return't_'+d_B.urlkey+(d_B.type==1?'_iid':'_txt');},d_C=function(){
var m=this,d_D=m.d_D;m.d_D=m.d_E;!m.d_E||m.d_E!=d_D?this.d_F():this.d_G();},d_H=function(d_I){return!d_d.isEmpty(d_I)?d_I.substr(1,d_I.length-2).split(','):d_b;},d_J=function(d_K){return d_K?d_e.toParams(d_K):d_b}
;return d_$.subclass({mixins:[d_d.Widget.mEventBindings],staticProperties:{ConstraintLevel:{None:d_l,Warn:d_o,PreventPost:d_n,PreventPurchase:d_m},Error:{Default:d_q,Customize:d_p,DesignNotPermitted:d_s,
DesignReadonly:d_r,ImagePermissions:d_t,PropertyInvalid:d_u}},stateProperties:d_d.copyInto({d_L:{name:'activeAreaGroups',conformer:d_x,derived:{properties:'unfilteredAreaGroups,activeAreaGroupsLookup',
derivation:function(d_M,d_N){var d_L=[];if(d_M){for(var d_O= -1;++d_O<d_M.length;){var d_P=d_M[d_O].name;if(d_N[d_P])d_L.push(d_N[d_P]);}}return d_L;}}},d_N:{name:'activeAreaGroupsLookup',conformer:function(d_y,d_z){
var d_Q=d_x(d_y,d_z);if(d_Q!=d_z)this.d_R=d_z;return d_Q;},derived:{properties:'unfilteredAreaGroupsLookup,activeDesignAreasLookup',derivation:function(d_S,d_T){var d_N={};if(d_S){for(var d_U in d_T){
var d_P=d_T[d_U].get('areaGroupName');if(d_P in d_S)d_N[d_P]=d_S[d_P];}}return d_N;}}},d_V:{name:'activeDesignAreas',conformer:d_x,derived:{properties:'designAreas,productOption',derivation:function(d_W,d_X){
var d_Y=d_d.lookup(d_H(d_X&&d_X['design.areas'])),d_V=[];for(var d_U in d_W){var d_Z=d_W[d_U];if(!d_Z.get('isEmpty')||d_U in d_Y)d_V.push(d_Z);}return d_V;}}},d_T:{name:'activeDesignAreasLookup',conformer:function(d_y,d_z){
var d_Q=d_x(d_y,d_z);if(d_Q!=d_z)this.d_0=d_z;return d_Q;},derived:{properties:'activeDesignAreas',derivation:function(d_V){var d_T={};for(var d_1= -1;++d_1<d_V.length;){var d_Z=d_V[d_1];d_T[d_Z.get('name')]=d_Z;
}return d_T;}}},d_2:'allowOutline',d_3:{name:'areaGroups',conformer:d_x,derived:{properties:'areaGroupsLookup',derivation:function(d_4){var d_3=[];for(var d_P in d_4)d_3.push(d_4[d_P]);return d_3;}}},
d_4:{name:'areaGroupsLookup',conformer:function(d_y,d_z){var d_Q=d_x(d_y,d_z);if(d_Q!=d_z)this.d_5=d_z;return d_Q;},derived:{properties:'unfilteredAreaGroupsLookup,activeAreaGroupsLookup,emptyAreaGroupNames,missingAreaGroupNames',
derivation:function(d_S,d_N,d_6,d_7){var d_4={};if(d_S&&d_N){for(var d_P in d_S){if(d_P in d_N||(d_7&&d_P in d_7)||(d_6&&d_P in d_6))d_4[d_P]=d_S[d_P];}}return d_4;}}},d_8:{name:'autoSaveDelay',value:30000
},d_9:{name:'enableAutoSave',value:d_a},d_$_:{name:'autoSaveRetries',value:0},d___:{name:'maxAutosaveRetries',value:10},d_a_:'autoSaveTimeoutID',d_b_:{name:'autoSaver',derived:'hasUnsavedChanges, enableAutoSave, autoSaveDelay, autoSaveRetries:Math.random()',
onChange:function(){var m=this;var d_c_=m.d_a_;var d_d_=m.d_d_;var d_9=m.d_9;var d_8=m.d_8;var d_$_=m.d_$_;var d_e_=m.d_e_;if(!d_d_|| !d_9){clearTimeout(d_c_);m.set({d_a_:null});return;}if(d_c_){return;
}m.set({d_a_:setTimeout(function(){m.set({d_a_:null});m.save(function(d_f_){if(!d_f_){d_$_++;if(d_$_>d_e_)return;m.set({d_$_:d_$_});}else{m.set({d_$_:0});}},'autoSave');},d_8)});}},d_g_:{name:'batchingTimeout',
value:50},d_h_:{name:'brokenConstraints',conformer:d_x},d_i_:{derived:'brokenConstraints,unfilteredDesignAreas:Math.random()',onChange:function(){var m=this,d_j_=m.d_j_;if(!d_d.isEmpty(d_j_)){var d_k_=m.d_l_(m.d_h_);
for(var d_m_ in d_j_)d_j_[d_m_].set('brokenConstraints',d_k_[d_m_]||[]);}}},d_n_:'canEditDesignObjectLock',d_o_:'canPaste',d_p_:'canPostForSale',d_q_:'canRedo',d_r_:'canUndo',d_k:{conformer:d_x,onChange:function(){
var m=this,d_k=m.d_k,d_s_=m.d_s_;m.set({d_M:d_s_?d_d.map(d_k.unfilteredAreaGroups,function(d_t_){return d_d.copy(d_t_,{process:d_s_[d_t_.processName]});}):d_k.unfilteredAreaGroups});}},d_u_:'designAreaNames',
d_W:{name:'designAreas',conformer:d_x,derived:{properties:'designAreaNames,unfilteredDesignAreas',derivation:function(d_u_,d_j_){var d_W;if(d_j_){d_W={};for(var d_m_ in d_j_){if(d_u_&&d_m_ in d_u_)d_W[d_m_]=d_j_[d_m_];
}}return d_W;}}},d_v_:{name:'designId',onChange:d_C},d_w_:{name:'droppedActiveAreaGroups',conformer:d_x,derived:{properties:'droppedActiveDesignAreas,unfilteredAreaGroupsLookup',derivation:function(d_x_,d_S){
var d_w_={};if(!d_d.isEmpty(d_x_)&& !d_d.isEmpty(d_S)){for(var d_m_ in d_x_){var d_y_=d_x_[d_m_],d_z_=d_y_.get('areaGroupName');if(d_z_ in d_S)d_w_[d_z_]=d_S[d_z_];}}return d_w_;}}},d_x_:{name:'droppedActiveDesignAreas',
conformer:d_x,derived:{properties:'activeDesignAreasLookup',derivation:function(d_T){var m=this,d_0=m.d_0,d_A_=m.d_A_,d_x_={};if(!d_d.isEmpty(d_T)&& !d_d.isEmpty(d_0)&& !d_d.isEmpty(d_A_)&& !d_w(d_A_,m.d_B_)){
var d_C_=m.d_6||{};for(var d_m_ in d_T)d_C_[d_T[d_m_].get('areaGroupName')]=1;for(var d_m_ in d_0){var d_D_=d_0[d_m_];if(!(d_m_ in d_T)&& !(d_D_.get('areaGroupName')in d_C_))d_x_[d_m_]=d_D_;}}return d_x_;
}}},d_6:{name:'emptyAreaGroupNames',conformer:d_x},d_E_:{name:'emptyAreaGroups',conformer:d_x,derived:{properties:'emptyAreaGroupNames,unfilteredAreaGroupsLookup',derivation:function(d_6,d_S){return d_6&&d_S
?d_d.map(d_6,function(v,d_F_){return d_S[d_F_]}):d_c;}}},d_G_:{name:'filteredBrokenConstraints',conformer:d_x,derived:{properties:'brokenConstraints,productId,isCustomizing,templateFields,designConstraintsWhitelist,productConstraintsWhitelist,templateConstraintsWhitelist',
derivation:function(d_h_,d_H_,d_I_,d_J_,d_K_,d_L_,d_M_){var d_G_=d_c;if(d_h_){var d_N_=d_I_|| !d_H_?d_K_:d_d.copy(d_L_,!d_d.isEmpty(d_J_)?d_M_:d_b),d_O_=d_d.isEmpty(d_N_);d_G_=[];for(var d_P_= -1;++d_P_<d_h_.length;){
var d_Q_=d_h_[d_P_],d_R_=d_Q_.type;if(d_R_!='none'&&(d_O_||('constraint_'+d_R_)in d_N_))d_G_.push(d_d.copy(d_Q_,d_O_?d_b:{level:d_N_['constraint_'+d_R_]||d_Q_.level}));}}return d_G_;}}},d_S_:{derived:'filteredBrokenConstraints,unfilteredDesignAreas:Math.random()',
onChange:function(){var m=this,d_j_=m.d_j_;if(!d_d.isEmpty(d_j_)){var d_k_=m.d_l_(m.d_G_);for(var d_m_ in d_j_)d_j_[d_m_].set('filteredBrokenConstraints',d_k_[d_m_]||[]);}}},d_T_:{name:'hasAreaGroups',
derived:'areaGroups:!Uize.isEmpty(areaGroups)'},d_U_:{name:'hasBrokenConstraints',derived:'brokenConstraints:!Uize.isEmpty(brokenConstraints)'},d_V_:{name:'hasFilteredBrokenConstraints',derived:'filteredBrokenConstraints:!Uize.isEmpty(filteredBrokenConstraints)'
},d_W_:{name:'hasTemplateFields',derived:'templateFields:!Uize.isEmpty(templateFields)'},d_X_:{name:'hasUnfilteredAreaGroups',derived:'unfilteredAreaGroups:!Uize.isEmpty(unfilteredAreaGroups)'},d_Y_:{
name:'hasVisibleTemplateFields',derived:'templateValues:templateValues && Uize.findRecordNo(templateValues, {ppShow:true}) > -1'},d_d_:{name:'hasUnsavedChanges',value:false},d_Z_:'initialDesignOptions',
d_I_:{name:'isCustomizing',onChange:d_C,value:d_a},d_0_:'isSaving',d_1_:'isSmart',d_7:{name:'missingAreaGroupNames',conformer:d_x},d_2_:'originalProductId',d_3_:'preventPushOrInitialize',d_H_:{name:'productId',
onChange:d_C},d_X:{name:'productOption',conformer:d_x,onChange:d_C},d_B_:{name:'productOptionSansDesignAreas',conformer:function(d_y,d_z){var d_Q=d_x(d_y,d_z);if(d_Q!=d_z)this.d_A_=d_z;return d_Q;},derived:{
properties:'productOption',derivation:function(d_X){var d_B_=d_d.copy(d_X);delete d_B_['design.areas'];return d_B_;}}},d_E:{name:'productTypeName',onChange:[function(){var m=this;!m.d_4_&&m.d_E&&m.ajax(
'rooter/design/getconfiginfo',{pt:m.d_E},{requestOverrides:{cache:'memory'},callbackSuccess:function(d_5_){var d_4_=m.d_4_;m.d_4_=d__;m.processInfoData(d_5_.data);m.d_4_=d_4_;},callbackFail:function(){
}});},d_C]},d_6_:'serverResult',d_7_:'smartTemplateHasBeenSet',d_8_:{name:'smartTemplateLogo',onChange:function(){}},d_J_:{name:'templateFields',conformer:d_x},d_9_:{derived:'templateFields,unfilteredDesignAreas: Math.random()',
onChange:function(){var m=this,d_J_=m.d_J_,d_j_=m.d_j_;if(!d_d.isEmpty(d_j_)){for(var d_U in d_j_)d_j_[d_U].set('templateFields',d_J_);}}},d_$a:{name:'templateFieldsLookup',conformer:d_x,derived:{properties:'templateFields',
derivation:function(d_J_){var d__a={};d_d.forEach(d_J_,function(d_aa){d__a[d_aa.name]=d_aa;});return d__a;}}},d_ba:{name:'templateParams',conformer:d_x,onChange:d_C},d_ca:{name:'templateValues',derived:{
properties:'templateFields, templateParams',derivation:function(d_J_,d_ba){var m=this;if(m.d_I_)return d_J_;var d_da=d_d.clone(m.get('templateValues')||[]);d_d.forEach(d_da,function(d_ea,d_fa){if(!d_d.findRecord(d_J_,{nameExplicit:d_ea.nameExplicit})){
d_ea.value="";}});d_d.forEach(d_J_,function(d_ea,d_fa){if(d_d.findRecord(d_da,{nameExplicit:d_ea.nameExplicit}))return;d_da.push(d_ea);});d_d.forEach(d_ba,function(d_Q,d_ga){var d_ha=d_d.findRecord(d_da,{nameExplicit:d_ga});
if(!d_ha){return;}d_ha.isModified=true;d_ha.value=d_Q;});return d_da;}}},d_ia:{name:'templateValuesLookup',conformer:d_x,derived:{properties:'templateValues',derivation:function(d_ca){var d__a={};d_d.forEach(d_ca,function(d_aa){
d__a[d_aa.name]=d_aa;});return d__a;}}},d_ja:{name:'pushTemplatesOnCustomizing',derived:{properties:'isCustomizing',derivation:function(d_I_){var m=this;var templateParams=m.get('templateParams');if(d_I_&& !Uize.isEmpty(templateParams)){
m.d_G();}}}},d_ka:'queueViewAreaNeededRequests',d_la:{name:'transferableDesignAreasForEachArea',conformer:d_x,derived:{properties:'activeDesignAreasLookup,designAreas,areaGroupsLookup',derivation:function(d_T,d_W,d_4){
return d_d.map(d_W,function(d_ma){var d_P=d_ma.get('areaGroupName'),d_na=d_d.lookup([d_P]),d_oa={};d_d.forEach(d_T,function(d_pa,d_qa){var d_ra=d_pa.get('areaGroupName');if(!d_na[d_ra]){d_oa[d_qa]=d_pa;
d_na[d_ra]=d__;}});d_d.forEach(d_4,function(d_sa,d_ta){if(!d_na[d_ta]){var d_j_=d_sa.unfilteredDesignAreas;if(!d_d.isEmpty(d_j_)){for(var d_1= -1;++d_1<d_j_.length;){var d_ma=d_W[d_j_[d_1].name];if(d_ma){
d_oa[d_ma.get('name')]=d_ma;break;}}}}});return d_oa;});}},onChange:function(){var m=this;d_d.forEach(m.d_la,function(d_ua,d_m_){m.d_W[d_m_].set('transferableAreas',d_ua);});}},d_M:{name:'unfilteredAreaGroups',
conformer:d_x},d_S:{name:'unfilteredAreaGroupsLookup',conformer:d_x,derived:{properties:'unfilteredAreaGroups',derivation:function(d_M){var d_S={};d_d.forEach(d_M,function(d_va){d_S[d_va.name]=d_va});
return d_S;}}},d_wa:{derived:'unfilteredAreaGroupsLookup,unfilteredDesignAreas:Math.random()',onChange:function(){var m=this,d_j_=m.d_j_,d_S=m.d_S;!d_d.isEmpty(d_S)&&d_d.forEach(d_j_,function(d_ma){var
 d_t_=d_S[d_ma.get('areaGroupName')],d_xa=d_t_&&d_t_.unfilteredDesignAreas;if(!d_d.isEmpty(d_xa)){for(var d_1= -1;++d_1<d_xa.length;){var d_ya=d_xa[d_1];if(d_ya.name==d_ma.get('name')){d_ma.set({allowFill:d_ya.allowFill,
bleedMargins:d_ya.bleedMargins,physicalHeight:d_ya.physicalHeight,physicalWidth:d_ya.physicalWidth,properties:d_ya.properties,safeAreaMargins:d_ya.safeAreaMargins,title:d_ya.title});break;}}}});}},d_j_:{
name:'unfilteredDesignAreas',conformer:d_x,onChange:function(){this.d_za=d_d.copy(this.d_j_);}},d_Aa:{name:'viewAreaNeededQueue',value:[]}},d_d.map({d_K_:{name:'designConstraintsWhitelist',d_Ba:'designConstraints'
},d_L_:{name:'productConstraintsWhitelist',d_Ba:'productConstraints'},d_M_:{name:'templateConstraintsWhitelist',d_Ba:'templateConstraints'},d_s_:'unfilteredAvailableProcesses'},function(d_Ca){d_Ca=d_d.isPlainObject(d_Ca)
?d_Ca:{name:d_Ca};d_Ca.derived=d_j+':'+d_j+'["'+(d_Ca.d_Ba||d_Ca.name)+'"]';delete d_Ca.d_Ba;return d_Ca;})),eventBindings:{':Design Push Success':function(){var m=this,d_Da=function(){if(m.d_Aa.length)
m.d_Aa.shift()(d_Da);else m.set({d_ka:false,d_Aa:[]});};d_Da();}},instanceMethods:{d_l_:function(d_h_){var d_j_=this.d_j_,d_k_={},d_Ea={};d_d.forEach(d_h_,function(d_Q_){var d_Fa=d_Q_.areaName,d_Ga=d_Ea[d_Fa]=d_Ea[d_Fa]||d_j_[d_Fa].get('designObjectsLookup')
;var d_Ha=d_d.copy(d_Q_,{designObjects:d_d.map(d_Q_.designObjectNames,function(v,d_Ia){return d_Ga[d_Ia]})});delete d_Ha.areaName;delete d_Ha.designObjectNames;(d_k_[d_Fa]=d_k_[d_Fa]||[]).push(d_Ha);
});return d_k_;},d_Ja:function(d_Ka){var m=this;return d_d.copyInto({pid:m.d_H_,id:m.d_v_,pdt:m.d_E,readonly: !m.d_I_},m.d_X,m.d_ba,d_Ka?m.d_Z_:d_b);},d_La:function(d_Ma,d_Na,d_Oa){var m=this,d_Pa=m.d_Pa
;if(d_Na){m.set({d_6_:d_Ma.design.serverResult});if(d_Ma.success){var d_j_={},d_za=m.d_za||{},d_Qa=d_Pa.getTemplates(),d_Ra=d_d.map(d_Pa.getConstraints(),function(d_Sa){return{areaName:d_Sa.area,level:d_Sa.level,
designObjectNames:d_d.lookup(d_Sa.objects.split(',')),type:d_Sa.type};}),d_Ta=m.d_$a,d_Ua=function(d_Q){return d_Q&&d_Q.replace(/\r/g,'');},d_J_=d_d.map(d_Qa,function(d_B){var d_Va=d_B.urlkey,d_Wa=d_B.type==1,
d_Q=d_Ua(d_B.value);return{name:d_Va,nameVerbose:d_B.title,nameExplicit:d_A(d_B),type:d_Wa?'image':'text',initialValue:d_Ta&&(d_Va in d_Ta)?d_Ta[d_Va].initialValue:d_Q,value:d_Q,ppShow:d_B.ppshow,isModified: !!d_B.applied
};}),d_6=d_d.lookup(d_Pa.emptyAreaGroups),d_7=d_d.lookup(d_Pa.missingAreaGroups),d_X=d_d.clone(d_Pa.getAttributes());delete d_X.context;delete d_X.view;delete d_X.title;var d_ba=m.get('templateParams')||{};
d_d.forEach(d_J_,function(d_ha){if(d_ha.isModified){d_ba[d_ha.nameExplicit]=d_ha.value;}});d_d.forEach(d_Pa.getAreas(),function(d_Xa){var d_U=d_Xa.getName(),d_ma;if(d_za[d_U]){(d_ma=d_za[d_U]).update(d_Xa);
}else{d_ma=d_g.create(d_Xa);d_ma.wire({'Request Push':function(e){if(!m.is('preventPushOrInitialize')){m.met('isCustomizing');m.d_G({d_Ya:e.realviewId});}},'Smart Template Object Added':function(e){var
 d_Za=e.designObject,d_0a={t_coverlogo_iid:m.d_8_,t__pickoption:d_a,t__smart:d__};switch(d_Za.type){case d_h.Text:d_0a.t_covertext_txt=d_Za.value;break;default:d_0a.t_coverimage_iid=d_Za.value;}m.d_G({
d_0a:d_0a});},'Start Queueing View Area Needed Requests':function(){m.met('queueViewAreaNeededRequests');},'View Area Needed':function(e){var d_1a=m.d_1a,d_Ya=e.realviewId,d_2a=function(d_3a){if(d_d.isFunction(e.callback))
e.callback(d_3a);},d_4a=function(d_5a){var d_m_=d_ma.get('name'),d_6a=d_Ya+'|'+d_m_+'|'+m.d_X['design.areas'];if(d_6a in d_1a){var d_3a=m.d_Pa.getView(d_Ya).getViewArea(d_m_);d_3a.setGrid(d_1a[d_6a]);
d_2a(d_3a);d_5a&&d_5a();}else if(d_Ya){d_Pa.getView({view:d_Ya}).setNeedsGridRefresh(true);m.d_G({d_7a:d__,d_Na:d_a,d_Ya:d_Ya,d_8a:function(e){if(e.success){var d_3a=e.zdesignView.getViewArea(d_m_);d_1a[d_6a]=d_3a.getGrid();
d_2a(d_3a);d_5a&&d_5a();}}});}};if(m.d_ka)m.d_Aa.push(d_4a);else d_4a();}});m.fire({name:'Design Area Added',areaName:d_U,area:d_ma});}d_ma.set({canEditDesignObjectLock:m.d_n_,deferAddingDesignObjects:m.d_8_&& !m.d_7_
});d_j_[d_U]=d_ma;});for(var d_U in d_za){if(!(d_U in d_j_)){d_za[d_U].kill();m.fire({name:'Design Area Removed',areaName:d_U});}}var d_9a=m.d_3_;m.met('preventPushOrInitialize');m.set({d_6:d_6,d_h_:d_Ra,
d_p_:d_Pa.canPublish(),d_j_:d_j_,d_v_:d_Pa.getId(),d_d_: !m.d_0_&&m.d_I_,d_7:d_7,d_H_:!m.d_I_?m.d_H_:d_b,d_X:d_X,d_E:d_Pa.getType(),d_J_:d_J_,d_ba:d_ba});m.set('preventPushOrInitialize',d_9a);m.fire('Design Push Success');
}else{var d_$b=d_Ma.design.serverResult.Code;m.fire({name:'Design Push Failure',code:d_$b,type:d_v[d_$b]||d_q});}}m.set({d_o_:d_Pa.canPaste(),d_q_:d_Pa.isRedoable(),d_r_:d_Pa.isUndoable()});d_Oa();},
d_F:function(){var m=this,d_Pa=m.d_Pa;if(!m.is('preventPushOrInitialize')){if(d_Pa){d_Pa=d_b;}if(m.d_E||m.d_v_||m.d_H_){m.set({d_I_:m.d_H_?m.d_I_:d__,d_2_:m.d_H_});d_Pa=m.d_Pa=d_i.createZDesign(m.d_Ja());
d_Pa.useDesignSpace(d__);m.d_1a={};m.d_G({d_7a:d__,d_Ka:d__});}}},d_G:function(d__b){d__b=d__b||{};var m=this,d_Pa=m.d_Pa,d_Ya=d__b.d_Ya,d_ab= !d_d.isEmpty(d_Ya),d_7a=d__b.d_7a,d_Ka=d__b.d_Ka,d_0a=d__b.d_0a,
d_8a=d__b.d_8a,d_Na=d__b.d_Na!==d_a;if(d_Pa&&(d_7a||(!m.isMet('busy')&& !m.is('preventPushOrInitialize')))){var d_bb=function(){var d_cb;m.met('busy');d_Pa.opts=m.d_Ja(d_Ka);if(d_0a){d_d.copyInto(d_Pa.opts,
d_0a);m.met('smartTemplateHasBeenSet');}if(d_ab){d_cb=d_Pa.getView({view:d_Ya});d_Pa.setActiveView(d_cb);}d_Pa.setDirty();d_Pa.update({ignoreActiveView:!d_ab,callback:function(e){m.d_La(e,d_Na,function(){
d_d.isFunction(d_8a)&&d_8a({success:e.success,zdesignView:d_cb});m.unmet('busy');});}});};clearTimeout(m.d_db);if(!d_7a&& !d_ab)m.d_db=setTimeout(d_bb,m.d_g_);else d_bb();}},processInfoData:function(d_eb){
this.set({d_k:d_eb});},initialize:function(d_k){var m=this,d_4_=m.d_4_;m.d_4_=d__;if(!d_d.isEmpty(d_k)){var d_fb=d_k.config;delete d_k.config;m.set(d_k);!d_d.isEmpty(d_fb)&&m.processInfoData(d_fb);}m.d_4_=d_4_;
},finish:function(d_gb,d_8a){var m=this;if(m.d_Pa){m.d_Pa.finish(!!d_gb);m.d_G({d_7a:d__,d_8a:d_8a});}},productize:function(d_hb,d_8a){var m=this,d_H_=m.d_H_,d_2a=function(d_ib){d_d.isFunction(d_8a)&&d_8a(d_ib);
};if(m.d_I_||(d_H_&& !d_d.isEmpty(m.d_ba))){m.save(function(){d_hb=d_hb||{};m.ajax('rooter/design/productize',{pt:m.d_E,pd:d_H_,dz:m.d_v_,po:d_J(m.d_X),ta:d_J(m.d_ba),preferredViewId:d_hb.preferredViewId,
mu:d_hb.priceMarkup,tl:d_hb.title},{requestOverrides:{cache:'memory'},callbackSuccess:function(d_5_){d_2a(d_5_.data)},callbackFail:function(){d_2a()}});});}else d_2a(d_H_?{productId:d_H_}:d_c);},redo:function(){
var m=this;if(m.d_Pa&&m.isMet('canRedo')){m.d_Pa.redo();m.d_G();}},reset:function(d_jb){this.set(d_d.copyInto({designId:d_c,isCustomizing:d_a,originalProductId:d_c,productId:d_c,productOption:d_c,productTypeName:d_c
},d_jb));},save:function(d_kb,d_lb){var m=this,d_mb=function(d_f_){d_d.isFunction(d_kb)&&d_kb(d_f_)};if(!m.d_Pa){m.fire({name:'Design Save Failed',reason:'No design model to save.'});d_mb();}else if(!m.isMet('hasUnsavedChanges')){
m.fire({name:'Design Save Failed',reason:'No new design data to save.'});d_mb();}else if(m.isMet('isSaving')){m.fire({name:'Design Save Failed',reason:'Save already in progress.'});d_mb();}else{m.met('isSaving');
m.d_Pa.save();m.d_G({d_7a:d__,d_8a:function(e){var d_f_=e.success;m.unmet('isSaving');if(d_f_){m.fire({name:'Design Saved',trigger:d_lb});m.unmet('hasUnsavedChanges');}else{m.fire({name:'Design Save Failed',reason:'Unspecified RLV failure.'});
}d_mb(d_f_);}});}},undo:function(){var m=this;if(m.d_Pa&&m.isMet('canUndo')){m.d_Pa.undo();m.d_G();}}}});}});
Uize.module({name:'Zazzle.Widgets.Rooter.mAreaGroups',required:['Uize.Url','Zazzle.Models.Rooter.Design','Zazzle.Widget.mV2','Zazzle.Widgets.Rooter.mModels'],builder:function(){'use strict';var d_$=true,
d__=false,d_a=null,d_b=Uize,d_c=Zazzle,d_d=d_c.Models.Rooter.Design.Error,d_e=function(){var m=this,d_f=m.activeAreaGroup;if(d_f&& !m.activeChildAreaGroup)m.loadChildAreaGroup(d_f);},d_g=function(){var
 m=this,d_h=m.childAreaGroupsLookup,d_i=m.preventHandlingOfChildAreaGroupsActiveDesignAreaChange;m.met('preventHandlingOfChildAreaGroupsActiveDesignAreaChange');d_b.forEach(d_h,function(d_j,d_k){var d_l=m.designAreas;
if(d_l&& !(d_j.get('activeDesignAreaName')in d_l)){for(var d_m in d_l){var d_n=d_l[d_m];if(d_n.get('areaGroupName')==d_k){d_j.set('activeDesignArea',d_n);break;}}}});m.set('preventHandlingOfChildAreaGroupsActiveDesignAreaChange',d_i);
};return function(d_o){d_o.declare({mixins:[d_c.Widget.mV2,d_c.Widgets.Rooter.mModels],stateProperties:{activeAreaGroup:{derived:{properties:'activeDesignArea,areaGroupsLookup',derivation:function(d_p,d_q){
var d_f;if(d_p&&d_q)d_f=d_q[d_p.get('areaGroupName')];return d_f;}},onChange:d_e},activeChildAreaGroup:{derived:{properties:'childAreaGroupsLookup,activeAreaGroup',derivation:function(d_h,d_f){var d_r;
if(d_h&&d_f)d_r=d_h[d_f.name];return d_r;}},onChange:function(){var m=this;m.forEachChildAreaGroup(function(d_j){d_j.set('isActive',d_j==m.activeChildAreaGroup)});}},activeDesignArea:{},activeDesignAreaName:{
},activeDesignAreas:{},areaGroups:{onChange:function(){}},areaGroupsLookup:{},canLoadChildAreaGroup:{onChange:d_e,value:d_$},childAreaGroups:{value:d_a},childAreaGroupsContainer:{},childAreaGroupsInjectMode:{
value:'inner bottom'},childAreaGroupsLookup:{derived:{properties:'childAreaGroups',derivation:function(d_s){var d_h={},d_t= -1,d_u=d_s?d_s.length:0;for(;++d_t<d_u;){var d_j=d_s[d_t];d_h[d_j.get('areaGroupName')]=d_j;
}return d_h;}},onChange:d_g},childAreaGroupWidgetNamePrefix:{value:'areaGroup'},designAreas:{onChange:d_g},designAreasForActiveAreaGroup:{derived:{properties:'activeAreaGroup,designAreas',derivation:function(d_f,d_v){
var d_w=[];if(d_f&&d_v){var d_x=d_f.unfilteredDesignAreas,d_y= -1,d_z=d_x.length;for(;++d_y<d_z;){var d_A=d_x[d_y],d_B=d_v[d_A.name];d_B&&d_w.push(d_B);}}return d_w;}}},firstChildAreaGroup:{derived:'childAreaGroups,numChildAreaGroups:numChildAreaGroups > 0 ? childAreaGroups[0] : undefined'
},hasChildAreaGroups:{derived:'numChildAreaGroups:numChildAreaGroups > 0'},includeAddImageButton:{},includeAddTextButton:{},isCustomizing:{},lastChildAreaGroup:{derived:'childAreaGroups,numChildAreaGroups:numChildAreaGroups > 0 ? childAreaGroups[numChildAreaGroups-1] : undefined'
},numChildAreaGroups:{derived:'childAreaGroups:childAreaGroups ? childAreaGroups.length : 0'},preventHandlingOfChildAreaGroupsActiveDesignAreaChange:{}},children:{areaGroupSelector:d_a},alphastructor:function(){
var m=this,d_C=m.children,d_D=m.addedChildren;m.uniqueChildAreaGroupWidgetNameIndex=0;m.childAreaGroupWiredEvents={};d_D.wire('Changed.*',function(e){var d_s=m.childAreaGroups||[];d_b.forEach(e.properties,
function(v,d_E){if(d_D.isMet(d_E)){var d_F=d_C[d_E];if(d_F.get('isAreaGroup')){var d_G=m.childAreaGroupWiredEvents[d_E]={'Changed.activeDesignArea':function(e){!m.isMet('preventHandlingOfChildAreaGroupsActiveDesignAreaChange')
&&m.handleChildAreaGroupActiveDesignAreaChange(e.newValue,d_F,e);}};d_F.wire(d_G);d_s=d_s.concat([d_F]);m.uniqueChildAreaGroupWidgetNameIndex++;}}else{var d_H=[];for(var d_I= -1;++d_I<d_s.length;){var d_j=d_s[d_I];
if(d_j.get('name')!=d_E)d_H.push(d_j);else d_j.unwire(m.childAreaGroupWiredEvents[d_E]);}d_s=d_H;}});m.set('childAreaGroups',d_s);});},modelBindings:{areaGroups:'<-design',areaGroupsLookup:'<-design',
activeDesignArea:{property:'activeDesignAreaName',when:'designAreas',valueAdapter:{aToB:function(d_p){return d_p&&d_p.get('name')},bToA:function(d_J,m){return m.designAreas[d_J]}}},activeDesignAreas:'<-design',
designAreas:'<-design',isCustomizing:'<-design'},modelEventBindings:{design:{'Changed.droppedActiveDesignAreas':function(e){var d_K=e.newValue;!d_b.isEmpty(d_K)&&this.handleDroppedActiveDesignAreas(d_K)
;},'Design Push Failure':function(e){this.handleDesignErrors(e.type,e.code)}}},childBindings:{activeDesignArea:{child:'areaGroupSelector',property:'value',when:'activeDesignArea,activeDesignAreas,designAreas',
valueAdapter:{aToB:function(d_p){return d_p.get('areaGroupName');},bToA:function(d_k,d_L,m){var d_M=function(d_v){for(var d_N in d_v){var d_B=d_v[d_N];if(d_B.get('areaGroupName')==d_k)return d_B;}};return(d_k in m.childAreaGroupsLookup?m.childAreaGroupsLookup[d_k].get('activeDesignArea'):d_a)
||d_M(m.activeDesignAreas)||d_M(m.designAreas);}}}},instanceMethods:{displayErrorMessage:function(d_O,d_P){this.inform({state:'error',message:d_O,callback:d_P});},handleChildAreaGroupActiveDesignAreaChange:function(d_Q
){this.set('activeDesignArea',d_Q);},handleCustomizeDesignError:function(d_P){this.displayErrorMessageWithLogin('customizeError',d_P);},handleDesignErrors:function(d_R){var m=this;switch(d_R){case d_d.Customize:
m.handleCustomizeDesignError();break;case d_d.DesignNotPermitted:m.handleDesignNotPermitted();break;case d_d.ImagePermissions:m.handleImagePermissionsDesignError();break;default:m.handleGenericDesignError();
break;}},handleDesignNotPermitted:function(d_P){this.displayErrorMessageWithLogin('rlvnetError',d_P);},handleGenericDesignError:function(d_P){this.displayErrorMessage(this.localize('rlvnetError'),d_P);
},handleImagePermissionsDesignError:function(d_P){this.displayErrorMessageWithLogin('imagePermissionsError',d_P);},handleDroppedActiveDesignAreas:function(){},getChildAreaGroupLoadParams:function(){},
loadChildAreaGroup:function(d_S,d_P){var m=this,d_T=function(d_U){d_b.isFunction(d_P)&&d_P(d_U)};if(d_S){var d_k=d_S.name,d_V=d__;m.forEachChildAreaGroup(function(d_j){if(d_j.get('areaGroupName')==d_k)
d_V=d_$;});if(m.canLoadChildAreaGroup&& !d_V){if(m.isWired){m.callInherited('loadHtmlIntoNode')({node:m.getNode(m.childAreaGroupsContainer),injectMode:m.childAreaGroupsInjectMode},d_b.copyInto({idPrefix:m.childId(m.getChildAreaGroupWidgetName(m.uniqueChildAreaGroupWidgetNameIndex)),
rootCssClassName:m.cssClass('areaGroup'),product:d_b.Url.toParams(m.models.product.serialize()),areaGroup:d_k,activeDesignArea:m.activeDesignArea.get('name'),includeAddImageButton:m.includeAddImageButton,
includeAddTextButton:m.includeAddTextButton},m.getChildAreaGroupLoadParams(d_S)),function(){d_T(d_$)});}}else d_T(d_V);}else d_T(d__);},forEachChildAreaGroup:function(d_W){d_b.forEach(this.childAreaGroups,d_W)},
getChildAreaGroupWidgetName:function(d_t){return this.childAreaGroupWidgetNamePrefix+d_t;},displayErrorMessageWithLogin:function(d_X,d_P){var m=this;m.displayErrorMessage(m.localize(d_X),function(){m.callInherited('ensureLoggedIn')({
forceLogin:d_$,callback:d_P});});}}});};}});
Uize.module({name:'Zazzle.Widgets.Rooter.AreaGroups',superclass:'Zazzle.Widget.V2',required:'Zazzle.Widgets.Rooter.mAreaGroups',builder:function(f_$){'use strict';var f__=Uize;return f_$.subclass({mixins:Zazzle.Widgets.Rooter.mAreaGroups,
cssBindings:{hasChildAreaGroups:['noAreaGroups','hasAreaGroups']},instanceMethods:{handleDroppedActiveDesignAreas:function(f_a){var m=this,f_b=m.localize('droppedActiveDesignAreasWarning',{areaList:'\n\n'
+f__.values(f__.map(f_a,function(f_c){return'- '+f_c.get('title');})).join('\n')+'\n\n'});if(f_b){m.confirm({state:'warning',message:f_b,noHandler:function(){m.models.design.undo()}});}}}});}});
Uize.module({name:'Zazzle.Widgets.Spp.AreaGroups',superclass:'Zazzle.Widgets.Rooter.AreaGroups',required:'Zazzle.Droplist',builder:function(g_$){'use strict';var g__=Uize;return g_$.subclass({stateProperties:{
g_a:{name:'areaGroupSelectorValues',derived:{properties:'areaGroupsForSelector',derivation:function(g_b){return Uize.map(g_b,function(g_c){var g_d=g_c.name;return{name:g_d,valueDetails:{name:g_d,displayName:g_c.title||g_d
}};});}}},g_b:{name:'areaGroupsForSelector',derived:'areaGroups,preferredViewVisibleAreaGroups: !Uize.isEmpty(preferredViewVisibleAreaGroups) ? preferredViewVisibleAreaGroups : areaGroups'},g_e:'preferredView',
g_f:{name:'preferredViewVisibleAreaGroups',derived:{properties:'areaGroupsLookup,designAreas,preferredView',derivation:function(g_g,g_h,g_e){if(!g__.isEmpty(g_g)&&g_h&&g_e){var g_i={};g__.forEach(g_e.get('visibleDesignAreaNames'),function(g_j){
var g_k=g_h[g_j],g_l=g_k&&g_g[g_k.get('areaGroupName')];if(g_l)g_i[g_l.name]=g_l;});return g__.values(g_i);}}}},g_m:{name:'showAreaGroupSelector',derived:'preferredViewVisibleAreaGroups: preferredViewVisibleAreaGroups && preferredViewVisibleAreaGroups.length > 1'
}},alphastructor:function(){var m=this;m.whenever('wired',function(){var g_n=function(e){var g_o=zPage.children.zazzleHeader&&zPage.children.zazzleHeader.children.headerSearch,g_p=zPage.children.productDialog,
g_q= !g_p||(g_p.is('shown')&&m.getInherited('isProductDialog')),g_r=g__.copy(g__.Widget.Dialog?g__.Widget.Dialog.openDialogs:{}),g_s=zPage.children.product.children.shippingEstimate;delete g_r.productDialog;
if(g_q&&g__.keys(g_r).length==0&&m.activeChildAreaGroup&&(!g_o|| !g_o.is('focused'))&& !g_s.get('paletteShown'))m.activeChildAreaGroup.handleKeyboardAction(e);};m.web(document.body).keydown(g_n);m.whenever('!wired',function(){
m.web(document.body).unwire('keydown',g_n);});});},set:{childAreaGroupsContainer:'areaGroups'},cssBindings:{showAreaGroupSelector:['','showAreaGroupSelector']},children:{areaGroupSelector:Zazzle.Droplist
},childBindings:{areaGroupSelectorValues:'->areaGroupSelector.values',canLoadChildAreaGroup:'<-.isCustomizing'},modelBindings:{preferredView:'<-product'},instanceMethods:{getChildAreaGroupLoadParams:function(g_l){
var g_t=g_l.process,g_u=function(g_v){switch(g_v){case'print':return'Zazzle.Widgets.Spp.OldAreaGroup.Print';case'simpletext':console.error('The simpletext embellishment process does not have SPP support yet');
break;case'stitch':return'Zazzle.Widgets.Spp.OldAreaGroup.Stitch';case'screen':console.error('The screen embellishment process does not have SPP support yet');break;case'screen':console.error('The screen embellishment process does not have SPP support yet');
break;}};return{cp:g_u(g_t.baseProcessName)||g_u(g_t.inheritedProcessName)};},handleDesignNotPermitted:function(g_w){this.displayErrorMessageWithLogin('rlvnetError',g_w);this.fire({name:'Track Event',
bubble:true,extra:{ax:'sppProcessingError',type:'designNotPermitted'}});},handleGenericDesignError:function(g_w){this.displayErrorMessage(this.localize('rlvnetError'),g_w);this.fire({name:'Track Event',
bubble:true,extra:{ax:'sppProcessingError',type:'generic'}});}}});}});
Uize.module({name:'Zazzle.ImageSelectorSingle',superclass:'Uize.Widget.FormElement',required:['Uize.Node','Uize.Url','Uize.Widget.Button','Zazzle.Widget.mV2','Uize.Widget.mWeb'],builder:function(e_$){'use strict';
var e__=true,e_a=Uize,e_b=e_a.Url,e_c=null,e_d=function(){var m=this;if(m.isWired){var e_e={},e_f=m.web('preview').css('backgroundImage'),e_g=e_f&&e_f.substr(0,3)==='url'?e_b.fromParams(m.web('preview').css('backgroundImage')):e_c
;if(e_a.isEmpty(m.get('value')))m.web('preview').css({backgroundImage:''});if(m.checkIsSameId(e_g))return;if(m.e_h)e_e.pendstitch=1;if(m.e_i=='spimage')e_e.screen=1;m.imageUrl(e_e,function(e_j){m.e_k(e_j)});
}};return e_$.subclass({mixins:[Zazzle.Widget.mV2,Uize.Widget.mWeb],omegastructor:function(){var m=this;m.e_l('select',function(){m.get('enabled')&&m.e_m()});m.e_l('clear',function(){m.get('enabled')&&m.set({value:''})});
m.wire('Changed.value',function(){m.e_n()});m.wire('Changed.enabled',function(){m.e_o()});},instanceMethods:{e_p:function(){var m=this,e_f=m.web('preview').css('backgroundImage');m.e_k(e_f&&e_f.substr(0,3)==='url'?e_b.fromParams(m.web('preview').css('backgroundImage')):e_c);
},e_l:e_a.Widget.Button.addChildButton,e_m:function(){var m=this,e_q=function(){m.callInherited('useMediaBrowser')(e_a.copyInto({selectionMode:'single',imageType:m.e_i,checkZT:m.e_i=='ztimage'},m.getAllMediaBrowserOverrides()
),function(e_r){m.mediaBrowserCallback(e_r);});};m.beforeMediaBrowserUpload(e_q);},e_k:function(e_j){var m=this;var e_s=16*m.e_t;var e_u=m.e_v?(m.e_w/m.e_x):1;if(!m.get('parent'))return;var e_y=m.web(m.get('parent').getNode()).width();
m.set({e_y:e_y});if(e_y<m.e_x||e_y<m.e_z){if(m.e_w==0||m.web("preview").contentHeight()==0)m.web('preview').css({padding:(e_u*100)+'% 0 0 0'});if(!e_a.isEmpty(m.get('value')))m.web('preview').css({backgroundImage:'url('+e_j+')'});
}else{var e_A={};if(!e_a.isEmpty(m.get('value'))){e_A.backgroundImage='url('+e_j+')';}e_A.width=m.e_v?m.e_x:m.e_z;e_A.height=m.e_v?m.e_w:m.e_z;m.web('preview').css(e_A);m.web('outerBorder').css({width:((m.e_v?m.e_x:m.e_z)+(2*e_s))+'px',
height:((m.e_v?m.e_w:m.e_z)+(2*e_s))+'px'});}},e_n:function(){var m=this;if(m.isWired){var e_B=m.children,e_C=m.get('value');m.updateImageUrl();m.web(e_B.select).html(m.localize(e_C?'change':'select'));
e_B.clear.set({enabled:!!e_C});}},e_o:function(){var m=this;m.web('actions').display(m.get('enabled'));},beforeMediaBrowserUpload:function(e_D){e_D&&e_D();},checkIsSameId:function(e_g){return e_g&&e_g.id===this.get('value');
},mediaBrowserCallback:function(e_r){var m=this;m.set({isDirty:e__,value:e_r[0].attributes.id,pending:e_r[0].pendstitch});m.updateImageUrl();m.fire({name:'Image selected',info:e_r[0]});},imageUrl:function(e_e,e_D){
var m=this,e_E={action:'getimage',max_dim:m.e_z,id:m.get('value'),bg_pattern:'checker',square_it:'true'};if(m.e_F==='fill'){m.ajax({serviceUrl:e_b.resolve(m.getInherited('env').realview,{action:'getimageinfo',
id:m.get('value'),output:'js'})},{cache:'memory',returnType:'json',callback:function(e_G){var e_H=e_G.children,e_x,e_w,e_I=0;for(;e_I<e_H.length;e_I++){if(e_H[e_I].name=='width'){e_x=e_H[e_I].value;}
else if(e_H[e_I].name=='height'){e_w=e_H[e_I].value;}}var e_J= !e_a.isNully(m.e_x)?m.e_x:m.e_z,e_K= !e_a.isNully(m.e_w)?m.e_w:m.e_z;if(e_x>e_w){e_a.copyInto(e_E,{zoom_height:e_K});if(e_x<e_J){e_a.copyInto(e_E,{zoom_width:(e_x*e_J/e_w)});
}}else if(e_w>e_x){e_a.copyInto(e_E,{zoom_width:e_J});if(e_w<m.e_z){e_a.copyInto(e_E,{zoom_height:(e_w*e_K/e_x)});}}e_D&&e_D(e_b.resolve([m.getInherited('env').realview,e_E,e_e]));}});}else{e_D&&e_D(e_b.resolve([
m.getInherited('env').realview,e_E,e_e]));}},getAllMediaBrowserOverrides:function(){return this.e_L;},updateImageUrl:e_d,updateUi:function(){var m=this;if(m.isWired){m.e_n();m.e_p();e_$.doMy(m,'updateUi');
}},wireUi:function(){var m=this;if(!m.isWired){m.web('preview').click(function(){m.get('enabled')&&m.e_m()});if(window.addEventListener)window.addEventListener('resize',function(){m.e_p();});e_$.doMy(m,'wireUi');
}}},stateProperties:{e_t:{name:'borderMargin',value:0.5},e_M:{name:'hasValue',derived:{derivation:function(e_C){return!e_a.isEmpty(e_C);},properties:'value'}},e_w:{name:'height',value:e_c},e_i:{name:'imageType',
onChange:e_d,value:'image'},e_v:{name:'isNonSquare',derived:{properties:['width','height'],derivation:function(e_x,e_w){return!e_a.isNully(e_x)&& !e_a.isNully(e_w)&&e_x>0&&e_w>0;}}},e_z:{name:'maxDim',
onChange:e_d,value:100},e_N:{name:'defaultMaxDim'},e_L:'mediaBrowserOverrides',e_h:{name:'pending',onChange:e_d},e_F:{name:'resizeMode',value:'fit'},e_O:'tooltip',e_x:{name:'width',value:e_c},e_P:{name:'valueEmpty',
derived:'value: Uize.isEmpty(value)'},e_y:{name:'parentWidth',value:0},e_Q:{name:'resized',derived:'parentWidth, width, maxDim: parentWidth != 0 && (parentWidth < width || parentWidth < maxDim)'}},cssBindings:{
hasValue:['','hasImage'],isNonSquare:['','nonSquare'],resizeMode:'value',valueEmpty:['','linearGradient'],resized:['','resized']}});}});
Uize.module({name:'Uize.Widget.Form.mDeclarativeElements',required:['Uize.Widget.FormElements','Uize.Widget.mDeclarativeChildren'],builder:function(){'use strict';return function(e_$){e_$.declare({staticProperties:{
mDeclarativeElements_elementsAdded:{}},staticMethods:{elements:function(e__){this.children(this.mDeclarativeElements_elementsAdded=e__)}},instanceMethods:{mDeclarativeChildObjects_children_getContainer:function(e_a){
var e_b=this.Class.mDeclarativeElements_elementsAdded;return e_b&&e_a in e_b?this.children.elements:this;}}});};}});
Uize.module({name:'Zazzle.Form',superclass:'Uize.Widget.Form',required:['Zazzle.Widget.mV2','Uize.Widget.Form.mDeclarativeElements'],builder:function(e_$){return e_$.subclass({mixins:[Zazzle.Widget.mV2,
Uize.Widget.Form.mDeclarativeElements]});}});
Uize.module({name:'Zazzle.TemplateFieldsUi',superclass:'Zazzle.Form',required:['Uize.Array.Sort','Uize.Data.Compare','Uize.Widget.FormElement.Text','Zazzle.ImageSelectorSingle','Zazzle.SeeMoreUi'],builder:function(f_$){
'use strict';var f__,f_a=false,f_b=true,f_c=null,f_d=Uize,f_e=f_d.Widget.FormElement.Text,f_f=Zazzle.ImageSelectorSingle,f_g=f_d.Data.Compare.identical,f_h=function(fn,f_i,f_j){if(!f_i||f_i<0)f_i=0;var f_k;
return function(){var m=this,f_l=arguments;var f_m=function(){f_k=null;if(!f_j){fn.apply(m,f_l);}};if(f_k){clearTimeout(f_k);}else if(f_j){fn.apply(m,f_l);}f_k=setTimeout(f_m,f_i);};},f_n=function(){
var m=this,f_o=m.f_o=(m.f_o||[]);if(f_o){var f_p=m.get('keypressUpdateDelay'),f_q=f_p>0?f_h(m.f_q,f_p):m.f_q;f_d.forEach(f_o,function(f_r,f_s){var f_t=f_r.type=='text',f_u=m.addFormElement('item'+f_s,
f_t?f_e:f_f,f_d.copyInto({value:f_r.value},f_t?{validator:[{func:function(f_v){return f_v!=f__?f_v.length<=512:f_b;},msg:m.localize('warningMessageLength')},{func:function(f_v){return f_v!=f__?(/^[\x0a\x0d\x20-\xFF\u0100-\u017F\u2018\u2019\u201C\u201D\u2460-\u2473\u2F00-\u31FF\u4E00-\u9FCB\uFF00-\uFFEE\uAC00-\uD7A3]*$/.test(f_v)):f_b;
},msg:m.localize('warningMessageCharset')}]}:{tooltip:f_r.nameVerbose}));f_u.wire(f_p>=0?'Changed.tentativeValue':'Changed.value',function(f_w){m.f_o[f_s].value=f_w.newValue;f_q.apply(m);});});}},f_x=function(){
var m=this,f_y=m.f_z=='stitch'?'ztimage':'image',f_o=m.f_o,f_A=f_o.length;for(var f_s= -1;++f_s<f_A;){var f_B=f_o[f_s],f_C=f_B.type==='image',f_D=f_C&&m.getFormElement('gsm'+f_s);f_D&&f_D.set({imageType:f_y});
}};return f_$.subclass({stateProperties:{f_p:'keypressUpdateDelay',f_z:{name:'process',onChange:f_x},f_o:{name:'templateFields',conformer:function(f_E,f_F){f_E=f_E&&f_d.Array.Sort.sortBy(f_E,function(f_v){
return f_v.name.toLowerCase().replace(/\d+$/,function(f_G){return(Math.pow(10,3)+ +f_G+'').slice(1)});});var f_H=f_g(f_E,f_F);if(!f_H)this.f_I=f_F;return f_H?f_F:f_E;},onChange:function(){var m=this;
if(m.isWired){var f_I=m.f_I,f_o=m.f_o,f_J=f_b,f_K={};if(f_I&&f_o&&f_o.length==f_I.length){var f_L=f_b;for(var f_M= -1;++f_M<f_o.length;){var f_r=f_d.copy(f_o[f_M]),f_N=f_d.copy(f_I[f_M]);f_K['item'+f_M]=f_r.value;
delete f_r.value;delete f_r.initialValue;delete f_r.isModified;delete f_N.value;delete f_N.initialValue;delete f_N.isModified;if(!f_g(f_r,f_N)){f_L=f_a;break;}}if(f_L)f_J=f_a;}if(f_J){var f_O=m.children.seeMore;
m.removeFormElement();m.unwireUi();m.get('html')!=f__&&m.set({built:f_a});m.f_n();m.insertOrWireUi();m.f_q();setTimeout(function(){f_O.set('updateIncrement',f_d.now())},0);}else{m.setValues(f_K);}}}}
},set:{html:f_b},children:{seeMore:Zazzle.SeeMoreUi},omegastructor:f_n,instanceMethods:{f_n:f_n,f_q:function(){this.fire({name:'Values Set',values:this.getValues(f_b)});},f_x:f_x,getTemplateFieldFormElement:function(f_P){
var f_s=f_d.findRecordNo(this.f_o,{name:f_P});return f_s> -1?this.getFormElement('gsm'+f_s):f_c;},getValues:function(f_Q,f_R){var m=this,f_S={},f_o=m.f_o,f_A=f_o.length;for(var f_s= -1;++f_s<f_A;){var
 f_B=f_o[f_s],f_P=f_B.name;if(!f_R||f_B.value!=f_B.initialValue)f_S[f_Q?f_B.nameExplicit:f_P]=f_B.value;}return f_S;},hasDeviantParams:function(){var m=this,f_T=f_a,f_o=m.f_o,f_A=f_o.length;for(var f_s= -1;++f_s<f_A&& !f_T;){
var f_B=f_o[f_s];f_T=f_B.value!=f_B.initialValue;}return f_T;},setValues:function(f_S){var f_U=this.children.committer.get('watchedProperties');for(var f_P in f_S){if(f_S[f_P]!=f_c){var f_V=f_U[f_P];
f_V&&f_V.instance.set(f_V.name,f_S[f_P]);}}},wireUi:function(){var m=this;if(!m.isWired){m.set({container:m.getNode('items')});f_$.doMy(m,'wireUi');}}}});}});
Uize.module({name:'Zazzle.Widgets.Rooter.mTemplate',required:['Uize.Data.Compare','Zazzle.Models.Rooter.Design','Zazzle.Widget.mV2','Zazzle.Widgets.Rooter.mModels'],builder:function(){'use strict';var d_$=Uize,
d__=Zazzle,d_a=d__.Models.Rooter.Design.ConstraintLevel,d_b=d_$.Data.Compare.identical,d_c=function(d_d,d_e){return d_b(d_d,d_e)?d_e:d_d;};return function(d_f){d_f.declare({mixins:[d__.Widget.mV2,d__.Widgets.Rooter.mModels
],stateProperties:{hasVisibleTemplateFields:{derived:{properties:'hasVisibleTemplateFieldsFromDesignModel,initialTemplateFields,isCrawler,templateFields',derivation:function(d_g,d_h,d_i,d_j){if(d_i)return d_$.findRecordNo(d_h,{bPPageShow:true})> -1;
else return d_g;}}},hasVisibleTemplateFieldsFromDesignModel:{},initialTemplateFields:{},isCustomizing:{},isCrawler:{value:true},templateParams:{},templateFields:{}},modelBindings:{hasVisibleTemplateFieldsFromDesignModel:'<-design.hasVisibleTemplateFields',
isCustomizing:'<-design',templateParams:'design',templateFields:'<-design.templateValues'},modelEventBindings:{'design:Changed.filteredBrokenConstraints':function(e){var m=this,d_k=m.getFormElement(),
d_l=e.source;if(!d_$.isEmpty(d_k)){var d_m={},d_n={};d_$.forEach(e.newValue,function(d_o){d_o.level!=d_a.None&&d_$.copyInto(d_m,d_$.lookup(d_$.keys(d_o.designObjectNames),d_o.type));});if(!d_$.isEmpty(d_m)){
d_$.forEach(d_l.get('designAreas'),function(d_p){d_$.forEach(d_p.get('designObjects'),function(d_q){var d_r=d_q.get('name'),d_s=d_q.get('templateUrlKey');if(d_s&&d_r in d_m)d_n[d_s]=d_m[d_r];});});}d_$.forEach(
d_k,function(d_t){var d_u=d_t.get('elementName'),d_v=d_n[d_u];d_t.set({warningMessage:d_v?m.localize('constraint_'+d_v):'',warningShown:!!d_v});});}}},eventBindings:{':Values Set':function(){var m=this,
d_w=this.getValues(true,true);m.set('templateParams',d_w);if(d_$.keys(d_w).length)m.fire({name:'Track Event',extra:{ax:'templateValueChanged'},bubble:true});}}});};}});
Uize.module({name:'Zazzle.Widgets.Rooter.Template',superclass:'Zazzle.TemplateFieldsUi',required:'Zazzle.Widgets.Rooter.mTemplate',builder:function(g_$){'use strict';return g_$.subclass({mixins:Zazzle.Widgets.Rooter.mTemplate,
cssBindings:{hasVisibleTemplateFields:['','hasVisible']}});}});
Uize.module({name:'Zazzle.Widgets.Spp.Template',superclass:'Zazzle.Widgets.Rooter.Template',builder:function(h_$){'use strict';var h__=Uize;return h_$.subclass({stateProperties:{},children:{},childBindings:{
},cssBindings:{},htmlBindings:{},eventBindings:{}});}});
Uize.module({name:'Zazzle.Callout',superclass:'Uize.Widget.Button',required:'Uize.Node.Classes',builder:function(e_$){'use strict';var e__=e_$.subclass(null,function(){var m=this;m.wire('Changed.text',
function(){m.e_a()});}),e_b=e__.prototype;e_b.e_c=function(){var m=this;m.isWired&&Uize.Node.Classes.setState(m.getNode(),[m.e_d+m.e_e,m.e_d+m.e_f],true);};e_b.e_a=function(){var m=this;m.isWired&&m.setNodeProperties('text',{title:m.get('text')})
;};e_b.updateUi=function(){var m=this;if(m.isWired){m.e_c();m.e_a();e_$.doMy(m,'updateUi');}};e_b.wireUi=function(){var m=this;if(!m.isWired){m.e_e='';e_$.doMy(m,'wireUi');}};e__.stateProperties({e_g:'filter',
e_f:{name:'style',conformer:function(e_f){this.e_e=this.e_f;return e_f;},onChange:e_b.e_c},e_d:'cssClassStylePrefix'});return e__;}});
Uize.module({name:'Zazzle.SelectorValueDisplay.Product',required:['Zazzle.Callout','Uize.Template','Uize.Json'],builder:function(i_$){var i__=null,i_a=Uize,i_b='Alternate',i_c=function(i_d){var m=this;
if(!m.isWired&&m.canWire){var i_e=['thumbnailBorder','displayName'],i_f,i_g=i_d.moreInfoValueDisplayInfo!==i_f,i_h=i_d.moreInfoRestTime!==i_f,i_i=m.i_i,i_j=m.i_j,i_k=[];if((i_g&& !i_i)||(i_h&&m.i_l))
m.i_m();i_i&&m.get('valueDetails').name!=i__&&i_h&&i_j&&i_a.forEach(i_e,function(i_n){var i_o=m.callInherited('wireTooltip')({node:m.getNode(i_n),component:{name:'Zazzle.Dialog.SelectorValueDisplay',
params:{valueDisplayInfo:i_a.Json.to(i_i,'mini')}},widgetProperties:{name:'moreInfoTooltip',valueDetails:m.get('valueDetails'),contents:i__},restTime:i_j});i_o&&i_k.push(i_o);});m.i_l=i_j;m.i_p=i_k;}
};return i_$.subclass({omegastructor:function(){var m=this;m.wire('Changed.valueDetails',function(){m.i_q()});},instanceMethods:{i_r:function(){var m=this;if(m.isWired&&m.canUpdate){var i_s=m.get('valueDetails');
m.web('info').display(!!(m.i_i&&(i_s.descriptionAlt||i_s.description)));}},i_q:function(){var m=this,i_s=m.get('valueDetails'),i_t=m.get('valueDisplayInfo');if(m.isWired&&m.canUpdate&&i_s&&i_t){var i_u=function(i_v){return!!i_v},
i_w=function(i_n,i_v,i_x){var i_y=m.web(i_n);i_y.display(i_x);i_x&&i_y.html(i_v);},i_z=i_s.extraInfo,i_A=i_t.showExtraInfo&&i_u(i_z),i_B=i_s.callouts,i_C=i_t.showCallouts&&i_t.showCallouts.length&&i_u(i_B),
i_D=m.showData=m.showData||i_A||i_C;i_D&&i_w('extraInfo',i_z,i_A);m.web('displayData').display(i_D);m.web('callouts').display(i_C);if(i_C){i_B=i_B||[];var i_E=m.children,i_F=i_t.showCallouts||[],i_G=m.i_G,
i_H=m.web('callouts'),i_I={},i_J=0,i_K={built:false,html:m.i_L||i__,container:i_H[0],insertionMode:'inner bottom',cssClassStylePrefix:m.i_M};if(i_F.length){for(var i_N= -1;++i_N<i_F.length;)i_I[i_F[i_N]]=true
;for(var i_O= -1;++i_O<i_B.length;){var i_P='callout'+i_J,i_Q=i_E[i_P],i_R=i_B[i_O];if(i_I[i_R.filter]){if(i_Q)i_Q.set(i_R);else{i_Q=m.addChild(i_P,Zazzle.Callout,i_a.copyInto({},i_K,i_R));if(m.web(i_Q).length){
i_Q.set({built:true});i_Q.wireUi();}else i_Q.insertUi();}i_J++;}}}if(i_J<i_G){for(var i_S=i_J;i_S<i_G;i_S++){var i_T=i_E['callout'+i_S];if(i_T){i_T.removeUi();m.removeChild(i_T);}}}i_H.display(i_J);m.i_G=i_B.length;
}}},i_m:function(){this.isWired&&this.i_p&&i_a.forEach(this.i_p,function(i_o){i_o()});},i_c:i_c,updateUi:function(){var m=this;if(m.isWired&&m.canUpdate){m.i_r();i_$.doMy(m,'updateUi');m.i_q();}},wireUi:function(){
var m=this;if(!m.isWired&&m.prepareToWire()){var i_U=m.web('info');i_U.length?i_U.click(function(i_V){var i_s=m.get('valueDetails'),i_i=m.i_i;m.callInherited('useDialog')({component:{name:'Zazzle.MaxInfoPopupUi.Product'},
widgetProperties:{name:'productValueMoreInfo',mooringNode:i_U[0],displayName:i_i.showDisplayName==i_b?i_s.displayNameAlt||i_s.displayName:i_s.displayName,description:i_i.showDescription==i_b?i_s.descriptionAlt||i_s.description
:i_s.description,price:i_i.showImportantInfo&&i_s.importantInfo,thumbnailUrl:i_i.showThumbnail==i_b?i_s.thumbnailUrlAlt||i_s.thumbnailUrl:i_s.thumbnailUrl}});i_V.stopPropagation();}):m.i_c({moreInfoRestTime:m.i_j})
;m.i_G=0;var i_W=m.web('calloutTemplate').value();if(i_W)m.i_L=i_a.Template.compile(i_W,{openerToken:'|%',closerToken:'%|'});i_$.doMy(m,'wireUi');}}},stateProperties:{i_M:'cssClassCalloutStylePrefix',
i_j:{name:'moreInfoRestTime',onChange:i_c,value:800},i_i:{name:'moreInfoValueDisplayInfo',onChange:i_c}}});}});
Uize.module({name:'Zazzle.Widgets.Rooter.mAttributeValue',required:['Uize.Data.Compare','Zazzle.Models.Rooter.Attributes','Zazzle.Models.Rooter.Product','Zazzle.Widget.mV2','Zazzle.Widgets.Rooter.mModels'
],builder:function(){'use strict';var d_$=Uize,d__=Zazzle,d_a=d__.Models.Rooter.Product.ExperienceType,d_b=d_a.ProductDesign,d_c=d_$.Data.Compare.identical,d_d=function(d_e,d_f){return d_c(d_e,d_f)?d_f:d_e;
};return function(d_g){d_g.declare({mixins:[d__.Widget.mV2,d__.Widgets.Rooter.mModels],stateProperties:{allAttributes:{},allAttributeValuesLookup:{},attribute:{onChange:function(){this.attribute&&this.addModel('attribute',this.attribute)}
},attributeIsPrimary:{derived:'attributeName,attributesDependencies:attributesDependencies ? attributeName == attributesDependencies.name : false'},attributeName:{},attributesDependencies:{},attributeValue:{
onChange:function(){this.attributeValue&&this.addModel('attributeValue',this.attributeValue)},derived:'value,allAttributeValuesLookup:allAttributeValuesLookup && allAttributeValuesLookup[value]'},attributeValueDetails:{
conformer:d_d,derived:{properties:'attributeValue,experience,thumbnailSize,imageBackgroundColor,dataIncrement,urlIncrement',derivation:function(d_h,d_i,d_j,d_k){var m=this,d_l=m.getInherited('env');return d_h
&&d_l&&d_h.toValueDetails(d_l.staticRealview,d_j,{usePriceDifferential:true,useBlankThumbnailRealview:d_i==d_b,thumbnailBackgroundColor:d_k});}}},blankRealviewUrl:{derived:{properties:'attributeValue,thumbnailSize,imageBackgroundColor,urlIncrement',
derivation:function(d_h,d_j,d_k){var d_l=this.getInherited('env');return d_h&&d_l&&d_h.getBlankRealviewUrl(d_l.staticRealview,d_j,d_k);}}},callouts:{conformer:d_d},dataIncrement:{value:0},description:{
},displayPrice:{},displayPriceDifferential:{},experience:{value:d_a.None},iconUrl:{derived:{properties:'attributeValue,thumbnailSize,imageBackgroundColor,urlIncrement',derivation:function(d_h,d_j,d_k){
var d_l=this.getInherited('env');return d_h&&d_l&&d_h.getIconUrl(d_l.staticRealview,d_j,d_k);}}},imageBackgroundColor:{},inStock:{},d_m:{},d_n:{},priceDifferential:{},price:{},properties:{},realviewUrl:{
derived:{properties:'attributeValue,thumbnailSize,imageBackgroundColor,urlIncrement',derivation:function(d_h,d_j,d_k){var d_l=this.getInherited('env');return d_h&&d_l&&d_h.getRealviewUrl(d_l.staticRealview,
d_j,d_k);}}},section:{value:d__.Models.Rooter.Attributes.SectionType.Primary},shortDescription:{},shortTitle:{},title:{},d_o:{},totalDisplayPrice:{},urlIncrement:{value:0}},modelBindings:{allAttributes:'<-attributes.attributes',
allAttributeValuesLookup:'<-attribute.valuesLookup',attribute:{property:'attributeName',when:'allAttributes',valueAdapter:{aToB:function(d_p){return d_p&&d_p.get('name')},bToA:function(d_q,m){return m.allAttributes[d_q]||m.attribute}
}},attributesDependencies:'<-attributes.dependencies',attributeValue:{property:'attributeValueName',when:'allAttributeValues',valueAdapter:{aToB:function(d_h){return d_h&&d_h.get('name')},bToA:function(d_r,m){return m.allAttributeValues[d_r]||m.attributeValue}
}},attributeValueDetails:'->.valueDetails:attributeValueDetails',callouts:'<-attributeValue',description:'<-attributeValue',displayPrice:'<-attributeValue',displayPriceDifferential:'<-attributeValue',
inStock:'<-attributeValue',isBestValue:'<-attributeValue',isPopular:'<-attributeValue',price:'<-attributeValue',priceDifferential:'<-attributeValue',properties:'<-attributeValue',shortDescription:'<-attributeValue',
shortTitle:'<-attributeValue',title:'<-attributeValue',totalPrice:'<-attributeValue',totalDisplayPrice:'<-attributeValue'},modelEventBindings:{'attributeValue:Data Updated':function(){this.set('dataIncrement',this.dataIncrement+1)},
'attributeValue:Update URL':function(){this.set('urlIncrement',this.urlIncrement+1)}}});};}});
Uize.module({name:'Zazzle.Widgets.Rooter.AttributeValue',superclass:'Zazzle.SelectorValueDisplay.Product',required:'Zazzle.Widgets.Rooter.mAttributeValue',builder:function(j_$){'use strict';var j__=null,
j_a=Uize;return j_$.subclass({mixins:Zazzle.Widgets.Rooter.mAttributeValue});}});
Uize.module({name:'Zazzle.Widgets.Spp.AttributeValue',superclass:'Zazzle.Widgets.Rooter.AttributeValue',builder:function(k_$){'use strict';return k_$.subclass();}});
Uize.module({name:'Zazzle.OptionsSelector.Advanced',required:['Uize.Array.Sort','Uize.Data'],builder:function(g_$){'use strict';var g__=Uize;var g_a=g_$.subclass(null,function(){var m=this,g_b=Zazzle.Droplist
?m.addChild('sort',Zazzle.Droplist):null;g_b&&g_b.wire('Changed.value',function(){var g_c=g_b+'';setTimeout(function(){var g_d=g_c.split('_');m.set({values:g__.Array.Sort.sortBy(m.get('values'),'+value.valueDetails.attributes.'+(g_d[0]||'index'),
g_d[1]=='desc'? -1:1).concat()});},0);});}),g_e=g_a.prototype;g_e.g_f=function(g_g,g_h,g_i){var m=this,g_j={},g_k=g_i&&m.g_l?m.g_l:m.get('values');if(g_g){for(var g_m= -1;++g_m<g_g.length;){var g_n=g_g[g_m];
if(g_n){var g_o=g_n.split('=');if(g_o.length>1&&g_o[1])g_j[g_o[0]]=g_o[1];}}}function g_p(g_q,g_r){if(g__.isArray(g_q)&&g__.isArray(g_r)){for(var g_s= -1;++g_s<g_q.length;)for(var g_t= -1;++g_t<g_r.length;)
if(g_q[g_s]==g_r[g_t])return true;}return false;}for(var g_u= -1;++g_u<g_k.length;){var g_v=g_k[g_u].valueDetails.attributes,g_w= !!g_v||Uize.isEmpty(g_j);if(g_v)for(var g_x in g_j)if(!g_v[g_x]|| !g_p(
g_v[g_x].split(','),g_j[g_x].split(','))){g_w=false;break;}g_h(g_u,g_w);}};g_e.g_y=function(){var m=this;if(m.isWired){m.g_f(m.g_n,function(g_z,g_A){m.displayNode('option'+g_z,g_A)});m.updateUiOptionsSeen();
}};g_e.getFilterCount=function(g_g,g_i){var g_B=0;this.g_f(g_g,function(g_z,g_A){g_B+=g_A},g_i);return g_B;};g_e.updateUi=function(){var m=this;if(m.isWired){g_$.doMy(m,'updateUi');m.g_y();}};g_e.wireUi=function(){
var m=this;if(!m.isWired){var g_b=m.children.sort,g_C=function(){m.fire({name:'Data Changed',count:m.get('values').length,bubble:true})};m.displayNode('sortSearchPanel',g_b&&g_b.get('values').length>1
);m.wire('Changed.values',g_C);g_C();g_$.doMy(m,'wireUi');}};g_a.stateProperties({g_l:'allValues',g_n:{name:'filter',onChange:g_e.g_y},g_D:{name:'mode',onChange:function(){var m=this,g_D=m.g_D,g_b=m.children.sort
;g_D&&g_b&&g_b.set({value:g_D.sort});}}});return g_a;}});
Uize.module({name:'Zazzle.Widgets.Rooter.mAttributeInput',required:['Uize.Data.Compare','Zazzle.Models.Rooter.Product','Zazzle.Widget.mV2','Zazzle.Widgets.Rooter.mModels'],builder:function(){'use strict';
var d_$,d__=Uize,d_a=Zazzle,d_b=d_a.Models.Rooter.Product.ExperienceType,d_c=d_b.ProductDesign,d_d=d__.Data.Compare.identical,d_e=function(d_f,d_g){return d_d(d_f,d_g)?d_g:d_f;},d_h=function(m,d_i){var
 d_j=m.getInherited('env'),d_k;if(d_j){var d_l=d_j.imageRealview,d_m={usePriceDifferential:!m.attributeIsPrimary,useBlankThumbnailRealview:m.experience==d_c,thumbnailBackgroundColor:m.imageBackgroundColor
};d_k=d__.map(d_i,function(d_n){return{attributeValue:d_n,name:d_n.get('name'),valueDetails:d_n.toValueDetails(d_l,50,d_m)};});}return d_k||[];};return function(d_o){d_o.declare({mixins:[d_a.Widget.mV2,
d_a.Widgets.Rooter.mModels],stateProperties:{allAttributes:{},allAttributeValues:{conformer:d_e},allAttributeValuesLookup:{},attribute:{onChange:function(){this.attribute&&this.addModel('attribute',this.attribute)}
},attributeIsPrimary:{derived:'attributeName,attributesDependencies:attributesDependencies ? attributeName == attributesDependencies.name : false'},attributeName:{},attributesDependencies:{},attributeValue:{
derived:'value,allAttributeValuesLookup:allAttributeValuesLookup && allAttributeValuesLookup[value]'},attributeValues:{conformer:d_e},attributeValuesNames:{conformer:d_e},experience:{value:d_b.None},
imageBackgroundColor:{},section:{value:d_a.Models.Rooter.Attributes.SectionType.Primary}},modelBindings:{allAttributes:'<-attributes.attributes',allAttributeValues:['<-attribute.values',{property:'allValues',
direction:'->',when:'allAttributeValues',valueAdapter:{aToB:function(d_p,m){return d_e(d_h(m,d_p),m.get('allValues'));}}}],allAttributeValuesLookup:'<-attribute.valuesLookup',attribute:{property:'attributeName',
when:'allAttributes',valueAdapter:{aToB:function(d_q){return d_q&&d_q.get('name')},bToA:function(d_r,m){return m.allAttributes[d_r]||m.attribute}}},attributesDependencies:'<-attributes.dependencies',
attributeValues:[{property:'attributeValuesNames',when:'allAttributeValuesLookup',valueAdapter:{aToB:function(d_i){return d_i&&d__.map(d_i,function(d_n){return d_n.get('name')});},bToA:function(d_s,m){
var d_t=m.allAttributeValuesLookup,d_i=d__.map(d_s,function(d_u){return d_t[d_u]});return!d__.isEmpty(d_i)&&d__.isIn(d_i,d_$)?m.attributeValues:d_i;}}},{property:'values',direction:'->',when:'attributeValues',
valueAdapter:{aToB:function(d_i,m){return d_e(d_h(m,d_i),m.get('values'));}}}]}});};}});
Uize.module('Zazzle.Widgets.Rooter.AttributeInput');
Uize.module({name:'Zazzle.Widgets.Rooter.AttributeInput.mSelector',required:['Zazzle.Widget.mV2','Zazzle.Widgets.Rooter.mAttributeInput'],builder:function(){'use strict';var e_$=null,e__=Uize,e_a=Zazzle
;return function(e_b){e_b.declare({mixins:[e_a.Widget.mV2,e_a.Widgets.Rooter.mAttributeInput]});};}});
Uize.module({name:'Zazzle.Widgets.Rooter.AttributeInput.Selector',superclass:'Zazzle.OptionsSelector.Advanced',required:'Zazzle.Widgets.Rooter.AttributeInput.mSelector',builder:function(h_$){'use strict';
return h_$.subclass({mixins:Zazzle.Widgets.Rooter.AttributeInput.mSelector,eventBindings:{':Option Event':function(e){if(e.childEvent.name=='Changed.attributeValueDetails'){var m=this;clearTimeout(m.h__);
m.h__=setTimeout(function(){m.unmet('optionsUpdated');m.updateUi();},0);}}}});}});
Uize.module('Zazzle.Widgets.Spp.AttributeInput');
Uize.module({name:'Zazzle.Widgets.Spp.AttributeInput.Selector',superclass:'Zazzle.Widgets.Rooter.AttributeInput.Selector',builder:function(i_$){'use strict';return i_$.subclass();}});
Uize.module({name:'Zazzle.SelectionUi',superclass:'Zazzle.Widget.V2',required:'Uize.Util.PropertyAdapter',builder:function(f_$){'use strict';var f__=null;var f_a=f_$.subclass(f__,function(){var m=this,
f_b=Uize,f_c=f_b.Util,f_d=m.addChild('input',m.f_e,m.f_f),f_g=f_b.Widget.FilterGroups?m.addChild('filterGroups',f_b.Widget.FilterGroups,f_b.copyInto({},m.f_h?{values:m.f_h}:f__,m.f_i?{value:m.f_i}:f__
)):f__;function f_j(f_k){setTimeout(function(){m.set(f_k,f_d.get(f_k))},0)}f_d.wire({'Changed.value':function(){f_j('value')},'Changed.tentativeValue':function(){f_j('tentativeValue')}});function f_l(f_k){
new Uize.Util.PropertyAdapter({propertyA:{instance:f_d,property:f_k},propertyB:{instance:m,property:f_k}})}f_l('valueDetails');f_l('tentativeValueDetails');m.wire({'Changed.value':function(){f_d.set({value:m.f_m})},
'Changed.tentativeValue':function(){f_d.set({tentativeValue:m.f_n})},'Data Changed':function(){m.f_o()}});if(f_g){new f_c.PropertyAdapter({propertyA:{instance:f_g,property:'value'},propertyB:{instance:f_d,
property:'filter'}});f_g.wire('Changed.value',function(){m.f_p()});new f_c.PropertyAdapter({propertyA:{instance:f_g,property:'value'},propertyB:{instance:m,property:'filter'}});}}),f_q=f_a.prototype;
f_q.f_p=function(){var m=this;if(m.isWired){var f_r=m.children,f_d=f_r.input,f_g=f_r.filterGroups;if(f_g){var f_s=f_g.get('values'),f_t=f_g.valueOf(),f_u=[];for(var f_v= -1;++f_v<f_s.length;){f_u.push([]);
var f_w=f_s[f_v].values,f_x=f_u[f_v];for(var f_y= -1;++f_y<f_w.length;){var f_i=f_w[f_y].name,f_z=f_t.concat();f_z[f_v]=f_i;f_x.push(f_d.getFilterCount(f_z));}}f_g.updateCounts(f_u);m.f_o();}}};f_q.f_A=function(){
var m=this,f_B=m.f_C,f_r=m.children,f_d=f_r.input;if(m.isWired&&f_B&&f_d){for(var f_D= -1;++f_D<f_B.length;){var f_E=f_B[f_D],f_F=f_r['fullLink'+f_D];f_F&&f_F.set({count:m.f_G===undefined?f_d.getFilterCount(f_E.filters,true)
:m.f_G});}}};f_q.f_o=function(){var m=this,f_g=m.children.filterGroups;f_g&&m.web().css('minHeight',Math.max(m.web(m.children.input).height(),m.web(f_g).height(),m.web('fullLinks').height()));};f_q.updateUi=function(){
var m=this;if(m.isWired){m.children.input.updateUi();m.f_o();f_$.doMy(m,'updateUi');}};f_q.wireUi=function(){var m=this;if(!m.isWired){var f_b=Uize,f_B=m.f_C;if(f_B&&Zazzle.FullLink)f_b.forEach(f_B,function(f_E,f_D){
m.addChild('fullLink'+f_D,Zazzle.FullLink,f_b.clone(f_E)).wire('Click',function(f_H){var f_I=f_H.source;m.fire({name:'Launch Full Dialog',filter:f_I.get('filters'),label:f_I.get('label'),bubble:true});
})});m.web('helpLink').click(function(){m.fire({name:'Help Clicked',bubble:true});});f_$.doMy(m,'wireUi');m.f_p();}};f_a.stateProperties({f_J:'columnId',f_i:'filter',f_h:'filters',f_C:'fullLinks',f_G:{
name:'fullLinksCountOverride',onChange:function(){this.f_A();}},f_K:'includeMargin',f_e:'inputWidgetClass',f_f:{name:'inputWidgetProperties',onChange:function(){var m=this,f_d=m.children.input;f_d&&f_d.set(m.f_f)
;m.f_p();m.f_A();}},f_L:'isInline',f_n:{name:'tentativeValue',value:f__},f_M:'tentativeValueDetails',f_m:{name:'value',value:f__},f_N:'valueDetails'});f_a.cssBindings({columnId:'value+"Type"',isInline:['palette','inline'],
includeMargin:['','includeMargin']});return f_a;}});
Uize.module({name:'Zazzle.Widgets.Rooter.mAttributeSelection',required:['Zazzle.Widget.mV2','Zazzle.Widgets.Rooter.mModels'],builder:function(){'use strict';return function(d_$){d_$.declare({mixins:[Zazzle.Widget.mV2,
Zazzle.Widgets.Rooter.mModels],stateProperties:{allAttributes:{},attribute:{onChange:function(){this.attribute&&this.addModel('attribute',this.attribute)}},attributeName:{}},modelBindings:{allAttributes:'<-attributes.attributes',
attribute:{property:'attributeName',when:'allAttributes',valueAdapter:{aToB:function(d__){return d__&&d__.get('name')},bToA:function(d_a,m){return m.allAttributes[d_a]||m.attribute}}}}});};}});
Uize.module({name:'Zazzle.Widgets.Rooter.AttributeSelection',superclass:'Zazzle.SelectionUi',required:'Zazzle.Widgets.Rooter.mAttributeSelection',builder:function(g_$){'use strict';return g_$.subclass({
mixins:Zazzle.Widgets.Rooter.mAttributeSelection,eventBindings:{':Changed.attribute':function(){var m=this;m.set({fullLinksCountOverride:m.attribute.get('hasIncompleteValues')?m.attribute.get('totalValuesCount')
:undefined});}}});}});
Uize.module({name:'Zazzle.Widgets.Spp.AttributeSelection',superclass:'Zazzle.Widgets.Rooter.AttributeSelection',builder:function(h_$){'use strict';return h_$.subclass();}});
Uize.module({name:'Uize.Widget.InlinePicker',superclass:'Uize.Widget.FormElement',required:['Uize.Widget.Button.ValueDisplay','Uize.Util.Coupler'],builder:function(e_$){'use strict';return e_$.subclass({
omegastructor:function(){var m=this,e__=m.addChild('value',m.e_a,m.get((m.e_b||[]).concat('value'))),e_c=m.addChild('valueDisplay',m.e_d||Uize.Widget.Button.ValueDisplay,m.e_e);Uize.Util.Coupler({instances:[m,e__],
properties:['value','valueDetails','tentativeValue','tentativeValueDetails']});function e_f(e_g,e_h){e_c.set(e_g,m.get(e_h||e_g));}m.wire({'Changed.value':function(){e_f('value')},'Changed.valueDetails':function(){e_f('valueDetails')},
'Changed.tentativeValue':function(){m.e_i&&e_f('value','tentativeValue')},'Changed.tentativeValueDetails':function(){m.e_i&&e_f('valueDetails','tentativeValueDetails')}});e_f('value');e_f('valueDetails');
},instanceMethods:{updateUi:function(){var m=this;if(m.isWired){m.children.value.updateUi();e_$.doMy(m,'updateUi');}}},stateProperties:{e_b:{name:'pipedProperties',onChange:function(){var m=this,e_j=m.e_j,
e_b=m.e_b,e_k=m.children,e_l=function(e_g){return'Changed.'+e_g},e_m=function(e_g){var e__=e_k.value;e__&&e__.set(e_g,m.get(e_g));},e_n=function(e_o){var e_p=e_o.name;e_m(e_p.substr(e_p.indexOf('.')+1));
};Uize.forEach(e_j,function(e_q){m.unwire(e_l(e_q),e_n);});Uize.forEach(e_b,function(e_q){m.wire(e_l(e_q),e_n);e_m(e_q);});m.e_j=m.e_b;}},e_i:{name:'syncTentativeValue',value:true},e_r:'tentativeValueDetails',
e_s:{name:'valueDetails',onChange:function(){this.set({e_r:this.e_s})}},e_d:'valueDisplayWidgetClass',e_e:'valueDisplayWidgetProperties',e_t:'valueFormatter',e_a:'valueWidgetClass'}});}});
Uize.module({name:'Zazzle.Picker.Inline',superclass:'Uize.Widget.InlinePicker',required:'Zazzle.Widget.mV2',builder:function(f_$){'use strict';return f_$.subclass({mixins:Zazzle.Widget.mV2});}});
Uize.module({name:'Zazzle.Picker.Inline.FilteredInput',required:['Zazzle.SelectionUi','Zazzle.SelectorValueDisplay'],builder:function(g_$){'use strict';var g__=g_$.subclass(),g_a=g__.prototype;g_a.g_b=function(){
var m=this,g_c=m.children.value;m.isWired&&g_c&&g_c.displayNode('',m.g_d<m.g_e);};g_a.updateUi=function(){var m=this;if(m.isWired){var g_c=this.children.value;g_c&&g_c.updateUi();m.g_b();g_$.doMy(m,'updateUi');
}};g__.stateProperties({g_e:{name:'count',onChange:g_a.g_b,value:1},g_f:'filter',g_g:'filters',g_h:'fullLinks',g_d:{name:'hideValueWidgetWhen',onChange:g_a.g_b,value:-1},g_i:'inputWidgetClass',g_j:'inputWidgetProperties'
});g__.set({pipedProperties:['inputWidgetClass','inputWidgetProperties','filter','filters','fullLinks'],valueDisplayWidgetClass:Zazzle.SelectorValueDisplay,valueWidgetClass:Zazzle.SelectionUi});return g__;
}});
Uize.module({name:'Zazzle.Widgets.Rooter.mAttributePicker',required:['Zazzle.Models.Rooter.Product','Zazzle.Widget.mV2','Zazzle.Widgets.Rooter.mModels'],builder:function(){'use strict';return function(d_$){
d_$.declare({mixins:[Zazzle.Widget.mV2,Zazzle.Widgets.Rooter.mModels],stateProperties:{allAttributes:{},attribute:{onChange:function(){this.attribute&&this.addModel('attribute',this.attribute)}},attributeIsPrimary:{
derived:'attributeName,attributesDependencies:attributesDependencies ? attributeName == attributesDependencies.name : false'},attributeName:{},attributesDependencies:{},attributeValue:{derived:{properties:'value,attributeValuesLookup',
derivation:function(d__,d_a){return d_a&&d__ in d_a?d_a[d__]:this.attributeValue;}}},attributeValueDetails:{derived:{properties:'attributeValue,experience,attributeIsPrimary,imageBackgroundColor',derivation:function(d_b,d_c,d_d,d_e){
var d_f=this.getInherited('env');return d_b&&d_f&&d_b.toValueDetails(d_f.staticRealview,50,{usePriceDifferential:!d_d,useBlankThumbnailRealview:d_c==Zazzle.Models.Rooter.Product.ExperienceType.ProductDesign,
thumbnailBackgroundColor:d_e});}}},attributeValuesLookup:{},experience:{value:Zazzle.Models.Rooter.Product.ExperienceType.None},imageBackgroundColor:{}},modelBindings:{allAttributes:'<-attributes.attributes',
attribute:{property:'attributeName',when:'allAttributes',valueAdapter:{aToB:function(d_g){return d_g&&d_g.get('name')},bToA:function(d_h,m){return m.allAttributes[d_h]||m.attribute}}},attributesDependencies:'<-attributes.dependencies',
attributeValueDetails:'->.valueDetails:attributeValueDetails',attributeValuesLookup:'<-attribute.valuesLookup',count:'<-attribute.totalValues'}});};}});
Uize.module('Zazzle.Widgets.Rooter.AttributePicker');
Uize.module({name:'Zazzle.Widgets.Rooter.AttributePicker.Inline',superclass:'Zazzle.Picker.Inline.FilteredInput',required:'Zazzle.Widgets.Rooter.mAttributePicker',builder:function(h_$){'use strict';return h_$.subclass({
mixins:Zazzle.Widgets.Rooter.mAttributePicker});}});
Uize.module('Zazzle.Widgets.Spp.AttributePicker');
Uize.module({name:'Zazzle.Widgets.Spp.AttributePicker.Inline',superclass:'Zazzle.Widgets.Rooter.AttributePicker.Inline',required:['Zazzle.Widgets.Spp.AttributeSelection','Zazzle.Widgets.Spp.AttributeValue'
],builder:function(i_$){'use strict';return i_$.subclass({set:{valueDisplayWidgetClass:Zazzle.Widgets.Spp.AttributeValue,valueWidgetClass:Zazzle.Widgets.Spp.AttributeSelection}});}});
Uize.module({name:'Zazzle.Widgets.Rooter.mAttribute',required:['Uize.Url','Zazzle.Models.Rooter.Attributes','Zazzle.Models.Rooter.Product','Zazzle.Widget.mV2','Zazzle.Widgets.Rooter.mModels'],builder:function(){
'use strict';var d_$=false,d__=true,d_a=Uize,d_b=Zazzle;return function(d_c){d_c.declare({mixins:[d_b.Widget.mV2,d_b.Widgets.Rooter.mModels],stateProperties:{allAttributes:{},allAttributeValues:{},attribute:{
onChange:function(){this.attribute&&this.addModel('attribute',this.attribute)}},attributeName:{},attributeValue:{},attributeValues:{derived:{properties:'allAttributeValues,maxQuantity,attributeValue',
derivation:function(d_d,d_e,d_f){var d_g;if(d_d&&d_f){var d_h=d_d.length,d_i=d_e?d_e:d_h;d_g=d_d;if(d_i<d_h){var d_j=[],d_k=d_i,d_l=d_$,d_m=(function(){var d_n= -1;for(var d_o= -1;++d_o<d_h;){if(d_g[d_o]==d_f){
d_n=d_o;break;}}return d_n;})();if(d_m>=d_i&&d_k>0){d_j.push(d_f);d_k--;d_l=d__;}for(var d_o=0;d_o<d_k&&d_o<d_h;d_o++){if(d_m!=d_o|| !d_l)d_j.push(d_d[d_o]);}d_g=d_j;}}return d_g;}}},experience:{value:d_b.Models.Rooter.Product.ExperienceType.None
},fullDialogName:{},forceSelection:{value:d_$},helpDialogName:{},helpUrl:{},hiddenThreshold:{value:0},imageBackgroundColor:{},isActive:{},isInlineSelection:{value:d_$},isVisible:{derived:'visibilityOverride,hiddenThreshold,totalAllAttributeValues:visibilityOverride && totalAllAttributeValues > hiddenThreshold'
},label:{},maxQuantity:{},pickerUiClass:{},pickerUiProperties:{},pplVersion:{},section:{value:d_b.Models.Rooter.Attributes.SectionType.Primary},syncPickerValueChange:{value:d__},totalAllAttributeValues:{
},visibilityOverride:{value:d__}},children:{picker:function(){return d_a.copyInto({widgetClass:this.pickerUiClass},this.pickerUiProperties);}},modelBindings:{allAttributes:'<-attributes.attributes',allAttributeValues:'<-attribute.values',
attribute:{property:'attributeName',when:'allAttributes',valueAdapter:{aToB:function(d_p){return d_p&&d_p.get('name')},bToA:function(d_q,m){return m.allAttributes[d_q]||m.attribute}}},attributeValue:'<-attribute.value',
totalAllAttributeValues:'<-attribute.totalValues',value:'attribute.valueName:value,syncPickerValueChange'},childBindings:{focused:'picker',tentativeValue:'picker',totalAllAttributeValues:'->picker.count',
value:'picker',attributeValues:{child:'picker',property:'inputWidgetProperties',direction:'->',valueAdapter:{aToB:function(d_g){return{attributeValues:d_g};}}}},eventBindings:{'':{'Launch Full Dialog':function(e){
var m=this;m.callInherited('useDialog')({component:{name:m.fullDialogName,params:{att:m.attributeName,product:d_a.Url.toParams(m.models.product.serialize()),experience:m.experience,bg:m.imageBackgroundColor,
ver:m.pplVersion,section:m.section,returnAttributeData:m.models.attribute.get('hasIncompleteValues')}},widgetProperties:{name:'fullDialog',value:m.get('value'),parent:m,pickerUiProperties:{filter:e.filter
},title:e.label},'Before Show':function(e){var d_r=e.source,d_s=d_r.get('attributeData'),d_t=m.models.attribute;if(d_s){d_t.update(d_s);d_t.unmet('hasIncompleteValues');d_t.set('attributeData',undefined);
}},submitHandler:function(d_u,d_v){d_u&& !d_v.keepOpen&&m.set('value',d_u.value);}});},'Help Clicked':function(){var m=this;if(m.helpUrl){m.callInherited('launchPopup')({url:m.helpUrl,name:'helpPopup'
});}else{m.callInherited('useDialog')({component:{name:m.helpDialogName||'Zazzle.Dialog.ProductAttributeHelp.Description',params:{product:d_a.Url.toParams(m.models.product.serialize()),op:m.attributeName,
pd:m.models.product.get('productId'),po:Uize.Url.toParams(m.models.product.get('productOption')),pt:m.models.product.get('productTypeName')}},widgetProperties:{name:'helpDialog',parent:m}});}}}},instanceMethods:{
updateUi:function(){var m=this;if(m.isWired){m.children.picker.updateUi();d_c.superclass.doMy(m,'updateUi');}}}});};}});
Uize.module({name:'Zazzle.Widgets.Rooter.Attribute',superclass:'Uize.Widget.FormElement',required:'Zazzle.Widgets.Rooter.mAttribute',builder:function(e_$){'use strict';var e__=null,e_a=Uize;return e_$.subclass({
mixins:Zazzle.Widgets.Rooter.mAttribute,cssBindings:{experience:'value',isActive:['','active'],isInlineSelection:['palette','inline'],isVisible:['hidden','visible'],section:'value'}});}});
Uize.module({name:'Zazzle.Widgets.Spp.Attribute',superclass:'Zazzle.Widgets.Rooter.Attribute',builder:function(f_$){'use strict';return f_$.subclass({set:{fullDialogName:'Zazzle.Widgets.Spp.Dialog.Attribute'
},htmlBindings:{label:'label'},eventBindings:{'#helpLink:click':function(){this.fire('Help Clicked')}}});}});
Uize.module({name:'Zazzle.Widgets.Rooter.mAttributes',required:['Uize.Data.Compare','Zazzle.Models.Rooter.Product','Zazzle.Widget.mV2','Zazzle.Widgets.Rooter.mModels'],builder:function(){'use strict';var
 d_$=true,d__=null,d_a,d_b=Uize,d_c=Zazzle,d_d=d_b.map,d_e=d_b.Data.Compare.identical,d_f=function(d_g,d_h){return d_e(d_g,d_h)?d_h:d_g;},d_i=function(d_j){return{property:d_j,when:'allAttributes',valueAdapter:{
aToB:function(d_k){return d_k&&d_k.get('name')},bToA:function(d_l,m){return m.allAttributes[d_l]}}};};return function(d_m){d_m.declare({mixins:[d_c.Widget.mV2,d_c.Widgets.Rooter.mModels],stateProperties:{
activeAttribute:{},activeAttributeName:{},allAttributes:{},attributeGroups:{conformer:d_f},attributeGroupsNames:{conformer:d_f},childAttributeGroupWidgetNamePrefix:{value:'attributeGroup'},downsellAttributeValue:{
derived:{properties:'selectedUpsellAttributeValue,lowerDownsellAttributeValue',derivation:function(d_n,d_o){return d_o&&d_o!=d_n&&d_o.get('priceDifferential')?d_o:d_a;}},onChange:function(){this.downsellAttributeValue&&this.addModel('downsellAttributeValue',this.downsellAttributeValue)}
},downsellDisplayPriceDifferential:{},downsellTitle:{},experience:{value:d_c.Models.Rooter.Product.ExperienceType.None},hasUpsellInfo:{derived:'primaryUpsellType,validUpsellType: validUpsellType ? (primaryUpsellType == validUpsellType) : !!primaryUpsellType'
},higherUpsellAttributeValue:{},imageBackgroundColor:{},isVisible:{value:d_$},lowerDownsellAttributeValue:{},preferredView:{},preferredViewId:{derived:'preferredView:preferredView && preferredView.get("value")'
},primaryUpsellType:{derived:{properties:'downsellAttributeValue,upsellAttributeValue',derivation:function(d_p,d_q){var d_r=d__;if(d_p)d_r='downsell';else if(d_q)d_r='upsell';return d_r;}}},validUpsellType:{
},selectedUpsellAttributeValue:{},upsellAttribute:{onChange:function(){this.upsellAttribute&&this.addModel('upsellAttribute',this.upsellAttribute)}},upsellAttributeName:{},upsellAttributeValue:{derived:{
properties:'selectedUpsellAttributeValue,higherUpsellAttributeValue',derivation:function(d_n,d_s){return d_s&&d_s!=d_n&&d_s.get('priceDifferential')?d_s:d_a;}},onChange:function(){this.upsellAttributeValue&&this.addModel('upsellAttributeValue',this.upsellAttributeValue)}
},upsellAttributeValuesLookup:{},upsellDisplayPriceDifferential:{},upsellTitle:{}},modelBindings:{allAttributes:'<-attributes.attributes',attributeGroups:{property:'attributeGroupsNames',when:'allAttributes',
valueAdapter:{aToB:function(d_t){return d_d(d_t,function(d_u){return d_d(d_u,function(d_k){return d_k.get('name')});});},bToA:function(attributeGroupsNames,m){var d_v=m.allAttributes;return d_d(attributeGroupsNames,
function(d_w){return d_d(d_w,function(d_l){return d_v[d_l]});});}}},activeAttribute:d_i('activeAttributeName'),downsellDisplayPriceDifferential:'<-downsellAttributeValue.displayPriceDifferential',downsellTitle:'<-downsellAttributeValue.title',
lowerDownsellAttributeValue:'<-upsellAttribute.lowerDownsell',higherUpsellAttributeValue:'<-upsellAttribute.higherUpsell',selectedUpsellAttributeValue:'<-upsellAttribute.value',upsellAttribute:d_i('upsellAttributeName'),
upsellAttributeValuesLookup:'<-upsellAttribute.valuesLookup',upsellDisplayPriceDifferential:'<-upsellAttributeValue.displayPriceDifferential',upsellTitle:'<-upsellAttributeValue.title'},children:{applyDownsell:d__,
applyUpsell:d__},modelEventBindings:{'attributes:Dependencies Changed':function(){}},eventBindings:{'applyDownsell:Click':function(){var m=this;m.upsellAttribute.set('valueName',m.downsellAttributeValue.get('name'));
m.fire({name:'Track Event',bubble:true,extra:{ax:'upsellApplied',upsellType:'downsell'}});},'applyUpsell:Click':function(){var m=this;m.upsellAttribute.set('valueName',m.upsellAttributeValue.get('name'));
m.fire({name:'Track Event',bubble:true,extra:{ax:'upsellApplied',upsellType:'upsell'}});}}});};}});
Uize.module({name:'Zazzle.Widgets.Rooter.Attributes',superclass:'Zazzle.Widget.V2',required:'Zazzle.Widgets.Rooter.mAttributes',builder:function(f_$){'use strict';var f__=null,f_a=Uize;return f_$.subclass({
mixins:Zazzle.Widgets.Rooter.mAttributes,cssBindings:{experience:'value',hasUpsellInfo:['noUpsell','hasUpsell'],isVisible:['','visible'],primaryUpsellType:'value'}});}});
Uize.module({name:'Zazzle.Widgets.Spp.Attributes',superclass:'Zazzle.Widgets.Rooter.Attributes',required:'Uize.Widget.Button',builder:function(g_$){'use strict';var g__=Uize.Widget.Button;return g_$.subclass({
children:{applyDownsell:g__,applyUpsell:g__},htmlBindings:{downsellDisplayPriceDifferential:'downsellMessagePriceDiff',downsellTitle:'downsellMessageTitle',upsellDisplayPriceDifferential:'upsellMessagePriceDiff',
upsellTitle:'upsellMessageTitle'}});}});
Uize.module({name:'Zazzle.Widgets.EditorsPick',superclass:'Zazzle.Widget.V2',required:['Uize.Widget.Button'],builder:function(f_$){'use strict';var f__=Uize;return f_$.subclass({stateProperties:{f_a:'shouldWireTooltip'
},omegastructor:function(){var m=this;m.once('wired',function(){if(m.f_a){m.callInherited('wireTooltip')(m.getNode(),false,15000);}});},children:{},childBindings:{},cssBindings:{},htmlBindings:{},eventBindings:{
'#:click':function(){var m=this;if(m.getInherited('env').isMobile){m.callInherited('useDialog')({component:{name:'Zazzle.Widgets.Spp.Dialog.EditorsPick'},widgetProperties:{name:'editorsPickDialog'}});
}}}});}});
Uize.module({name:'Zazzle.Widgets.Spp.VizliteSplash',superclass:'Zazzle.Widget.V2',builder:function(f_$){'use strict';var f__=false,f_a=true;return f_$.subclass({stateProperties:{f_b:{name:'removeSplash',
value:f__},f_c:{name:'osVer'},f_d:{name:'osType'},f_e:{name:'pageType'},f_f:{name:'pageParam'},f_g:{name:'marketURL'}},cssBindings:{removeSplash:['','removeSplash']},eventBindings:{'#continue:click':function(){
var m=this;m.met('removeSplash');},'#close:click':function(){var m=this;m.met('removeSplash');},'#openApp:click':function(){var m=this;m.f_h(m);}},instanceMethods:{f_h:function(m){if(m.f_d===0){m.f_i(m);
}else if(m.f_d===1){m.f_j(m);}},f_k:function(m){var f_l="";f_l+="&source_type=web_interstitial";f_l+="&source_type_id=dynamic_options_v1";f_l+="&source_page="+m.f_e;f_l+="&source_url="+document.URL;if(m.f_d===1){
f_l+="&utm_source=zazzle_site";f_l+="&utm_content="+"viz_lite_splash";f_l+="&utm_term="+m.f_e;}return f_l;},f_m:function(m){var f_n="";switch(m.f_e){case"Product":f_n="product?product_id="+m.f_f;break;
case"Default":f_n="page?stub=0";break;default:f_n="page?stub=0";}return f_n+m.f_k(m);},f_o:function(m){if(m.f_d===0){return"iOS";}else if(m.f_d===1){return"Android";}},f_i:function(m){var timer;var heartbeat;
var lastInterval;function clearTimers(){clearTimeout(timer);clearTimeout(heartbeat);}window.addEventListener("pageshow",function(){clearTimers();},false);window.addEventListener("pagehide",function(){
clearTimers();},false);function getTime(){return(new Date()).getTime();}function intervalHeartbeat(){var now=getTime();var diff=now-lastInterval-200;lastInterval=now;if(diff>1000){clearTimers();}}function launchAppOrAltUrl(m){
var timeToOpen;lastInterval=getTime();heartbeat=setInterval(intervalHeartbeat,200);m.fire({name:'Track Event',bubble:f_a,extra:{ax:'webhookInstalled',sourceType:'web_banner',sourceTypeId:m.f_p,sourceTypePosition:m.f_q,
sourcePage:m.f_e,sourceURL:document.URL,sourceOS:m.f_o(m),sourceRouteDestination:m.f_m(m),isControl:m.f_r,isPhone:m.f_s,isTablet:m.f_t,isBlueClosed:m.f_u}});document.location="zazzle://"+m.f_m(m);if(parseInt(m.f_c)>=8){
timeToOpen=800;}else{timeToOpen=30;}timer=setTimeout(function(){m.fire({name:'Track Event',bubble:f_a,extra:{ax:'webhookNotInstalled',sourceType:'web_banner',sourceTypeId:m.f_p,sourceTypePosition:m.f_q,
sourcePage:m.f_e,sourceURL:document.URL,sourceOS:m.f_o(m),sourceRouteDestination:m.f_m(m),isControl:m.f_r,isPhone:m.f_s,isTablet:m.f_t,isBlueClosed:m.f_u}});document.location=m.f_g;},timeToOpen);}launchAppOrAltUrl(m);
event.preventDefault();},f_j:function(m){var custom="zazzle://"+m.f_m(m)+"#Intent;scheme=zazzle;package=com.zazzle;end";var alt=m.f_g;var gIntent="intent://"+m.f_m(m)+"#Intent;scheme=zazzle;package=com.zazzle;end";
var timer;var heartbeat;var iframeTimer;function clearTimers(){clearTimeout(timer);clearTimeout(heartbeat);clearTimeout(iframeTimer);}function intervalHeartbeat(){if(document.webkitHidden||document.hidden){
clearTimers();}}function track(){m.fire({name:'Track Event',bubble:f_a,extra:{ax:'webhookAndroid',sourceType:'web_banner',sourceTypeId:m.f_p,sourceTypePosition:m.f_q,sourcePage:m.f_e,sourceURL:document.URL,
sourceOS:m.f_o(m),sourceRouteDestination:m.f_m(m),isControl:m.f_r,isPhone:m.f_s,isTablet:m.f_t,isBlueClosed:m.f_u}});}function tryIframeApproach(){var iframe=document.createElement("iframe");iframe.style.border="none";
iframe.style.width="1px";iframe.style.height="1px";iframe.onload=function(){track();document.location=alt;};iframe.src=custom;document.body.appendChild(iframe);}function tryWebkitApproach(){document.location=custom;
timer=setTimeout(function(){track();document.location=alt;},2500);}function useIntent(){track();document.location=gIntent;}function launchAppOrAltUrl(){heartbeat=setInterval(intervalHeartbeat,200);if(navigator.userAgent.match(/Chrome/)){
useIntent();}else if(navigator.userAgent.match(/Firefox/)){tryWebkitApproach();iframeTimer=setTimeout(function(){tryIframeApproach();},1500);}else{tryIframeApproach();}}launchAppOrAltUrl(m);event.preventDefault();
}}});}});
Uize.module({name:'Zazzle.Widgets.Spp.VizliteOpenApp',superclass:'Zazzle.Widget.V2',builder:function(f_$){'use strict';var f__=Uize,f_a=false,f_b=true;return f_$.subclass({stateProperties:{f_c:'marketURL',
f_d:'osType',f_e:'osVer',f_f:'pageParam',f_g:'pageType'},children:{},childBindings:{},instanceMethods:{f_h:function(m){if(m.f_d===0){m.f_i(m);}else if(m.f_d===1){m.f_j(m);}},f_k:function(m){var f_l="";
f_l+="&source_type=web_action_button";f_l+="&source_type_id=product_action_v1";f_l+="&source_page="+m.f_g;f_l+="&source_url="+document.URL;if(m.f_d===1){f_l+="&utm_source=zazzle_site";f_l+="&utm_content="+"viz_lite_splash";
f_l+="&utm_term="+m.f_g;}return f_l;},f_m:function(m){var f_n="";switch(m.f_g){case"Product":f_n="product?product_id="+m.f_f;break;case"Default":f_n="page?stub=0";break;default:f_n="page?stub=0";}return f_n+m.f_k(m);
},f_o:function(m){if(m.f_d===0){return"iOS";}else if(m.f_d===1){return"Android";}},f_i:function(m){var timer;var heartbeat;var lastInterval;function clearTimers(){clearTimeout(timer);clearTimeout(heartbeat);
}window.addEventListener("pageshow",function(){clearTimers();},false);window.addEventListener("pagehide",function(){clearTimers();},false);function getTime(){return(new Date()).getTime();}function intervalHeartbeat(){
var now=getTime();var diff=now-lastInterval-200;lastInterval=now;if(diff>1000){clearTimers();}}function launchAppOrAltUrl(m){var timeToOpen;lastInterval=getTime();heartbeat=setInterval(intervalHeartbeat,200);
m.fire({name:'Track Event',bubble:f_b,extra:{ax:'webhookInstalled',sourceType:'web_banner',sourceTypeId:m.f_p,sourceTypePosition:m.f_q,sourcePage:m.f_g,sourceURL:document.URL,sourceOS:m.f_o(m),sourceRouteDestination:m.f_m(m),
isControl:m.f_r,isPhone:m.f_s,isTablet:m.f_t,isBlueClosed:m.f_u}});document.location="zazzle://"+m.f_m(m);if(parseInt(m.f_e)>=8){timeToOpen=800;}else{timeToOpen=30;}timer=setTimeout(function(){m.fire({
name:'Track Event',bubble:f_b,extra:{ax:'webhookNotInstalled',sourceType:'web_banner',sourceTypeId:m.f_p,sourceTypePosition:m.f_q,sourcePage:m.f_g,sourceURL:document.URL,sourceOS:m.f_o(m),sourceRouteDestination:m.f_m(m),
isControl:m.f_r,isPhone:m.f_s,isTablet:m.f_t,isBlueClosed:m.f_u}});document.location=m.f_c;},timeToOpen);}launchAppOrAltUrl(m);event.preventDefault();},f_j:function(m){var custom="zazzle://"+m.f_m(m)+"#Intent;scheme=zazzle;package=com.zazzle;end";
var alt=m.f_c;var gIntent="intent://"+m.f_m(m)+"#Intent;scheme=zazzle;package=com.zazzle;end";var timer;var heartbeat;var iframeTimer;function clearTimers(){clearTimeout(timer);clearTimeout(heartbeat);
clearTimeout(iframeTimer);}function intervalHeartbeat(){if(document.webkitHidden||document.hidden){clearTimers();}}function track(){m.fire({name:'Track Event',bubble:f_b,extra:{ax:'webhookAndroid',sourceType:'web_banner',
sourceTypeId:m.f_p,sourceTypePosition:m.f_q,sourcePage:m.f_g,sourceURL:document.URL,sourceOS:m.f_o(m),sourceRouteDestination:m.f_m(m),isControl:m.f_r,isPhone:m.f_s,isTablet:m.f_t,isBlueClosed:m.f_u}});
}function tryIframeApproach(){var iframe=document.createElement("iframe");iframe.style.border="none";iframe.style.width="1px";iframe.style.height="1px";iframe.onload=function(){track();document.location=alt;
};iframe.src=custom;document.body.appendChild(iframe);}function tryWebkitApproach(){document.location=custom;timer=setTimeout(function(){track();document.location=alt;},2500);}function useIntent(){track();
document.location=gIntent;}function launchAppOrAltUrl(){heartbeat=setInterval(intervalHeartbeat,200);if(navigator.userAgent.match(/Chrome/)){useIntent();}else if(navigator.userAgent.match(/Firefox/)){
tryWebkitApproach();iframeTimer=setTimeout(function(){tryIframeApproach();},1500);}else{tryIframeApproach();}}launchAppOrAltUrl(m);event.preventDefault();}},htmlBindings:{},eventBindings:{'#openApp:click':function(){
var m=this;m.f_h(m);}}});}});
Uize.module({name:'Zazzle.Widgets.Rooter.mProductModel',required:'Zazzle.Widgets.Rooter.mModels',builder:function(){'use strict';var d_$,d__=Uize;return function(d_a){d_a.declare({mixins:Zazzle.Widgets.Rooter.mModels,
stateProperties:{productModelData:{}},eventBindings:{':Changed.productModelData':function(){var m=this,d_b=m.productModelData;if(d_b){d__.require(d_b.modelClass,function(d_c){var d_d=m.getInherited('env'),
d_e=d_c.create(d_b,{serviceUrlBase:d_d.service,csrfToken:d_d.csrfToken});m.addModel('product',d_e);m.d_b=d_$;});}}}});};}});
Uize.module({name:'Zazzle.Widgets.Rooter.mProduct',required:['Zazzle.Models.Rooter.Design','Zazzle.Models.Rooter.DesignObject','Zazzle.Models.Rooter.Product','Zazzle.Widget.mV2','Zazzle.Widgets.Rooter.mProductModel'
],builder:function(){'use strict';var d_$=true,d__=false,d_a=null,d_b,d_c=Uize,d_d=Zazzle,d_e=d_d.Models.Rooter,d_f=d_e.Design.ConstraintLevel,d_g=d_e.DesignObject.Type,d_h=d_e.Product.ExperienceType,
d_i='post',d_j='purchase';return function(d_k){d_k.declare({mixins:[d_d.Widget.mV2,d_d.Widgets.Rooter.mProductModel],staticProperties:{FinishActions:{Post:d_i,Purchase:d_j}},stateProperties:{activeAttribute:{
},activeDesignArea:{},allowOos:{},canPostForSale:{},canSave:{derived:'isSaving: !isSaving'},contextualBrokenConstraints:{derived:{properties:'filteredBrokenConstraints',derivation:function(d_l){var d_m=[],
d_n={};d_c.forEach(d_l,function(d_o){var d_p=d_o.type;if(!(d_p in d_n)){d_n[d_p]=d_$;d_m.push(d_o);}});return d_m;}}},defaultImageId:{},defaultText:{},experience:{value:d_h.None},filteredBrokenConstraints:{
},finishOnSubmit:{value:d_$},hasAreaGroups:{},hasContextualBrokenConstraints:{derived:'contextualBrokenConstraints: !Uize.isEmpty(contextualBrokenConstraints)'},hasFilteredBrokenConstraints:{},hasVisibleTemplateFields:{
},imageBackgroundColor:{},inStock:{},isCustomizable:{value:d_$},isCustomizing:{derived:'isCustomizable,experience:isCustomizable && experience == Zazzle.Models.Rooter.Product.ExperienceType.ProductDesign'
},isPreorder:{},isTemplate:{},isSaving:{},needValidPurchaseAttributesWhenPosting:{value:d__},pplVersion:{},preferredView:{},preferredViewId:{derived:'preferredView:preferredView && preferredView.get("value")'
},preferredViewsOnly:{},productizeOnSubmit:{value:d_$},singleContextOnly:{},submitEnabled:{derived:'inStock,allowOos:inStock || allowOos'},title:{},treatConstraintLevelNoPostAsNoPurchase:{value:d__}},
children:{areaGroups:d_a,attributes:d_a,price:d_a,purchaseAttributeGroup:d_a,quantity:d_a,submit:d_a,template:d_a,title:d_a,views:d_a},modelBindings:{canPostForSale:'<-design',experience:{child:'design',
property:'isCustomizing',valueAdapter:{aToB:function(d_q){return d_q==d_h.ProductDesign},bToA:function(d_r){return d_r?d_h.ProductDesign:d_h.None;}}},filteredBrokenConstraints:'<-design',hasAreaGroups:'<-design',
hasFilteredBrokenConstraints:'<-design',inStock:'<-attributes',isCustomizing:'->design.enableAutoSave',isPreorder:'<-attributes',isSaving:'<-design',isTemplate:'<-product',preferredViewId:'product',title:'product'
},modelEventBindings:{design:{'Design Save Failed':function(){this.fire('Save Action Complete');},'Design Saved':function(){this.fire('Save Action Complete');}}},childBindings:{activeAttribute:['attributes','views'],
activeDesignArea:['areaGroups','views'],experience:'->attributes',hasVisibleTemplateFields:'<-template',imageBackgroundColor:['attributes','views','purchaseAttributeGroup'],submitEnabled:{child:'submit',
property:'enabled',direction:'->',valueAdapter:{aToB:function(d_s){return d_s?'inherit':d__}}},preferredView:['->attributes','views'],preferredViewsOnly:'views',singleContextOnly:'views'},alphastructor:function(){
var m=this;m.beforeFinishChecks=[function(d_t){var d_u=d_$,d_v=m.children.purchaseAttributeGroup;if(d_v&&d_t==d_j||(d_t==d_i&&m.needValidPurchaseAttributesWhenPosting)){d_v.forEachChildAttribute(function(d_w){
if(!d_w.get('isValid')){d_w.set('warningShown',d_$);d_u=d__;}});}return d_u;},function(d_t){var d_m=m.contextualBrokenConstraints,d_u=d_$;for(var d_x= -1;++d_x<d_m.length;){var d_y=d_m[d_x].level;if((d_t==d_j&&(d_y==d_f.PreventPurchase||(m.treatConstraintLevelNoPostAsNoPurchase&&d_y==d_f.PreventPost)))
||(d_t==d_i&&(d_y==d_f.PreventPost))){d_u=d__;break;}}return d_u;}];m.whenever('wired,activeDesignArea',function(){var d_z=m.defaultImageId,d_A=m.defaultText,d_B=[];d_z&&d_B.push({type:d_g.Image,value:d_z
});d_A&&d_B.push({type:d_g.Text,value:d_A});m.activeDesignArea.addDesignObjects(d_B);});},eventBindings:{'':{'Post For Sale Requested':function(){var m=this;m.beforeFinishAction(d_i,function(d_C){if(d_C){
m.callInherited('ensureLoggedIn')({callback:function(){m.models.design.save(function(){m.fire('Ready to Post For Sale')});}});}});},'Save Requested':function(){var m=this;m.callInherited('ensureLoggedIn')({
callback:function(){m.models.design.save();}});},'Submit Requested':function(){var m=this;if(m.inStock||m.allowOos){m.beforeFinishAction(d_j,function(d_C){if(d_C){var d_D=m.models,d_E=d_D.product,d_F=d_D.design,
d_G=function(d_H){m.fire({name:'Ready to Submit',data:d_H||d_E.getData()});};if(!m.isCustomizing&&d_E.get('isTemplate')&& !d_c.isEmpty(d_F.get('templateParams'))&&m.productizeOnSubmit)d_F.productize(
{preferredViewId:d_E.get('preferredViewId'),priceMarkup:d_E.get('priceMarkup'),title:m.title},d_G);else if(m.isCustomizing)d_F.save(function(){m.finishOnSubmit?d_F.finish(d__,function(){d_G()}):d_G()
;});else d_G();}});}}},'submit:Click':function(){this.fire('Submit Requested')}},instanceMethods:{beforeFinishAction:function(d_t,d_I){var m=this,d_J=m.beforeFinishChecks,d_K=d_J.length,d_L= -1,d_M=function(d_u){d_c.isFunction(d_I)&&d_I(d_u)},
d_N=function(){if(++d_L<d_K){var d_O=function(d_u){d_u?d_N():d_M(d__);},d_P=d_J[d_L].call(m,d_t,d_O);if(d_P!==d_b)d_O(d_P);}else d_M(d_$);};d_N();},getProductQueryParams:function(){return this.models.product.getQueryParams();
},registerBeforeFinishCheck:function(d_Q){var d_J=this.beforeFinishChecks,d_R=d_c.isArray(d_Q)?d_Q:[d_Q];;d_c.forEach(d_R,function(d_S){d_c.isFunction(d_S)&&d_J.push(d_S)});}}});};}});
Uize.module({name:'Zazzle.Widgets.Rooter.Product',superclass:'Zazzle.Widget.V2',required:'Zazzle.Widgets.Rooter.mProduct',builder:function(f_$){'use strict';return f_$.subclass({mixins:Zazzle.Widgets.Rooter.mProduct,
stateProperties:{f__:'hasUserTitle'},children:{title:null},childBindings:{hasUserTitle:'title'},cssBindings:{allowOos:['','allowOos'],canPostForSale:['cannotPost','canPost'],experience:'value',hasAreaGroups:['','hasAreaGroups'],
hasVisibleTemplateFields:['noTemplateFields','hasVisibleTemplateFields'],inStock:['oos','inStock'],isCustomizable:['','isCustomizable'],isCustomizing:['notCustomizing','isCustomizing']},instanceMethods:{
updateUi:function(){Uize.callOn(this.children,'updateUi');f_$.doMy(this,'updateUi');}}});}});
Uize.module({name:'Zazzle.Widgets.Spp.Product',superclass:'Zazzle.Widgets.Rooter.Product',required:['Uize.Dom.Event','Uize.Url','Uize.Widget.Button','Uize.Widget.Fleeting','Zazzle.FormWarnings','Zazzle.DepartmentBreadcrumb',
'Zazzle.Models.Rooter.Product','Zazzle.Widgets.EditorsPick','Zazzle.Widgets.Spp.AreaGroups','Zazzle.Widgets.Spp.AttributeGroup','Zazzle.Widgets.Spp.Attributes','Zazzle.Widgets.Spp.AttributesInfo','Zazzle.Widgets.Spp.Price',
'Zazzle.Widgets.Spp.ProductTitle','Zazzle.Widgets.Spp.QuantitySelector','Zazzle.Widgets.Spp.Views','Zazzle.Widgets.Spp.VizliteSplash','Zazzle.Widgets.Spp.VizliteOpenApp','Zazzle.Widgets.Rooter.mDoublecheck'
],builder:function(g_$){'use strict';var g__=true,g_a=false,g_b=null,g_c=Uize,g_d=Zazzle,g_e=g_d.Widgets,g_f=g_e.Spp,g_g=g_d.Widget.V2.subclass({stateProperties:{focused:{},isValid:{value:g_a},warningMessage:{},
warningShown:{value:g__}}}),g_h=g_d.Models.Rooter.Product.ExperienceType.ProductDesign;return g_$.subclass({mixins:[Zazzle.Widgets.Rooter.mDoublecheck],stateProperties:{g_i:{derived:{properties:'contextualBrokenConstraints',
derivation:function(g_j){var m=this;return g_c.map(g_j,function(g_k){var g_l=g_k.type;return new g_g({idPrefix:m.childId(g_l),warningMessage:m.localize('constraint_'+g_l)});});}}},g_m:'departmentId',
g_n:'enableShippingEstimate',g_o:'newAttributesUiNeeded',g_p:'newPurchaseAttributeGroup',g_q:'newPurchaseAttributeGroupUiNeeded',g_r:'numCrumbsToShow',g_s:'prop65Message',g_t:'safetyWarning',g_u:'showDepartmentBreadcrumbs',
g_v:'showValueMessaging',g_w:'technicalSpecs',g_x:'warrantyMessage'},children:{areaGroups:g_f.AreaGroups,attributes:g_f.Attributes,attributesInfo:g_f.AttributesInfo,customize:g_c.Widget.Button,editorsPick:g_d.Widgets.EditorsPick,
formWarnings:g_d.FormWarnings,postForSale:Uize.Widget.Button,price:g_f.Price,purchaseAttributeGroup:g_f.AttributeGroup,quantity:g_f.QuantitySelector,shippingEstimate:null,submit:g_c.Widget.Button,template:g_b,
departmentBreadcrumbs:g_b,title:g_f.ProductTitle,valueMessaging:g_b,views:g_b,vizliteSplash:g_f.VizliteSplash,vizliteOpenApp:g_f.VizliteOpenApp,save:g_c.Widget.Button,help:g_c.Widget.Button,fleetingSave:{
widgetClass:Uize.Widget.Fleeting,lifeSpan:3000}},modelBindings:{prop65Message:'<-attributes',safetyWarning:'<-attributes',technicalSpecs:'<-attributes',warrantyMessage:'<-attributes',departmentId:'<-attributes'
},childBindings:{g_i:'->formWarnings.watchedElements',enableShippingEstimate:{child:'shippingEstimate',property:'enabled',direction:'->',valueAdapter:{aToB:function(g_y){return g_y?'inherit':g_a;}}},
hasContextualBrokenConstraints:'->formWarnings.shown',imageBackgroundColor:'->attributesInfo'},cssBindings:{isCustomizing:['notCustomizing','isCustomizing'],isTemplate:['notTemplate','isTemplate']},htmlBindings:{
prop65Message:'prop65Shell:?',safetyWarning:['safetyWarning:?','safetyWarningMessage:html'],technicalSpecs:['techSpecs:?','techSpecsMessage:html'],warrantyMessage:['warranty:?','warrantyMessage:html'
]},alphastructor:function(){var m=this;m.registerBeforeFinishCheck([function(g_z,g_A){var g_B={};function g_C(g_D,g_E){if(g_D in g_B){if(Uize.global().localStorage&&localStorage.debug){throw new Error("Trying to add multiple finish checks with the same name "+g_D);
}return;}g_B[g_D]=g_E;}m.fire({name:'RegisterBeforeFinish',finishAction:g_z,waitFor:g_C});var g_F=[];Uize.forEach(g_B,function(g_E){g_F.push(g_E);});g_G();function g_G(){var g_E=g_F.splice(0,1)[0];if(!g_E){
g_A(true);return;}var g_H=false;g_E(function g_I(g_J){if(g_H){if(Uize.global().localStorage&&localStorage.debug){throw new Error("Finish action continue function was called multiple times, your handler is bust, only call _done once!");
}return;}g_H=true;if(!g_J){g_A(false);}else{g_G();}});}},function(g_z,g_A){if(g_z!=m.Class.FinishActions.Purchase|| !g_c.findRecord(m.get('contextualBrokenConstraints'),{type:'resolution'}))g_A(g__);
else{m.confirm({message:m.localize('constraint_resolution'),callback:g_A});}}]);m.whenever('wired,!inStock',function(){m.setNodeInnerHtml('oosOverlay',m.localize('oosWarning'));});},eventBindings:{'':{
'Changed.departmentId':function(){var m=this;if(!g_c.isNully(m.get('departmentId'))&&m.get('showDepartmentBreadcrumbs')){m.callInherited('loadHtmlIntoNode')({node:m.getNode('departmentBreadcrumb'),injectMode:'inner replace'
},{cp:'Zazzle.DepartmentBreadcrumb',dp:m.get('departmentId'),idPrefix:m.childId('departmentBreadcrumbs'),urlBase:'pd/find',linkCurrent:g__,trackClicks:g__,maxCrumbsToShow:m.get('numCrumbsToShow')},{beforeInject:function(g_K){
var g_L=m.children.departmentBreadcrumbs;if(g_L){m.removeChild(g_L);}g_K();}});}},'Changed.experience':function(){var m=this,g_M=m.get('experience'),g_N=m.children;if(g_M==g_h){var g_o=m.g_o,g_q=m.g_q,
g_p=m.g_p,g_O=g_c.Url.toParams(m.models.product.serialize()),g_P=m.get('activeAttribute'),g_Q=g_P&&g_P.get('name'),g_R=m.get('activeDesignArea'),g_S=g_R&&g_R.get('name'),g_T=m.get('imageBackgroundColor'),
g_U=m.get('pplVersion'),g_V=g_o+(g_q&& !!g_p),g_W=function(g_X){m.callInherited('displayLoadingOverlay')(g_X,{parent:m});},g_Y=function(){g_V--;if(g_V==0){g_W(g_a);m.set('busy','inherit');}};g_V&&g_W();
if(g_o){m.met('busy');m.callInherited('loadHtmlIntoNode')({node:m.getNode('attributesShell'),injectMode:'inner replace'},{cp:'Zazzle.Widgets.Spp.Attributes',idPrefix:m.childId('attributes'),experience:g_M,
product:g_O,activeAttribute:g_Q,activeDesignArea:g_S,bg:g_T,ver:g_U},{cache:'memory',beforeInject:function(g_A){var g_Z=g_N.attributes;g_Z.removeUi();m.removeChild(g_Z);g_Z.kill();g_A();},callback:g_Y
});}if(g_q&&g_p){m.met('busy');m.callInherited('loadHtmlIntoNode')({node:m.getNode('purchaseAttributeGroupShell'),injectMode:'inner replace'},{cp:'Zazzle.Widgets.Spp.AttributeGroup',idPrefix:m.childId('purchaseAttributeGroup'),
experience:g_M,section:'Purchase',product:g_O,attributeGroup:g_p.join(','),activeAttribute:g_Q,bg:g_T,ver:g_U},{cache:'memory',beforeInject:function(g_A){var g_0=g_N.purchaseAttributeGroup;g_0.removeUi();
m.removeChild(g_0);g_0.kill();g_A();},callback:g_Y});}}},'Save Action Complete':function(){this.children.fleetingSave.show();}},'customize:Click':function(){var m=this;m.set('experience',g_h);m.fire({
name:'Track Event',bubble:true,extra:{ax:'spp',a:'a'}});m.enteringCustomizeModeByUser();},'#customize:click':function(){var m=this;m.set('experience',g_h);m.fire({name:'Track Event',bubble:true,extra:{
ax:'spp',a:'a'}});m.enteringCustomizeModeByUser();},'#defaultForm:submit':function(e){g_c.Dom.Event.preventDefault(e)},'help:Click':function(){this.callInherited('launchPopup')({url:this.get('urls').help})},
'postForSale:Click':function(){this.fire('Post For Sale Requested')},'#prop65Link:click':function(){this.inform({message:this.g_s})},'save:Click':function(){this.fire('Save Requested')}},instanceMethods:{
enteringCustomizeModeByUser:function(){}}});}});
Uize.module({name:'Zazzle.Widgets.Spp.Product.Desktop',required:['Uize.Widget.Fleeting','Zazzle.Widgets.Spp.Views'],builder:function(h_$){'use strict';var m=this;return h_$.subclass({stateProperties:{h__:'defaultToArtViewOnCustomize',
h_a:'isNarrow',h_b:'showZoomPreview',h_c:'wasNarrow',h_d:'zoomPreviewAspect',h_e:'zoomPreviewIsHighRes',h_f:'zoomPreviewLeft',h_g:'zoomPreviewOffsetTop',h_h:'zoomPreviewTop',h_i:{name:'zoomPreviewUrl',
value:''}},children:{views:Zazzle.Widgets.Spp.Views,modifyMessage:{widgetClass:Uize.Widget.Fleeting,lifeSpan:9999999}},cssBindings:{isNarrow:['','isNarrow'],showZoomPreview:['','showZoomPreview'],zoomPreviewIsHighRes:['','zoomPreviewIsHighRes']
},eventBindings:{':Zoom Preview Moved':function(e){this.set({h_f: -e.bounds.left*2048,h_h: -e.bounds.top*2048});},':Zoom Preview Toggled':function(e){var m=this,h_j=m.web('right');if(!m.h_a){m.set({h_b:e.shouldShow,
h_d:h_j.width()/e.currentViewSize,h_e:false,h_g:e.source.web().coords().top-h_j.coords().top,h_i:e.currentImageUrl});var h_k=new Image();h_k.onload=function(){m.set({h_e:true,h_i:h_k.src});};h_k.src=e.getImageUrl(2048);
e.source.set({zoomPreviewAspect:m.h_d,zoomPreviewWidthPercentage:h_j.width()/2048*100});}},':Changed.isCustomizing':function(){var m=this;if(m.get('isCustomizing'))m.children.modifyMessage&&m.children.modifyMessage.unmet('shown');
},'customize:Over':function(){var m=this;m.children.modifyMessage.met('shown');},'customize:Out':function(){var m=this;m.children.modifyMessage.unmet('shown');}},childBindings:{isNarrow:{property:'wasNarrow',
direction:'->',when:'isNarrow'}},htmlBindings:{isNarrow:function(h_a){var m=this;if(m.isWired){var h_l=m.web(m.children.views),h_m=m.web(m.children.formWarnings),h_n=m.web('purchasePod'),h_o=m.web(m.children.areaGroups),
h_p=m.web('templateShell'),h_q=m.web('attributesShell');if(h_a){h_n.insertAfter(h_l);h_m.insertAfter(h_n);h_p.insertAfter(h_m);h_q.insertAfter(h_p);}else if(!h_a&&m.h_c){h_m.prependTo(m.web('right'));
h_n.insertAfter(h_m);h_o.insertAfter(h_n);h_p.insertAfter(h_o);h_q.insertAfter(h_p);m.unmet('wasNarrow');}}},zoomPreviewAspect:function(h_d){this.web('zoomPreviewViewport').css('padding-bottom',100/h_d+'%');
},zoomPreviewLeft:'zoomPreviewImageCrop:style.left',zoomPreviewOffsetTop:'zoomPreview:style.padding-top',zoomPreviewTop:'zoomPreviewImageCrop:style.top',zoomPreviewUrl:'zoomPreviewImage:src'},instanceMethods:{
enteringCustomizeModeByUser:function(){var m=this;if(m.h__)m.children.views.children.view.switchToArtViewAndNotify();}}});}});
Uize.module({name:'Zazzle.Models.Rooter.Attributes.Live',required:['Uize.Data.Compare','Uize.Url'],builder:function(e_$){'use strict';var e__=null,e_a,e_b=Uize,e_c=e_b.Url,e_d=e_b.keys({e_e:1})[0],e_f='getAttributesInfo',
e_g=e_b.Data.Compare.identical,e_h=function(e_i,e_j){return e_g(e_i,e_j)?e_j:e_i;},e_k=function(e_l){return e_l?e_c.toParams(e_l):e__};return e_$.subclass({stateProperties:e_b.copyInto({e_m:{name:'accessoryId',
onChange:e_f},e_n:{name:'designId',onChange:e_f},e_o:{name:'optionFilterId',onChange:e_f},e_e:{conformer:e_h,onChange:function(){var m=this,e_p=m.e_e;m.set({e_m:e_p.accessoryId,e_n:e_p.designId,e_o:e_p.optionFilterId,
e_q:e_p.parentProductId,e_r:e_p.parentProductOption,e_s:e_p.productId,e_t:e_p.productOption,e_u:e_p.productTypeName});}},e_q:{name:'parentProductId',onChange:e_f},e_r:{name:'parentProductOption',conformer:e_h,
onChange:e_f},e_s:{name:'productId',onChange:e_f},e_t:{name:'productOption',conformer:e_h,onChange:e_f},e_u:{name:'productTypeName',onChange:e_f}},e_b.map({e_v:'cyoTitle',e_w:'hasDesignTips',e_x:'properties'
},function(e_y){e_y=e_b.isPlainObject(e_y)?e_y:{name:e_y};e_y.derived=e_d+':'+e_d+'["'+(e_y.e_z||e_y.name)+'"]';delete e_y.e_z;return e_y;})),set:{attributesInfoUrlEndPoint:'rooter/attributes/get'},instanceMethods:{
getAttributesInfoServiceParams:function(){var m=this,e_A;if(m.e_u||m.e_s||m.e_n)e_A=e_b.copyInto(e_$.doMy(m,'getAttributesInfoServiceParams'),{accd:m.e_m,dz:m.e_n,of:m.e_o,pd:m.e_s,po:e_k(m.e_t),ppd:m.e_q,
ppo:e_k(m.e_r),pt:m.e_u});return e_A;},processInfoData:function(e_B){e_$.doMy(this,'processInfoData',[e_B]);this.set({e_e:e_B});},reset:function(e_C){var m=this;e_$.doMy(m,'reset',[e_b.copyInto({accessoryId:e_a,
designId:e_a,optionFilterId:e_a,productId:e_a,productOption:e_a,productTypeName:e_a},e_C)]);},setAttributeValue:function(e_D,e_E){var m=this,e_t=m.e_t;if(!e_t||e_t[e_D]!=e_E)m.validate(e_b.pairUp(e_D,e_E),
function(e_F,e_G){var e_H=function(){m.set({e_t:e_F});};if(e_b.keys(e_G).length>1){var e_I=m.fire({name:'Dependencies Changed',changedAttributes:e_G,validProductOption:e_F,confirmChanges:function(e_J){
if(e_J)e_H();else m.get('attributes')[e_D].set({valueName:e_t[e_D]});}}).handled;!e_I&&e_H();}else{e_H();m.get('attributes')[e_D].set({valueName:e_F[e_D]});}});},validate:function(e_K,e_L){var m=this;
m.ajax('rooter/attributes/validate',{accd:m.e_m,dz:m.e_n,of:m.e_o,pd:m.e_s,po:e_k(m.e_t),poOverride:e_b.Url.toParams(e_K),ppd:m.e_q,ppo:e_k(m.e_r),pt:m.e_u},{cache:'memory',callbackSuccess:function(e_M){
var e_p=e_M.data;e_L(e_p.productOption,e_p.changedAttributes);},callbackFail:function(){}});}}});}});
Uize.module({name:'Zazzle.Models.Rooter.Realviews',superclass:'Zazzle.Model',required:['Uize.Data.Compare','Zazzle.Models.Rooter.Realview','Zazzle.Models.Rooter.RealviewAnnotation'],builder:function(d_$){
'use strict';var d__=true,d_a=false,d_b=null,d_c,d_d=Uize,d_e=Zazzle,d_f=d_e.Models.Rooter,d_g=d_f.Realview,d_h=d_d.keys({d_i:1})[0],d_j=d_g.Type.Design,d_k=d_g.Type.Print,d_l=d_g.Type.Product,d_m=d_f.RealviewAnnotation.Type.Attribute,
d_n=d_d.Data.Compare.identical,d_o=function(d_p,d_q){return d_n(d_p,d_q)?d_q:d_p;};return d_$.subclass({stateProperties:d_d.copyInto({d_i:{conformer:d_o},d_r:{name:'designRealviews',conformer:d_o,derived:{
properties:'realviews',derivation:function(d_s){var d_r=[];for(var d_t= -1;++d_t<d_s.length;){var d_u=d_s[d_t];d_u.get('type')==d_j&&d_r.push(d_u);}return d_r;}}},d_v:{name:'printRealviews',conformer:d_o,
derived:{properties:'realviews',derivation:function(d_s){var d_v=[];for(var d_t= -1;++d_t<d_s.length;){var d_u=d_s[d_t];d_u.get('type')==d_k&&d_v.push(d_u);}return d_v;}}},d_w:{name:'productRealviews',
conformer:d_o,derived:{properties:'realviews',derivation:function(d_s){var d_w=[];for(var d_t= -1;++d_t<d_s.length;){var d_u=d_s[d_t];d_u.get('type')==d_l&&d_w.push(d_u);}return d_w;}}},d_s:{name:'realviews',
conformer:d_o,derived:{properties:d_h,derivation:function(d_i){var m=this,d_x=d_i.realviews,d_y=d_x.length,d_z=d_d.copy(m.d_A),d_s=[];for(var d_t= -1;++d_t<d_y;){var d_B=d_x[d_t],d_C=d_B.id;if(d_C in d_z){
var d_D=d_z[d_C];d_D.update(d_B);d_s.push(d_D);delete d_z[d_C];}else{d_s.push(d_g.create(d_B));}}for(var d_E in d_z)d_z[d_E].kill();return d_s;}}},d_F:'realviewsInfoUrlEndPoint',d_A:{name:'realviewsLookup',
conformer:d_o,derived:{properties:'realviews',derivation:function(d_s){var d_A={},d_y=d_s?d_s.length:0,d_t= -1;for(;++d_t<d_y;){var d_u=d_s[d_t];d_A[d_u.get('value')]=d_u;}return d_A;}}},d_G:{name:'templateParams',
conformer:d_o},d_H:{name:'templateParamsSync',derived:'realviews, templateParams: Math.random()',onChange:function(){var m=this,d_s=m.d_s,d_G=m.d_G;if(d_s)for(var d_t= -1;++d_t<d_s.length;)d_s[d_t].set('templateParams',d_G)
;}}},d_d.map({d_I:{name:'isVizLite',onChange:function(){}},d_J:'watermarkDesignRealviews',d_K:'watermarkProductRealviews'},function(d_L){d_L=d_d.isPlainObject(d_L)?d_L:{name:d_L};d_L.derived=d_h+':'+d_h+'["'+(d_L.d_M||d_L.name)+'"]';
delete d_L.d_M;return d_L;})),instanceMethods:{getRealviewsInfo:function(){var m=this,d_N=m.getRealviewsInfoServiceParams();!m.d_O&& !d_d.isEmpty(d_N)&&m.ajax(m.d_F,d_N,{requestOverrides:{cache:'memory'
},callbackSuccess:function(d_P){var d_O=m.d_O;m.d_O=d__;m.processInfoData(m.normalizeInfoServiceResponse(d_P.data));m.d_O=d_O;},callbackFail:function(){}});},getRealviewsInfoServiceParams:function(){
return{};},normalizeInfoServiceResponse:function(d_Q){return d_Q;},processInfoData:function(d_R){this.set({d_i:d_R});},defeatImageUrlCache:function(){d_d.callOn(this.d_s,'defeatImageUrlCache');},filter:function(d_s,d_S,d_T,d_U){
var m=this;d_U=m.getBestMatchingRealview(d_U||(!d_d.isEmpty(d_s)?d_s[0]:d_b),d_s=d_s||m.d_w);if(d_S){var d_V=[];for(var d_W= -1;++d_W<d_s.length;){var d_u=d_s[d_W];if(d_u.get('canBePreferred'))d_V.push(d_u);
}if(d_d.isEmpty(d_V))d_V=d_s;d_s=d_V;}var d_X=[];d_d.forEach(d_s,function(d_u){if(!d_T||d_u.get('type')!=d_l|| !d_U||d_U.get('contextId')=='0'||d_u.get('contextId')=='0'||d_u.get('contextId')==d_U.get('contextId')
)d_X.push(d_u);});return d_s;},getBestDesignViewForAttribute:function(d_Y,d_s){return this.getBestViewForAttribute(d_Y,d_s,d_j);},getBestDesignViewForDesignArea:function(d_Z,d_s){return this.getBestViewForDesignArea(d_Z,d_s,d_j);
},getBestMatchingRealview:function(d_0,d_s){var m=this,d_1=d_a,d_2=d_a,d_3=d_a,d_4;d_s=d_s||m.d_w;for(var d_W= -1;++d_W<d_s.length;){var d_u=d_s[d_W];if(d_0){if(d_u.get('value')==d_0.get('value')){d_4=d_u;
break;}else if(d_u.get('title')==d_0.get('title')){if(!d_1&&d_u.get('contextId')==d_0.get('contextId')){d_4=d_u;d_1=d__;}else if(!d_2&& !d_1){d_4=d_u;d_2=d__;}}else if(!d_3&& !d_2&& !d_1&&d_u.contextId==d_0.contextId){
d_4=d_u;d_3=d__;}}if(!d_4)d_4=d_u;}return d_4;},getBestPrintViewForAttribute:function(d_Y,d_s){return this.getBestViewForAttribute(d_Y,d_s,d_k);},getBestPrintViewForDesignArea:function(d_Z,d_s){return this.getBestViewForDesignArea(d_Z,d_s,d_k);
},getBestProductViewForAttribute:function(d_Y,d_s){return this.getBestViewForAttribute(d_Y,d_s,d_l);},getBestProductViewForDesignArea:function(d_Z,d_s){return this.getBestViewForDesignArea(d_Z,d_s,d_l);
},getBestViewForAttribute:function(d_Y,d_s,d_5){d_s=d_s||this.d_s;var d_y=d_s.length,d_6,d_7,d_8;for(var d_W= -1;++d_W<d_y;){var d_u=d_s[d_W];if(!d_5||d_u.get('type')==d_5){var d_9=d_u.get('annotations'),
d_$_=d_9&&d_9.length,d___=d_a;for(var d_a_= -1;++d_a_<d_$_;){var d_b_=d_9[d_a_];if(d_b_.get('type')==d_m&&d_d.isIn(d_b_.get('attributeNames'),d_Y)){d_$_=d__;break;}}if(d___){d_6=d_u;break;}else if(!d_7)
d_7=d_u;}if(!d_8)d_8=d_u;}return d_6||d_7||d_8;},getBestViewForDesignArea:function(d_Z,d_s,d_5){var d_c_;if(d_s=(d_s||this.d_s)){var d_y=d_s.length,d_d_,d_6,d_7,d_8;for(var d_W= -1;++d_W<d_y;){var d_u=d_s[d_W];
if(!d_5||d_u.get('type')==d_5){var d_e_=d_u.get('primaryVisibleDesignAreaNamesLookup'),d_f_=d_u.get('visibleDesignAreaNamesLookup');if(d_e_&&d_Z in d_e_){d_d_=d_u;break;}else if(!d_6&&d_f_&&d_Z in d_f_)
d_6=d_u;else if(!d_7)d_7=d_u;}if(!d_8)d_8=d_u;}d_c_=d_d_||d_6||d_7||d_8;}return d_c_;},getDesignViewsForDesignArea:function(d_Z,d_s){return this.getViewsForDesignArea(d_Z,d_s,d_j);},getPrintViewsForDesignArea:function(d_Z,d_s){
return this.getViewsForDesignArea(d_Z,d_s,d_k);},getProductViewsForDesignArea:function(d_Z,d_s){return this.getViewsForDesignArea(d_Z,d_s,d_l);},getViewsForDesignArea:function(d_Z,d_s,d_5){d_s=d_s||this.d_s;
if(d_5){var d_X=[];Uize.forEach(d_s,function(d_u){if(d_u.get('type')===d_5){d_X.push(d_u);}});d_s=d_X;}var d_g_=[];Uize.forEach(d_s,function(d_u){if(d_Z in d_u.get('visibleDesignAreaNamesLookup')){d_g_.push(d_u.get('value'));
}});return d_g_;},initialize:function(d_i){var m=this,d_O=m.d_O;m.d_O=d__;!d_d.isEmpty(d_i)&&m.processInfoData(d_i);m.d_O=d_O;},reset:function(d_h_){this.set(d_d.copyInto({},d_h_));}}});}});
Uize.module({name:'Zazzle.Models.Rooter.Realviews.Live',required:['Uize.Data.Compare','Uize.Url'],builder:function(e_$){'use strict';var e__=true,e_a=false,e_b=null,e_c,e_d=Uize,e_e=e_d.Url,e_f=Zazzle,
e_g=e_d.keys({e_h:1})[0],e_i='getRealviewsInfo',e_j=e_d.Data.Compare.identical,e_k=function(e_l,e_m){return e_j(e_l,e_m)?e_m:e_l;},e_n=function(e_o){return e_o?e_e.toParams(e_o):e_b};return e_$.subclass({
stateProperties:{e_p:{name:'designId',onChange:e_i},e_h:{conformer:e_k,onChange:function(){var m=this,e_q=m.e_h;m.set({e_p:e_q.designId,e_r:e_q.parentProductId,e_s:e_q.parentProductOption,e_t:e_q.productId,
e_u:e_q.productOption,e_v:e_q.productTypeName});}},e_r:{name:'parentProductId',onChange:e_i},e_s:{name:'parentProductOption',conformer:e_k,onChange:e_i},e_t:{name:'productId',onChange:e_i},e_u:{name:'productOption',
conformer:e_k,onChange:e_i},e_v:{name:'productTypeName',onChange:e_i}},set:{realviewsInfoUrlEndPoint:'rooter/realviews/get'},instanceMethods:{getRealviewsInfoServiceParams:function(){var m=this,e_w;if(m.e_v||m.e_t||m.e_p)
e_w=e_d.copyInto(e_$.doMy(m,'getRealviewsInfoServiceParams'),{dz:m.e_p,pd:m.e_t,po:e_n(m.e_u),ppd:m.e_r,ppo:e_n(m.e_s),pt:m.e_v});return e_w;},processInfoData:function(e_x){e_$.doMy(this,'processInfoData',[e_x]);
this.set({e_h:e_x});},reset:function(e_y){var m=this;e_$.doMy(m,'reset',[e_d.copyInto({designId:e_c,productId:e_c,productOption:e_c,productTypeName:e_c},e_y)]);}}});}});
Uize.module({name:'Zazzle.Models.Rooter.Pricing',superclass:'Zazzle.Model',required:'Uize.Data.Compare',builder:function(d_$){'use strict';var d__=true,d_a=false,d_b=null,d_c,d_d=Uize,d_e=d_d.keys({d_f:1})[0],
d_g='getPricingInfo',d_h=d_d.Data.Compare.identical,d_i=function(d_j,d_k){return d_h(d_j,d_k)?d_k:d_j;};return d_$.subclass({stateProperties:d_d.copyInto({d_f:{conformer:d_i,onChange:function(){var m=this,
d_f=m.d_f;m.set({d_l:d_f.priceMarkup});}},d_m:'pricingInfoUrlEndPoint',d_l:{name:'priceMarkup',conformer:function(d_n){return d_d.constrain(d_n,0,1)},onChange:d_g,value:0.05},d_o:{name:'quantity',onChange:d_g,
value:1},d_p:{name:'validVolumeDiscountTiers',derived:{properties:'volumeDiscountTiers',derivation:function(d_q){var d_r=[];d_d.forEach(d_q,function(d_s){if(d_s.hasDiscount)d_r.push(d_s);});return d_r;
}}}},d_d.map({d_t:'discountedTotalDisplayPrice',d_u:'discountedTotalPrice',d_v:'discountedUnitDisplayPrice',d_w:'discountedUnitPrice',d_x:'mostDiscountedUnitDisplayPrice',d_y:'mostDiscountedUnitPrice',
d_z:'totalDisplayPrice',d_A:'totalPrice',d_B:'unitDisplayPrice',d_C:'unitPrice',d_q:'volumeDiscountTiers'},function(d_D){d_D=d_d.isPlainObject(d_D)?d_D:{name:d_D};d_D.derived=d_e+':'+d_e+'["'+(d_D.d_E||d_D.name)+'"]';
delete d_D.d_E;return d_D;})),instanceMethods:{getPricingInfo:function(d_F){var m=this,d_G=m.getPricingInfoServiceParams();!m.d_H&& !d_d.isEmpty(d_G)&&m.ajax(m.d_m,d_G,{requestOverrides:{cache:d_F===d__?'never':'memory'
},callbackSuccess:function(d_I){var d_H=m.d_H;m.d_H=d__;m.processInfoData(m.normalizeInfoServiceResponse(d_I.data));m.d_H=d_H;},callbackFail:function(){}});},getPricingInfoServiceParams:function(){var m=this;
return{mu:m.d_l,qty:m.d_o};},normalizeInfoServiceResponse:function(d_J){return d_J;},processInfoData:function(d_K){this.set({d_f:d_K});},forcePricingUpdate:function(){this.getPricingInfo(d__);},initialize:function(d_f){
var m=this,d_H=m.d_H;m.d_H=d__;!d_d.isEmpty(d_f)&&m.processInfoData(d_f);m.d_H=d_H;},reset:function(d_L){this.set(d_d.copyInto({},d_L));}}});}});
Uize.module({name:'Zazzle.Models.Rooter.Pricing.Live',required:['Uize.Data.Compare','Uize.Url'],builder:function(e_$){'use strict';var e__=true,e_a=false,e_b=null,e_c,e_d=Uize,e_e=e_d.Url,e_f=Zazzle,e_g=e_d.keys({e_h:1})[0],
e_i='getPricingInfo',e_j=e_d.Data.Compare.identical,e_k=function(e_l,e_m){return e_j(e_l,e_m)?e_m:e_l;},e_n=function(e_o){return e_o?e_e.toParams(e_o):e_b};return e_$.subclass({stateProperties:e_d.copyInto(
{e_h:{conformer:e_k,onChange:function(){var m=this,e_p=m.e_h;m.set({e_q:e_p.productId,e_r:e_p.productOption,e_s:e_p.productTypeName});}},e_q:{name:'productId',onChange:e_i},e_r:{name:'productOption',
conformer:e_k,onChange:e_i},e_s:{name:'productTypeName',onChange:e_i}},e_d.map({},function(e_t){e_t=e_d.isPlainObject(e_t)?e_t:{name:e_t};e_t.derived=e_g+':'+e_g+'["'+(e_t.e_u||e_t.name)+'"]';delete e_t.e_u;
return e_t;})),set:{pricingInfoUrlEndPoint:'rooter/pricing/get'},instanceMethods:{getPricingInfoServiceParams:function(){var m=this,e_v;if(m.e_s||m.e_q)e_v=e_d.copyInto(e_$.doMy(m,'getPricingInfoServiceParams'),
{pd:m.e_q,po:e_n(m.e_r),pt:m.e_s});return e_v;},processInfoData:function(e_w){e_$.doMy(this,'processInfoData',[e_w]);this.set({e_h:e_w});},reset:function(e_x){var m=this;e_$.doMy(m,'reset',[e_d.copyInto(
{productId:e_c,productOption:e_c,productTypeName:e_c},e_x)]);}}});}});
Uize.module({name:'Zazzle.Models.Rooter.Product.Live',required:['Uize.Data.Compare','Uize.Url','Zazzle.Models.Rooter.Attributes.Live','Zazzle.Models.Rooter.Design','Zazzle.Models.Rooter.Realviews.Live',
'Zazzle.Models.Rooter.Pricing.Live'],builder:function(e_$){'use strict';var e__=null,e_a,e_b=Uize,e_c=Zazzle,e_d=e_c.Models.Rooter,e_e=e_b.keys({e_f:1})[0],e_g='updateProductInfo',e_h=e_b.Data.Compare.identical,
e_i=function(e_j,e_k){return e_h(e_j,e_k)?e_k:e_j;};return e_$.subclass({models:{design:e_d.Design,pricing:e_d.Pricing.Live,attributes:e_d.Attributes.Live,realviews:e_d.Realviews.Live},stateProperties:e_b.copyInto(
{e_l:'accessoryId',e_m:'designId',e_f:{conformer:e_i,onChange:function(){var m=this,e_n=m.e_f;m.set({e_l:e_n.accessoryId,e_m:e_n.designId,e_o:e_n.optionFilterId,e_p:e_n.parentProductId,e_q:e_n.parentProductOption,
e_r:e_n.productId,e_s:e_n.productOption,e_t:e_n.productTypeName});}},e_p:'parentProductId',e_q:{name:'parentProductOption',conformer:e_i},e_u:{name:'productAttributes',derived:'productOption,preferredViewId:Uize.copy(productOption, {view:preferredViewId})'
},e_r:{name:'productId',onChange:e_g},e_s:{name:'productOption',conformer:e_i},e_t:{name:'productTypeName',onChange:e_g},e_o:'optionFilterId'},e_b.map({e_v:'isSmartTemplate',e_w:{name:'originalProductAttributes',
conformer:e_i},e_x:'rootProductId',e_y:'royaltyFix',e_z:'royaltyFlex'},function(e_A){e_A=e_b.isPlainObject(e_A)?e_A:{name:e_A};e_A.derived=e_e+':'+e_e+'["'+(e_A.e_B||e_A.name)+'"]';delete e_A.e_B;return e_A;
})),set:{productInfoUrlEndPoint:'rooter/product/get'},modelBindings:{accessoryId:'->attributes',designId:['->attributes:productTypeName,designId,productOption','design:productTypeName,productOption',
'->realviews:productTypeName,designId,productOption'],optionFilterId:'->attributes',parentProductId:['->attributes','->realviews'],parentProductOption:['->attributes','->realviews'],productId:['->attributes:productTypeName,productId,designId,productOption',
'design:productTypeName,productId,designId,productOption','->pricing:productTypeName,productId,productOption','->realviews:productTypeName,productId,designId,productOption'],productOption:['attributes:productTypeName,designId,productOption',
'design:productTypeName,productOption','->pricing:productTypeName,productOption','->realviews:productTypeName,designId,productOption'],productTypeName:['->attributes:productTypeName,designId,productOption',
'design:productTypeName,productOption','->pricing:productTypeName,productOption','->realviews:productTypeName,designId,productOption']},instanceMethods:{getProductInfoServiceParams:function(){var m=this,
e_C;if(m.e_r!==e__&&(m.e_t||m.e_r))e_C=e_b.copyInto(e_$.doMy(m,'getProductInfoServiceParams'),{pt:m.e_t,pd:m.e_r});return e_C;},getQueryParams:function(){var m=this,e_D=m.models.design,e_w=m.e_w,e_u=m.e_u,
e_E={};for(var e_F in e_w){var e_G=e_u[e_F];if(e_G!=e_w[e_F])e_E[e_F]=e_G;}return e_b.copyInto(e_$.doMy(m,'getQueryParams'),e_D.get('isCustomizing')?{dz:m.e_m}:e__,e_E,e_D.get('templateParams'));},processInfoData:function(e_H){
e_$.doMy(this,'processInfoData',[e_H]);this.set({e_f:e_H});},reset:function(e_I){var m=this;e_$.doMy(m,'reset',[e_b.copyInto({accessoryId:e_a,designId:e_a,optionFilterId:e_a,productId:e_a,productOption:e_a,
productTypeName:e_a},e_I)]);},serialize:function(){var m=this;return e_b.copyInto(e_$.doMy(m,'serialize'),{source:'Live',parentProductOption:m.e_q&&e_b.Url.toParams(m.e_q),productOption:m.e_s&&e_b.Url.toParams(m.e_s)
},m.get(['accessoryId','designId','optionFilterId','parentProductId','productId','productTypeName']));}}});}});
Uize.module({name:'Zazzle.Widgets.Spp.Product.Desktop.Marketplace',builder:function(i_$){'use strict';return i_$.subclass();}});
Uize.module({name:'Uize.Widget.CollectionItem.Zooming',required:['Uize.Dom.Basics','Uize.Dom.Pos','Uize.Dom.VirtualEvents.Remain','Uize.Fade'],builder:function(e_$){'use strict';var e__=true,e_a=false,
e_b=Uize.Dom.Basics,e_c=Uize.Dom.Pos;function e_d(e_e,e_f){var e_g='border'+Uize.capFirstChar(e_f);return(e_b.getStyle(e_e,e_g+'Style')=='none'?0: +e_b.getStyle(e_e,e_g+'Width').replace(/px/i,'')||0);
}function e_h(m){var e_i=m.e_i;return Uize.isFunction(e_i)?e_i.call(m):e_i;}function e_j(){this.set({e_k:this.e_l&&this.e_m>1&& !!this.e_i});}function e_n(){this.set({e_o:this.e_l&&this.e_p});}function e_q(){
var m=this;m.set({e_r:(m.get('over')||m.e_l)&&m.e_m>1&& !!m.e_i});};function e_s(){this.set({e_t:this.e_l&& !this.e_p});}function e_u(){var m=this,e_v=m.isWired?m.getNode('previewZoom'):e_a;m.set({e_p:
e_v&&e_v.Uize_Widget_CollectionItem_Zooming_src==e_h(m)});}function e_w(m,e_x,e_y){if(m.isWired){var e_z=e_x=='previewZoom';if(e_y){var e_A=m.getNode('preview');m.e_B=e_c.getCoords(m.getNode('previewShell')||(e_A?e_A.parentNode:null)
);var e_C=m.e_C=e_c.getDimensions(e_A);e_C.width-=e_d(e_A,'left')+e_d(e_A,'right');e_C.height-=e_d(e_A,'top')+e_d(e_A,'bottom');var e_D=e_A.parentNode;e_b.setStyle(e_D,{overflow:'hidden',height:e_D.offsetHeight-
e_d(e_D,'top')-e_d(e_D,'bottom')});if(!m.getNode(e_x)){m.flushNodeCache(e_x);var e_v=e_A.cloneNode(e__);e_b.setProperties(e_v,{id:m.get('idPrefix')+'-'+e_x,title:''});e_b.setStyle(e_v,{left:0,top:0,border:'none',
width:e_C.width,height:e_C.height,position:'absolute',backgroundImage:''});e_A.parentNode.appendChild(e_v);(e_z?e_E:e_F).call(m);e_x=='previewZoom'&&m.wireNode(e_x,'load',function(){e_u.call(m)});}}m.displayNode(e_x,e_y);
if(e_y){var e_G=e_z?e_h(m):m.e_H,e_e=m.getNode(e_x);e_G!=e_e.Uize_Widget_CollectionItem_Zooming_src&&e_G!=e_e.src&&m.setNodeProperties(e_e,{src:e_G,Uize_Widget_CollectionItem_Zooming_src:e_G});}}}function e_I(m){
m.isWired&&m.e_H&&m.setNodeProperties('preview',{src:m.e_H});}function e_J(){var m=this;if(m.isWired&&((m.e_r&&m.e_t)||(m.e_k&&m.e_o))){var e_K={},e_L=function(e_M){var e_N=e_M?'height':'width';e_K[e_M?'top':'left']=
m.get(e_M?'alignY':'alignX')*(m.e_B[e_N]-(e_K[e_N]=m.e_C[e_N]*m.e_O));};e_L(0);e_L(1);m.setNodeStyle(m.e_o?'previewZoom':'previewZoomLowRes',e_K);}}function e_P(m,e_x,e_Q){if(m.isWired){e_Q&&e_J.call(m);
m.showNode(e_x,e_Q);}}function e_F(){e_P(this,'previewZoomLowRes',this.e_t);}function e_E(){e_P(this,'previewZoom',this.e_o);}return e_$.subclass({omegastructor:function(){var m=this;m.wire('Changed.over',
function(e_R){if(!e_R.newValue){m.isWired&&m.unwireNode(document.documentElement,'mousemove');m.set({inUse:e_a});}e_q.call(m);});},instanceMethods:{updateUi:function(){e_I(this);e_$.doMy(this,'updateUi');
},wireUi:function(){var m=this;if(!m.isWired){var e_A=m.getNode('preview'),e_S=m.getNode('previewShell')||(e_A?e_A.parentNode:null);m.e_H||m.set({e_H:e_A.src});m.wireNode(e_S,Uize.Dom.VirtualEvents.Remain.mouseRest(150),
function(){if(!m.get('over'))return;if(m.e_m>1){m.set({inUse:e__});var e_T=function(){var e_U=e_c.getEventAbsPos(),e_V=m.e_V;function e_W(e_M){return(Uize.constrain((e_U[e_M?'top':'left']-(m.e_B[e_M?'y':'x']+e_V))/(m.e_B[e_M?'height':'width']-e_V*2),
0,1))}m.e_B&&m.set({e_X:e_W(0),e_Y:e_W(1)});};e_T();m.wireNode(document.documentElement,'mousemove',e_T);}});e_$.doMy(m,'wireUi');}}},stateProperties:{e_X:{name:'alignX',onChange:e_J,value:0},e_Y:{name:'alignY',
onChange:e_J,value:0},e_V:{name:'deadMargin',value:20},e_O:{name:'displayedZoomPower',onChange:e_J,value:1},e_l:{name:'inUse',onChange:[e_n,e_j,e_s,e_q,function(){var m=this;if(m.isWired){if(m.e_l){var e_i=e_h(m);
if(e_i){if(m.e_m>1){m.e_Z=e__;m.e_0||(m.e_0=Uize.Fade()).wire('Changed.value',function(e_R){m.set({e_O:e_R.newValue})});m.e_0.start(Uize.copyInto({startValue:1,endValue:m.e_m},m.e_1));}else{m.setNodeProperties('preview',{src:e_i});
}m.set({e_2:e__});}}else{if(m.e_Z){m.e_0.stop();m.set({e_O:1});m.e_Z=e_a;}else{e_I(m);}m.set({e_2:e_a});}}}],value:e_a},e_H:{name:'previewUrl',onChange:[e_u,function(){e_I(this)}]},e_i:{name:'previewZoomUrl',
onChange:[e_j,e_q]},e_2:{name:'showingPreview',value:e_a},e_m:{name:'zoomPower',onChange:[e_j,e_q],value:1},e_1:{name:'zoomFadeProperties',value:{duration:600,curve:Uize.Fade.celeration(0,1)}},e_p:{onChange:[e_n,e_s],
value:e_a},e_k:{onChange:function(){e_w(this,'previewZoom',this.e_k);},value:e_a},e_o:{onChange:e_E,value:e_a},e_r:{onChange:function(){e_w(this,'previewZoomLowRes',this.e_r);},value:e_a},e_t:{onChange:e_F,
value:e__}}});}});
Uize.module({name:'Zazzle.GridCell',superclass:'Uize.Widget.CollectionItem.Zooming',required:['Uize.Node.Classes','Uize.Url','Zazzle.Checkbox'],builder:function(f_$){'use strict';var f__=null;var f_a=f_$.subclass(
f__,function(){var m=this,f_b=m.f_c&&m.addChild('selected',Zazzle.Checkbox);f_b&&(new Uize.Util.PropertyAdapter({propertyA:{instance:m,property:'selected'},propertyB:{instance:f_b,property:'value'}})
);m.wire('Changed.showingPreview',function(){var f_d=m.getNode('previewZoom'),f_e=m.getNode('previewZoomLowRes');if(f_d)Uize.Node.Classes.addClass(f_d,m.f_f);if(f_e)Uize.Node.Classes.addClass(f_e,m.f_f);
});});f_a.set({cssClassActive:'selected',cssClassOver:'over',cssClassImage:'realviewImage',cssClassImageOver:'realviewImageHover',previewZoomUrl:function(){var m=this,f_g=f__,f_h=m.get('previewUrl'),
f_i=m.get('zoomPower');if(f_i>1)f_g=f_a.setUrlMaxDim(f_h,f_a.getUrlMaxDim(f_h)*f_i);return f_g;},zoomPower:2.5});var f_j=/(max_dim=)(\d+)(.*)/,f_k=/(_)(\d+)(\.[^\.]*(\?|#|$))/;f_a.getUrlMaxDim=function(f_l){
var f_m=f_l.match(f_j)||f_l.match(f_k);if(f_m&&f_m.length>1)return f_m[2];else return'1';};f_a.setUrlMaxDim=function(f_l,f_n){var f_o;function f_p(f_q,f_r,f_s,f_t){f_o=true;return f_r+Math.min(Math.round(f_n),2000)+f_t;
}var f_g=f_l.replace(f_j,f_p);if(!f_o)f_g=f_l.replace(f_k,f_p);return f_g;};f_a.stateProperties({f_c:'showSelectUi',f_f:'cssClassPreviewZoom'});return f_a;}});
Uize.module({name:'Zazzle.GridCell.Product',required:['Uize.Url','Uize.Node','Uize.Node.Classes'],builder:function(g_$){'use strict';var g__=true,g_a=false,g_b=null,g_c=Uize,g_d=g_c.Url,g_e=g_c.Node,g_f=g_e.Classes
;var g_g=g_$.subclass(g_b,function(){var m=this,g_h=m.get('properties'),g_i;m.g_i=g_i=m.get('productType')||g_h.pt||g_h.pdt;if(m.getNode()){m.g_j=m.getNode('preview').src;m.g_k=g_h.pid||g_h.pd;m.g_l=g_h.un;
var g_m=m.g_m=g_h.views,g_n=m.g_n=g_h.multiviews;if(g_n){m.g_o= -1;for(var g_p=0;g_p<g_n.length;++g_p){if(g_n[g_p].isCurrent){m.g_o=g_p;break;}}m.g_o== -1&&(m.g_n=undefined);}else if(g_m&&g_i!='zazzle_shirt'){
m.g_o=0;if(g_i=='zazzle_card'){m.g_q=g_m[1];g_m=g_m[0];}if(typeof g_m=='string'){m.g_m=g_i=='zazzle_ornament'?(g_m.indexOf('angle0')?['angle0',g_m]:[g_m,'angle180']):g_c.clone(g_r[g_i]);while(m.g_o<m.g_m.length&&
m.g_m[m.g_o]!=g_m)++m.g_o;m.g_o==m.g_m.length&&m.g_m.push(g_m);}}var g_s=function(){var g_t=m.getNode(m.g_u),g_v=g_e.getCoords(g_t),g_w=m.getNode('hoverContentInsert'),g_x=g_e.getCoords(g_w),g_y=g_e.getDocumentScrollElement(),
g_z=g_y.scrollTop,g_A=g_x.top-g_z,g_B=(g_z+g_e.getCoords(window).height)-g_x.bottom,g_C='auto',g_D='auto';g_C=(g_v.width-g_x.width)/2;g_D=(g_v.height-g_x.height)/2;var g_E=(g_A+g_D)<0,g_F=(g_B-g_D)<0
;if(g_E)g_D= -1*g_A;else if(g_F)g_D=g_B;g_e.setStyle(g_w,{position:'absolute',left:g_C,top:g_D});};var g_G=function(){g_e.setStyle(m.getNode('hoverContentInsert'),{position:'absolute',left:0,top:0});
};m.wire('Changed.hover',function(){var g_t=m.getNode(),g_H='lowRes';if(m.g_I&&m.g_J&&m.g_K&& !Uize.isEmpty(m.get('productId'))){var g_L='hovered',g_M=g_d.fromParams(m.g_K),g_N=g_M.childControlName,g_O=g_d.fromParams(g_M.childWidgetProperties),
g_P=g_c.copyInto(g_O,{cp:g_N,itemData:g_d.toParams({pd:m.get('productId'),att:g_d.toParams(g_h.att),titleSeo:g_h.titleSeo}),idPrefix:m.get('idPrefix')+'_'+g_L,lowResImageUrl:m.get('previewUrl')}),g_Q=function(){
g_f.setState(m.getNode(),m.g_R,g__);g_G();g_s();};if(!m.getNode('hoverContentInsert')){g_e.injectHtml(m.getNode(m.g_u),'<div id="'+m.get('idPrefix')+'-hoverContentInsert" class="'+m.g_S+'"></div>','inner bottom');
m.flushNodeCache('hoverContentInsert');}if(!m.children[g_L]){m.callInherited('loadHtmlIntoNode')({node:m.getNode('hoverContentInsert')},g_P,{cache:'memory',callback:function(g_T){if(m.g_J){g_Q();m.fire('Hover Loaded');
}}});}else if(m.g_J){g_Q();}}else{g_f.setState(m.getNode(),m.g_R,g_a);g_G();}});}}),g_U=g_g.prototype;var g_V=['front','back'],g_r={zazzle_envelope:['angle0','angle180','angle180_2'],zazzle_binder:['angle45_outside_spinefront','angle0_outside_front','angle45_outside_front','angle0_outside_back','angle45_outside_spineback','angle0_outside_spine','angle0_outside_full'],
zazzle_invitation:g_V,zazzle_mug:['0','270','90'],zazzle_card:['front','inside2','inside1','back'],zazzle_postcard:g_V,zazzle_profilecard:g_V,zazzle_photocard:g_V,zazzle_flyer:g_V,zazzle_rackcard:g_V
},g_W={front:'viewFront',back:'viewBack',angle0:'viewFront',angle0_2:'viewFront',angle0_outside_front:'viewFront',angle0_outside_full:'viewFull',angle0_outside_spine:'viewSpine',angle0_outside_back:'viewBack',
angle45:'viewFrontRight',angle45_outside_front:'viewFront',angle45_outside_back:'viewBack',angle45_outside_spinefront:'viewFront',angle45_outside_spineback:'viewBack',angle90:'viewLeft',angle180:'viewBack',
angle180_2:'viewBack',angle270:'viewRight',angle315:'viewFrontLeft',cover:'viewCover',calendar:'viewMonth',inside1horz:'viewInsideTop',inside2horz:'viewInsideBottom',inside1vert:'viewInsideLeft',inside2vert:'viewInsideRight',
90:'viewBack',0:'viewCenter',270:'viewLeft'};g_U.g_X=function(g_Y){var m=this,g_Z=m.getNode('nextviewLink'),g_n=m.g_n,g_m=m.g_m,g_i=m.g_i,g_0=parseInt(g_e.getStyle(g_Z,'borderWidth').replace('px')),g_1=g_e.getDimensions(g_Z),
g_2=Math.max(g_1.height||0,g_1.width||0)-(g_0*2),g_3=g_e.getDimensions(m.getNode('preview')),g_4=Math.max(g_3.width||0,g_3.height||0),g_j=m.g_j,g_5=(m.g_o+1)%(g_n||g_m).length,g_6=g_n?g_n[g_5]:g_m[g_5],
g_7=g_n?g_d.resolve(g_6.url,{max_dim:g_Y?g_4:(g_2>=0?g_2:0)}):g_d.resolve(g_j,g_c.copyInto(g_i=='zazzle_mug'?{lon:g_6}:{view:g_6},{max_dim:g_4}));if(g_n){var g_8=g_d.fromParams(g_j),g_9;for(g_9 in g_8)
if(g_9.indexOf('t_'))delete g_8[g_9];g_7=g_d.resolve(g_7,g_8);}g_Y?(m.g_o=g_5):(g_7=g_n?g_7:g_g.setUrlMaxDim(g_7,g_2));return g_7;};g_U.g_$_=function(){var m=this,g_Z=m.getNode('nextviewLink'),g_n=m.g_n,
g_m=m.g_m,g_i=m.g_i,g___=function(g_p){return(g_p&&g_p.title)||m.localize(g_W[g_p]);},g_5=(m.g_o+1)%(g_n||g_m).length,g_p=g_n?g_n[g_5]:g_m[g_5],g_a_;if(g_i=='zazzle_ornament')g_p=g_5==0?'angle0':'angle180';
else if(g_p=='inside1'||g_p=='inside2')g_p+=m.g_q;g_a_=g___(g_p);if(g_Z){g_Z.style.backgroundImage='url("'+m.g_X()+'")';g_Z.title=m.localize('clickToView',g_a_);}};g_U.updateNextView=function(){var m=this,
g_Z=m.getNode('nextviewLink');if(m.isWired){m.set({previewUrl:m.g_X(g__)});m.g_$_();g_Z&&g_Z.blur();}};g_U.initNextViewLink=function(){var m=this;if(!m.g_b_){var g_Z=m.getNode('nextviewLink'),g_n=m.g_n,
g_m=m.g_m,g_c_=((g_n&&g_n.length>1)||(g_m&&g_m.length))&&g_Z;m.displayNode(g_Z,g__);m.g_$_();m.wireNode(g_Z,'click',function(){m.updateNextView();m.g_d_('multiview');});m.wire('Changed.previewUrl',function(){
m.g_j=m.getNode('preview').src;m.g_$_();});m.wire('Changed.showingPreview',function(){var g_e_= !m.get('showingPreview');g_c_&&m.showNode(g_Z,g_e_);});}m.g_b_=true;};g_U.wireUi=function(){var m=this;
if(!m.isWired&&m.getNode('')){var g_m=m.g_m,g_n=m.g_n,g_c_=((g_n&&g_n.length>1)||(g_m&&g_m.length))&&m.getNode('nextviewLink'),g_f_=m.getInherited('env'),g_P=g_f_.params,g_g_=function(){var g_h_=(m.parent.storeContext)?
m.parent.storeContext+'/products/styles/pd-'+m.g_k:'pd/styles/pd-'+m.g_k;location.href=g_d.resolve(g_f_.www+g_h_,{dp:g_P.gp?g_b:g_P.dp||'',qs:g_P.qs||'',tl:m.getInherited('searchTitle')||''});},g_i_=function(){
var g_j_=g_f_.www+(m.parent.storeContext?m.parent.storeContext+'/':'')+'gifts';location.href=g_d.resolve(g_j_,{gp:m.g_k});};m.wireNode('contributorLink','click',function(){location.href=g_f_.www+m.g_l}
);m.wireNode('storeLink','click',function(){location.href=g_f_.www+(m.getInherited('storeLinksToStores')?'':'gifts/ch-')+m.g_l;});m.wireNode('moreStylesLink','click',function(){g_g_();});m.wireNode('moreStylesLink2','click',function(){g_g_();});
m.wireNode('moreProductsLink','click',function(){g_i_();});m.wireNode('moreProductsLink2','click',function(){g_i_();});m.wireNode('','mouseover',function(){});m.wire('Changed.showingPreview',function(){
var g_e_= !m.get('showingPreview');m.showNode('productTypeIcon',g_e_);});if(g_c_&&m.g_k_){m.initNextViewLink();}m.wire('Init Nextview',function(){if(g_c_)m.initNextViewLink();});m.wire('Changed.displayedZoomPower',
function(){if(m.get('displayedZoomPower')==m.get('zoomPower'))!m.g_l_&&(m.g_l_=new Date);else if(m.g_l_){m.g_d_('zoom',new Date-m.g_l_);m.g_l_=undefined;}});m.wireNode(m.g_u,'mouseRest(200)',function(){
m.g_I&&m.set({g_J:g__});});m.wireNode(m.g_u,'mouseout',function(g_m_){if(m.g_I){m.g_n_=setTimeout(function(){m.set({g_J:g_a});m.g_n_=null;},400);}});m.wireNode(m.g_u,'mouseover',function(){if(m.g_n_){
clearTimeout(m.g_n_);m.g_n_=null;}});g_$.doMy(m,'wireUi');}};g_U.g_d_=g_U.fireTrackEvent=function(g_o_,g_p_){this.fire({name:'Track Event',bubble:g__,extra:{idPrefix:this.get('idPrefix'),pd:this.g_k,
ax:g_o_,ts:g_p_}})};g_g.stateProperties({g_q_:'seen',g_k:'productId',g_k_:{name:'initNextviewOnLoad',value:g__},g_K:'hoverItemReferenceWidget',g_I:{name:'isHoverable'},g_J:{name:'hover',conformer:function(g_r_){return this.g_I&&g_r_}
},g_u:{name:'hoverableNode',value:''},g_s_:{name:'useStoreLinks',value:g_a},g_R:{name:'cssClassHovering',value:'hovering'},g_S:{name:'cssClassHoverContentInsert',value:'hoverContentInsert'}});return g_g;
}});
Uize.module('Zazzle.Collection');
Uize.module({name:'Zazzle.Collection.Products',superclass:'Uize.Widget.Collection.Dynamic',builder:function(f_$){'use strict';return f_$.subclass();}});
Uize.module('ZazzleWww.Collection');
Uize.module('ZazzleWww.Collection.Products');
Uize.module({name:'ZazzleWww.Collection.Products.WithModel',superclass:'Zazzle.Collection.Products',required:['Uize.Widget.mModels'],builder:function(g_$){'use strict';return g_$.subclass({mixins:[Uize.Widget.mModels]
});}});
Uize.module({name:'Zazzle.Results',superclass:'Zazzle.Widget',required:'Uize.Node',builder:function(e_$){'use strict';var e__=Uize,e_a=e__.Node,e_b=true,e_c=false,e_d=null,e_e;var e_f=e_$.subclass(e_d,
function(){var m=this,e_g=m.e_g,e_h=m.e_h,e_i=e__.Util,e_j=e_i.Coupler,e_k=e_i.PropertyAdapter,e_l=e__.Widget.Button,e_m=Zazzle,e_n=e_m.Pagination,e_o=e_g&&m.addChild('paginationTop',e_n),e_p=e_h&&m.addChild('paginationBottom',e_n)
;m.addChild('collection',m.e_q,m.e_r);m.e_s=m.e_t;m.e_u=[];m.e_v=0;e_o&&e_p&&new e_j({instances:[e_o,e_p],properties:['classSelected','numResults','pageSize','value']});if(e_o){new e_k({propertyA:{instance:m,
property:'page'},propertyB:{instance:e_o,property:'value'}});new e_k({propertyA:{instance:m,property:'pageSize'},propertyB:{instance:e_o,property:'pageSize'}});new e_k({propertyA:{instance:m,property:'numResults'
},propertyB:{instance:e_o,property:'numResults'}});}if(m.e_w){var e_x=e_m.Droplist,e_y=e_g&&m.e_z&&m.addChild('pageSizeTop',e_x),e_A=e_h&&m.e_z&&m.addChild('pageSizeBottom',e_x),e_B=e_g&&m.e_C&&m.addChild('sortTop',e_x),
e_D=e_h&&m.e_C&&m.addChild('sortBottom',e_x),e_E=e_g&&m.e_F&&m.addChild('infiniteScrollTop',e_l,{clickToSelect:e_b,clickToDeselect:e_b}),e_G=e_h&&m.e_F&&m.addChild('infiniteScrollBottom',e_l,{clickToSelect:e_b,clickToDeselect:e_b}),
e_H=m.e_F&&m.addChild('showMoreResults',e_l);if(e_y){e_A&&new e_j({instances:[e_y,e_A],properties:['value','values']});new e_k({propertyA:{instance:m,property:'pageSize'},propertyB:{instance:e_y,property:'value'
},valueAdapter:{aToB:function(e_I){return e_I+''},bToA:function(e_I){return+e_I}}});}if(e_B){e_D&&new e_j({instances:[e_B,e_D],properties:['value','values']});new e_k({propertyA:{instance:m,property:'sort'
},propertyB:{instance:e_B,property:'value'}});}if(e_E){e_G&&new e_i.Coupler({instances:[e_E,e_G],properties:['selected']});new e_i.PropertyAdapter({propertyA:{instance:m,property:'infiniteScroll'},propertyB:{
instance:e_E,property:'selected'}});}e_H&&e_H.wire('Click',function(){if(m.isWired){m.displayNode('showMoreResults',e_c);e_o&&e_o.displayNode('',e_c);}m.set({page:m.e_t+1});});m.e_J=e_c;}}),e_K=e_f.prototype
;e_K.e_L=function(e_M){var e_L=e_c;if(this.e_N&&e_M)for(var e_O in this.getScrollableProperties())if(e_M[e_O]!=e_e){e_L=e_b;break;}return e_L;};e_K.e_P=function(e_Q){return this.children.collection.getNode('itemsContainer'+(e_Q?'2':''))
};e_K.e_R=function(e_t){var m=this;e_t=e_t==e_e?1:e_t;if(m.isWired){m.e_t==e_t?m.e_S():m.set({e_t:e_t});}};e_K.e_T=function(e_U,e_V){var m=this;if(m.isWired&&m.e_W){m.callInherited('displayLoadingOverlay')(
e_U,{parent:m,node:e_V?m.getNode('infiniteScrollLoad'):e_d,loaderSize:e_V?'Small':e_d});m.displayNode('infiniteScrollLoad',e_V&&e_U);}};e_K.e_X=function(){this.e_Y=(this.e_Y||0)+1};e_K.e_S=function(e_V){
var m=this;if(m.isWired&&m.e_w&& !m.e_Z){!e_V&&(m.e_J= !m.e_J);var e_0=m.children,e_1=e_0.collection,e_2=m.e_2,e_3,e_t=m.e_t,e_s=m.e_s,e_4=e_t-e_s,e_5=m.e_5,e_6=e_4&&m.e_6,e_7=(e_t-1)*e_5,e_8=(e_t*e_5)-1,
e_9=e_1.itemWidgets.length,e_$_=e_8-e_7+1,e___=e_1.getNode(),e_a_=e_1.getNode('items'),e_b_=e___.style,e_c_=e___?{height:e_b_.height,overflow:e_b_.overflow}:{},e_d_=e_1.getNodeStyle(e_a_,'overflow');
e_6&&e_1.setNodeStyle(e_a_,{overflow:'hidden'});var e_e_=e_a.getDimensions(e___),e_f_=m.e_P(m.e_J),e_g_=m.e_P(!m.e_J),e_h_=e_c,e_i_=0;if(e_0.sortTop){var e_j_=e_0.sortTop.get('values');for(var e_k_=0;e_k_<e_j_.length;e_k_++){
var e_l_=e_j_[e_k_];e_l_.name==e_2&&(e_3=e_l_.valueDetails);}}var e_m_=function(e_n_){m.callInherited('loadHtmlIntoNode')({node:e_f_,injectMode:'inner bottom'},e__.copyInto({service:m.e_w,serviceCaller:m.get('idPrefix'),
idPrefix:m.get('idPrefix'),itemNo:e_n_,itemReferenceWidget:m.e_o_,itemWidgetNamePrefix:e_1.get('itemWidgetNamePrefix'),collectionReferenceWidget:m.e_p_,itemRootNodeCssClass:e_1.get('itemRootNodeCssClass'),
rev:m.e_Y,ps:m.e_5},e_3?e_3.attributes:{st:e_2},m.getServiceParams()),{cache:'memory',beforeInject:function(e_q_,e_r_){if(!e_h_&&e___){e_1.setNodeStyle(e___,{height:e_e_.height,overflow:'hidden'});e_h_=e_b;
m.beforeAddNewItems();!e_6&&m.displayNode(e_f_);!e_V&& !e_6&&m.displayNode(e_g_,e_c);m.e_T(e_c,e_V);if(m.e_s_&&m.e_t_&&e_V&&(m.e_u_>=m.e_v_||((m.e_t-1)%Math.floor(m.e_v_/m.e_u_))==0)){var e_w_='pageBreak'+m.e_v++,
e_x_=Math.floor(((m.e_t-1)/Math.floor(m.e_v_/m.e_u_))+1);m.injectNodeHtml(e_f_,'<div id=\"'+m.get('idPrefix')+'-'+e_w_+'\" class=\"hrsingle '+m.e_y_+'\"><span class=\"'+m.e_z_+'\">'+m.localize('page',{page:e_x_})+'</span></div>','inner bottom');
m.e_u.push(e_w_);}}e_q_();},callback:function(){var e_A_='$'+m.get('idPrefix'),e_B_=window[e_A_];if(e_B_){m.set(e_B_);e_$_=Math.min(m.e_C_,e_t*e_5)-e_7;window[e_A_]=e_e;m.fire('Updated Data');}if(++e_i_==e_$_||(!e_$_&& !(e_i_-1))){
var e_D_=e_1.getNode('clearDiv'+(m.e_J?'2':''));if(e_D_){e_a.remove(e_D_);e_f_.appendChild(e_D_);}e_1.setNodeStyle(e___,e_c_);if(!e_V){var e_E_=function(){e_6&&e_1.setNodeStyle(e_a_,{overflow:e_d_});
var e_F_=e_1.itemWidgets,e_G_=[];for(var e_H_= -1;++e_H_<e_9;)e_G_.push(e_F_[e_H_]);e_1.remove(e_G_);if(m.e_s_&&m.e_t_){m.removeNode(m.e_u);e__.emptyOut(m.e_u);}};if(e_6){e__.require(['Uize.Fade','Uize.Curve'],
function(e_I_,e_J_){var e_K_=e_e_.width*(e_4>0?1: -1),e_L_=new e_I_({startValue:e_K_,endValue:0,duration:e_6,curve:e_J_.easeOutCircular()});e_L_.wire({Start:function(){m.setNodeStyle(e_g_,{left:0,position:'absolute',
top:0});m.setNodeStyle(e_f_,{display:'block',left:+e_L_,position:'relative'});},'Changed.value':function(){var e_I= +e_L_;m.setNodeStyle(e_f_,{left:e_I});m.setNodeStyle(e_g_,{left:e_I-e_K_});},Done:function(){
m.setNodeStyle(e_g_,{display:'none',position:''});m.setNodeStyle(e_f_,{position:''});e_E_();m.set({e_Z:e_c});e_L_=e_d;}});e_L_.start();});}else e_E_();}if(!e_6){m.set({e_Z:e_c});}m.e_s_&&m.e_M_();}}}
);};if(e_7<=e_8){m.e_T(e_b,e_V);m.set({e_Z:e_b});var e_N_=function(){for(var e_n_=e_7;e_n_<=e_8;e_n_++)e_m_(e_n_);};if(m.e_O_)e_N_();else Uize.require('Uize.Fx.Scroll',function(e_P_){e_P_.scrollToNode(m.getNode(),{callback:e_N_})}
);}else e_1.set({items:[]});}m.e_s=m.e_t;};e_K.e_Q_=function(){var m=this;if(m.isWired){var e_0=m.children,e_o=m.children.paginationTop,e_C_=m.e_C_,e_5=m.e_5,e_R_=e_C_>1,e_S_= !m.e_s_,e_T_=function(e_U_,e_V_){
var e_W_=e_0[e_U_];e_W_&&e_W_.displayNode('',e_V_);};e_T_('sortTop',e_R_);e_T_('sortBottom',e_R_);e_T_('pageSizeTop',e_S_);e_T_('pageSizeBottom',e_S_);e_T_('paginationTop',e_S_||m.e_X_);e_T_('paginationBottom',e_S_);
var e_Y_= !e_S_&&m.e_Z_> -1&&((m.e_t-1)%m.e_Z_==(m.e_Z_-1))&&(m.e_t*e_5<m.e_0_)&&(m.e_t*e_5<e_C_);m.displayNode('sortsUi',e_R_);m.displayNode('top',e_R_||m.e_X_);m.displayNode('bottom',e_R_&&(e_S_||e_Y_));
m.displayNode('collection',e_C_|| !m.e_1_);m.displayNode('noResults',!e_C_&&m.e_1_);m.displayNode('showMoreResults',e_Y_);m.set({infiniteScrollButtonDisplay:e_Y_});}};e_K.e_M_=function(){var m=this;if(m.isWired&&m.e_s_){
var e_2_=m.children.collection.itemWidgets,e_3_=e_2_?e_2_.length:0,e_4_=(m.e_5*.25).toFixed(),e_5_=e_3_>e_4_?e_2_[e_3_-e_4_]:e_d,e_6_=e_3_>0?e_2_[e_3_-1]:e_d,e_7_=(m.e_t*m.e_5<m.e_0_)&&(m.e_t*m.e_5<m.e_C_)
;if(!m.e_Z&&e_7_&&(m.e_Z_== -1||((m.e_t-1)%m.e_Z_)!=(m.e_Z_-1))&&(e_5_&&e_a.getCoords(e_5_.getNode()).percentSeen>10||e_6_&&e_a.getCoords(e_6_.getNode()).percentSeen>10)){m.children.paginationTop.displayNode('',e_c);
m.set({page:m.e_t+1});}}};e_K.beforeAddNewItems=function(){};e_K.afterAddNewItems=function(){};e_K.getScrollableProperties=function(){return{page:1,pageSize:1,sort:1}};e_K.getServiceParams=function(){return{}};
e_K.reset=function(){var m=this;m.e_X();m.e_R();};e_K.updateResults=function(e_M){var m=this;e_M=e_M||{};e_M.page==e_e&&m.e_t!=1&&(e_M.page=1);if(e_M.page&&m.e_t!=e_M.page)m.set(e_M);else{var e_V=m.e_s_
&&e_M.page!=e_e&&e__.keys(e_M).length==1;m.e_O_=e_V|| !m.e_L(e_M);m.e_S(e_V);m.e_O_=e_c;}};e_K.updateUi=function(){var m=this;if(m.isWired){m.children.collection.forAll(function(e_8_){e_8_.updateUi()});
m.e_Q_();e_$.doMy(m,'updateUi');}};e_K.wireUi=function(){var m=this,e_E=m.children.infiniteScrollTop;if(!m.isWired){m.displayNode(m.e_P(e_b),e_c);m.children.collection.wire('Items Removed',function(e_9_){
if(e_9_.byUser){!m.e_w&&m.set({e_C_:m.e_C_-e_9_.totalRemoved});m.e_X();m.e_R((m.e_t-1)*m.e_5<m.e_C_?m.e_t:Math.max(m.e_t-1,1));}});e_a.wire(window,{scroll:function(){m.e_M_()},load:function(){m.e_M_()}
});e_$.doMy(m,'wireUi');e_E&&m.callInherited('wireTooltip')(e_E.getNode(),function(){return m.e_s_?m.localize('showNumResults',{num:m.e_v_?m.e_v_:m.e_5}):m.localize('showAllResults');});m.e_$a&&m.updateResults()
;}};var e__a='updateResults';e_f.stateProperties({e_X_:{name:'alwaysShowTop',value:e_c},e_6:'animatePagination',e_$a:'clientSideLoaded',e_p_:'collectionReferenceWidget',e_q:'collectionWidgetClass',e_r:'collectionWidgetProperties',
e_1_:{name:'hideCollectionWhenNoResults',value:e_b},e_h:'includeBottomBar',e_z:'includePageSizesUi',e_C:'includeSortsUi',e_F:'includeInfiniteScrollUi',e_g:'includeTopBar',e_s_:{name:'infiniteScroll',
onChange:[e_K.e_Q_,function(){var m=this;if(m.e_s_){m.e_v_=m.get('pageSize');m.set({page:1,pageSize:m.e_u_});}else{m.set({page:1,pageSize:m.e_v_?m.e_v_:m.e_5});}}]},e_aa:{name:'infiniteScrollButtonDisplay',
value:e_c},e_Z_:{name:'infiniteScrollButtonInterval',value:3},e_t_:{name:'infiniteScrollPageDisplay',value:e_c},e_z_:'pageBreakCssClassName',e_y_:'pageBreakHrCssClassName',e_u_:{name:'infiniteScrollPageSize',
value:18},e_o_:'itemReferenceWidget',e_0_:{name:'maxResults',value:540},e_C_:{name:'numResults',onChange:e_K.e_Q_},e_v_:'oldPageSize',e_t:{name:'page',onChange:e__a,value:1},e_5:{name:'pageSize',onChange:e__a,
value:20},e_ba:'scrollToTargetNodeId',e_N:{name:'scrollToTop',value:e_b},e_ca:{name:'showJumpPagination',value:e_b},e_2:{name:'sort',onChange:e__a},e_Z:{name:'updating',onChange:function(){var m=this;
m.set({busy:m.e_Z?e_b:'inherit'});!m.e_Z&&m.e_s_&&m.e_Q_();},value:e_c},e_w:'serviceUrl',e_W:{name:'useLoadingOverlay',value:e_b}});return e_f;}});
Uize.module({name:'Zazzle.Results.Cell',required:'Uize.Widget.Collection',builder:function(f_$){'use strict';var f__=false;var f_a=f_$.subclass(null,function(){var m=this;if(m.f_b&&m.get('serviceUrl')){
var f_c=Uize,f_d=f_c.Widget.Options,f_e=f_c.Util,f_f=m.addChild('viewModeTop',f_d),f_g=m.addChild('viewModeBottom',f_d);new f_e.Coupler({instances:[f_f,f_g],properties:['value','values']});new f_e.PropertyAdapter({
propertyA:{instance:m,property:'viewMode'},propertyB:{instance:f_f,property:'value'}});}}),f_h=f_a.prototype;f_h.getScrollableProperties=function(){return Uize.copyInto({viewMode:1},f_$.doMy(this,'getScrollableProperties')
);};f_h.beforeAddNewItems=function(){var m=this,f_i=m.children,f_j=f_i.collection,f_k=f_i.viewModeTop;f_$.doMy(m,'beforeAddNewItems');if(f_k){var f_l=Uize.findRecord(f_k.get('values'),{name:m.f_m});f_j.set({itemWidgetClass:f_l.itemWidgetClass});
f_j.isWired&&Uize.Node.Classes.setState(f_j.getNode(),[f_j.get('cssClassGrid'),f_j.get('cssClassList')],Uize.findRecord(f_k.get('values'),{name:m.f_m}).viewMode=='List');}};f_h.getServiceParams=function(){
var m=this,f_k=m.children.viewModeTop,f_n=f_k&&f_k.get('values');return Uize.copyInto(f_$.doMy(m,'getServiceParams'),{collectionViewMode:f_n&&Uize.findRecord(f_n,{name:m.f_m}).viewMode});};f_h.updateResults=function(f_o){
f_o=f_o||{};var m=this,f_p='viewMode'in f_o;if(f_p){var f_k=m.children.viewModeTop;if(f_k){var f_n=f_k.get('values');f_n&&m.set({itemReferenceWidget:Uize.findRecord(f_n,{name:m.f_m}).itemReferenceWidget
});}}f_$.doMy(m,'updateResults',[Uize.copy(f_o,f_p&&Uize.keys(f_o).length==1?{page:m.get('infiniteScroll')?1:m.get('page')}:null)]);};f_h.wireUi=function(){var m=this,f_f=m.children.viewModeTop;if(!m.isWired){
f_$.doMy(m,'wireUi');f_f&&f_f.forAll(function(f_q){m.callInherited('wireTooltip')(f_q.getNode());});}};f_a.set({collectionWidgetClass:Uize.Widget.Collection});f_a.stateProperties({f_b:{name:'includeViewModes',
value:f__},f_m:{name:'viewMode',onChange:'updateResults'}});return f_a;}});
Uize.module({name:'ZazzleWww.Widgets.ProductSuggestedIdeaboards',superclass:'Zazzle.Results.Cell',required:['Zazzle.Widget.mV2Web','Uize.Node','Uize.Widget.mModels','ZazzleWww.Models.IdeaBoards','ZazzleWww.Collection.Products.WithModel'
],builder:function(g_$){'use strict';var g__=Uize,g_a=true,g_b=false;return g_$.subclass({stateProperties:{g_c:'productId',g_d:{name:'ideaboardNum',value:1,onChange:'updateResults'},g_e:{name:'context',
value:'ProductPage'},g_f:'ideaboardId',g_g:'ideaboardTitle',g_h:'ideaboardLink',g_i:'attribution',g_j:'ideaboardCreatedBy',g_k:{name:'numIdeaboards',value:0},g_l:'maxIdeaboardsToShow',g_m:{name:'foundInTitle',
value:'',derived:{properties:'numIdeaboards',derivation:function(g_k){var m=this;return g_k>1?m.localize("foundInMultiple").replace('{num}',Number(g_k).toLocaleString()):m.localize("foundInSingle");}
}},g_n:{name:'showPrevious',value:g_b,derived:{properties:'ideaboardNum',derivation:function(g_d){return g_d>1;}}},g_o:{name:'showNext',value:g_b,derived:{properties:'ideaboardNum,numIdeaboards,maxIdeaboardsToShow',
derivation:function(g_d,g_k,g_l){return g_d<Math.min(g_k,g_l);}}},g_p:'hasBeenSeen'},mixins:[Uize.Widget.mModels,Zazzle.Widget.mV2Web],htmlBindings:{ideaboardTitle:'ideaboardTitle:html',attribution:'attribution:html',
foundInTitle:'foundInTitle:html',ideaboardLink:'ideaboardLink:href',showPrevious:'prev:show',showNext:'next:show'},omegastructor:function(){var m=this,g_q=function(){if(!m.g_p){if(g__.Node.getCoords(m.getNode()).percentSeen>90){
m.g_r('collectionSeen');m.set('hasBeenSeen',g_a);}}};m.whenever('wired',function(){g__.Node.wire(window,{scroll:function(){g_q()},load:function(){g_q()}});});},eventBindings:{'#prev:click':function(){
var m=this;m.set({ideaboardNum:Math.max(m.get('ideaboardNum')-1,1)});m.g_r('collectionPrevClicked');},'#next:click':function(){var m=this;m.set({ideaboardNum:Math.min(m.get('ideaboardNum')+1,m.get('numIdeaboards'))});
m.g_r('collectionNextClicked');},'#ideaboardTitle:click':function(){var m=this;m.g_r('collectionTitleClicked',{pg:m.g_d});},':Updated Data':function(){var m=this;Uize.forEach(m.children.collection.itemWidgets,function(g_s,i){
g_s.wire('Item Mouse Down',function(){m.g_r('collectionProductClicked',{targetPd:g_s.get('properties').pd,pg:m.g_d});});});}},instanceMethods:{g_r:function(g_t,g_u){var m=this;m.fire({name:'Track Event',
bubble:g_a,extra:g__.copyInto({ax:g_t,id:m.g_f,pd:m.get('productId'),context:m.g_e},g_u)});},getServiceParams:function(){var m=this;return g__.copyInto(g_$.doMy(m,'getServiceParams'),{productId:m.get('productId'),
ideaboardNum:m.get('ideaboardNum')});}},set:{collectionWidgetClass:ZazzleWww.Collection.Products.WithModel}});}});
Uize.module({name:'Zazzle.Results.Products',superclass:'Zazzle.Results.Cell',required:'Zazzle.Collection.Products',builder:function(g_$){'use strict';var g__=g_$.subclass();g__.set({collectionWidgetClass:Zazzle.Collection.Products
});return g__;}});
Uize.module('ZazzleWww.Results');
Uize.module('ZazzleWww.Results.Products');
Uize.module({name:'ZazzleWww.Results.Products.Related',superclass:'Zazzle.Results.Cell',required:['Uize.Widget.mWeb'],builder:function(g_$){'use strict';var g__=g_$.subclass(null,null),g_a=g__.prototype
;g__.mixins(Uize.Widget.mWeb);g_a.getServiceParams=function(){var m=this;return Uize.copyInto(g_$.doMy(m,'getServiceParams'),{pd:m.g_b,basedOn:m.g_c,referrerUrl:m.g_d,isShowingOnTop:m.g_e});};g_a.g_f=function(){
var m=this,g_g=m.get('page');m.web('prev').display(g_g>1);m.web('next').display((g_g*m.get('pageSize'))<m.get('numResults'));};g_a.updateUi=function(){var m=this;m.g_f();g_$.doMy(m,'updateUi');};g_a.wireUi=function(){
var m=this;if(!m.isWired){m.wireNode('prev','click',function(){m.set({page:Math.max(m.get('page')-1,1)});});m.wireNode('next','click',function(){m.set({page:Math.min(m.get('page')+1,Math.ceil(m.get('numResults')/m.get('pageSize')))});
});m.wire('Updated Data',function(){m.g_f();});g_$.doMy(m,'wireUi');}};g__.stateProperties({g_b:'productId',g_c:'basedOn',g_d:'referrerUrl',g_e:'isShowingOnTop'});return g__;}});
Uize.module('Zazzle.CollectionItem');
Uize.module({name:'Zazzle.CollectionItem.Cell',superclass:'Uize.Widget.CollectionItem.Zooming',required:['Uize.Url','Zazzle.Checkbox','Zazzle.Widget.mV2Web'],builder:function(f_$){'use strict';var f__=/(max_dim=)(\d+)(.*)/,
f_a=/(_)(\d+)(\.[^\.]*(\?|#|$))/;return f_$.subclass({mixins:Zazzle.Widget.mV2Web,stateProperties:{f_b:'cssClassPreviewZoom',f_c:{name:'maxImageSize',value:216},f_d:'showSelectUi',f_e:{name:'viewMode',
value:'Grid'}},set:{cssClassActive:'selected',cssClassOver:'over',cssClassImage:'realviewImage',cssClassImageOver:'realviewImageHover',extraClasses:'clearfix',previewZoomUrl:function(){var m=this,mClass=m.Class,
f_f=null,f_g=m.get('previewUrl'),f_h=m.get('zoomPower');if(f_h>1)f_f=mClass.setUrlMaxDim(f_g,mClass.getUrlMaxDim(f_g)*f_h);return f_f;},zoomPower:2.5},children:{selected:function(){return{widgetClass:this.f_d?Zazzle.Checkbox:null
};}},childBindings:{selected:'selected.value'},cssBindings:{maxImageSize:'value',viewMode:'value'},eventBindings:{':Changed.showingPreview':function(){var m=this;m.web('previewZoom').addClass(m.f_b);
m.web('previewZoomLowRes').addClass(m.f_b);}},staticMethods:{getUrlMaxDim:function(f_i){var f_j=f_i.match(f__)||f_i.match(f_a);if(f_j&&f_j.length>1)return f_j[2];else return'1';},setUrlMaxDim:function(f_i,f_k){
var f_l;function f_m(f_n,f_o,f_p,f_q){f_l=true;return f_o+Math.min(Math.round(f_k),2000)+f_q;}var f_f=f_i.replace(f__,f_m);if(!f_l)f_f=f_i.replace(f_a,f_m);return f_f;}}});}});
Uize.module({name:'Zazzle.RatingBars',superclass:'Uize.Widget',builder:function(d_$){'use strict';var d__=null;var d_a=d_$.subclass(),d_b=d_a.prototype;d_b.draw=function(){var m=this,d_c=function(d_d){
m.fire({name:'Rating Clicked',bubble:true,rating:d_d});};Uize.forEach(m.d_e,function(d_f){m.d_g[d_f]=m.d_h>0?m.d_i[d_f]/m.d_h*m.d_j:0;m.setNodeValue('title'+d_f,m.d_k[d_f]);m.setNodeStyle('bar'+d_f,{width:m.d_g[d_f]+'px'});
m.setNodeValue('detail'+d_f,m.d_l[d_f]);if(m.d_m){m.wireNode("ratingLink"+d_f,'click',function(){d_c(m.d_e-d_f);});}});};d_b.wireUi=function(){var m=this;if(!m.isWired){d_$.doMy(m,'wireUi');}};d_a.stateProperties({
d_n:'barHeight',d_j:'barWidth',d_o:'barSpacing',d_m:'linkRatingInfo',d_i:{name:'values',onChange:d_b.draw},d_h:'totalValue',d_l:'detailLabels',d_k:'titleLabels',d_e:'numBars',d_g:'fillA'});return d_a;
}});
Uize.module({name:'Zazzle.ReviewSummary',superclass:'Zazzle.Widget',required:['Zazzle.RatingContinuous','Zazzle.RatingBars'],builder:function(e_$){var e__,e_a=true,e_b=false,e_c=null,e_d=Uize;var e_e=e_$.subclass(
e_c,function(){var m=this;m.addChild('rating',Zazzle.RatingContinuous);m.addChild('ratingBars',Zazzle.RatingBars);}),e_f=e_e.prototype;e_f.e_g=function(){var m=this;if(m.isWired){var e_h='',e_i='',e_j='',
e_k='';m.children.rating.set({value:m.e_l});e_h=m.e_m;e_i=m.localize('xReviews',{num:m.e_n});m.setNodeInnerHtml('ratingLabel',e_h);m.setNodeInnerHtml('ratingLabelInner',e_i);e_j=m.localize('percentRecommend',{number:m.e_o});
m.setNodeInnerHtml('percentRecommend',e_j);m.e_p&&(e_k=m.localize('recommendedFor',{occasion:m.e_p}));m.setNodeInnerHtml('recommendedFor',e_k);m.children.ratingBars.set({detailLabels:m.e_q,values:m.e_r,
totalValue:m.e_n});m.web('ratingStars').display(m.e_n>0);m.web('recommendText').display(m.e_n>0);m.web('noReviews').display(m.e_n==0);}};e_f.reset=function(){var m=this;if(m.isWired){m.ajax({serviceUrl:'/svc/product/productreviews/'+(!m.e_s?'readreviews':'readptpdreviews'),
type:!m.e_s?m.e_t:null,pg:1,ps:5,callerId:m.getInherited('user').id,pd:m.e_u,pt:m.e_v,atts:m.e_w,isPublic:m.e_x,privateView:m.e_y,minRating:0},{cache:'memory',callbackSuccess:function(e_z){var e_A=e_z.data,
e_B;if(m.e_s){e_B=m.e_t=='OnProduct'?e_A.pdResults:e_A.ptResults;}else{e_B=e_A.results;}if(e_B!=e__){m.e_n=e_B.numResults;m.e_l=e_B.avgRating;m.e_m=e_B.avgRatingDisplay;m.e_p=e_B.mostRecommendedFor;m.e_r=e_B.ratingBreakdown;
m.e_q=e_B.ratingBreakdownDetail;m.e_o=e_B.percentRecommended;m.e_g();}}});}};e_f.wireUi=function(){var m=this;if(!m.isWired){m.wireNode('writeAReview','click',function(){m.callInherited('ensureLoggedIn')({
callback:function(e_C){m.ajax({serviceUrl:'/svc/product/productreviews/canreview',mbr:m.getInherited('user').id,pd:m.e_u,pt:m.e_D,atts:m.e_w},function(e_A){var e_z=e_A.data;m.e_E=e_z.hasOthers;m.e_F=e_z.goToForm;
m.e_G=e_z.reviewUrl;if(m.e_F){location.href=m.e_G;}else{var e_H=m.localize('message')+'<br /><br />';m.e_E&&(e_H+='<a href="'+m.get('urls').productsToReviewUrl+'">'+m.localize('linkMessage')+'</a>');
m.inform({title:m.localize('title'),message:e_H,state:'info'});}});}});});m.wireNode('ratingLabelInnerLink','click',function(){e_d.require('Uize.Fx.Scroll',function(e_I){e_I.scrollToNode(m.e_J);});});
m.wireNode('showAll','click',function(){m.fire({name:'Rating Clicked',bubble:true,rating:'all'});});e_$.doMy(m,'wireUi');}};e_e.stateProperties({e_s:{name:'ajaxBoth',value:e_b},e_w:{name:'attributes',
onChange:e_f.reset},e_l:'avgRating',e_m:'avgRatingDisplay',e_E:'canReviewItems',e_F:'canReviewThis',e_x:'isPublic',e_p:'mostRecommendedFor',e_o:'percentRecommended',e_y:'privateView',e_v:'qualifiedType',
e_r:'ratingBreakdown',e_q:'ratingBreakdownDetail',e_u:'rootId',e_G:'reviewFormUrl',e_K:'reviewQuality',e_t:'reviewsSet',e_J:'scrollToNodeId',e_n:'totalReviews',e_D:'unqualifiedType',e_L:'value'});return e_e;
}});
Uize.module({name:'Zazzle.Droplist.Navigate',required:'Uize.Url',builder:function(k_$){'use strict';var k__=k_$.subclass(null,function(){var m=this;m.wire('Changed.value',function(){m.k_a()});}),k_b=k__.prototype
;k_b.k_a=function(){var m=this,k_c={},k_d=m.getValueObject(),k_e=m.k_e;if(k_d){var k_f=k_d.valueDetails,k_g=k_f.importantInfo||k_f.attributes.url,k_h=k_f.attributes;if(k_h){if(!k_e){k_e={};for(var k_i in k_h)
k_e[k_i]=k_i;}for(var k_j in k_e)k_c[k_j]=k_h[k_e[k_j]];}location.href=Uize.Url.resolve(k_g||m.k_k||location.href,k_c)+(m.k_l?'#'+m.k_l:'');}};k__.stateProperties({k_l:'anchor',k_k:'urlBase',k_e:'urlParamsMap'
});return k__;}});
Uize.module({name:'Zazzle.JumpPagination',superclass:'Uize.Widget.Form',required:'Uize.Widget.FormElement.Text',builder:function(e_$){'use strict';var e__=e_$.subclass(null,function(){this.e_a=this.addFormElement('page',Uize.Widget.FormElement.Text)
}),e_b=e__.prototype;e_b.e_c=function(){return this.e_d?Infinity:Math.ceil(this.e_e/this.e_f)};e_b.e_g=function(){this.isWired&&this.displayNode('',this.e_c()>1)};e_b.e_h=function(){var m=this,e_a=m.e_a
;if(e_a){var e_i=e_a.get('validator')||[],e_j=Uize.findRecord(e_i,{type:'Range'}),e_k= !!e_j,e_l=m.e_c();e_j=Uize.copyInto(e_j||{},{type:'Range',min:1,max:e_l,func:function(e_m){return e_m>=1&&e_m<=e_l},
msg:m.localize(m.e_d?'minRangeWarning':'fullRangeWarning',{minValue:1,maxValue:e_l})});if(!e_k)e_i.push(e_j);e_a.validate();}};e_b.updateUi=function(){var m=this;if(m.isWired){m.e_g();e_$.doMy(m,'updateUi');
}};e__.stateProperties({e_d:{name:'isFuzzyNumResults',onChange:[e_b.e_h,e_b.e_g]},e_e:{name:'numResults',onChange:[e_b.e_h,e_b.e_g]},e_f:{name:'pageSize',onChange:[e_b.e_h,e_b.e_g]}});return e__;}});

Uize.module({name:'Uize.Widget.Pagination',required:['Uize.Widget.Button','Uize.Dom.Basics','Uize.Dom.Classes','Uize.Url'],builder:function(d_$){'use strict';function d__(d_a){var d_b=d_a+'',d_c=d_b.length,
d_d=[];for(var d_e=0;++d_e<=d_c;){d_d.unshift(d_b.charAt(d_c-d_e));!(d_e%3)&&d_e<d_c&&d_d.unshift(',');}return d_d.join('');}function d_f(m,d_g,d_h){return Uize.Widget.Button.addChildButton.call(m,d_g,d_h);
}function d_i(m){return Math.ceil(m.d_j/m.d_k)}function d_l(m){var d_m=m.d_m,d_n=m.d_n,d_o=d_i(m),d_p=1+(m.d_q&&d_m>1),d_r=d_o-(m.d_s&&d_m<d_o),d_t=Math.ceil(d_n/2),d_u=d_m-d_t+1,d_v=d_m+(d_n-d_t);return(
d_u>=d_p&&d_v<=d_r?d_u:d_u>=d_p?Math.max(d_p,d_r-d_n+1):d_p);}function d_w(m,d_x){m.set({d_m:d_x})}function d_y(){var m=this,d_z=m.children,d_m=m.d_m,d_o=d_i(m),d_A=d_o>1,d_j=m.d_j;if(m.isWired&&m.getNode()){
m.displayNode('displayShell',d_j>0);m.displayNode('paginationShell',d_A);m.setNodeInnerHtml('displayShell',m.localize('displayInfo',{number:d__((d_m-1)*m.d_k+1),toNumber:d__(Math.min(d_j,d_m*m.d_k)),
total:m.localize('numResultsDisplay',{numResults:d__(d_j)})||d__(d_j)}));m.setNodeInnerHtml('pageDisplay',m.localize('pageDisplayInfo',{page:d__(d_m),totalPages:d__(m.localize('numResultsDisplay',{numResults:d_o})||d_o)
}));if(d_A){var d_B=function(d_C,d_D){d_z[d_C]&&d_z[d_C].displayNode('',d_D);},d_E=function(d_C,d_x){d_z[d_C]&&d_z[d_C].set({text:d__(d_x)});};d_B('prev',d_m>1);d_B('next',d_m<d_o);m.d_F&&d_E('first',1);
d_B('first',d_m>1);d_B('last',d_m<d_o);m.d_F&&d_E('last',d_o);var d_G=d_l(m);m.displayNode('less',d_G>(1+m.d_q));m.displayNode('more',(d_G+m.d_n)<(d_o-m.d_s));for(var d_H= -1;++d_H<m.d_n;){var d_I='page'+d_H,
d_J=d_z[d_I].getNode(),d_x=d_G+d_H,d_K=d_x==d_m;d_E(d_I,d_K?m.localize('selectedPage',{page:d_x})||d_x:d_x);d_B(d_I,d_x==d_m||d_x<=(d_o-m.d_s));Uize.Dom.Classes.setState(d_J,m.d_L,d_K);}}}}return d_$.subclass({
omegastructor:function(){var m=this;d_f(m,'prev',function(){d_w(m,m.d_m-1)});d_f(m,'next',function(){d_w(m,m.d_m+1)});},instanceMethods:{updateUi:function(){var m=this;if(m.isWired){d_y.call(m);d_$.doMy(m,'updateUi');
}},wireUi:function(){var m=this;if(!m.isWired){var d_M=function(d_N){return!!Uize.Dom.Basics.getById(m.get('idPrefix')+'_'+d_N);},d_O=function(d_H){d_f(m,'page'+d_H,function(){d_w(m,d_l(m)+d_H)});};m.d_q=d_M('first');
m.d_s=d_M('last');m.d_n= -1;while(d_M('page'+ ++m.d_n));m.d_q&&d_f(m,'first',function(){d_w(m,1)});m.d_s&&d_f(m,'last',function(){d_w(m,d_i(m))});for(var d_H= -1;++d_H<m.d_n;)d_O(d_H);d_$.doMy(m,'wireUi');
}}},stateProperties:{d_L:{name:'classSelected',value:'selected'},d_j:{name:'numResults',onChange:d_y},d_k:{name:'pageSize',conformer:function(d_P){return d_P?d_P:30},onChange:d_y,value:30},d_F:{name:'setEdgeButtons',
value:true},d_Q:{name:'thousandsSeparator',onChange:d_y,value:','},d_R:'urlAnchor',d_S:'urlBase',d_T:{name:'urlParam',value:'pg'},d_m:{name:'value',conformer:function(d_U){var d_o=d_i(this);return d_U?(!d_o||d_U<d_o?Math.floor(d_U):d_o):1;
},onChange:[function(){var m=this;if(m.d_S&&m.isWired)location.href=Uize.Url.resolve(m.d_S,Uize.pairUp(m.d_T,m.d_m));},d_y],value:1}}});}});
Uize.module({name:'Zazzle.Pagination',superclass:'Uize.Widget.Pagination',required:['Zazzle.JumpPagination','Uize.Util.Coupler','Uize.Util.PropertyAdapter'],builder:function(e_$){'use strict';var e__=e_$.subclass(
null,function(){var m=this,e_a=m.addChild('jumpPagination',Zazzle.JumpPagination),e_b=new Uize.Util.PropertyAdapter({propertyA:m,propertyB:e_a,valueAdapter:{aToB:function(e_c){return{page:e_c}},bToA:function(e_c){return e_c.page}
},connected:e_a.get('isValid')});e_a.wire('Changed.isValid',function(){e_b.set({connected:e_a.get('isValid')})});new Uize.Util.Coupler({instances:[m,e_a],properties:['numResults','pageSize','isFuzzyNumResults']
});});e__.prototype.wireUi=function(){var m=this;if(!m.isWired){e_$.doMy(m,'wireUi');var e_d=m.children;Uize.forEach(['first','prev','next','last'],function(e_e){var e_f=e_d[e_e];e_f&&m.callInherited('wireTooltip')(e_f.getNode())
;});}};e__.stateProperties({e_g:{name:'isFuzzyNumResults',value:false}});return e__;}});
Uize.module({name:'Zazzle.CollectionItem.Review',superclass:'Uize.Widget.CollectionItem',required:['Zazzle.RatingContinuous','Zazzle.SeeMoreUi','Uize.Widget.mWeb'],builder:function(e_$){var e__=false,e_a=true
;var e_b=e_$.subclass(null,function(){var m=this;m.addChild('rating',Zazzle.RatingContinuous);m.addChild('review',Zazzle.SeeMoreUi);}),e_c=e_b.prototype;e_b.mixins(Uize.Widget.mWeb);e_c.e_d=function(e_e){
var m=this;m.callInherited('ensureLoggedIn')({callback:function(){m.e_f=m.getInherited('user').id;m.ajax({serviceUrl:'/svc/product/productreviews/updatehelpfulness',ax:'UpdateHelpfulness',mbr:m.e_f,rid:m.e_g,
helpful:e_e},function(e_h){if(e_h.success){m.web('helpfulYes').setClassState(m.e_i,e_e);m.web('helpfulNo').setClassState(m.e_i,!e_e);m.e_e=e_e?1:0;}});}});};e_c.e_j=function(){var m=this;m.callInherited('ensureLoggedIn')({
callback:function(){m.e_f=m.getInherited('user').id;m.ajax({serviceUrl:'/svc/product/productreviews/flagreview',mbr:m.e_f,rid:m.e_g},function(e_h){if(e_h.success){m.web('violationLink').setClassState(m.e_i,e_a);
}});}});};e_c.updateUi=function(){var m=this,e_k=m.children,e_l=e_k.rating,e_m=e_k.review;if(m.isWired){e_l&&e_l.updateUi();e_m&&e_m.updateUi();e_$.doMy(m,'updateUi');}};e_c.wireUi=function(){var m=this;
if(!m.isWired){m.wireNode('helpfulYes','click',function(){m.e_d(e_a);});m.wireNode('helpfulNo','click',function(){m.e_d(e__);});m.wireNode('violationLink','click',function(){m.confirm({title:m.localize('violationTitle'),
message:m.localize('violationMessage'),okText:m.localize('yes'),cancelText:m.localize('no'),yesHandler:function(){m.e_j();}});});m.callInherited('wireTooltip')({node:m.getNode('helpfulYes')});m.callInherited('wireTooltip')({node:m.getNode('helpfulNo')});
m.callInherited('wireTooltip')({node:m.getNode('violationLink')});e_$.doMy(m,'wireUi');m.updateUi();}};e_b.stateProperties({e_e:'helpful',e_f:{name:'memberId',value:0},e_g:'reviewId',e_n:'memberIconUrl',
e_i:'cssClassActionSelected'});return e_b;}});
Uize.module({name:'Zazzle.Collection.Reviews',superclass:'Uize.Widget.Collection.Dynamic',required:['Zazzle.CollectionItem.Review'],builder:function(f_$){var f__=f_$.subclass(null,function(){var m=this;
m.wire({'Items Changed':function(){m.f_a()},Remove:function(f_b){if(f_b.byUser){f_b.handled=true;var f_c=f_b.itemWidgets,f_d=f_c[0].get('memberId'),f_e=f_c[0].get('reviewId');m.ajax({serviceUrl:'/svc/product/productreviews/removereview',
rid:f_e,mbr:f_d},function(f_f){!f_f.success?m.inform({message:m.localize('removeItemError')}):f_b.finishRemove(f_c,f_b.byUser);});}}});}),f_g=f__.prototype;f_g.f_a=function(){var m=this;if(m.isWired){
var f_h=m.get('totalItems')>0;m.displayNode('items',f_h);m.displayNode('noReviews',!f_h);}};f_g.updateUi=function(){var m=this;if(m.isWired){m.f_a();f_$.doMy(m,'updateUi');}};f_g.wireUi=function(){var m=this;
if(!m.isWired){m.wireNode('writeAReview','click',function(){m.callInherited('ensureLoggedIn')({callback:function(f_i){m.ajax({serviceUrl:'/svc/product/productreviews/canreview',mbr:m.getInherited('user').id,
pt:m.f_j,pd:m.f_k},function(f_l){var f_f=f_l.data;m.f_m=f_f.hasOthers;m.f_n=f_f.goToForm;m.f_o=f_f.reviewUrl;if(m.f_n){location.href=m.f_o;}else{var f_p=m.localize('message')+'<br /><br />';m.f_m&&(f_p+='<a href="'+m.get('urls').productsToReviewUrl+'">'+m.localize('linkMessage')+'</a>');
m.inform({title:m.localize('title'),message:f_p,state:'info'});}});}});});f_$.doMy(m,'wireUi');}};f__.stateProperties({f_m:'canReviewItems',f_n:'canReviewThis',f_j:'productType',f_o:'reviewFormUrl',f_k:'rootId'
});f__.set({itemWidgetClass:Zazzle.CollectionItem.Review});return f__;}});
Uize.module({name:'Zazzle.Results.Reviews',superclass:'Zazzle.Results',required:['Zazzle.Collection.Reviews','Zazzle.Droplist','Zazzle.Widget.mV2'],builder:function(f_$){'use strict';var f__=Uize,f_a=true,
f_b='updateResults';return f_$.subclass({mixins:Zazzle.Widget.mV2,stateProperties:{f_c:{name:'ajaxBoth',value:false},f_d:{name:'attributes',onChange:f_b},f_e:{name:'callerId',value:0},f_f:'imageBackgroundColor',
f_g:{name:'memberId',onChange:f_b},f_h:'minRating',f_i:{name:'rootId',onChange:f_b},f_j:{name:'qualifiedType',onChange:f_b},f_k:{name:'reviewsSet',onChange:f_b,value:'OnProductType'},f_l:'reviewerId',
f_m:{name:'storeId',onChange:f_b},f_n:{name:'ratingsFilterValue',onChange:function(){var m=this,f_o=m.get('ratingsFilterValues');if(m.isWired){if(f_o&&f_o.length>2){m.set('alwaysShowTop',f_a);}m.updateResults();
m.fire({name:'Track Event',bubble:f_a,extra:{ax:'ratingFilterClicked',rating:m.get('ratingsFilterValue')}});}}},f_p:'isPublic',f_q:'privateView',f_r:'reviewQuality',f_s:'similarReviewsTitle',f_t:'testHash',
f_o:{name:'ratingsFilterValues',value:[],onChange:function(){var m=this,f_o=m.get('ratingsFilterValues');if(m.isWired&& !f__.isNully(f_o)&&m.children.ratingsFilter.get('values').length<2){m.children.ratingsFilter.set('values',f_o);
}}},f_u:'showFilteredMessage',f_v:'filteredMessageText'},children:{ratingsFilter:Zazzle.Droplist},childBindings:{ratingsFilterValue:'ratingsFilter.value'},htmlBindings:{showFilteredMessage:'filteredMessage:show',
filteredMessageText:'filteredMessageText:value'},eventBindings:{'#showAll:click':function(){this.set('ratingsFilterValue','all');},':Updated Data':function(){var m=this,f_v='',f_n=m.get('ratingsFilterValue')
;if(m.get('numResults')==0){f_v=m.localize('noFilteredResults').replace('{curRating}',f_n);}else{f_v=m.localize('filterMessage').replace('{pageSize}',Math.min(m.get('numResults'),m.get('pageSize'))).replace('{totalNum}',m.get('numResults'))
.replace('{curRating}',f_n);}m.set('filteredMessageText',f_v);m.set('showFilteredMessage',!f__.isNully(f_n)&&f_n!='all');}},instanceMethods:{getServiceParams:function(){var m=this;return Uize.copyInto(
f_$.doMy(m,'getServiceParams'),{ax:m.f_k,useCache:f_a,rpd:m.f_i,pt:m.f_j,callerId:m.f_e,mbr:m.f_l,att:m.f_d,voting:m.f_w,isPublic:m.f_p,privateView:m.f_q,reviewQuality:m.f_r,minRating:m.f_h,sr:m.f_m,
rating:m.f_n});}},set:{collectionWidgetClass:Zazzle.Collection.Reviews}});}});
Uize.module({name:'Zazzle.GridCell.Image',required:['Uize.Url','Uize.Dom.Pos'],builder:function(g_$){'use strict';var g__=false,g_a=Uize,g_b=g_a.Url;var g_c=g_$.subclass(),g_d=g_c.prototype;g_d.imageUrl=function(g_e){
var m=this,g_f=m.get('properties');return g_b.resolve(m.getInherited('env').imageRealview,Uize.copyInto({action:'getimage',square_it:g__,id:g_f.im},g_e));};g_d.click=function(){var m=this,g_g=g_a.Dom.Pos.getDimensions(window),
g_h=g_g.width,g_i=g_g.height,g_j=Math.min(1000,g_h,g_i),g_k=m.imageUrl();m.g_l&&m.callInherited('useDialog')({component:{name:'Zazzle.ImageOverlay'},widgetProperties:{name:'imageCellOverlay',url:g_k,
maxDim:g_j}});};g_d.wireUi=function(){var m=this;if(!m.isWired&&m.getNode('')){m.wireNode('realview','click',function(){m.click()});g_$.doMy(m,'wireUi');}};g_c.stateProperties({g_m:'imageTitle',g_l:{
name:'launchImageOverlay',value:true}});return g_c;}});
Uize.module('ZazzleWww.CollectionItem');
Uize.module({name:'ZazzleWww.CollectionItem.Comment',superclass:'Uize.Widget.CollectionItem',required:'Zazzle.GridCell.Image',builder:function(e_$){return e_$.subclass({mixins:Uize.Widget.mDeclarativeChildren,
children:{imageCell:Zazzle.GridCell.Image}});}});
Uize.module({name:'Uize.Widget.mBindings',required:['Uize.Widget.mHtmlBindings','Uize.Widget.mCssBindings','Uize.Widget.mEventBindings','Uize.Widget.mDeclarativeChildren'],builder:function(){'use strict';
return[Uize.Widget.mHtmlBindings,Uize.Widget.mCssBindings,Uize.Widget.mEventBindings,Uize.Widget.mDeclarativeChildren];}});
Uize.module({name:'ZazzleWww.Collection.Comments',superclass:'Uize.Widget.Collection.Dynamic',required:['ZazzleWww.CollectionItem.Comment','Uize.Widget.mBindings'],builder:function(f_$){'use strict';return f_$.subclass({
mixins:Uize.Widget.mBindings,omegastructor:function(){this.set({itemWidgetClass:ZazzleWww.CollectionItem.Comment});},eventBindings:{':Remove':function(f__){if(f__.byUser){f__.handled=true;var m=this,
f_a=f__.itemWidgets,f_b=f_a[0].get('properties');m.ajax({service:'store/comments',ax:'delete',ci:f_b.commentId},function(f_c){!f_c.success?m.inform({message:m.localize('removeItemError')}):f__.finishRemove(f_a,f__.byUser)
;});}}}});}});
Uize.module({name:'ZazzleWww.ResultsComments',superclass:'Zazzle.Results',required:'ZazzleWww.Collection.Comments',builder:function(f_$){var f__=false,f_a=true;var f_b=f_$.subclass(),f_c=f_b.prototype;
f_c.getServiceParams=function(){var m=this;return Uize.copyInto(f_$.doMy(m,'getServiceParams'),{ax:m.f_d,useCache:m.f_e,canDelete:m.f_f,sr:m.f_g,pd:m.f_h,callerId:m.f_i,mbr:m.f_j});};var f_k='updateResults';
f_b.stateProperties({f_i:{name:'callerId',value:0},f_f:{name:'canDelete',value:f__},f_d:{name:'commentsSet',onChange:f_k,value:'OnStore'},f_j:{name:'memberId',onChange:f_k},f_h:{name:'productId',onChange:f_k
},f_g:{name:'storeId',onChange:f_k},f_e:{name:'useCache',value:f_a}});f_b.set({collectionWidgetClass:ZazzleWww.Collection.Comments});return f_b;}});
Uize.module({name:'ZazzleWww.CommentWall',superclass:'Uize.Widget',required:['ZazzleWww.ResultsComments','Uize.Widget.Button'],builder:function(d_$){var d__=false,d_a=true,d_b=null;var d_c=d_$.subclass(
d_b,function(){var m=this,d_d=m.addChild('comments',ZazzleWww.ResultsComments,{callerId:m.d_e,commentsSet:m.d_f?'OnProduct':'OnStore',productId:m.d_f,storeId:m.d_g});m.addChild('add',Uize.Widget.Button).wire(
'Click',function(){var d_h=m.getInherited('user').id;function d_i(){m.callInherited('useDialog')({component:{name:'ZazzleWww.Dialog.Form.Comment',params:{md:'add',mbr:m.d_h,pd:m.d_f,sr:m.d_g}},widgetProperties:{name:'commentDialog'},
submitHandler:function(){d_d.reset()}});}if(!m.d_j)m.callInherited('enableProfile')({memberId:d_h,dialogTitle:m.localize('dialogTitle'),callback:function(){m.set('memberId',m.getInherited('user').id);
d_i();}});else d_i();});});d_c.prototype.wireUi=function(){var m=this;if(!m.isWired){var d_k=m.getProvider('user');d_k.wire('Changed.user',function(){m.displayNode('manageShell',m.d_l==d_k.get('user').id)
});d_$.doMy(m,'wireUi');}};d_c.stateProperties({d_e:'callerId',d_l:'ownerId',d_f:'productId',d_g:'storeId',d_j:'displayname',d_h:'memberId'});return d_c;}});
Uize.module('ZazzleWww.CollectionItem.Cell');
Uize.module({name:'ZazzleWww.CollectionItem.Cell.RecentlyViewed',superclass:'Zazzle.CollectionItem.Cell',required:['Zazzle.Widget.mV2'],builder:function(g_$){'use strict';var g__=Uize;return g_$.subclass({
mixins:Zazzle.Widget.mV2,stateProperties:{},htmlBindings:{},eventBindings:{'#previewShell:click':function(){var m=this,g_a=m.get('properties');m.fire({name:'Track Event',bubble:true,extra:{ax:'recentlyViewedItemClicked',
objectId:g_a&&g_a.id,objectType:g_a&&g_a.type}});}}});}});
Uize.module({name:'ZazzleWww.Results.RecentlyViewed',superclass:'Zazzle.Results.Cell',required:['Uize.Widget.Collection.Dynamic','Zazzle.Widget.mV2'],builder:function(g_$){'use strict';var g__=Uize,g_a=null
;return g_$.subclass({mixins:Zazzle.Widget.mV2,stateProperties:{g_b:{name:'objectIdToFilter',value:g_a},g_c:'recentlyViewedTitle'},children:{},omegastructor:function(){var m=this;},instanceMethods:{g_d:function(){
var m=this,g_e=m.get('page');m.web('prev').display(g_e>1);m.web('next').display((g_e*m.get('pageSize'))<m.get('numResults'));},g_f:function(){var m=this,g_g=m.get('numResults');m.web('recentlyViewedTitle').display(g_g);
},getServiceParams:function(){var m=this;return g__.copyInto(g_$.doMy(m,'getServiceParams'),{objectIdToFilter:m.g_b});},updateUi:function(){var m=this;m.g_d();g_$.doMy(m,'updateUi');},wireUi:function(){
var m=this;if(!m.isWired){m.wireNode('prev','click',function(){m.set({page:Math.max(m.get('page')-1,1)});});m.wireNode('next','click',function(){m.set({page:Math.min(m.get('page')+1,Math.ceil(m.get('numResults')/m.get('pageSize')))});
});m.wire('Updated Data',function(){m.g_f();m.g_d();});g_$.doMy(m,'wireUi');}}},set:{collectionWidgetClass:Uize.Widget.Collection.Dynamic}});}});

